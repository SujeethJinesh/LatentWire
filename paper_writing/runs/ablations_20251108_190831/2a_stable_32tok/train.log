W1108 20:22:29.899000 2706851 torch/distributed/run.py:793] 
W1108 20:22:29.899000 2706851 torch/distributed/run.py:793] *****************************************
W1108 20:22:29.899000 2706851 torch/distributed/run.py:793] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1108 20:22:29.899000 2706851 torch/distributed/run.py:793] *****************************************
/users/sujinesh/.local/lib/python3.10/site-packages/transformers/utils/hub.py:128: FutureWarning: Using `TRANSFORMERS_CACHE` is deprecated and will be removed in v5 of Transformers. Use `HF_HOME` instead.
  warnings.warn(
/users/sujinesh/.local/lib/python3.10/site-packages/transformers/utils/hub.py:128: FutureWarning: Using `TRANSFORMERS_CACHE` is deprecated and will be removed in v5 of Transformers. Use `HF_HOME` instead.
  warnings.warn(
/users/sujinesh/.local/lib/python3.10/site-packages/transformers/utils/hub.py:128: FutureWarning: Using `TRANSFORMERS_CACHE` is deprecated and will be removed in v5 of Transformers. Use `HF_HOME` instead.
  warnings.warn(
/users/sujinesh/.local/lib/python3.10/site-packages/transformers/utils/hub.py:128: FutureWarning: Using `TRANSFORMERS_CACHE` is deprecated and will be removed in v5 of Transformers. Use `HF_HOME` instead.
  warnings.warn(
==== Config ====
source_model: mistralai/Mistral-7B-Instruct-v0.3
target_model: meta-llama/Meta-Llama-3.1-8B-Instruct
translator_type: bottleneck_gated
bottleneck_dim: 768
soft_tokens: 32
depth: 4
heads: 12
lr: 0.0001
weight_decay: 0.01
train_steps: 3000
warmup_steps: 600
per_device_batch: 10
eval_every: 250
eval_samples: 500
max_new_tokens: 256
seed: 1234
bf16: True
save_path: paper_writing/runs/ablations_20251108_190831/2a_stable_32tok/checkpoint.pt
show_eval_samples: 1
early_stop_patience: 5
dataset: gsm8k
info_nce_weight: 0.05
Loading source model/tokenizer...
Downloading shards:   0%|          | 0/3 [00:00<?, ?it/s]Downloading shards: 100%|██████████| 3/3 [00:00<00:00, 808.20it/s]
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:00<00:00,  2.12it/s]Downloading shards:   0%|          | 0/3 [00:00<?, ?it/s]Downloading shards: 100%|██████████| 3/3 [00:00<00:00, 6006.16it/s]
Loading checkpoint shards:  67%|██████▋   | 2/3 [00:00<00:00,  2.82it/s]Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Downloading shards:   0%|          | 0/3 [00:00<?, ?it/s]Downloading shards:   0%|          | 0/3 [00:00<?, ?it/s]Downloading shards: 100%|██████████| 3/3 [00:00<00:00, 3766.21it/s]
Downloading shards: 100%|██████████| 3/3 [00:00<00:00, 407.97it/s]
Loading checkpoint shards: 100%|██████████| 3/3 [00:01<00:00,  3.17it/s]Loading checkpoint shards: 100%|██████████| 3/3 [00:01<00:00,  2.91it/s]
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:00<00:00,  2.52it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:00<00:00,  2.35it/s]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:00<00:00,  3.00it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:00<00:00,  2.27it/s]Loading checkpoint shards: 100%|██████████| 3/3 [00:00<00:00,  3.13it/s]Loading checkpoint shards: 100%|██████████| 3/3 [00:00<00:00,  3.01it/s]
Loading checkpoint shards:  67%|██████▋   | 2/3 [00:00<00:00,  2.49it/s]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:00<00:00,  2.50it/s]Loading checkpoint shards: 100%|██████████| 3/3 [00:01<00:00,  2.73it/s]Loading checkpoint shards: 100%|██████████| 3/3 [00:01<00:00,  2.68it/s]Loading checkpoint shards: 100%|██████████| 3/3 [00:01<00:00,  2.61it/s]
Loading checkpoint shards: 100%|██████████| 3/3 [00:01<00:00,  2.60it/s]
Loading target model/tokenizer...
Downloading shards:   0%|          | 0/4 [00:00<?, ?it/s]Downloading shards: 100%|██████████| 4/4 [00:00<00:00, 3969.06it/s]
Downloading shards:   0%|          | 0/4 [00:00<?, ?it/s]Downloading shards: 100%|██████████| 4/4 [00:00<00:00, 8816.19it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Downloading shards:   0%|          | 0/4 [00:00<?, ?it/s]Downloading shards: 100%|██████████| 4/4 [00:00<00:00, 8004.40it/s]
Downloading shards:   0%|          | 0/4 [00:00<?, ?it/s]Downloading shards: 100%|██████████| 4/4 [00:00<00:00, 8733.58it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:00<00:01,  2.70it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:00<00:01,  2.71it/s]Loading checkpoint shards:  50%|█████     | 2/4 [00:00<00:00,  2.92it/s]Loading checkpoint shards:  50%|█████     | 2/4 [00:00<00:00,  2.80it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:00<00:01,  2.05it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:00<00:01,  1.63it/s]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:01<00:00,  2.46it/s]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:01<00:00,  2.33it/s]Loading checkpoint shards:  50%|█████     | 2/4 [00:01<00:01,  1.83it/s]Loading checkpoint shards:  50%|█████     | 2/4 [00:01<00:01,  1.64it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:01<00:00,  2.49it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:01<00:00,  2.54it/s]
Loading checkpoint shards: 100%|██████████| 4/4 [00:01<00:00,  2.48it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:01<00:00,  2.49it/s]
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:01<00:00,  2.05it/s]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:01<00:00,  2.13it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:01<00:00,  2.13it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:01<00:00,  2.04it/s]
Loading checkpoint shards: 100%|██████████| 4/4 [00:01<00:00,  2.13it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:02<00:00,  1.99it/s]
Source hidden dim: 4096 | Target hidden dim: 4096
Target embedding RMS: 0.0105
Translator parameters: 61.5M
Loading GSM8K...
Optimizer groups: 34 decay, 59 no_decay, 4 gates (LR ×3)
Step 20/3000 | Loss (avg over last 20): 10.0264
Step 40/3000 | Loss (avg over last 20): 10.1307
Step 60/3000 | Loss (avg over last 20): 9.9787
Step 80/3000 | Loss (avg over last 20): 9.0891
Step 100/3000 | Loss (avg over last 20): 8.4529
Step 120/3000 | Loss (avg over last 20): 8.2311
Step 140/3000 | Loss (avg over last 20): 7.5671
Step 160/3000 | Loss (avg over last 20): 7.4484
Step 180/3000 | Loss (avg over last 20): 7.0667
Step 200/3000 | Loss (avg over last 20): 6.7051
Step 220/3000 | Loss (avg over last 20): 6.4176
Step 240/3000 | Loss (avg over last 20): 6.1792
/users/sujinesh/.local/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:590: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/users/sujinesh/.local/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:595: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(

============================================================
SAMPLE OUTPUTS (first 3 examples):
============================================================

--- Example 1 ---
Question: You are a helpful math tutor. Solve the problem step by step, then end your final line with '#### <number>'.

Problem:
Janet’s ducks lay 16 eggs per day. She eats three for breakfast every morning and...
Gold answer: 18
Target-alone: 210.0.0
Bridged: [invalid]
Bridged generation start: + is was / is/ has is/90 is/1/ is being is/ / is + and is/ will is/ - is/ > is/4/ is: + is / + is: was is / was is is –/ is  was/ + / + was/ =/ is /+ is  / is was - is + / is / and is ++ is...

--- Example 2 ---
Question: You are a helpful math tutor. Solve the problem step by step, then end your final line with '#### <number>'.

Problem:
A robe takes 2 bolts of blue fiber and half that much white fiber.  How many bolt...
Gold answer: 3
Target-alone: 3
Bridged: [invalid]
Bridged generation start:  + =/ = / / $ / + + / = / + $ /  is / + >/ / * / + is/ / / $ / / / = + / * /  $/ $  / = / > / + * / / is/ $+ / / >  / * + / > /  * / $ = / / *  / > + / is / /+ /  > / / - / + // / + / $- / /> / + - / /$ / +// /  - / $+/...

--- Example 3 ---
Question: You are a helpful math tutor. Solve the problem step by step, then end your final line with '#### <number>'.

Problem:
Josh decides to try flipping a house.  He buys a house for $80,000 and then puts ...
Gold answer: 70000
Target-alone: 97500
Bridged: [invalid]
Bridged generation start: 4  =   *  16/ >>  11/ + = / + 0 /  + = 52 + ...
============================================================

[Eval] Step 250 | Target-alone acc: 0.296 | Bridged acc: 0.008
[Early Stop] New best bridged acc: 0.008, resetting patience
Step 260/3000 | Loss (avg over last 20): 5.9614
Step 280/3000 | Loss (avg over last 20): 5.8608
Step 300/3000 | Loss (avg over last 20): 5.8304
Step 320/3000 | Loss (avg over last 20): 5.6220
Step 340/3000 | Loss (avg over last 20): 5.6346
Step 360/3000 | Loss (avg over last 20): 5.6164
Step 380/3000 | Loss (avg over last 20): 5.5882
Step 400/3000 | Loss (avg over last 20): 5.6041
Step 420/3000 | Loss (avg over last 20): 5.4859
Step 440/3000 | Loss (avg over last 20): 5.4301
Step 460/3000 | Loss (avg over last 20): 5.3803
Step 480/3000 | Loss (avg over last 20): 5.3967
Step 500/3000 | Loss (avg over last 20): 5.4130

============================================================
SAMPLE OUTPUTS (first 3 examples):
============================================================

--- Example 1 ---
Question: You are a helpful math tutor. Solve the problem step by step, then end your final line with '#### <number>'.

Problem:
Janet’s ducks lay 16 eggs per day. She eats three for breakfast every morning and...
Gold answer: 18
Target-alone: 210.0.0
Bridged: [invalid]

--- Example 2 ---
Question: You are a helpful math tutor. Solve the problem step by step, then end your final line with '#### <number>'.

Problem:
A robe takes 2 bolts of blue fiber and half that much white fiber.  How many bolt...
Gold answer: 3
Target-alone: 3
Bridged: [invalid]
Bridged generation start:  202210 0210 250 =  = =210 =210210 = = =
 210
  =
 =15 210>>210 ==210 =
210 =15  =15 =210=210210210= =210
210=
210210 is210210
 =210>> 2105210 =>>210210>> =210 Mour 21015210210 Mour210210400210210...

--- Example 3 ---
Question: You are a helpful math tutor. Solve the problem step by step, then end your final line with '#### <number>'.

Problem:
Josh decides to try flipping a house.  He buys a house for $80,000 and then puts ...
Gold answer: 70000
Target-alone: 97500
Bridged: [invalid]
Bridged generation start: 800 250
210 is0210210 is is210 is250 500 is 0=   is = ==  is is  is210
800 0250 is 
2100800 =250 is is250 is25002500800 is 800=2102100202210210=0210250 is= 0
210=202210 is
210
150 210L210210
230 210Ms210 140 210...
============================================================

[Eval] Step 500 | Target-alone acc: 0.296 | Bridged acc: 0.006
[Early Stop] No improvement, patience: 1/5
Step 520/3000 | Loss (avg over last 20): 5.4394
Step 540/3000 | Loss (avg over last 20): 5.2483
Step 560/3000 | Loss (avg over last 20): 5.2402
Step 580/3000 | Loss (avg over last 20): 5.2264
Step 600/3000 | Loss (avg over last 20): 5.2912
Step 620/3000 | Loss (avg over last 20): 11.0349
Step 640/3000 | Loss (avg over last 20): 7.3196
Step 660/3000 | Loss (avg over last 20): 6.6184
Step 680/3000 | Loss (avg over last 20): 6.6575
Step 700/3000 | Loss (avg over last 20): 6.3978
Step 720/3000 | Loss (avg over last 20): 6.4975
Step 740/3000 | Loss (avg over last 20): 6.2172

============================================================
SAMPLE OUTPUTS (first 3 examples):
============================================================

--- Example 1 ---
Question: You are a helpful math tutor. Solve the problem step by step, then end your final line with '#### <number>'.

Problem:
Janet’s ducks lay 16 eggs per day. She eats three for breakfast every morning and...
Gold answer: 18
Target-alone: 210.0.0
Bridged: [invalid]

--- Example 2 ---
Question: You are a helpful math tutor. Solve the problem step by step, then end your final line with '#### <number>'.

Problem:
A robe takes 2 bolts of blue fiber and half that much white fiber.  How many bolt...
Gold answer: 3
Target-alone: 3
Bridged: [invalid]
Bridged generation start: > = 40 = 20 = 2 = 16 = 3 = 24 =  << = 4 = 6 =, = =+ =*= =*+ ** = =
 = =<< = =>> = =2 = =3 =** *<< =*<< *>> =*>> *...

--- Example 3 ---
Question: You are a helpful math tutor. Solve the problem step by step, then end your final line with '#### <number>'.

Problem:
Josh decides to try flipping a house.  He buys a house for $80,000 and then puts ...
Gold answer: 70000
Target-alone: 97500
Bridged: [invalid]
Bridged generation start: 0000$000++=<<000+
+++
=+
000+<<+=*+=100==*==<<++<<==.++*=

+

=
 ++ += +
*++100++,++ the++ +++-++ =++200++50++60++00++20++120++%++5++240++800...
============================================================

[Eval] Step 750 | Target-alone acc: 0.296 | Bridged acc: 0.012
[Early Stop] New best bridged acc: 0.012, resetting patience
Step 760/3000 | Loss (avg over last 20): 6.0968
Step 780/3000 | Loss (avg over last 20): 6.1668
Step 800/3000 | Loss (avg over last 20): 6.1007
Step 820/3000 | Loss (avg over last 20): 6.0668
Step 840/3000 | Loss (avg over last 20): 6.0387
Step 860/3000 | Loss (avg over last 20): 6.1433
Step 880/3000 | Loss (avg over last 20): 5.9974
Step 900/3000 | Loss (avg over last 20): 5.8198
Step 920/3000 | Loss (avg over last 20): 6.1869
Step 940/3000 | Loss (avg over last 20): 5.9114
Step 960/3000 | Loss (avg over last 20): 6.0693
Step 980/3000 | Loss (avg over last 20): 5.8469
Step 1000/3000 | Loss (avg over last 20): 5.7151

============================================================
SAMPLE OUTPUTS (first 3 examples):
============================================================

--- Example 1 ---
Question: You are a helpful math tutor. Solve the problem step by step, then end your final line with '#### <number>'.

Problem:
Janet’s ducks lay 16 eggs per day. She eats three for breakfast every morning and...
Gold answer: 18
Target-alone: 210.0.0
Bridged: [invalid]

--- Example 2 ---
Question: You are a helpful math tutor. Solve the problem step by step, then end your final line with '#### <number>'.

Problem:
A robe takes 2 bolts of blue fiber and half that much white fiber.  How many bolt...
Gold answer: 3
Target-alone: 3
Bridged: [invalid]
Bridged generation start:  4 = 4.
 +2 +/ + = +4  == 2* 26 /6 25 /5 2
 /8 />> /* /
 2>> 28 2<<...

--- Example 3 ---
Question: You are a helpful math tutor. Solve the problem step by step, then end your final line with '#### <number>'.

Problem:
Josh decides to try flipping a house.  He buys a house for $80,000 and then puts ...
Gold answer: 70000
Target-alone: 97500
Bridged: [invalid]
Bridged generation start: 0 in00000021000000030000000140000000500000060000000 for000000 total000000 a000000##000000 he00000010000002000000 will000000 <<00000080000000 The000000300000015000000180000000450000000 +000000:000000**000000230000000 000000 by0000006000000800000025000000>00000020100000022000000024000000550000000 year...
============================================================

[Eval] Step 1000 | Target-alone acc: 0.296 | Bridged acc: 0.010
[Early Stop] No improvement, patience: 1/5
Step 1020/3000 | Loss (avg over last 20): 6.0252
Step 1040/3000 | Loss (avg over last 20): 5.9886
Step 1060/3000 | Loss (avg over last 20): 5.9603
Step 1080/3000 | Loss (avg over last 20): 5.9316
Step 1100/3000 | Loss (avg over last 20): 5.7229
Step 1120/3000 | Loss (avg over last 20): 5.7820
Step 1140/3000 | Loss (avg over last 20): 5.8222
Step 1160/3000 | Loss (avg over last 20): 5.7623
Step 1180/3000 | Loss (avg over last 20): 5.6307
Step 1200/3000 | Loss (avg over last 20): 5.8097
Step 1220/3000 | Loss (avg over last 20): 5.6587
Step 1240/3000 | Loss (avg over last 20): 5.9765

============================================================
SAMPLE OUTPUTS (first 3 examples):
============================================================

--- Example 1 ---
Question: You are a helpful math tutor. Solve the problem step by step, then end your final line with '#### <number>'.

Problem:
Janet’s ducks lay 16 eggs per day. She eats three for breakfast every morning and...
Gold answer: 18
Target-alone: 210.0.0
Bridged: [invalid]

--- Example 2 ---
Question: You are a helpful math tutor. Solve the problem step by step, then end your final line with '#### <number>'.

Problem:
A robe takes 2 bolts of blue fiber and half that much white fiber.  How many bolt...
Gold answer: 3
Target-alone: 3
Bridged: [invalid]
Bridged generation start: 24/2452412*/446264*64266*6/2/*2502*52*.
2* 2*60...

--- Example 3 ---
Question: You are a helpful math tutor. Solve the problem step by step, then end your final line with '#### <number>'.

Problem:
Josh decides to try flipping a house.  He buys a house for $80,000 and then puts ...
Gold answer: 70000
Target-alone: 97500
Bridged: [invalid]
Bridged generation start: 12000##002000.00800005=0=000=1000==0/=01000000100=000=0####0000####=0*0000*=0
=0<<0000<<=02000000200=05000-002400014000+004000018000$0000####0000*0000
000015000001200000001500000<<000...
============================================================

[Eval] Step 1250 | Target-alone acc: 0.296 | Bridged acc: 0.008
[Early Stop] No improvement, patience: 2/5
Step 1260/3000 | Loss (avg over last 20): 5.6679
Step 1280/3000 | Loss (avg over last 20): 5.5660
Step 1300/3000 | Loss (avg over last 20): 5.8635
Step 1320/3000 | Loss (avg over last 20): 5.5260
Step 1340/3000 | Loss (avg over last 20): 5.6247
Step 1360/3000 | Loss (avg over last 20): 5.5933
Step 1380/3000 | Loss (avg over last 20): 5.5659
Step 1400/3000 | Loss (avg over last 20): 5.5079
Step 1420/3000 | Loss (avg over last 20): 5.5568
Step 1440/3000 | Loss (avg over last 20): 5.7537
Step 1460/3000 | Loss (avg over last 20): 5.6057
Step 1480/3000 | Loss (avg over last 20): 5.5962
Step 1500/3000 | Loss (avg over last 20): 5.5446

============================================================
SAMPLE OUTPUTS (first 3 examples):
============================================================

--- Example 1 ---
Question: You are a helpful math tutor. Solve the problem step by step, then end your final line with '#### <number>'.

Problem:
Janet’s ducks lay 16 eggs per day. She eats three for breakfast every morning and...
Gold answer: 18
Target-alone: 210.0.0
Bridged: [invalid]

--- Example 2 ---
Question: You are a helpful math tutor. Solve the problem step by step, then end your final line with '#### <number>'.

Problem:
A robe takes 2 bolts of blue fiber and half that much white fiber.  How many bolt...
Gold answer: 3
Target-alone: 3
Bridged: [invalid]
Bridged generation start: 62=6238*=*66248*+6*=6*+8*3*6=26+26=6688868666+*6...

--- Example 3 ---
Question: You are a helpful math tutor. Solve the problem step by step, then end your final line with '#### <number>'.

Problem:
Josh decides to try flipping a house.  He buys a house for $80,000 and then puts ...
Gold answer: 70000
Target-alone: 97500
Bridged: [invalid]
Bridged generation start: 0##003006
06000000600
01200000120000200000*10000001000
10001001000=1000200...
============================================================

[Eval] Step 1500 | Target-alone acc: 0.296 | Bridged acc: 0.014
[Early Stop] New best bridged acc: 0.014, resetting patience
Step 1520/3000 | Loss (avg over last 20): 5.5844
Step 1540/3000 | Loss (avg over last 20): 5.4199
Step 1560/3000 | Loss (avg over last 20): 5.4929
Step 1580/3000 | Loss (avg over last 20): 5.5244
Step 1600/3000 | Loss (avg over last 20): 5.5195
Step 1620/3000 | Loss (avg over last 20): 5.4736
Step 1640/3000 | Loss (avg over last 20): 5.3699
Step 1660/3000 | Loss (avg over last 20): 5.4733
Step 1680/3000 | Loss (avg over last 20): 5.4236
Step 1700/3000 | Loss (avg over last 20): 5.4464
Step 1720/3000 | Loss (avg over last 20): 5.5287
Step 1740/3000 | Loss (avg over last 20): 5.3636

============================================================
SAMPLE OUTPUTS (first 3 examples):
============================================================

--- Example 1 ---
Question: You are a helpful math tutor. Solve the problem step by step, then end your final line with '#### <number>'.

Problem:
Janet’s ducks lay 16 eggs per day. She eats three for breakfast every morning and...
Gold answer: 18
Target-alone: 210.0.0
Bridged: [invalid]
Bridged generation start: 8.
=*.
=.
########.
####/.
#### ####.
/...

--- Example 2 ---
Question: You are a helpful math tutor. Solve the problem step by step, then end your final line with '#### <number>'.

Problem:
A robe takes 2 bolts of blue fiber and half that much white fiber.  How many bolt...
Gold answer: 3
Target-alone: 3
Bridged: [invalid]
Bridged generation start:  =2.
 ==.
.
 4.
.
 =*.
0.
.
=.
.
.
 of.
.
/.
.
8.
.
4.
=8.
=4.
28.
2.
2
.
24.
/2//.
*8.
*
.
.

.
 8.
 
.
*<<.
.
+.
 6...

--- Example 3 ---
Question: You are a helpful math tutor. Solve the problem step by step, then end your final line with '#### <number>'.

Problem:
Josh decides to try flipping a house.  He buys a house for $80,000 and then puts ...
Gold answer: 70000
Target-alone: 97500
Bridged: [invalid]
Bridged generation start: 080000000+00000120000000500000002400000001000000025000000020000000150000000900000000##000000=$0000004000000030000000700000000The00000012000000$0000050000000####00000.
00000*00000.00000>>00000 0000040000000 the00000##00000###0000005000000600000002000000>000000-$000000In000000 for000000 will0000001000...
============================================================

[Eval] Step 1750 | Target-alone acc: 0.296 | Bridged acc: 0.012
[Early Stop] No improvement, patience: 1/5
Step 1760/3000 | Loss (avg over last 20): 5.5781
Step 1780/3000 | Loss (avg over last 20): 5.3927
Step 1800/3000 | Loss (avg over last 20): 5.4092
Step 1820/3000 | Loss (avg over last 20): 5.4250
Step 1840/3000 | Loss (avg over last 20): 5.4377
Step 1860/3000 | Loss (avg over last 20): 5.2662
Step 1880/3000 | Loss (avg over last 20): 5.5216
Step 1900/3000 | Loss (avg over last 20): 5.4008
Step 1920/3000 | Loss (avg over last 20): 5.4173
Step 1940/3000 | Loss (avg over last 20): 5.5745
Step 1960/3000 | Loss (avg over last 20): 5.3796
Step 1980/3000 | Loss (avg over last 20): 5.4565
Step 2000/3000 | Loss (avg over last 20): 5.3167

============================================================
SAMPLE OUTPUTS (first 3 examples):
============================================================

--- Example 1 ---
Question: You are a helpful math tutor. Solve the problem step by step, then end your final line with '#### <number>'.

Problem:
Janet’s ducks lay 16 eggs per day. She eats three for breakfast every morning and...
Gold answer: 18
Target-alone: 210.0.0
Bridged: [invalid]

--- Example 2 ---
Question: You are a helpful math tutor. Solve the problem step by step, then end your final line with '#### <number>'.

Problem:
A robe takes 2 bolts of blue fiber and half that much white fiber.  How many bolt...
Gold answer: 3
Target-alone: 3
Bridged: [invalid]
Bridged generation start: 28/=826.
//4//*//.
/682=4/6*/63/64/= /6+//####// of...

--- Example 3 ---
Question: You are a helpful math tutor. Solve the problem step by step, then end your final line with '#### <number>'.

Problem:
Josh decides to try flipping a house.  He buys a house for $80,000 and then puts ...
Gold answer: 70000
Target-alone: 97500
Bridged: [invalid]
Bridged generation start: 000000.
000000>>00000050000000 he000000%000000=$00000030000000$0000060000000 00000####00000.00000500000000000000000
0000/000020000001000000=00006000000####00005000000080000000<<0000012000000*000002500000040000008000000,0000.0000 00001200000<<0000*00004000000024000002400000090000000070000000021000000...
============================================================

[Eval] Step 2000 | Target-alone acc: 0.296 | Bridged acc: 0.010
[Early Stop] No improvement, patience: 2/5
Step 2020/3000 | Loss (avg over last 20): 5.4606
Step 2040/3000 | Loss (avg over last 20): 5.5019
Step 2060/3000 | Loss (avg over last 20): 5.2981
Step 2080/3000 | Loss (avg over last 20): 5.4527
Step 2100/3000 | Loss (avg over last 20): 5.4294
Step 2120/3000 | Loss (avg over last 20): 5.4038
Step 2140/3000 | Loss (avg over last 20): 5.3720
Step 2160/3000 | Loss (avg over last 20): 5.2974
Step 2180/3000 | Loss (avg over last 20): 5.3946
Step 2200/3000 | Loss (avg over last 20): 5.3563
Step 2220/3000 | Loss (avg over last 20): 5.2958
Step 2240/3000 | Loss (avg over last 20): 5.3943

============================================================
SAMPLE OUTPUTS (first 3 examples):
============================================================

--- Example 1 ---
Question: You are a helpful math tutor. Solve the problem step by step, then end your final line with '#### <number>'.

Problem:
Janet’s ducks lay 16 eggs per day. She eats three for breakfast every morning and...
Gold answer: 18
Target-alone: 210.0.0
Bridged: [invalid]
Bridged generation start: /
####/ ####...

--- Example 2 ---
Question: You are a helpful math tutor. Solve the problem step by step, then end your final line with '#### <number>'.

Problem:
A robe takes 2 bolts of blue fiber and half that much white fiber.  How many bolt...
Gold answer: 3
Target-alone: 3
Bridged: [invalid]
Bridged generation start: 2832842/.
26=/8.
//.
/88/8=2*/2 823824.
23623=2+/2+82*82
...

--- Example 3 ---
Question: You are a helpful math tutor. Solve the problem step by step, then end your final line with '#### <number>'.

Problem:
Josh decides to try flipping a house.  He buys a house for $80,000 and then puts ...
Gold answer: 70000
Target-alone: 97500
Bridged: [invalid]
Bridged generation start: 10000006000000600002000000=$001000000.
003000000,000010000600000000
00<<00-0000300000<<0000002000000005000000500005000000004000008000000800001500000$00,00800000000<<0000$0000400000040000$000024000%0000002400000+0000...
============================================================

[Eval] Step 2250 | Target-alone acc: 0.296 | Bridged acc: 0.012
[Early Stop] No improvement, patience: 3/5
Step 2260/3000 | Loss (avg over last 20): 5.2507
Step 2280/3000 | Loss (avg over last 20): 5.3562
Step 2300/3000 | Loss (avg over last 20): 5.4095
Step 2320/3000 | Loss (avg over last 20): 5.3711
Step 2340/3000 | Loss (avg over last 20): 5.3764
Step 2360/3000 | Loss (avg over last 20): 5.4076
Step 2380/3000 | Loss (avg over last 20): 5.4630
Step 2400/3000 | Loss (avg over last 20): 5.3300
Step 2420/3000 | Loss (avg over last 20): 5.2918
Step 2440/3000 | Loss (avg over last 20): 5.3123
Step 2460/3000 | Loss (avg over last 20): 5.4418
Step 2480/3000 | Loss (avg over last 20): 5.2107
Step 2500/3000 | Loss (avg over last 20): 5.2823

============================================================
SAMPLE OUTPUTS (first 3 examples):
============================================================

--- Example 1 ---
Question: You are a helpful math tutor. Solve the problem step by step, then end your final line with '#### <number>'.

Problem:
Janet’s ducks lay 16 eggs per day. She eats three for breakfast every morning and...
Gold answer: 18
Target-alone: 210.0.0
Bridged: [invalid]
Bridged generation start: />> /<< />>2/<<<</...

--- Example 2 ---
Question: You are a helpful math tutor. Solve the problem step by step, then end your final line with '#### <number>'.

Problem:
A robe takes 2 bolts of blue fiber and half that much white fiber.  How many bolt...
Gold answer: 3
Target-alone: 3
Bridged: [invalid]
Bridged generation start: /422 =/2 ==/6=/8=/.
//32/.
2=8/=82=.
/=.
26=66//.
=/>>6/66268/6...

--- Example 3 ---
Question: You are a helpful math tutor. Solve the problem step by step, then end your final line with '#### <number>'.

Problem:
Josh decides to try flipping a house.  He buys a house for $80,000 and then puts ...
Gold answer: 70000
Target-alone: 97500
Bridged: [invalid]
Bridged generation start: 0%000000.
000000 to000000$0000####000020000006000000=00001000000/00000####0000020000000=000001000000060000000,00005000000,000
000
00000
000000
####000

000
100000
200000
600000
=000
50000000500000
/000
,00000800000080000000<<0000<<00000400000040000000$0000012000006000000####0000200000010000005000000...
============================================================

[Eval] Step 2500 | Target-alone acc: 0.296 | Bridged acc: 0.014
[Early Stop] No improvement, patience: 4/5
Step 2520/3000 | Loss (avg over last 20): 5.3334
Step 2540/3000 | Loss (avg over last 20): 5.4435
Step 2560/3000 | Loss (avg over last 20): 5.2578
Step 2580/3000 | Loss (avg over last 20): 5.3756
Step 2600/3000 | Loss (avg over last 20): 5.1569
Step 2620/3000 | Loss (avg over last 20): 5.4882
Step 2640/3000 | Loss (avg over last 20): 5.3650
Step 2660/3000 | Loss (avg over last 20): 5.2080
Step 2680/3000 | Loss (avg over last 20): 5.3326
Step 2700/3000 | Loss (avg over last 20): 5.3092
Step 2720/3000 | Loss (avg over last 20): 5.3232
Step 2740/3000 | Loss (avg over last 20): 5.3431

============================================================
SAMPLE OUTPUTS (first 3 examples):
============================================================

--- Example 1 ---
Question: You are a helpful math tutor. Solve the problem step by step, then end your final line with '#### <number>'.

Problem:
Janet’s ducks lay 16 eggs per day. She eats three for breakfast every morning and...
Gold answer: 18
Target-alone: 210.0.0
Bridged: [invalid]
Bridged generation start: #####<<####/>>####/8####/3####/4########2########6...

--- Example 2 ---
Question: You are a helpful math tutor. Solve the problem step by step, then end your final line with '#### <number>'.

Problem:
A robe takes 2 bolts of blue fiber and half that much white fiber.  How many bolt...
Gold answer: 3
Target-alone: 3
Bridged: [invalid]
Bridged generation start: /.
/=.
/.
=/6 //3//####// /=*/= /6*/6+/=####/2####/=+/66/88/...

--- Example 3 ---
Question: You are a helpful math tutor. Solve the problem step by step, then end your final line with '#### <number>'.

Problem:
Josh decides to try flipping a house.  He buys a house for $80,000 and then puts ...
Gold answer: 70000
Target-alone: 97500
Bridged: [invalid]
Bridged generation start: 0000 to000000%000000<<00006000000/00002000000####000050000001000000=0000,00008000000<<00000/000
00

000

0
00000
000000
####00000####000
10000000100000
50000000500000
60000000200000
20000000600000
/00000,000
80000000=000
=00000800000
,000004000000400000
40000000$0000$000
<<000
$0000090000000030...
============================================================

[Eval] Step 2750 | Target-alone acc: 0.296 | Bridged acc: 0.012
[Early Stop] No improvement, patience: 5/5
[Early Stop] Stopping early at step 2750. Best bridged acc: 0.014
Saved BEST translator (acc=0.014) to paper_writing/runs/ablations_20251108_190831/2a_stable_32tok/checkpoint.pt
[rank1]:[E1108 22:38:08.743412721 ProcessGroupNCCL.cpp:616] [Rank 1] Watchdog caught collective operation timeout: WorkNCCL(SeqNum=19251, OpType=ALLREDUCE, NumelIn=1, NumelOut=1, Timeout(ms)=600000) ran for 600016 milliseconds before timing out.
[rank1]:[E1108 22:38:08.743708729 ProcessGroupNCCL.cpp:1785] [PG ID 0 PG GUID 0(default_pg) Rank 1] Exception (either an error or timeout) detected by watchdog at work: 19251, last enqueued NCCL work: 19251, last completed NCCL work: 19250.
[rank3]:[E1108 22:38:08.748048421 ProcessGroupNCCL.cpp:616] [Rank 3] Watchdog caught collective operation timeout: WorkNCCL(SeqNum=19251, OpType=ALLREDUCE, NumelIn=1, NumelOut=1, Timeout(ms)=600000) ran for 600037 milliseconds before timing out.
[rank3]:[E1108 22:38:08.748282617 ProcessGroupNCCL.cpp:1785] [PG ID 0 PG GUID 0(default_pg) Rank 3] Exception (either an error or timeout) detected by watchdog at work: 19251, last enqueued NCCL work: 19251, last completed NCCL work: 19250.
[rank2]:[E1108 22:38:08.752041509 ProcessGroupNCCL.cpp:616] [Rank 2] Watchdog caught collective operation timeout: WorkNCCL(SeqNum=19251, OpType=ALLREDUCE, NumelIn=1, NumelOut=1, Timeout(ms)=600000) ran for 600072 milliseconds before timing out.
[rank2]:[E1108 22:38:08.752276923 ProcessGroupNCCL.cpp:1785] [PG ID 0 PG GUID 0(default_pg) Rank 2] Exception (either an error or timeout) detected by watchdog at work: 19251, last enqueued NCCL work: 19251, last completed NCCL work: 19250.
[rank1]:[E1108 22:38:09.446330596 ProcessGroupNCCL.cpp:1834] [PG ID 0 PG GUID 0(default_pg) Rank 1] Timeout at NCCL work: 19251, last enqueued NCCL work: 19251, last completed NCCL work: 19250.
[rank1]:[E1108 22:38:09.446365750 ProcessGroupNCCL.cpp:630] [Rank 1] Some NCCL operations have failed or timed out. Due to the asynchronous nature of CUDA kernels, subsequent GPU operations might run on corrupted/incomplete data.
[rank1]:[E1108 22:38:09.446372615 ProcessGroupNCCL.cpp:636] [Rank 1] To avoid data inconsistency, we are taking the entire process down.
[rank1]:[E1108 22:38:09.447429489 ProcessGroupNCCL.cpp:1595] [PG ID 0 PG GUID 0(default_pg) Rank 1] Process group watchdog thread terminated with exception: [Rank 1] Watchdog caught collective operation timeout: WorkNCCL(SeqNum=19251, OpType=ALLREDUCE, NumelIn=1, NumelOut=1, Timeout(ms)=600000) ran for 600016 milliseconds before timing out.
Exception raised from checkTimeout at ../torch/csrc/distributed/c10d/ProcessGroupNCCL.cpp:618 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x96 (0x1555542b9446 in /users/sujinesh/.local/lib/python3.10/site-packages/torch/lib/libc10.so)
frame #1: c10d::ProcessGroupNCCL::WorkNCCL::checkTimeout(std::optional<std::chrono::duration<long, std::ratio<1l, 1000l> > >) + 0x282 (0x155509bcfa92 in /users/sujinesh/.local/lib/python3.10/site-packages/torch/lib/libtorch_cuda.so)
frame #2: c10d::ProcessGroupNCCL::watchdogHandler() + 0x233 (0x155509bd6ed3 in /users/sujinesh/.local/lib/python3.10/site-packages/torch/lib/libtorch_cuda.so)
frame #3: c10d::ProcessGroupNCCL::ncclCommWatchdog() + 0x14d (0x155509bd893d in /users/sujinesh/.local/lib/python3.10/site-packages/torch/lib/libtorch_cuda.so)
frame #4: <unknown function> + 0x145c0 (0x1555547445c0 in /users/sujinesh/.local/lib/python3.10/site-packages/torch/lib/libtorch.so)
frame #5: <unknown function> + 0x94ac3 (0x15555526fac3 in /lib/x86_64-linux-gnu/libc.so.6)
frame #6: <unknown function> + 0x126850 (0x155555301850 in /lib/x86_64-linux-gnu/libc.so.6)

terminate called after throwing an instance of 'c10::DistBackendError'
  what():  [PG ID 0 PG GUID 0(default_pg) Rank 1] Process group watchdog thread terminated with exception: [Rank 1] Watchdog caught collective operation timeout: WorkNCCL(SeqNum=19251, OpType=ALLREDUCE, NumelIn=1, NumelOut=1, Timeout(ms)=600000) ran for 600016 milliseconds before timing out.
Exception raised from checkTimeout at ../torch/csrc/distributed/c10d/ProcessGroupNCCL.cpp:618 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x96 (0x1555542b9446 in /users/sujinesh/.local/lib/python3.10/site-packages/torch/lib/libc10.so)
frame #1: c10d::ProcessGroupNCCL::WorkNCCL::checkTimeout(std::optional<std::chrono::duration<long, std::ratio<1l, 1000l> > >) + 0x282 (0x155509bcfa92 in /users/sujinesh/.local/lib/python3.10/site-packages/torch/lib/libtorch_cuda.so)
frame #2: c10d::ProcessGroupNCCL::watchdogHandler() + 0x233 (0x155509bd6ed3 in /users/sujinesh/.local/lib/python3.10/site-packages/torch/lib/libtorch_cuda.so)
frame #3: c10d::ProcessGroupNCCL::ncclCommWatchdog() + 0x14d (0x155509bd893d in /users/sujinesh/.local/lib/python3.10/site-packages/torch/lib/libtorch_cuda.so)
frame #4: <unknown function> + 0x145c0 (0x1555547445c0 in /users/sujinesh/.local/lib/python3.10/site-packages/torch/lib/libtorch.so)
frame #5: <unknown function> + 0x94ac3 (0x15555526fac3 in /lib/x86_64-linux-gnu/libc.so.6)
frame #6: <unknown function> + 0x126850 (0x155555301850 in /lib/x86_64-linux-gnu/libc.so.6)

Exception raised from ncclCommWatchdog at ../torch/csrc/distributed/c10d/ProcessGroupNCCL.cpp:1601 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x96 (0x1555542b9446 in /users/sujinesh/.local/lib/python3.10/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0xe7eb1b (0x15550984db1b in /users/sujinesh/.local/lib/python3.10/site-packages/torch/lib/libtorch_cuda.so)
frame #2: <unknown function> + 0x145c0 (0x1555547445c0 in /users/sujinesh/.local/lib/python3.10/site-packages/torch/lib/libtorch.so)
frame #3: <unknown function> + 0x94ac3 (0x15555526fac3 in /lib/x86_64-linux-gnu/libc.so.6)
frame #4: <unknown function> + 0x126850 (0x155555301850 in /lib/x86_64-linux-gnu/libc.so.6)

[rank3]:[E1108 22:38:09.458123615 ProcessGroupNCCL.cpp:1834] [PG ID 0 PG GUID 0(default_pg) Rank 3] Timeout at NCCL work: 19251, last enqueued NCCL work: 19251, last completed NCCL work: 19250.
[rank3]: Traceback (most recent call last):
[rank3]:   File "/projects/m000066/sujinesh/LatentWire/paper_writing/cross_attention.py", line 935, in <module>
[rank3]:     main()
[rank3]:   File "/projects/m000066/sujinesh/LatentWire/paper_writing/cross_attention.py", line 869, in main
[rank3]:     loss.backward()
[rank3]:   File "/users/sujinesh/.local/lib/python3.10/site-packages/torch/_tensor.py", line 581, in backward
[rank3]:     torch.autograd.backward(
[rank3]:   File "/users/sujinesh/.local/lib/python3.10/site-packages/torch/autograd/__init__.py", line 347, in backward
[rank3]:     _engine_run_backward(
[rank3]:   File "/users/sujinesh/.local/lib/python3.10/site-packages/torch/autograd/graph.py", line 825, in _engine_run_backward
[rank3]:     return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
[rank3]: torch.distributed.DistBackendError: NCCL communicator was aborted on rank 3. 
[rank3]:[E1108 22:38:09.458848321 ProcessGroupNCCL.cpp:630] [Rank 3] Some NCCL operations have failed or timed out. Due to the asynchronous nature of CUDA kernels, subsequent GPU operations might run on corrupted/incomplete data.
[rank3]:[E1108 22:38:09.458861691 ProcessGroupNCCL.cpp:636] [Rank 3] To avoid data inconsistency, we are taking the entire process down.
[rank3]:[E1108 22:38:09.472960947 ProcessGroupNCCL.cpp:1595] [PG ID 0 PG GUID 0(default_pg) Rank 3] Process group watchdog thread terminated with exception: [Rank 3] Watchdog caught collective operation timeout: WorkNCCL(SeqNum=19251, OpType=ALLREDUCE, NumelIn=1, NumelOut=1, Timeout(ms)=600000) ran for 600037 milliseconds before timing out.
Exception raised from checkTimeout at ../torch/csrc/distributed/c10d/ProcessGroupNCCL.cpp:618 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x96 (0x1555542b9446 in /users/sujinesh/.local/lib/python3.10/site-packages/torch/lib/libc10.so)
frame #1: c10d::ProcessGroupNCCL::WorkNCCL::checkTimeout(std::optional<std::chrono::duration<long, std::ratio<1l, 1000l> > >) + 0x282 (0x155509bcfa92 in /users/sujinesh/.local/lib/python3.10/site-packages/torch/lib/libtorch_cuda.so)
frame #2: c10d::ProcessGroupNCCL::watchdogHandler() + 0x233 (0x155509bd6ed3 in /users/sujinesh/.local/lib/python3.10/site-packages/torch/lib/libtorch_cuda.so)
frame #3: c10d::ProcessGroupNCCL::ncclCommWatchdog() + 0x14d (0x155509bd893d in /users/sujinesh/.local/lib/python3.10/site-packages/torch/lib/libtorch_cuda.so)
frame #4: <unknown function> + 0x145c0 (0x1555547445c0 in /users/sujinesh/.local/lib/python3.10/site-packages/torch/lib/libtorch.so)
frame #5: <unknown function> + 0x94ac3 (0x15555526fac3 in /lib/x86_64-linux-gnu/libc.so.6)
frame #6: <unknown function> + 0x126850 (0x155555301850 in /lib/x86_64-linux-gnu/libc.so.6)

[rank2]:[E1108 22:38:09.474701477 ProcessGroupNCCL.cpp:1834] [PG ID 0 PG GUID 0(default_pg) Rank 2] Timeout at NCCL work: 19251, last enqueued NCCL work: 19251, last completed NCCL work: 19250.
[rank2]:[E1108 22:38:09.474726320 ProcessGroupNCCL.cpp:630] [Rank 2] Some NCCL operations have failed or timed out. Due to the asynchronous nature of CUDA kernels, subsequent GPU operations might run on corrupted/incomplete data.
[rank2]:[E1108 22:38:09.474755361 ProcessGroupNCCL.cpp:636] [Rank 2] To avoid data inconsistency, we are taking the entire process down.
[rank2]: Traceback (most recent call last):
[rank2]:   File "/projects/m000066/sujinesh/LatentWire/paper_writing/cross_attention.py", line 935, in <module>
[rank2]:     main()
[rank2]:   File "/projects/m000066/sujinesh/LatentWire/paper_writing/cross_attention.py", line 869, in main
[rank2]:     loss.backward()
[rank2]:   File "/users/sujinesh/.local/lib/python3.10/site-packages/torch/_tensor.py", line 581, in backward
[rank2]:     torch.autograd.backward(
[rank2]:   File "/users/sujinesh/.local/lib/python3.10/site-packages/torch/autograd/__init__.py", line 347, in backward
[rank2]:     _engine_run_backward(
[rank2]:   File "/users/sujinesh/.local/lib/python3.10/site-packages/torch/autograd/graph.py", line 825, in _engine_run_backward
[rank2]:     return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
[rank2]: torch.distributed.DistBackendError: NCCL communicator was aborted on rank 2. 
[rank2]:[E1108 22:38:09.488588090 ProcessGroupNCCL.cpp:1595] [PG ID 0 PG GUID 0(default_pg) Rank 2] Process group watchdog thread terminated with exception: [Rank 2] Watchdog caught collective operation timeout: WorkNCCL(SeqNum=19251, OpType=ALLREDUCE, NumelIn=1, NumelOut=1, Timeout(ms)=600000) ran for 600072 milliseconds before timing out.
Exception raised from checkTimeout at ../torch/csrc/distributed/c10d/ProcessGroupNCCL.cpp:618 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x96 (0x1555542b9446 in /users/sujinesh/.local/lib/python3.10/site-packages/torch/lib/libc10.so)
frame #1: c10d::ProcessGroupNCCL::WorkNCCL::checkTimeout(std::optional<std::chrono::duration<long, std::ratio<1l, 1000l> > >) + 0x282 (0x155509bcfa92 in /users/sujinesh/.local/lib/python3.10/site-packages/torch/lib/libtorch_cuda.so)
frame #2: c10d::ProcessGroupNCCL::watchdogHandler() + 0x233 (0x155509bd6ed3 in /users/sujinesh/.local/lib/python3.10/site-packages/torch/lib/libtorch_cuda.so)
frame #3: c10d::ProcessGroupNCCL::ncclCommWatchdog() + 0x14d (0x155509bd893d in /users/sujinesh/.local/lib/python3.10/site-packages/torch/lib/libtorch_cuda.so)
frame #4: <unknown function> + 0x145c0 (0x1555547445c0 in /users/sujinesh/.local/lib/python3.10/site-packages/torch/lib/libtorch.so)
frame #5: <unknown function> + 0x94ac3 (0x15555526fac3 in /lib/x86_64-linux-gnu/libc.so.6)
frame #6: <unknown function> + 0x126850 (0x155555301850 in /lib/x86_64-linux-gnu/libc.so.6)

terminate called after throwing an instance of 'c10::DistBackendError'
  what():  [PG ID 0 PG GUID 0(default_pg) Rank 3] Process group watchdog thread terminated with exception: [Rank 3] Watchdog caught collective operation timeout: WorkNCCL(SeqNum=19251, OpType=ALLREDUCE, NumelIn=1, NumelOut=1, Timeout(ms)=600000) ran for 600037 milliseconds before timing out.
Exception raised from checkTimeout at ../torch/csrc/distributed/c10d/ProcessGroupNCCL.cpp:618 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x96 (0x1555542b9446 in /users/sujinesh/.local/lib/python3.10/site-packages/torch/lib/libc10.so)
frame #1: c10d::ProcessGroupNCCL::WorkNCCL::checkTimeout(std::optional<std::chrono::duration<long, std::ratio<1l, 1000l> > >) + 0x282 (0x155509bcfa92 in /users/sujinesh/.local/lib/python3.10/site-packages/torch/lib/libtorch_cuda.so)
frame #2: c10d::ProcessGroupNCCL::watchdogHandler() + 0x233 (0x155509bd6ed3 in /users/sujinesh/.local/lib/python3.10/site-packages/torch/lib/libtorch_cuda.so)
frame #3: c10d::ProcessGroupNCCL::ncclCommWatchdog() + 0x14d (0x155509bd893d in /users/sujinesh/.local/lib/python3.10/site-packages/torch/lib/libtorch_cuda.so)
frame #4: <unknown function> + 0x145c0 (0x1555547445c0 in /users/sujinesh/.local/lib/python3.10/site-packages/torch/lib/libtorch.so)
frame #5: <unknown function> + 0x94ac3 (0x15555526fac3 in /lib/x86_64-linux-gnu/libc.so.6)
frame #6: <unknown function> + 0x126850 (0x155555301850 in /lib/x86_64-linux-gnu/libc.so.6)

Exception raised from ncclCommWatchdog at ../torch/csrc/distributed/c10d/ProcessGroupNCCL.cpp:1601 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x96 (0x1555542b9446 in /users/sujinesh/.local/lib/python3.10/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0xe7eb1b (0x15550984db1b in /users/sujinesh/.local/lib/python3.10/site-packages/torch/lib/libtorch_cuda.so)
frame #2: <unknown function> + 0x145c0 (0x1555547445c0 in /users/sujinesh/.local/lib/python3.10/site-packages/torch/lib/libtorch.so)
frame #3: <unknown function> + 0x94ac3 (0x15555526fac3 in /lib/x86_64-linux-gnu/libc.so.6)
frame #4: <unknown function> + 0x126850 (0x155555301850 in /lib/x86_64-linux-gnu/libc.so.6)

terminate called after throwing an instance of 'c10::DistBackendError'
  what():  [PG ID 0 PG GUID 0(default_pg) Rank 2] Process group watchdog thread terminated with exception: [Rank 2] Watchdog caught collective operation timeout: WorkNCCL(SeqNum=19251, OpType=ALLREDUCE, NumelIn=1, NumelOut=1, Timeout(ms)=600000) ran for 600072 milliseconds before timing out.
Exception raised from checkTimeout at ../torch/csrc/distributed/c10d/ProcessGroupNCCL.cpp:618 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x96 (0x1555542b9446 in /users/sujinesh/.local/lib/python3.10/site-packages/torch/lib/libc10.so)
frame #1: c10d::ProcessGroupNCCL::WorkNCCL::checkTimeout(std::optional<std::chrono::duration<long, std::ratio<1l, 1000l> > >) + 0x282 (0x155509bcfa92 in /users/sujinesh/.local/lib/python3.10/site-packages/torch/lib/libtorch_cuda.so)
frame #2: c10d::ProcessGroupNCCL::watchdogHandler() + 0x233 (0x155509bd6ed3 in /users/sujinesh/.local/lib/python3.10/site-packages/torch/lib/libtorch_cuda.so)
frame #3: c10d::ProcessGroupNCCL::ncclCommWatchdog() + 0x14d (0x155509bd893d in /users/sujinesh/.local/lib/python3.10/site-packages/torch/lib/libtorch_cuda.so)
frame #4: <unknown function> + 0x145c0 (0x1555547445c0 in /users/sujinesh/.local/lib/python3.10/site-packages/torch/lib/libtorch.so)
frame #5: <unknown function> + 0x94ac3 (0x15555526fac3 in /lib/x86_64-linux-gnu/libc.so.6)
frame #6: <unknown function> + 0x126850 (0x155555301850 in /lib/x86_64-linux-gnu/libc.so.6)

Exception raised from ncclCommWatchdog at ../torch/csrc/distributed/c10d/ProcessGroupNCCL.cpp:1601 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x96 (0x1555542b9446 in /users/sujinesh/.local/lib/python3.10/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0xe7eb1b (0x15550984db1b in /users/sujinesh/.local/lib/python3.10/site-packages/torch/lib/libtorch_cuda.so)
frame #2: <unknown function> + 0x145c0 (0x1555547445c0 in /users/sujinesh/.local/lib/python3.10/site-packages/torch/lib/libtorch.so)
frame #3: <unknown function> + 0x94ac3 (0x15555526fac3 in /lib/x86_64-linux-gnu/libc.so.6)
frame #4: <unknown function> + 0x126850 (0x155555301850 in /lib/x86_64-linux-gnu/libc.so.6)

W1108 22:38:10.720000 2706851 torch/distributed/elastic/multiprocessing/api.py:897] Sending process 2706875 closing signal SIGTERM
E1108 22:38:11.243000 2706851 torch/distributed/elastic/multiprocessing/api.py:869] failed (exitcode: -6) local_rank: 1 (pid: 2706876) of binary: /marlowe/apps/Mambaforge/24.3.0-0/bin/python
Traceback (most recent call last):
  File "/users/sujinesh/.local/bin/torchrun", line 7, in <module>
    sys.exit(main())
  File "/users/sujinesh/.local/lib/python3.10/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 355, in wrapper
    return f(*args, **kwargs)
  File "/users/sujinesh/.local/lib/python3.10/site-packages/torch/distributed/run.py", line 919, in main
    run(args)
  File "/users/sujinesh/.local/lib/python3.10/site-packages/torch/distributed/run.py", line 910, in run
    elastic_launch(
  File "/users/sujinesh/.local/lib/python3.10/site-packages/torch/distributed/launcher/api.py", line 138, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/users/sujinesh/.local/lib/python3.10/site-packages/torch/distributed/launcher/api.py", line 269, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
========================================================
paper_writing/cross_attention.py FAILED
--------------------------------------------------------
Failures:
[1]:
  time      : 2025-11-08_22:38:10
  host      : n22.cm.cluster
  rank      : 2 (local_rank: 2)
  exitcode  : -6 (pid: 2706877)
  error_file: <N/A>
  traceback : Signal 6 (SIGABRT) received by PID 2706877
[2]:
  time      : 2025-11-08_22:38:10
  host      : n22.cm.cluster
  rank      : 3 (local_rank: 3)
  exitcode  : -6 (pid: 2706878)
  error_file: <N/A>
  traceback : Signal 6 (SIGABRT) received by PID 2706878
--------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2025-11-08_22:38:10
  host      : n22.cm.cluster
  rank      : 1 (local_rank: 1)
  exitcode  : -6 (pid: 2706876)
  error_file: <N/A>
  traceback : Signal 6 (SIGABRT) received by PID 2706876
========================================================
