# Core dependencies for LatentWire
torch>=2.2.0,<2.7.0  # Upper bound for compatibility
# Pin transformers to avoid torch>=2.6 restriction for .bin weights on older Pythons
transformers==4.45.2  # Critical: supports Llama-3.2 and Qwen models
datasets>=4.0.0
accelerate>=1.10.0
numpy>=1.21.0,<2.0  # Avoid numpy 2.0 breaking changes
scipy>=1.7.0
scikit-learn>=1.0.0
tqdm>=4.60.0
sentence-transformers>=2.2.0
sentencepiece>=0.1.99
protobuf>=3.20.0
tokenizers>=0.13.0
rouge-score>=0.1.2
psutil>=5.9.0  # For memory and system resource tracking

# Statistical analysis and visualization
statsmodels>=0.13.0  # For McNemar test, multiple testing correction
pandas>=1.3.0  # For data analysis and reporting
matplotlib>=3.3.0  # For attention visualizations
seaborn>=0.11.0  # For heatmaps and statistical plots

# Model enhancement and compression
peft>=0.5.0  # For LoRA, prefix tuning, prompt tuning
llmlingua>=0.2.0  # For LLMLingua baseline comparison (optional)

# Optional dependencies
# bitsandbytes is Linux/CUDA specific; safely ignored on macOS
bitsandbytes>=0.43.0 ; platform_system == "Linux"

# Testing dependencies
pytest>=7.4.0
pytest-cov>=4.1.0
pytest-xdist>=3.3.0
pytest-timeout>=2.1.0

# Code quality (optional, for development)
# black>=23.0.0
# isort>=5.12.0
# ruff>=0.1.0
# mypy>=1.5.0
