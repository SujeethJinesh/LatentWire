================================================================================
LEARNED ADAPTER ABLATION - LINEAR - STARTING
================================================================================
Python version: 3.10.14 | packaged by conda-forge | (main, Mar 20 2024, 12:45:18) [GCC 12.3.0]
PyTorch version: 2.5.1+cu121
CUDA available: True
CUDA device count: 1
CUDA current device: 0
Script: /projects/m000066/sujinesh/LatentWire/experimental/learning/learned_adapter_ablation.py
Adapter type: linear
GPU assigned: 1
Log file: runs/learned_adapters/linear_gpu1_20251030_001355.log
================================================================================

Downloading shards:   0%|          | 0/4 [00:00<?, ?it/s]Downloading shards: 100%|##########| 4/4 [00:00<00:00, 5292.50it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|##5       | 1/4 [00:19<00:57, 19.11s/it]Loading checkpoint shards:  50%|#####     | 2/4 [00:37<00:37, 18.59s/it]Loading checkpoint shards:  75%|#######5  | 3/4 [00:55<00:18, 18.29s/it]Loading checkpoint shards: 100%|##########| 4/4 [00:59<00:00, 12.86s/it]Loading checkpoint shards: 100%|##########| 4/4 [00:59<00:00, 14.95s/it]
Downloading shards:   0%|          | 0/3 [00:00<?, ?it/s]Downloading shards: 100%|##########| 3/3 [00:00<00:00, 6436.27it/s]
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|###3      | 1/3 [00:17<00:35, 17.93s/it]Loading checkpoint shards:  67%|######6   | 2/3 [00:35<00:17, 17.67s/it]Loading checkpoint shards: 100%|##########| 3/3 [00:51<00:00, 16.95s/it]Loading checkpoint shards: 100%|##########| 3/3 [00:51<00:00, 17.19s/it]

================================================================================
LINEAR ADAPTER EXPERIMENT FAILED WITH ERROR
================================================================================
Error type: TypeError
Error message: must be called with a dataclass type or instance

Full traceback:
--------------------------------------------------------------------------------
Traceback (most recent call last):
  File "/projects/m000066/sujinesh/LatentWire/experimental/learning/learned_adapter_ablation.py", line 689, in <module>
    results = run_single_adapter_experiment(adapter_type)
  File "/projects/m000066/sujinesh/LatentWire/experimental/learning/learned_adapter_ablation.py", line 556, in run_single_adapter_experiment
    squad = load_dataset("rajpurkar/squad", split="train", trust_remote_code=True)
  File "/users/sujinesh/.local/lib/python3.10/site-packages/datasets/load.py", line 2132, in load_dataset
    builder_instance = load_dataset_builder(
  File "/users/sujinesh/.local/lib/python3.10/site-packages/datasets/load.py", line 1853, in load_dataset_builder
    dataset_module = dataset_module_factory(
  File "/users/sujinesh/.local/lib/python3.10/site-packages/datasets/load.py", line 1729, in dataset_module_factory
    raise e1 from None
  File "/users/sujinesh/.local/lib/python3.10/site-packages/datasets/load.py", line 1694, in dataset_module_factory
    ).get_module()
  File "/users/sujinesh/.local/lib/python3.10/site-packages/datasets/load.py", line 1045, in get_module
    {
  File "/users/sujinesh/.local/lib/python3.10/site-packages/datasets/load.py", line 1046, in <dictcomp>
    config_name: DatasetInfo.from_dict(exported_dataset_infos[config_name])
  File "/users/sujinesh/.local/lib/python3.10/site-packages/datasets/info.py", line 284, in from_dict
    return cls(**{k: v for k, v in dataset_info_dict.items() if k in field_names})
  File "<string>", line 20, in __init__
  File "/users/sujinesh/.local/lib/python3.10/site-packages/datasets/info.py", line 170, in __post_init__
    self.features = Features.from_dict(self.features)
  File "/users/sujinesh/.local/lib/python3.10/site-packages/datasets/features/features.py", line 1832, in from_dict
    obj = generate_from_dict(dic)
  File "/users/sujinesh/.local/lib/python3.10/site-packages/datasets/features/features.py", line 1458, in generate_from_dict
    return {key: generate_from_dict(value) for key, value in obj.items()}
  File "/users/sujinesh/.local/lib/python3.10/site-packages/datasets/features/features.py", line 1458, in <dictcomp>
    return {key: generate_from_dict(value) for key, value in obj.items()}
  File "/users/sujinesh/.local/lib/python3.10/site-packages/datasets/features/features.py", line 1458, in generate_from_dict
    return {key: generate_from_dict(value) for key, value in obj.items()}
  File "/users/sujinesh/.local/lib/python3.10/site-packages/datasets/features/features.py", line 1458, in <dictcomp>
    return {key: generate_from_dict(value) for key, value in obj.items()}
  File "/users/sujinesh/.local/lib/python3.10/site-packages/datasets/features/features.py", line 1473, in generate_from_dict
    field_names = {f.name for f in fields(class_type)}
  File "/marlowe/apps/Mambaforge/24.3.0-0/lib/python3.10/dataclasses.py", line 1198, in fields
    raise TypeError('must be called with a dataclass type or instance') from None
TypeError: must be called with a dataclass type or instance
--------------------------------------------------------------------------------

================================================================================
