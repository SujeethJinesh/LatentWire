================================================================================
LEARNED ADAPTER EXPERIMENT - LORA
================================================================================
Platform: hpc
Log file: /projects/m000066/sujinesh/LatentWire/experimental/learning/runs/learned_adapters/lora_gpu2_20251030_163759.log
GPU assigned: 2

Loading models on hpc...
Using bfloat16 for H100
Using Flash Attention 2
Downloading shards:   0%|          | 0/4 [00:00<?, ?it/s]Downloading shards:   0%|          | 0/4 [00:00<?, ?it/s]Downloading shards: 100%|##########| 4/4 [00:00<00:00, 2323.71it/s]Downloading shards: 100%|##########| 4/4 [00:00<00:00, 2323.71it/s]

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|##5       | 1/4 [00:00<00:00,  3.70it/s]Loading checkpoint shards:  25%|##5       | 1/4 [00:00<00:00,  3.70it/s]Loading checkpoint shards:  50%|#####     | 2/4 [00:00<00:00,  3.84it/s]Loading checkpoint shards:  50%|#####     | 2/4 [00:00<00:00,  3.84it/s]Loading checkpoint shards:  75%|#######5  | 3/4 [00:00<00:00,  3.81it/s]Loading checkpoint shards:  75%|#######5  | 3/4 [00:00<00:00,  3.81it/s]Loading checkpoint shards: 100%|##########| 4/4 [00:01<00:00,  3.93it/s]Loading checkpoint shards: 100%|##########| 4/4 [00:01<00:00,  3.93it/s]Loading checkpoint shards: 100%|##########| 4/4 [00:01<00:00,  3.86it/s]Loading checkpoint shards: 100%|##########| 4/4 [00:01<00:00,  3.86it/s]

Downloading shards:   0%|          | 0/3 [00:00<?, ?it/s]Downloading shards:   0%|          | 0/3 [00:00<?, ?it/s]Downloading shards: 100%|##########| 3/3 [00:00<00:00, 2293.64it/s]Downloading shards: 100%|##########| 3/3 [00:00<00:00, 2293.64it/s]

Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|###3      | 1/3 [00:00<00:00,  3.03it/s]Loading checkpoint shards:  33%|###3      | 1/3 [00:00<00:00,  3.03it/s]Loading checkpoint shards:  67%|######6   | 2/3 [00:00<00:00,  3.47it/s]Loading checkpoint shards:  67%|######6   | 2/3 [00:00<00:00,  3.47it/s]Loading checkpoint shards: 100%|##########| 3/3 [00:00<00:00,  3.55it/s]Loading checkpoint shards: 100%|##########| 3/3 [00:00<00:00,  3.55it/s]Loading checkpoint shards: 100%|##########| 3/3 [00:00<00:00,  3.47it/s]Loading checkpoint shards: 100%|##########| 3/3 [00:00<00:00,  3.47it/s]


Training LoRAAdapter...
Loading dataset (10000 samples)...
README.md: 0.00B [00:00, ?B/s]README.md: 0.00B [00:00, ?B/s]README.md: 10.5kB [00:00, 8.75MB/s]README.md: 10.5kB [00:00, 8.75MB/s]

wikitext-103-v1/test-00000-of-00001.parq(…):   0%|          | 0.00/722k [00:00<?, ?B/s]wikitext-103-v1/test-00000-of-00001.parq(…):   0%|          | 0.00/722k [00:00<?, ?B/s]wikitext-103-v1/test-00000-of-00001.parq(…): 100%|##########| 722k/722k [00:00<00:00, 859kB/s]wikitext-103-v1/test-00000-of-00001.parq(…): 100%|##########| 722k/722k [00:00<00:00, 859kB/s]wikitext-103-v1/test-00000-of-00001.parq(…): 100%|##########| 722k/722k [00:00<00:00, 858kB/s]wikitext-103-v1/test-00000-of-00001.parq(…): 100%|##########| 722k/722k [00:00<00:00, 858kB/s]

wikitext-103-v1/train-00000-of-00002.par(…):   0%|          | 0.00/156M [00:00<?, ?B/s]wikitext-103-v1/train-00000-of-00002.par(…):   0%|          | 0.00/156M [00:00<?, ?B/s]wikitext-103-v1/train-00000-of-00002.par(…):  14%|#3        | 21.7M/156M [00:00<00:04, 28.1MB/s]wikitext-103-v1/train-00000-of-00002.par(…):  14%|#3        | 21.7M/156M [00:00<00:04, 28.1MB/s]wikitext-103-v1/train-00000-of-00002.par(…):  57%|#####6    | 88.7M/156M [00:00<00:00, 111MB/s] wikitext-103-v1/train-00000-of-00002.par(…):  57%|#####6    | 88.7M/156M [00:00<00:00, 111MB/s] wikitext-103-v1/train-00000-of-00002.par(…): 100%|##########| 156M/156M [00:01<00:00, 155MB/s] wikitext-103-v1/train-00000-of-00002.par(…): 100%|##########| 156M/156M [00:01<00:00, 155MB/s] 

wikitext-103-v1/train-00001-of-00002.par(…):   0%|          | 0.00/156M [00:00<?, ?B/s]wikitext-103-v1/train-00001-of-00002.par(…):   0%|          | 0.00/156M [00:00<?, ?B/s]wikitext-103-v1/train-00001-of-00002.par(…):   0%|          | 162k/156M [00:00<11:30, 225kB/s]wikitext-103-v1/train-00001-of-00002.par(…):   0%|          | 162k/156M [00:00<11:30, 225kB/s]wikitext-103-v1/train-00001-of-00002.par(…):  14%|#3        | 21.8M/156M [00:00<00:03, 33.8MB/s]wikitext-103-v1/train-00001-of-00002.par(…):  14%|#3        | 21.8M/156M [00:00<00:03, 33.8MB/s]wikitext-103-v1/train-00001-of-00002.par(…):  57%|#####6    | 88.8M/156M [00:01<00:00, 117MB/s] wikitext-103-v1/train-00001-of-00002.par(…):  57%|#####6    | 88.8M/156M [00:01<00:00, 117MB/s] wikitext-103-v1/train-00001-of-00002.par(…): 100%|##########| 156M/156M [00:01<00:00, 140MB/s] wikitext-103-v1/train-00001-of-00002.par(…): 100%|##########| 156M/156M [00:01<00:00, 140MB/s] 

wikitext-103-v1/validation-00000-of-0000(…):   0%|          | 0.00/655k [00:00<?, ?B/s]wikitext-103-v1/validation-00000-of-0000(…):   0%|          | 0.00/655k [00:00<?, ?B/s]wikitext-103-v1/validation-00000-of-0000(…):   5%|4         | 32.3k/655k [00:00<00:08, 71.8kB/s]wikitext-103-v1/validation-00000-of-0000(…):   5%|4         | 32.3k/655k [00:00<00:08, 71.8kB/s]wikitext-103-v1/validation-00000-of-0000(…): 100%|##########| 655k/655k [00:00<00:00, 1.46MB/s] wikitext-103-v1/validation-00000-of-0000(…): 100%|##########| 655k/655k [00:00<00:00, 1.46MB/s] 

Generating test split:   0%|          | 0/4358 [00:00<?, ? examples/s]Generating test split:   0%|          | 0/4358 [00:00<?, ? examples/s]Generating test split: 100%|##########| 4358/4358 [00:00<00:00, 286034.94 examples/s]Generating test split: 100%|##########| 4358/4358 [00:00<00:00, 286034.94 examples/s]

Generating train split:   0%|          | 0/1801350 [00:00<?, ? examples/s]Generating train split:   0%|          | 0/1801350 [00:00<?, ? examples/s]Generating train split:   6%|6         | 113000/1801350 [00:00<00:01, 1121922.95 examples/s]Generating train split:   6%|6         | 113000/1801350 [00:00<00:01, 1121922.95 examples/s]Generating train split:  15%|#5        | 271000/1801350 [00:00<00:01, 1018112.08 examples/s]Generating train split:  15%|#5        | 271000/1801350 [00:00<00:01, 1018112.08 examples/s]Generating train split:  22%|##1       | 389000/1801350 [00:00<00:01, 1077749.86 examples/s]Generating train split:  22%|##1       | 389000/1801350 [00:00<00:01, 1077749.86 examples/s]Generating train split:  28%|##8       | 509000/1801350 [00:00<00:01, 1115512.17 examples/s]Generating train split:  28%|##8       | 509000/1801350 [00:00<00:01, 1115512.17 examples/s]Generating train split:  35%|###5      | 638000/1801350 [00:00<00:01, 927406.61 examples/s] Generating train split:  35%|###5      | 638000/1801350 [00:00<00:01, 927406.61 examples/s] Generating train split:  41%|####1     | 739000/1801350 [00:00<00:01, 597451.88 examples/s]Generating train split:  41%|####1     | 739000/1801350 [00:00<00:01, 597451.88 examples/s]Generating train split:  48%|####7     | 857000/1801350 [00:01<00:01, 615521.65 examples/s]Generating train split:  48%|####7     | 857000/1801350 [00:01<00:01, 615521.65 examples/s]Generating train split:  54%|#####4    | 978675/1801350 [00:01<00:01, 731473.55 examples/s]Generating train split:  54%|#####4    | 978675/1801350 [00:01<00:01, 731473.55 examples/s]Generating train split:  61%|######1   | 1102675/1801350 [00:01<00:00, 841391.76 examples/s]Generating train split:  61%|######1   | 1102675/1801350 [00:01<00:00, 841391.76 examples/s]Generating train split:  68%|######7   | 1222675/1801350 [00:01<00:00, 924034.41 examples/s]Generating train split:  68%|######7   | 1222675/1801350 [00:01<00:00, 924034.41 examples/s]Generating train split:  75%|#######4  | 1342675/1801350 [00:01<00:00, 993066.07 examples/s]Generating train split:  75%|#######4  | 1342675/1801350 [00:01<00:00, 993066.07 examples/s]Generating train split:  81%|########1 | 1459675/1801350 [00:01<00:00, 1039004.87 examples/s]Generating train split:  81%|########1 | 1459675/1801350 [00:01<00:00, 1039004.87 examples/s]Generating train split:  88%|########7 | 1583675/1801350 [00:01<00:00, 1092860.77 examples/s]Generating train split:  88%|########7 | 1583675/1801350 [00:01<00:00, 1092860.77 examples/s]Generating train split:  95%|#########5| 1711675/1801350 [00:02<00:00, 704486.00 examples/s] Generating train split:  95%|#########5| 1711675/1801350 [00:02<00:00, 704486.00 examples/s] Generating train split: 100%|##########| 1801350/1801350 [00:02<00:00, 831818.09 examples/s]Generating train split: 100%|##########| 1801350/1801350 [00:02<00:00, 831818.09 examples/s]

Generating validation split:   0%|          | 0/3760 [00:00<?, ? examples/s]Generating validation split:   0%|          | 0/3760 [00:00<?, ? examples/s]Generating validation split: 100%|##########| 3760/3760 [00:00<00:00, 668528.32 examples/s]Generating validation split: 100%|##########| 3760/3760 [00:00<00:00, 668528.32 examples/s]


================================================================================
LORA ADAPTER EXPERIMENT FAILED
================================================================================
Error: name 'MAX_LENGTH' is not defined
Traceback (most recent call last):
Traceback (most recent call last):
  File "/projects/m000066/sujinesh/LatentWire/experimental/learning/unified_cross_model_experiments.py", line 973, in run_adapter_experiment
    adapter, metrics = train_adapter(
  File "/projects/m000066/sujinesh/LatentWire/experimental/learning/unified_cross_model_experiments.py", line 973, in run_adapter_experiment
    adapter, metrics = train_adapter(
  File "/projects/m000066/sujinesh/LatentWire/experimental/learning/unified_cross_model_experiments.py", line 677, in train_adapter
    train_dataset = AlignmentDataset(texts, tokenizer_a, tokenizer_b, MAX_LENGTH)
  File "/projects/m000066/sujinesh/LatentWire/experimental/learning/unified_cross_model_experiments.py", line 677, in train_adapter
    train_dataset = AlignmentDataset(texts, tokenizer_a, tokenizer_b, MAX_LENGTH)
NameError: name 'MAX_LENGTH' is not defined
NameError: name 'MAX_LENGTH' is not defined
