================================================================================
LEARNED ADAPTER EXPERIMENT - AFFINE
================================================================================
Platform: hpc
Log file: /projects/m000066/sujinesh/LatentWire/experimental/learning/runs/learned_adapters/affine_gpu1_20251031_114041.log
GPU assigned: 1

Loading models on hpc...
Using bfloat16 for H100
Using Flash Attention 2
Downloading shards:   0%|          | 0/4 [00:00<?, ?it/s]Downloading shards:   0%|          | 0/4 [00:00<?, ?it/s]Downloading shards: 100%|##########| 4/4 [00:00<00:00, 435.11it/s]Downloading shards: 100%|##########| 4/4 [00:00<00:00, 435.11it/s]

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  50%|#####     | 2/4 [00:00<00:00, 14.51it/s]Loading checkpoint shards:  50%|#####     | 2/4 [00:00<00:00, 14.51it/s]Loading checkpoint shards: 100%|##########| 4/4 [00:00<00:00, 15.37it/s]Loading checkpoint shards: 100%|##########| 4/4 [00:00<00:00, 15.37it/s]Loading checkpoint shards: 100%|##########| 4/4 [00:00<00:00, 15.22it/s]Loading checkpoint shards: 100%|##########| 4/4 [00:00<00:00, 15.22it/s]

Downloading shards:   0%|          | 0/3 [00:00<?, ?it/s]Downloading shards:   0%|          | 0/3 [00:00<?, ?it/s]Downloading shards: 100%|##########| 3/3 [00:00<00:00, 3505.97it/s]Downloading shards: 100%|##########| 3/3 [00:00<00:00, 3505.97it/s]

Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  67%|######6   | 2/3 [00:00<00:00, 13.04it/s]Loading checkpoint shards:  67%|######6   | 2/3 [00:00<00:00, 13.04it/s]Loading checkpoint shards: 100%|##########| 3/3 [00:00<00:00, 13.99it/s]Loading checkpoint shards: 100%|##########| 3/3 [00:00<00:00, 13.99it/s]


Training AffineAdapter...
Loading dataset (10000 samples)...

Epoch 1/10
  Step 10/1250: Loss = 10.6804
  Step 20/1250: Loss = 10.3041
  Step 30/1250: Loss = 10.0677
  Step 40/1250: Loss = 9.8440
  Step 50/1250: Loss = 9.6367
  Step 60/1250: Loss = 9.4766
  Step 70/1250: Loss = 9.3370
  Step 80/1250: Loss = 9.2336
  Step 90/1250: Loss = 9.1416
  Step 100/1250: Loss = 9.0656
  Step 110/1250: Loss = 8.9913
  Step 120/1250: Loss = 8.9235
  Step 130/1250: Loss = 8.8586
  Step 140/1250: Loss = 8.8058
  Step 150/1250: Loss = 8.7648
  Step 160/1250: Loss = 8.7226
  Step 170/1250: Loss = 8.6824
  Step 180/1250: Loss = 8.6477
  Step 190/1250: Loss = 8.6162
  Step 200/1250: Loss = 8.5858
  Step 210/1250: Loss = 8.5603
  Step 220/1250: Loss = 8.5302
  Step 230/1250: Loss = 8.5058
  Step 240/1250: Loss = 8.4793
  Step 250/1250: Loss = 8.4541
  Step 260/1250: Loss = 8.4336
  Step 270/1250: Loss = 8.4098
  Step 280/1250: Loss = 8.3888
  Step 290/1250: Loss = 8.3675
  Step 300/1250: Loss = 8.3473
  Step 310/1250: Loss = 8.3298
  Step 320/1250: Loss = 8.3165
  Step 330/1250: Loss = 8.3005
  Step 340/1250: Loss = 8.2855
  Step 350/1250: Loss = 8.2722
  Step 360/1250: Loss = 8.2600
  Step 370/1250: Loss = 8.2479
  Step 380/1250: Loss = 8.2355
  Step 390/1250: Loss = 8.2253
  Step 400/1250: Loss = 8.2162
  Step 410/1250: Loss = 8.2057
  Step 420/1250: Loss = 8.1958
  Step 430/1250: Loss = 8.1831
  Step 440/1250: Loss = 8.1718
  Step 450/1250: Loss = 8.1607
  Step 460/1250: Loss = 8.1517
  Step 470/1250: Loss = 8.1429
  Step 480/1250: Loss = 8.1339
  Step 490/1250: Loss = 8.1255
  Step 500/1250: Loss = 8.1175
  Step 510/1250: Loss = 8.1088
  Step 520/1250: Loss = 8.1003
  Step 530/1250: Loss = 8.0931
  Step 540/1250: Loss = 8.0864
  Step 550/1250: Loss = 8.0793
  Step 560/1250: Loss = 8.0715
  Step 570/1250: Loss = 8.0634
  Step 580/1250: Loss = 8.0550
  Step 590/1250: Loss = 8.0483
  Step 600/1250: Loss = 8.0422
  Step 610/1250: Loss = 8.0364
  Step 620/1250: Loss = 8.0306
  Step 630/1250: Loss = 8.0249
  Step 640/1250: Loss = 8.0189
  Step 650/1250: Loss = 8.0140
  Step 660/1250: Loss = 8.0082
  Step 670/1250: Loss = 8.0032
  Step 680/1250: Loss = 7.9964
  Step 690/1250: Loss = 7.9908
  Step 700/1250: Loss = 7.9848
  Step 710/1250: Loss = 7.9780
  Step 720/1250: Loss = 7.9728
  Step 730/1250: Loss = 7.9680
  Step 740/1250: Loss = 7.9619
  Step 750/1250: Loss = 7.9549
  Step 760/1250: Loss = 7.9507
  Step 770/1250: Loss = 7.9461
  Step 780/1250: Loss = 7.9416
  Step 790/1250: Loss = 7.9369
  Step 800/1250: Loss = 7.9325
  Step 810/1250: Loss = 7.9272
  Step 820/1250: Loss = 7.9232
  Step 830/1250: Loss = 7.9178
  Step 840/1250: Loss = 7.9131
  Step 850/1250: Loss = 7.9093
  Step 860/1250: Loss = 7.9056
  Step 870/1250: Loss = 7.9020
  Step 880/1250: Loss = 7.8969
  Step 890/1250: Loss = 7.8928
  Step 900/1250: Loss = 7.8898
  Step 910/1250: Loss = 7.8865
  Step 920/1250: Loss = 7.8829
  Step 930/1250: Loss = 7.8798
  Step 940/1250: Loss = 7.8769
  Step 950/1250: Loss = 7.8736
  Step 960/1250: Loss = 7.8695
  Step 970/1250: Loss = 7.8663
  Step 980/1250: Loss = 7.8633
  Step 990/1250: Loss = 7.8594
  Step 1000/1250: Loss = 7.8571
  Step 1010/1250: Loss = 7.8541
  Step 1020/1250: Loss = 7.8496
  Step 1030/1250: Loss = 7.8468
  Step 1040/1250: Loss = 7.8443
  Step 1050/1250: Loss = 7.8413
  Step 1060/1250: Loss = 7.8374
  Step 1070/1250: Loss = 7.8345
  Step 1080/1250: Loss = 7.8316
  Step 1090/1250: Loss = 7.8281
  Step 1100/1250: Loss = 7.8253
  Step 1110/1250: Loss = 7.8228
  Step 1120/1250: Loss = 7.8197
  Step 1130/1250: Loss = 7.8159
  Step 1140/1250: Loss = 7.8133
  Step 1150/1250: Loss = 7.8102
  Step 1160/1250: Loss = 7.8080
  Step 1170/1250: Loss = 7.8060
  Step 1180/1250: Loss = 7.8033
  Step 1190/1250: Loss = 7.7997
  Step 1200/1250: Loss = 7.7980
  Step 1210/1250: Loss = 7.7954
  Step 1220/1250: Loss = 7.7925
  Step 1230/1250: Loss = 7.7898
  Step 1240/1250: Loss = 7.7871
  Step 1250/1250: Loss = 7.7840

================================================================================
AFFINE ADAPTER EXPERIMENT FAILED
================================================================================
Error: list index out of range
Traceback (most recent call last):
Traceback (most recent call last):
  File "/projects/m000066/sujinesh/LatentWire/experimental/learning/unified_cross_model_experiments.py", line 1076, in run_adapter_experiment
    adapter, metrics = train_adapter(
  File "/projects/m000066/sujinesh/LatentWire/experimental/learning/unified_cross_model_experiments.py", line 1076, in run_adapter_experiment
    adapter, metrics = train_adapter(
  File "/projects/m000066/sujinesh/LatentWire/experimental/learning/unified_cross_model_experiments.py", line 944, in train_adapter
    source_repr = outputs_a.hidden_states[ALIGNMENT_LAYERS[1]][:, 0, :]
  File "/projects/m000066/sujinesh/LatentWire/experimental/learning/unified_cross_model_experiments.py", line 944, in train_adapter
    source_repr = outputs_a.hidden_states[ALIGNMENT_LAYERS[1]][:, 0, :]
IndexError: list index out of range
IndexError: list index out of range
