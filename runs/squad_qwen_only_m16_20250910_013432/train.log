Loading dataset subset...
Loading SQuAD subset...
Qwen hidden size: 896
⚠️  No valid checkpoint found to resume; starting fresh.
Epoch 1/5
  step 10/512 | loss=20.7992 | sec/step~1.24
  step 20/512 | loss=16.3529 | sec/step~0.90
  step 30/512 | loss=14.8713 | sec/step~0.77
  step 40/512 | loss=13.0131 | sec/step~0.73
  step 50/512 | loss=10.8460 | sec/step~0.73
  step 60/512 | loss=10.3433 | sec/step~0.72
  step 70/512 | loss=8.0158 | sec/step~0.72
  step 80/512 | loss=7.0612 | sec/step~0.71
  step 90/512 | loss=6.4131 | sec/step~0.71
  step 100/512 | loss=4.9632 | sec/step~0.71
  [debug:Q] a.scale=0.9890 | Z.std=1.0042 Z.mean||=16.0670 | p.std=0.2923 p.mean||=8.7050
  step 110/512 | loss=4.7391 | sec/step~0.71
  step 120/512 | loss=4.6699 | sec/step~0.72
  step 130/512 | loss=4.0151 | sec/step~0.71
  step 140/512 | loss=4.0962 | sec/step~0.71
  step 150/512 | loss=3.3357 | sec/step~0.71
  step 160/512 | loss=3.6147 | sec/step~0.72
  step 170/512 | loss=3.3666 | sec/step~0.72
  step 180/512 | loss=2.9902 | sec/step~0.72
  step 190/512 | loss=2.8517 | sec/step~0.72
  step 200/512 | loss=2.4531 | sec/step~0.71
  [debug:Q] a.scale=0.9826 | Z.std=1.0116 Z.mean||=16.1858 | p.std=0.1761 p.mean||=5.1914
  step 210/512 | loss=2.7026 | sec/step~0.72
  step 220/512 | loss=2.5563 | sec/step~0.71
  step 230/512 | loss=2.6869 | sec/step~0.71
  step 240/512 | loss=2.2491 | sec/step~0.72
  step 250/512 | loss=2.4324 | sec/step~0.71
  step 260/512 | loss=2.1402 | sec/step~0.71
  step 270/512 | loss=2.4019 | sec/step~0.71
  step 280/512 | loss=2.1913 | sec/step~0.71
  step 290/512 | loss=2.4914 | sec/step~0.71
  step 300/512 | loss=2.0840 | sec/step~0.71
  [debug:Q] a.scale=0.9782 | Z.std=1.0163 Z.mean||=16.2612 | p.std=0.1328 p.mean||=3.8616
  step 310/512 | loss=2.2130 | sec/step~0.76
  step 320/512 | loss=2.3067 | sec/step~0.75
  step 330/512 | loss=2.1823 | sec/step~0.76
  step 340/512 | loss=2.4451 | sec/step~0.76
  step 350/512 | loss=2.1616 | sec/step~0.76
  step 360/512 | loss=1.8300 | sec/step~0.76
  step 370/512 | loss=1.8468 | sec/step~0.77
  step 380/512 | loss=1.7339 | sec/step~0.78
  step 390/512 | loss=2.4045 | sec/step~0.77
  step 400/512 | loss=2.1933 | sec/step~0.77
  [debug:Q] a.scale=0.9746 | Z.std=1.0190 Z.mean||=16.3037 | p.std=0.1186 p.mean||=3.4176
  step 410/512 | loss=2.1841 | sec/step~0.77
  step 420/512 | loss=1.7490 | sec/step~0.78
  step 430/512 | loss=2.0724 | sec/step~0.75
  step 440/512 | loss=1.8898 | sec/step~0.74
  step 450/512 | loss=1.7192 | sec/step~0.73
  step 460/512 | loss=1.7499 | sec/step~0.72
  step 470/512 | loss=1.8520 | sec/step~0.72
  step 480/512 | loss=1.8756 | sec/step~0.71
  step 490/512 | loss=1.5123 | sec/step~0.71
  step 500/512 | loss=1.9793 | sec/step~0.71
  [debug:Q] a.scale=0.9714 | Z.std=1.0212 Z.mean||=16.3386 | p.std=0.1073 p.mean||=3.0452
  ✅ Saved checkpoint at step 500
  step 510/512 | loss=1.9812 | sec/step~0.71
  step 512/512 | loss=1.7417 | sec/step~0.71
  [debug:Q] a.scale=0.9710 | Z.std=1.0215 Z.mean||=16.3432 | p.std=0.1055 p.mean||=3.0048
Epoch 2/5
  step 10/512 | loss=1.7127 | sec/step~0.71
  step 20/512 | loss=1.8211 | sec/step~0.71
  step 30/512 | loss=1.9951 | sec/step~0.71
  step 40/512 | loss=1.8758 | sec/step~0.71
  step 50/512 | loss=1.6726 | sec/step~0.72
  step 60/512 | loss=1.9860 | sec/step~0.71
  step 70/512 | loss=1.8421 | sec/step~0.71
  step 80/512 | loss=1.9147 | sec/step~0.72
  step 90/512 | loss=1.6963 | sec/step~0.72
  step 100/512 | loss=1.7284 | sec/step~0.71
  [debug:Q] a.scale=0.9682 | Z.std=1.0235 Z.mean||=16.3757 | p.std=0.0964 p.mean||=2.7253
  step 110/512 | loss=1.5820 | sec/step~0.71
  step 120/512 | loss=1.8986 | sec/step~0.72
  step 130/512 | loss=1.9916 | sec/step~0.71
  step 140/512 | loss=2.0484 | sec/step~0.71
  step 150/512 | loss=2.2219 | sec/step~0.71
  step 160/512 | loss=1.8966 | sec/step~0.71
  step 170/512 | loss=1.5829 | sec/step~0.71
  step 180/512 | loss=1.9514 | sec/step~0.71
  step 190/512 | loss=1.7408 | sec/step~0.71
  step 200/512 | loss=1.8527 | sec/step~0.71
  [debug:Q] a.scale=0.9654 | Z.std=1.0248 Z.mean||=16.3972 | p.std=0.0936 p.mean||=2.6212
  step 210/512 | loss=2.2709 | sec/step~0.71
  step 220/512 | loss=1.4232 | sec/step~0.71
  step 230/512 | loss=1.2353 | sec/step~0.71
  step 240/512 | loss=1.7506 | sec/step~0.71
  step 250/512 | loss=1.6513 | sec/step~0.71
  step 260/512 | loss=1.8140 | sec/step~0.71
  step 270/512 | loss=1.4603 | sec/step~0.72
  step 280/512 | loss=1.4225 | sec/step~0.71
  step 290/512 | loss=1.4896 | sec/step~0.71
  step 300/512 | loss=1.4254 | sec/step~0.72
  [debug:Q] a.scale=0.9628 | Z.std=1.0265 Z.mean||=16.4235 | p.std=0.0849 p.mean||=2.3539
  step 310/512 | loss=2.3946 | sec/step~0.72
  step 320/512 | loss=1.9524 | sec/step~0.71
  step 330/512 | loss=1.4759 | sec/step~0.71
  step 340/512 | loss=1.5243 | sec/step~0.71
  step 350/512 | loss=1.7405 | sec/step~0.72
  step 360/512 | loss=1.4693 | sec/step~0.71
  step 370/512 | loss=1.6488 | sec/step~0.72
  step 380/512 | loss=1.4853 | sec/step~0.71
  step 390/512 | loss=1.6116 | sec/step~0.71
  step 400/512 | loss=1.2663 | sec/step~0.71
  [debug:Q] a.scale=0.9602 | Z.std=1.0272 Z.mean||=16.4357 | p.std=0.0842 p.mean||=2.3308
  step 410/512 | loss=1.5562 | sec/step~0.71
  step 420/512 | loss=1.3565 | sec/step~0.71
  step 430/512 | loss=1.5957 | sec/step~0.71
  step 440/512 | loss=1.6153 | sec/step~0.71
  step 450/512 | loss=1.6538 | sec/step~0.71
  step 460/512 | loss=1.3861 | sec/step~0.71
  step 470/512 | loss=1.9874 | sec/step~0.71
  step 480/512 | loss=1.8269 | sec/step~0.71
  ✅ Saved checkpoint at step 1000
  step 490/512 | loss=1.5713 | sec/step~0.72
  step 500/512 | loss=1.4302 | sec/step~0.71
  [debug:Q] a.scale=0.9577 | Z.std=1.0287 Z.mean||=16.4586 | p.std=0.0796 p.mean||=2.2023
  step 510/512 | loss=1.6250 | sec/step~0.71
  step 512/512 | loss=1.5741 | sec/step~0.71
  [debug:Q] a.scale=0.9574 | Z.std=1.0286 Z.mean||=16.4574 | p.std=0.0796 p.mean||=2.1881
Epoch 3/5
  step 10/512 | loss=1.7464 | sec/step~0.71
  step 20/512 | loss=1.6824 | sec/step~0.71
  step 30/512 | loss=1.8401 | sec/step~0.71
  step 40/512 | loss=1.4093 | sec/step~0.72
  step 50/512 | loss=1.7550 | sec/step~0.71
  step 60/512 | loss=1.7364 | sec/step~0.71
  step 70/512 | loss=1.4191 | sec/step~0.71
  step 80/512 | loss=1.5512 | sec/step~0.71
  step 90/512 | loss=1.4529 | sec/step~0.71
  step 100/512 | loss=1.7438 | sec/step~0.71
  [debug:Q] a.scale=0.9551 | Z.std=1.0292 Z.mean||=16.4674 | p.std=0.0793 p.mean||=2.1803
  step 110/512 | loss=1.8358 | sec/step~0.71
  step 120/512 | loss=1.5793 | sec/step~0.71
  step 130/512 | loss=1.6187 | sec/step~0.71
  step 140/512 | loss=1.3660 | sec/step~0.71
  step 150/512 | loss=1.8278 | sec/step~0.71
  step 160/512 | loss=1.3473 | sec/step~0.71
  step 170/512 | loss=1.5715 | sec/step~0.71
  step 180/512 | loss=1.7384 | sec/step~0.71
  step 190/512 | loss=1.3675 | sec/step~0.71
  step 200/512 | loss=1.4721 | sec/step~0.71
  [debug:Q] a.scale=0.9527 | Z.std=1.0306 Z.mean||=16.4896 | p.std=0.0734 p.mean||=2.0138
  step 210/512 | loss=1.3810 | sec/step~0.71
  step 220/512 | loss=1.4981 | sec/step~0.71
  step 230/512 | loss=1.7703 | sec/step~0.71
  step 240/512 | loss=1.7859 | sec/step~0.71
  step 250/512 | loss=1.7686 | sec/step~0.71
  step 260/512 | loss=1.4054 | sec/step~0.71
  step 270/512 | loss=1.2497 | sec/step~0.71
  step 280/512 | loss=1.4110 | sec/step~0.71
  step 290/512 | loss=1.7024 | sec/step~0.71
  step 300/512 | loss=1.6624 | sec/step~0.71
  [debug:Q] a.scale=0.9503 | Z.std=1.0311 Z.mean||=16.4970 | p.std=0.0737 p.mean||=2.0242
  step 310/512 | loss=1.6627 | sec/step~0.71
  step 320/512 | loss=1.2171 | sec/step~0.71
  step 330/512 | loss=1.5817 | sec/step~0.71
  step 340/512 | loss=1.5490 | sec/step~0.71
  step 350/512 | loss=1.3734 | sec/step~0.71
  step 360/512 | loss=1.3766 | sec/step~0.71
  step 370/512 | loss=1.2131 | sec/step~0.71
  step 380/512 | loss=1.5045 | sec/step~0.71
  step 390/512 | loss=1.2975 | sec/step~0.71
  step 400/512 | loss=1.6439 | sec/step~0.71
  [debug:Q] a.scale=0.9479 | Z.std=1.0309 Z.mean||=16.4949 | p.std=0.0782 p.mean||=2.1478
  step 410/512 | loss=1.4517 | sec/step~0.71
  step 420/512 | loss=1.1904 | sec/step~0.71
  step 430/512 | loss=1.5999 | sec/step~0.71
  step 440/512 | loss=1.4826 | sec/step~0.71
  step 450/512 | loss=1.6404 | sec/step~0.71
  step 460/512 | loss=1.4671 | sec/step~0.71
  step 470/512 | loss=1.3167 | sec/step~0.71
  ✅ Saved checkpoint at step 1500
  step 480/512 | loss=1.5592 | sec/step~0.72
  step 490/512 | loss=1.6693 | sec/step~0.72
  step 500/512 | loss=1.4733 | sec/step~0.72
  [debug:Q] a.scale=0.9454 | Z.std=1.0320 Z.mean||=16.5118 | p.std=0.0741 p.mean||=2.0207
  step 510/512 | loss=1.3865 | sec/step~0.72
  step 512/512 | loss=1.2140 | sec/step~0.72
  [debug:Q] a.scale=0.9451 | Z.std=1.0323 Z.mean||=16.5167 | p.std=0.0730 p.mean||=1.9907
Epoch 4/5
  step 10/512 | loss=1.2683 | sec/step~0.72
  step 20/512 | loss=1.7823 | sec/step~0.72
  step 30/512 | loss=1.3378 | sec/step~0.72
  step 40/512 | loss=1.6685 | sec/step~0.72
  step 50/512 | loss=1.4625 | sec/step~0.72
  step 60/512 | loss=1.3771 | sec/step~0.71
  step 70/512 | loss=1.1023 | sec/step~0.71
  step 80/512 | loss=2.1580 | sec/step~0.71
  step 90/512 | loss=1.6759 | sec/step~0.71
  step 100/512 | loss=1.2872 | sec/step~0.71
  [debug:Q] a.scale=0.9426 | Z.std=1.0335 Z.mean||=16.5352 | p.std=0.0677 p.mean||=1.8484
  step 110/512 | loss=1.1610 | sec/step~0.71
  step 120/512 | loss=1.3658 | sec/step~0.71
  step 130/512 | loss=1.6483 | sec/step~0.71
  step 140/512 | loss=1.3110 | sec/step~0.71
  step 150/512 | loss=1.7198 | sec/step~0.71
  step 160/512 | loss=1.4075 | sec/step~0.71
  step 170/512 | loss=1.5789 | sec/step~0.71
  step 180/512 | loss=1.4961 | sec/step~0.71
  step 190/512 | loss=1.3251 | sec/step~0.71
  step 200/512 | loss=1.9003 | sec/step~0.71
  [debug:Q] a.scale=0.9401 | Z.std=1.0334 Z.mean||=16.5340 | p.std=0.0708 p.mean||=1.9359
  step 210/512 | loss=1.5465 | sec/step~0.71
  step 220/512 | loss=1.5356 | sec/step~0.71
  step 230/512 | loss=1.7125 | sec/step~0.71
  step 240/512 | loss=1.3699 | sec/step~0.71
  step 250/512 | loss=1.6414 | sec/step~0.71
  step 260/512 | loss=1.3954 | sec/step~0.71
  step 270/512 | loss=1.4369 | sec/step~0.71
  step 280/512 | loss=1.6487 | sec/step~0.71
  step 290/512 | loss=1.5433 | sec/step~0.71
  step 300/512 | loss=1.3358 | sec/step~0.71
  [debug:Q] a.scale=0.9376 | Z.std=1.0338 Z.mean||=16.5409 | p.std=0.0704 p.mean||=1.9225
  step 310/512 | loss=1.1908 | sec/step~0.73
  step 320/512 | loss=1.1792 | sec/step~0.73
  step 330/512 | loss=1.8290 | sec/step~0.72
  step 340/512 | loss=1.4041 | sec/step~0.71
  step 350/512 | loss=1.3012 | sec/step~0.71
  step 360/512 | loss=1.5536 | sec/step~0.71
  step 370/512 | loss=1.9166 | sec/step~0.71
  step 380/512 | loss=1.3914 | sec/step~0.71
  step 390/512 | loss=1.5864 | sec/step~0.71
  step 400/512 | loss=1.8166 | sec/step~0.71
  [debug:Q] a.scale=0.9350 | Z.std=1.0339 Z.mean||=16.5419 | p.std=0.0715 p.mean||=1.9374
  step 410/512 | loss=1.4562 | sec/step~0.71
  step 420/512 | loss=1.4375 | sec/step~0.71
  step 430/512 | loss=1.7399 | sec/step~0.71
  step 440/512 | loss=1.8820 | sec/step~0.71
  step 450/512 | loss=1.4763 | sec/step~0.71
  step 460/512 | loss=1.6641 | sec/step~0.71
  ✅ Saved checkpoint at step 2000
  step 470/512 | loss=1.2223 | sec/step~0.72
  step 480/512 | loss=1.5409 | sec/step~0.71
  step 490/512 | loss=2.6603 | sec/step~0.71
  step 500/512 | loss=1.3023 | sec/step~0.71
  [debug:Q] a.scale=0.9325 | Z.std=1.0352 Z.mean||=16.5635 | p.std=0.0662 p.mean||=1.7882
  step 510/512 | loss=1.4581 | sec/step~0.71
  step 512/512 | loss=1.7678 | sec/step~0.71
  [debug:Q] a.scale=0.9322 | Z.std=1.0346 Z.mean||=16.5535 | p.std=0.0696 p.mean||=1.8868
Epoch 5/5
  step 10/512 | loss=1.3194 | sec/step~0.73
  step 20/512 | loss=1.4331 | sec/step~0.72
  step 30/512 | loss=1.2159 | sec/step~0.71
  step 40/512 | loss=1.1141 | sec/step~0.71
  step 50/512 | loss=1.4023 | sec/step~0.71
  step 60/512 | loss=1.3819 | sec/step~0.71
  step 70/512 | loss=1.3272 | sec/step~0.71
  step 80/512 | loss=1.4166 | sec/step~0.71
  step 90/512 | loss=1.3523 | sec/step~0.71
  step 100/512 | loss=1.1247 | sec/step~0.71
  [debug:Q] a.scale=0.9296 | Z.std=1.0354 Z.mean||=16.5661 | p.std=0.0656 p.mean||=1.7561
  step 110/512 | loss=1.3984 | sec/step~0.71
  step 120/512 | loss=1.4771 | sec/step~0.71
  step 130/512 | loss=1.5271 | sec/step~0.71
  step 140/512 | loss=1.5603 | sec/step~0.71
  step 150/512 | loss=1.3686 | sec/step~0.71
  step 160/512 | loss=1.6122 | sec/step~0.71
  step 170/512 | loss=1.7181 | sec/step~0.71
  step 180/512 | loss=1.6692 | sec/step~0.71
  step 190/512 | loss=1.4601 | sec/step~0.71
  step 200/512 | loss=1.5362 | sec/step~0.71
  [debug:Q] a.scale=0.9269 | Z.std=1.0351 Z.mean||=16.5608 | p.std=0.0688 p.mean||=1.8501
  step 210/512 | loss=1.2087 | sec/step~0.71
  step 220/512 | loss=1.6211 | sec/step~0.71
  step 230/512 | loss=1.3440 | sec/step~0.71
  step 240/512 | loss=1.4822 | sec/step~0.71
  step 250/512 | loss=1.4541 | sec/step~0.71
  step 260/512 | loss=1.5296 | sec/step~0.71
  step 270/512 | loss=1.1911 | sec/step~0.71
  step 280/512 | loss=1.4184 | sec/step~0.71
  step 290/512 | loss=1.3931 | sec/step~0.71
  step 300/512 | loss=1.5355 | sec/step~0.71
  [debug:Q] a.scale=0.9243 | Z.std=1.0355 Z.mean||=16.5685 | p.std=0.0682 p.mean||=1.8358
  step 310/512 | loss=1.5749 | sec/step~0.71
  step 320/512 | loss=1.7420 | sec/step~0.71
  step 330/512 | loss=1.2097 | sec/step~0.71
  step 340/512 | loss=1.6611 | sec/step~0.71
  step 350/512 | loss=1.4885 | sec/step~0.71
  step 360/512 | loss=1.3710 | sec/step~0.71
  step 370/512 | loss=1.4031 | sec/step~0.71
  step 380/512 | loss=1.7870 | sec/step~0.71
  step 390/512 | loss=1.3106 | sec/step~0.71
  step 400/512 | loss=1.1664 | sec/step~0.71
  [debug:Q] a.scale=0.9214 | Z.std=1.0364 Z.mean||=16.5825 | p.std=0.0647 p.mean||=1.7326
  step 410/512 | loss=1.6959 | sec/step~0.72
  step 420/512 | loss=1.6128 | sec/step~0.72
  step 430/512 | loss=1.4097 | sec/step~0.72
  step 440/512 | loss=1.3274 | sec/step~0.72
  step 450/512 | loss=1.2569 | sec/step~0.72
  ✅ Saved checkpoint at step 2500
  step 460/512 | loss=1.4729 | sec/step~0.72
  step 470/512 | loss=1.5120 | sec/step~0.72
  step 480/512 | loss=1.7264 | sec/step~0.72
  step 490/512 | loss=1.5071 | sec/step~0.72
  step 500/512 | loss=1.7198 | sec/step~0.71
  [debug:Q] a.scale=0.9184 | Z.std=1.0368 Z.mean||=16.5885 | p.std=0.0650 p.mean||=1.7468
  step 510/512 | loss=1.2466 | sec/step~0.71
  step 512/512 | loss=1.3586 | sec/step~0.71
  [debug:Q] a.scale=0.9181 | Z.std=1.0373 Z.mean||=16.5961 | p.std=0.0626 p.mean||=1.6918
Saved encoder, adapters, and state to runs/squad_qwen_only_m16_20250910_013432/ckpt
