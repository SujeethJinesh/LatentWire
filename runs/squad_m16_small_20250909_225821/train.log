Loading dataset subset...
Llama hidden size: 2048, Qwen hidden size: 896
⚠️  No valid checkpoint found to resume; starting fresh.
Epoch 1/5
  step 10/500 | loss_llama=3.4742 | loss_qwen=13.2330 | grad_norm=3.40 | sec/step~2.74
  step 20/500 | loss_llama=3.7372 | loss_qwen=12.1496 | grad_norm=2.72 | sec/step~2.33
  step 30/500 | loss_llama=2.9039 | loss_qwen=11.8299 | grad_norm=2.57 | sec/step~2.18
  step 40/500 | loss_llama=3.2891 | loss_qwen=11.2050 | grad_norm=2.20 | sec/step~2.14
  step 50/500 | loss_llama=3.0092 | loss_qwen=10.5610 | grad_norm=2.20 | sec/step~2.12
  step 60/500 | loss_llama=3.2583 | loss_qwen=9.9304 | grad_norm=2.79 | sec/step~2.10
  step 70/500 | loss_llama=3.0181 | loss_qwen=8.3534 | grad_norm=4.09 | sec/step~2.10
  step 80/500 | loss_llama=2.7622 | loss_qwen=6.4953 | grad_norm=3.33 | sec/step~2.10
  step 90/500 | loss_llama=3.4988 | loss_qwen=6.0432 | grad_norm=1.26 | sec/step~2.11
  step 100/500 | loss_llama=2.9932 | loss_qwen=5.4369 | grad_norm=1.24 | sec/step~2.10
  step 110/500 | loss_llama=2.4578 | loss_qwen=4.6246 | grad_norm=1.20 | sec/step~2.10
  step 120/500 | loss_llama=2.6235 | loss_qwen=4.2977 | grad_norm=2.49 | sec/step~2.14
  step 130/500 | loss_llama=2.8120 | loss_qwen=3.9696 | grad_norm=1.54 | sec/step~2.24
  step 140/500 | loss_llama=2.5885 | loss_qwen=3.5977 | grad_norm=1.14 | sec/step~2.28
  step 150/500 | loss_llama=2.5675 | loss_qwen=3.1719 | grad_norm=1.11 | sec/step~2.22
  step 160/500 | loss_llama=2.5078 | loss_qwen=2.7957 | grad_norm=1.30 | sec/step~2.17
  step 170/500 | loss_llama=2.6463 | loss_qwen=2.6675 | grad_norm=0.90 | sec/step~2.12
  step 180/500 | loss_llama=2.6981 | loss_qwen=2.5992 | grad_norm=0.73 | sec/step~2.11
  step 190/500 | loss_llama=2.5681 | loss_qwen=2.3692 | grad_norm=0.43 | sec/step~2.10
  step 200/500 | loss_llama=2.6923 | loss_qwen=2.3076 | grad_norm=0.44 | sec/step~2.11
  step 210/500 | loss_llama=2.4384 | loss_qwen=2.2228 | grad_norm=0.41 | sec/step~2.10
  step 220/500 | loss_llama=2.7178 | loss_qwen=2.3179 | grad_norm=0.36 | sec/step~2.10
  step 230/500 | loss_llama=2.7008 | loss_qwen=2.3801 | grad_norm=0.44 | sec/step~2.11
  step 240/500 | loss_llama=2.3058 | loss_qwen=1.9722 | grad_norm=0.33 | sec/step~2.11
  step 250/500 | loss_llama=2.4666 | loss_qwen=2.1152 | grad_norm=0.35 | sec/step~2.11
  step 260/500 | loss_llama=2.0297 | loss_qwen=1.6955 | grad_norm=0.35 | sec/step~2.11
  step 270/500 | loss_llama=2.4618 | loss_qwen=2.0591 | grad_norm=0.34 | sec/step~2.11
  step 280/500 | loss_llama=2.3584 | loss_qwen=1.9132 | grad_norm=0.23 | sec/step~2.10
  step 290/500 | loss_llama=2.2416 | loss_qwen=1.8600 | grad_norm=0.35 | sec/step~2.11
  step 300/500 | loss_llama=2.1212 | loss_qwen=1.8287 | grad_norm=0.28 | sec/step~2.10
  step 310/500 | loss_llama=2.7799 | loss_qwen=2.3996 | grad_norm=0.30 | sec/step~2.10
  step 320/500 | loss_llama=2.3625 | loss_qwen=1.9906 | grad_norm=0.31 | sec/step~2.10
  step 330/500 | loss_llama=2.2191 | loss_qwen=1.8573 | grad_norm=0.22 | sec/step~2.12
  step 340/500 | loss_llama=2.6008 | loss_qwen=2.0961 | grad_norm=0.26 | sec/step~2.12
  step 350/500 | loss_llama=2.5322 | loss_qwen=1.9872 | grad_norm=0.22 | sec/step~2.11
  step 360/500 | loss_llama=2.8789 | loss_qwen=2.5439 | grad_norm=0.29 | sec/step~2.12
  step 370/500 | loss_llama=2.1665 | loss_qwen=1.8003 | grad_norm=0.52 | sec/step~2.10
  step 380/500 | loss_llama=3.1937 | loss_qwen=2.7818 | grad_norm=0.43 | sec/step~2.11
  step 390/500 | loss_llama=2.5183 | loss_qwen=2.0420 | grad_norm=0.38 | sec/step~2.11
  step 400/500 | loss_llama=2.3046 | loss_qwen=2.0807 | grad_norm=0.32 | sec/step~2.11
  step 410/500 | loss_llama=2.0213 | loss_qwen=1.6773 | grad_norm=0.25 | sec/step~2.11
  step 420/500 | loss_llama=1.9646 | loss_qwen=1.6795 | grad_norm=0.31 | sec/step~2.10
  step 430/500 | loss_llama=2.3939 | loss_qwen=1.8718 | grad_norm=0.28 | sec/step~2.10
  step 440/500 | loss_llama=2.4936 | loss_qwen=2.0949 | grad_norm=0.28 | sec/step~2.10
  step 450/500 | loss_llama=2.1509 | loss_qwen=1.7596 | grad_norm=0.25 | sec/step~2.11
  step 460/500 | loss_llama=2.4110 | loss_qwen=1.9969 | grad_norm=0.32 | sec/step~2.11
  step 470/500 | loss_llama=2.1604 | loss_qwen=1.8065 | grad_norm=0.24 | sec/step~2.11
  step 480/500 | loss_llama=2.1046 | loss_qwen=1.7320 | grad_norm=0.25 | sec/step~2.11
  step 490/500 | loss_llama=2.4978 | loss_qwen=2.0849 | grad_norm=0.26 | sec/step~2.11
  step 500/500 | loss_llama=2.5866 | loss_qwen=2.0954 | grad_norm=0.31 | sec/step~2.11
  ✅ Saved checkpoint at step 500
Epoch 2/5
  step 10/500 | loss_llama=2.5914 | loss_qwen=2.2158 | grad_norm=0.51 | sec/step~2.11
  step 20/500 | loss_llama=2.4179 | loss_qwen=1.9710 | grad_norm=0.31 | sec/step~2.12
  step 30/500 | loss_llama=2.3050 | loss_qwen=1.9691 | grad_norm=0.34 | sec/step~2.12
  step 40/500 | loss_llama=2.4559 | loss_qwen=2.0437 | grad_norm=0.30 | sec/step~2.11
  step 50/500 | loss_llama=2.2208 | loss_qwen=1.9006 | grad_norm=0.29 | sec/step~2.10
  step 60/500 | loss_llama=2.8743 | loss_qwen=2.3748 | grad_norm=0.30 | sec/step~2.10
  step 70/500 | loss_llama=2.2344 | loss_qwen=1.8614 | grad_norm=0.33 | sec/step~2.10
  step 80/500 | loss_llama=2.3674 | loss_qwen=1.9136 | grad_norm=0.39 | sec/step~2.10
  step 90/500 | loss_llama=2.0822 | loss_qwen=1.6986 | grad_norm=0.49 | sec/step~2.10
  step 100/500 | loss_llama=2.0554 | loss_qwen=1.6489 | grad_norm=0.35 | sec/step~2.11
  step 110/500 | loss_llama=2.1037 | loss_qwen=1.7423 | grad_norm=0.35 | sec/step~2.11
  step 120/500 | loss_llama=2.1441 | loss_qwen=1.6792 | grad_norm=0.63 | sec/step~2.12
  step 130/500 | loss_llama=1.7865 | loss_qwen=1.4146 | grad_norm=0.34 | sec/step~2.11
  step 140/500 | loss_llama=2.9464 | loss_qwen=2.3988 | grad_norm=0.51 | sec/step~2.11
  step 150/500 | loss_llama=2.2214 | loss_qwen=1.7795 | grad_norm=0.23 | sec/step~2.11
  step 160/500 | loss_llama=2.0462 | loss_qwen=1.8039 | grad_norm=0.21 | sec/step~2.12
  step 170/500 | loss_llama=2.3569 | loss_qwen=1.9632 | grad_norm=0.53 | sec/step~2.10
  step 180/500 | loss_llama=2.0214 | loss_qwen=1.5871 | grad_norm=0.80 | sec/step~2.10
  step 190/500 | loss_llama=1.8731 | loss_qwen=1.5506 | grad_norm=0.77 | sec/step~2.10
  step 200/500 | loss_llama=2.6508 | loss_qwen=2.3633 | grad_norm=0.37 | sec/step~2.10
  step 210/500 | loss_llama=2.1812 | loss_qwen=1.6823 | grad_norm=0.27 | sec/step~2.10
  step 220/500 | loss_llama=2.1758 | loss_qwen=1.7875 | grad_norm=0.28 | sec/step~2.10
  step 230/500 | loss_llama=2.0192 | loss_qwen=1.6437 | grad_norm=0.54 | sec/step~2.12
  step 240/500 | loss_llama=2.1816 | loss_qwen=1.7215 | grad_norm=0.33 | sec/step~2.11
  step 250/500 | loss_llama=2.0605 | loss_qwen=1.6796 | grad_norm=0.24 | sec/step~2.11
  step 260/500 | loss_llama=2.2068 | loss_qwen=1.7809 | grad_norm=0.36 | sec/step~2.11
  step 270/500 | loss_llama=2.0162 | loss_qwen=1.6166 | grad_norm=0.79 | sec/step~2.11
  step 280/500 | loss_llama=1.9149 | loss_qwen=1.4873 | grad_norm=0.28 | sec/step~2.11
  step 290/500 | loss_llama=2.0098 | loss_qwen=1.7040 | grad_norm=0.34 | sec/step~2.11
  step 300/500 | loss_llama=1.8576 | loss_qwen=1.4711 | grad_norm=0.49 | sec/step~2.11
  step 310/500 | loss_llama=2.4126 | loss_qwen=1.9902 | grad_norm=0.81 | sec/step~2.12
  step 320/500 | loss_llama=2.0272 | loss_qwen=1.4271 | grad_norm=0.34 | sec/step~2.12
  step 330/500 | loss_llama=2.2350 | loss_qwen=1.7720 | grad_norm=0.27 | sec/step~2.12
  step 340/500 | loss_llama=2.4809 | loss_qwen=1.8205 | grad_norm=0.32 | sec/step~2.12
  step 350/500 | loss_llama=2.0471 | loss_qwen=1.5173 | grad_norm=0.35 | sec/step~2.12
  step 360/500 | loss_llama=2.2547 | loss_qwen=1.7024 | grad_norm=0.65 | sec/step~2.12
  step 370/500 | loss_llama=2.1145 | loss_qwen=1.5889 | grad_norm=0.29 | sec/step~2.11
  step 380/500 | loss_llama=1.9585 | loss_qwen=1.4824 | grad_norm=0.34 | sec/step~2.12
  step 390/500 | loss_llama=1.8804 | loss_qwen=1.3794 | grad_norm=0.57 | sec/step~2.10
  step 400/500 | loss_llama=2.4036 | loss_qwen=1.8868 | grad_norm=0.67 | sec/step~2.10
  step 410/500 | loss_llama=1.7719 | loss_qwen=1.2788 | grad_norm=0.38 | sec/step~2.10
  step 420/500 | loss_llama=2.2163 | loss_qwen=1.7220 | grad_norm=0.28 | sec/step~2.10
  step 430/500 | loss_llama=2.4368 | loss_qwen=1.8481 | grad_norm=0.48 | sec/step~2.11
  step 440/500 | loss_llama=1.9317 | loss_qwen=1.4416 | grad_norm=0.29 | sec/step~2.11
  step 450/500 | loss_llama=2.1192 | loss_qwen=1.7144 | grad_norm=0.33 | sec/step~2.11
  step 460/500 | loss_llama=2.4524 | loss_qwen=1.9891 | grad_norm=0.24 | sec/step~2.12
  step 470/500 | loss_llama=2.4175 | loss_qwen=1.8058 | grad_norm=0.32 | sec/step~2.11
  step 480/500 | loss_llama=2.1730 | loss_qwen=1.5390 | grad_norm=0.28 | sec/step~2.11
  step 490/500 | loss_llama=2.1470 | loss_qwen=1.4874 | grad_norm=0.51 | sec/step~2.11
  step 500/500 | loss_llama=2.5901 | loss_qwen=1.9919 | grad_norm=0.29 | sec/step~2.11
  ✅ Saved checkpoint at step 1000
Epoch 3/5
  step 10/500 | loss_llama=2.0948 | loss_qwen=1.5299 | grad_norm=0.35 | sec/step~2.11
  step 20/500 | loss_llama=1.5783 | loss_qwen=1.0362 | grad_norm=0.41 | sec/step~2.11
  step 30/500 | loss_llama=2.2921 | loss_qwen=1.7340 | grad_norm=0.34 | sec/step~2.11
  step 40/500 | loss_llama=2.2144 | loss_qwen=1.7876 | grad_norm=0.30 | sec/step~2.11
  step 50/500 | loss_llama=1.9641 | loss_qwen=1.4446 | grad_norm=0.20 | sec/step~2.11
  step 60/500 | loss_llama=2.1383 | loss_qwen=1.5266 | grad_norm=0.41 | sec/step~2.11
  step 70/500 | loss_llama=2.6885 | loss_qwen=1.9082 | grad_norm=0.36 | sec/step~2.11
  step 80/500 | loss_llama=1.7743 | loss_qwen=1.1773 | grad_norm=0.32 | sec/step~2.11
  step 90/500 | loss_llama=2.2948 | loss_qwen=1.7085 | grad_norm=0.42 | sec/step~2.10
  step 100/500 | loss_llama=2.1201 | loss_qwen=1.4986 | grad_norm=0.33 | sec/step~2.10
  step 110/500 | loss_llama=2.3795 | loss_qwen=1.7898 | grad_norm=0.39 | sec/step~2.10
  step 120/500 | loss_llama=1.9296 | loss_qwen=1.4310 | grad_norm=0.24 | sec/step~2.10
  step 130/500 | loss_llama=2.3065 | loss_qwen=1.7120 | grad_norm=0.38 | sec/step~2.11
  step 140/500 | loss_llama=2.0917 | loss_qwen=1.5532 | grad_norm=0.21 | sec/step~2.11
  step 150/500 | loss_llama=2.4573 | loss_qwen=1.9121 | grad_norm=0.32 | sec/step~2.11
  step 160/500 | loss_llama=2.0688 | loss_qwen=1.5176 | grad_norm=0.28 | sec/step~2.11
  step 170/500 | loss_llama=1.8516 | loss_qwen=1.4161 | grad_norm=0.50 | sec/step~2.13
  step 180/500 | loss_llama=2.5614 | loss_qwen=2.1166 | grad_norm=0.68 | sec/step~2.11
  step 190/500 | loss_llama=2.0985 | loss_qwen=1.4875 | grad_norm=0.41 | sec/step~2.11
  step 200/500 | loss_llama=2.1584 | loss_qwen=1.7138 | grad_norm=0.40 | sec/step~2.11
  step 210/500 | loss_llama=1.8211 | loss_qwen=1.3469 | grad_norm=0.38 | sec/step~2.10
  step 220/500 | loss_llama=2.3982 | loss_qwen=1.7582 | grad_norm=0.32 | sec/step~2.11
  step 230/500 | loss_llama=2.9722 | loss_qwen=2.3842 | grad_norm=0.33 | sec/step~2.11
  step 240/500 | loss_llama=2.0412 | loss_qwen=1.5251 | grad_norm=0.29 | sec/step~2.10
  step 250/500 | loss_llama=2.2703 | loss_qwen=1.7227 | grad_norm=0.54 | sec/step~2.10
  step 260/500 | loss_llama=1.9024 | loss_qwen=1.3011 | grad_norm=0.24 | sec/step~2.12
  step 270/500 | loss_llama=2.2162 | loss_qwen=1.6052 | grad_norm=0.36 | sec/step~2.12
  step 280/500 | loss_llama=1.8777 | loss_qwen=1.2874 | grad_norm=0.26 | sec/step~2.11
  step 290/500 | loss_llama=2.1735 | loss_qwen=1.5864 | grad_norm=0.38 | sec/step~2.11
  step 300/500 | loss_llama=2.2576 | loss_qwen=1.7452 | grad_norm=0.30 | sec/step~2.10
  step 310/500 | loss_llama=2.2838 | loss_qwen=1.7106 | grad_norm=0.29 | sec/step~2.10
  step 320/500 | loss_llama=1.7993 | loss_qwen=1.2623 | grad_norm=0.46 | sec/step~2.11
  step 330/500 | loss_llama=2.1325 | loss_qwen=1.5944 | grad_norm=0.37 | sec/step~2.11
  step 340/500 | loss_llama=1.8421 | loss_qwen=1.4724 | grad_norm=0.27 | sec/step~2.11
  step 350/500 | loss_llama=2.0613 | loss_qwen=1.5369 | grad_norm=0.44 | sec/step~2.10
  step 360/500 | loss_llama=2.2580 | loss_qwen=1.6798 | grad_norm=0.43 | sec/step~2.10
  step 370/500 | loss_llama=1.7559 | loss_qwen=1.3147 | grad_norm=0.26 | sec/step~2.10
  step 380/500 | loss_llama=1.9599 | loss_qwen=1.3255 | grad_norm=0.25 | sec/step~2.11
  step 390/500 | loss_llama=2.4741 | loss_qwen=1.8413 | grad_norm=0.33 | sec/step~2.11
  step 400/500 | loss_llama=2.1993 | loss_qwen=1.6744 | grad_norm=0.55 | sec/step~2.11
  step 410/500 | loss_llama=1.7081 | loss_qwen=1.1758 | grad_norm=0.38 | sec/step~2.11
  step 420/500 | loss_llama=2.1741 | loss_qwen=1.6066 | grad_norm=0.24 | sec/step~2.11
  step 430/500 | loss_llama=1.8715 | loss_qwen=1.3799 | grad_norm=0.25 | sec/step~2.11
  step 440/500 | loss_llama=1.9902 | loss_qwen=1.4313 | grad_norm=0.39 | sec/step~2.10
  step 450/500 | loss_llama=2.0476 | loss_qwen=1.5288 | grad_norm=0.40 | sec/step~2.11
  step 460/500 | loss_llama=1.9974 | loss_qwen=1.4852 | grad_norm=0.35 | sec/step~2.12
  step 470/500 | loss_llama=1.8396 | loss_qwen=1.3644 | grad_norm=0.26 | sec/step~2.10
  step 480/500 | loss_llama=1.8060 | loss_qwen=1.2612 | grad_norm=0.34 | sec/step~2.11
  step 490/500 | loss_llama=2.4253 | loss_qwen=1.9445 | grad_norm=0.44 | sec/step~2.11
  step 500/500 | loss_llama=2.5549 | loss_qwen=2.0448 | grad_norm=0.34 | sec/step~2.11
  ✅ Saved checkpoint at step 1500
Epoch 4/5
  step 10/500 | loss_llama=2.5080 | loss_qwen=2.0530 | grad_norm=0.49 | sec/step~2.11
  step 20/500 | loss_llama=2.5571 | loss_qwen=2.1482 | grad_norm=0.36 | sec/step~2.10
  step 30/500 | loss_llama=2.1090 | loss_qwen=1.5414 | grad_norm=0.39 | sec/step~2.10
  step 40/500 | loss_llama=2.1929 | loss_qwen=1.6511 | grad_norm=0.40 | sec/step~2.12
  step 50/500 | loss_llama=2.0390 | loss_qwen=1.4891 | grad_norm=0.42 | sec/step~2.12
  step 60/500 | loss_llama=2.4820 | loss_qwen=1.9251 | grad_norm=0.36 | sec/step~2.12
  step 70/500 | loss_llama=1.9698 | loss_qwen=1.5144 | grad_norm=0.65 | sec/step~2.12
  step 80/500 | loss_llama=2.8221 | loss_qwen=2.1693 | grad_norm=0.27 | sec/step~2.12
  step 90/500 | loss_llama=1.8641 | loss_qwen=1.3448 | grad_norm=0.74 | sec/step~2.11
  step 100/500 | loss_llama=1.9020 | loss_qwen=1.4626 | grad_norm=0.43 | sec/step~2.12
  step 110/500 | loss_llama=1.8970 | loss_qwen=1.3457 | grad_norm=0.30 | sec/step~2.11
  step 120/500 | loss_llama=1.9043 | loss_qwen=1.4570 | grad_norm=0.28 | sec/step~2.11
  step 130/500 | loss_llama=1.7940 | loss_qwen=1.3497 | grad_norm=0.39 | sec/step~2.11
  step 140/500 | loss_llama=2.6551 | loss_qwen=2.0587 | grad_norm=0.29 | sec/step~2.12
  step 150/500 | loss_llama=1.9360 | loss_qwen=1.5063 | grad_norm=0.30 | sec/step~2.11
  step 160/500 | loss_llama=1.8485 | loss_qwen=1.3601 | grad_norm=0.40 | sec/step~2.11
  step 170/500 | loss_llama=2.2161 | loss_qwen=1.7609 | grad_norm=0.48 | sec/step~2.10
  step 180/500 | loss_llama=2.5825 | loss_qwen=1.9267 | grad_norm=0.25 | sec/step~2.10
  step 190/500 | loss_llama=1.8667 | loss_qwen=1.3389 | grad_norm=0.36 | sec/step~2.10
  step 200/500 | loss_llama=1.8927 | loss_qwen=1.3589 | grad_norm=0.37 | sec/step~2.10
  step 210/500 | loss_llama=2.2094 | loss_qwen=1.6417 | grad_norm=0.27 | sec/step~2.10
  step 220/500 | loss_llama=1.8774 | loss_qwen=1.4002 | grad_norm=0.32 | sec/step~2.10
  step 230/500 | loss_llama=1.8047 | loss_qwen=1.2682 | grad_norm=0.49 | sec/step~2.10
  step 240/500 | loss_llama=2.1915 | loss_qwen=1.6663 | grad_norm=0.31 | sec/step~2.10
  step 250/500 | loss_llama=1.6100 | loss_qwen=1.1680 | grad_norm=0.43 | sec/step~2.12
  step 260/500 | loss_llama=1.9233 | loss_qwen=1.5019 | grad_norm=0.29 | sec/step~2.09
  step 270/500 | loss_llama=2.0138 | loss_qwen=1.5997 | grad_norm=0.40 | sec/step~2.10
  step 280/500 | loss_llama=2.3208 | loss_qwen=1.8075 | grad_norm=0.49 | sec/step~2.10
  step 290/500 | loss_llama=1.9506 | loss_qwen=1.5565 | grad_norm=0.53 | sec/step~2.11
  step 300/500 | loss_llama=1.9701 | loss_qwen=1.4844 | grad_norm=0.37 | sec/step~2.11
  step 310/500 | loss_llama=1.8795 | loss_qwen=1.4000 | grad_norm=0.28 | sec/step~2.12
  step 320/500 | loss_llama=2.1823 | loss_qwen=1.6757 | grad_norm=0.56 | sec/step~2.12
  step 330/500 | loss_llama=2.8510 | loss_qwen=2.4746 | grad_norm=0.66 | sec/step~2.12
  step 340/500 | loss_llama=1.5926 | loss_qwen=1.2088 | grad_norm=0.68 | sec/step~2.12
  step 350/500 | loss_llama=1.8382 | loss_qwen=1.3156 | grad_norm=0.41 | sec/step~2.12
  step 360/500 | loss_llama=2.5254 | loss_qwen=2.1662 | grad_norm=0.37 | sec/step~2.11
  step 370/500 | loss_llama=1.8904 | loss_qwen=1.3606 | grad_norm=0.36 | sec/step~2.11
  step 380/500 | loss_llama=1.8587 | loss_qwen=1.3553 | grad_norm=0.36 | sec/step~2.10
  step 390/500 | loss_llama=2.1808 | loss_qwen=1.6187 | grad_norm=0.38 | sec/step~2.10
  step 400/500 | loss_llama=2.0040 | loss_qwen=1.4910 | grad_norm=0.34 | sec/step~2.11
  step 410/500 | loss_llama=1.8883 | loss_qwen=1.4740 | grad_norm=0.34 | sec/step~2.10
  step 420/500 | loss_llama=1.7425 | loss_qwen=1.2896 | grad_norm=1.21 | sec/step~2.12
  step 430/500 | loss_llama=2.0979 | loss_qwen=1.5772 | grad_norm=0.43 | sec/step~2.11
  step 440/500 | loss_llama=1.8593 | loss_qwen=1.3138 | grad_norm=0.58 | sec/step~2.12
  step 450/500 | loss_llama=2.0538 | loss_qwen=1.5961 | grad_norm=0.42 | sec/step~2.12
  step 460/500 | loss_llama=1.7648 | loss_qwen=1.3476 | grad_norm=0.31 | sec/step~2.11
  step 470/500 | loss_llama=1.6698 | loss_qwen=1.2895 | grad_norm=0.44 | sec/step~2.10
  step 480/500 | loss_llama=1.9650 | loss_qwen=1.5375 | grad_norm=0.37 | sec/step~2.11
  step 490/500 | loss_llama=2.1276 | loss_qwen=1.5824 | grad_norm=0.26 | sec/step~2.10
  step 500/500 | loss_llama=2.0060 | loss_qwen=1.4811 | grad_norm=0.36 | sec/step~2.11
  ✅ Saved checkpoint at step 2000
Epoch 5/5
  step 10/500 | loss_llama=1.9405 | loss_qwen=1.4284 | grad_norm=0.42 | sec/step~2.11
  step 20/500 | loss_llama=2.6026 | loss_qwen=2.0173 | grad_norm=0.38 | sec/step~2.10
  step 30/500 | loss_llama=2.3641 | loss_qwen=1.7423 | grad_norm=0.40 | sec/step~2.10
  step 40/500 | loss_llama=2.5647 | loss_qwen=2.0992 | grad_norm=0.35 | sec/step~2.10
  step 50/500 | loss_llama=2.4776 | loss_qwen=2.0426 | grad_norm=0.38 | sec/step~2.10
  step 60/500 | loss_llama=2.4126 | loss_qwen=1.8440 | grad_norm=0.77 | sec/step~2.10
  step 70/500 | loss_llama=1.8607 | loss_qwen=1.3649 | grad_norm=0.54 | sec/step~2.11
  step 80/500 | loss_llama=1.8146 | loss_qwen=1.3290 | grad_norm=0.39 | sec/step~2.10
  step 90/500 | loss_llama=1.8861 | loss_qwen=1.5104 | grad_norm=0.55 | sec/step~2.11
  step 100/500 | loss_llama=1.8818 | loss_qwen=1.3392 | grad_norm=0.40 | sec/step~2.10
  step 110/500 | loss_llama=2.2067 | loss_qwen=1.8042 | grad_norm=0.28 | sec/step~2.10
  step 120/500 | loss_llama=2.3235 | loss_qwen=1.7521 | grad_norm=0.33 | sec/step~2.12
  step 130/500 | loss_llama=2.2587 | loss_qwen=1.9194 | grad_norm=0.40 | sec/step~2.11
  step 140/500 | loss_llama=2.0432 | loss_qwen=1.5197 | grad_norm=0.48 | sec/step~2.10
  step 150/500 | loss_llama=2.3549 | loss_qwen=2.0086 | grad_norm=0.73 | sec/step~2.11
  step 160/500 | loss_llama=1.6104 | loss_qwen=1.1404 | grad_norm=0.59 | sec/step~2.11
  step 170/500 | loss_llama=2.4509 | loss_qwen=2.1749 | grad_norm=0.42 | sec/step~2.11
  step 180/500 | loss_llama=1.6598 | loss_qwen=1.2392 | grad_norm=0.43 | sec/step~2.11
  step 190/500 | loss_llama=1.8513 | loss_qwen=1.4262 | grad_norm=0.58 | sec/step~2.11
  step 200/500 | loss_llama=1.4224 | loss_qwen=1.0507 | grad_norm=1.37 | sec/step~2.11
  step 210/500 | loss_llama=1.8727 | loss_qwen=1.3537 | grad_norm=0.37 | sec/step~2.11
  step 220/500 | loss_llama=1.8419 | loss_qwen=1.3461 | grad_norm=0.31 | sec/step~2.11
  step 230/500 | loss_llama=2.1036 | loss_qwen=1.7254 | grad_norm=0.33 | sec/step~2.12
  step 240/500 | loss_llama=1.9823 | loss_qwen=1.5887 | grad_norm=0.29 | sec/step~2.11
  step 250/500 | loss_llama=1.6323 | loss_qwen=1.2422 | grad_norm=0.64 | sec/step~2.11
  step 260/500 | loss_llama=1.6894 | loss_qwen=1.2793 | grad_norm=0.44 | sec/step~2.11
  step 270/500 | loss_llama=1.9081 | loss_qwen=1.4343 | grad_norm=0.44 | sec/step~2.11
  step 280/500 | loss_llama=1.8593 | loss_qwen=1.4283 | grad_norm=0.35 | sec/step~2.12
  step 290/500 | loss_llama=2.1213 | loss_qwen=1.6306 | grad_norm=0.38 | sec/step~2.11
  step 300/500 | loss_llama=1.7692 | loss_qwen=1.4472 | grad_norm=0.41 | sec/step~2.09
  step 310/500 | loss_llama=2.2065 | loss_qwen=1.6760 | grad_norm=0.43 | sec/step~2.10
  step 320/500 | loss_llama=1.5137 | loss_qwen=1.1277 | grad_norm=0.98 | sec/step~2.11
  step 330/500 | loss_llama=1.7506 | loss_qwen=1.3099 | grad_norm=0.58 | sec/step~2.11
  step 340/500 | loss_llama=2.1370 | loss_qwen=1.6039 | grad_norm=0.51 | sec/step~2.13
  step 350/500 | loss_llama=1.6699 | loss_qwen=1.2422 | grad_norm=0.75 | sec/step~2.13
  step 360/500 | loss_llama=1.7646 | loss_qwen=1.4026 | grad_norm=0.47 | sec/step~2.11
  step 370/500 | loss_llama=2.1654 | loss_qwen=1.7196 | grad_norm=0.43 | sec/step~2.11
  step 380/500 | loss_llama=1.3687 | loss_qwen=1.0391 | grad_norm=0.67 | sec/step~2.11
  step 390/500 | loss_llama=1.7521 | loss_qwen=1.3600 | grad_norm=0.54 | sec/step~2.12
  step 400/500 | loss_llama=2.3844 | loss_qwen=1.8670 | grad_norm=0.72 | sec/step~2.12
  step 410/500 | loss_llama=2.0858 | loss_qwen=1.6038 | grad_norm=0.78 | sec/step~2.11
  step 420/500 | loss_llama=2.3185 | loss_qwen=1.8479 | grad_norm=0.95 | sec/step~2.11
  step 430/500 | loss_llama=1.7703 | loss_qwen=1.4331 | grad_norm=0.47 | sec/step~2.10
  step 440/500 | loss_llama=1.7473 | loss_qwen=1.3525 | grad_norm=0.67 | sec/step~2.11
  step 450/500 | loss_llama=2.3461 | loss_qwen=1.8018 | grad_norm=0.55 | sec/step~2.12
  step 460/500 | loss_llama=2.4060 | loss_qwen=1.9709 | grad_norm=0.41 | sec/step~2.11
  step 470/500 | loss_llama=2.1139 | loss_qwen=1.7401 | grad_norm=0.88 | sec/step~2.11
  step 480/500 | loss_llama=2.1759 | loss_qwen=1.6866 | grad_norm=0.49 | sec/step~2.12
  step 490/500 | loss_llama=1.7118 | loss_qwen=1.3070 | grad_norm=0.47 | sec/step~2.11
  step 500/500 | loss_llama=1.4720 | loss_qwen=1.0917 | grad_norm=0.71 | sec/step~2.11
  ✅ Saved checkpoint at step 2500
Saved encoder/adapters/state to runs/squad_m16_small_20250909_225821/ckpt
Loading dataset subset...
Llama hidden size: 2048, Qwen hidden size: 896
⏪ Resuming from: runs/squad_m16_small_20250909_225821/ckpt/state_step2500.pt
   -> start_epoch=4, global_step=2500
Epoch 5/5
  step 10/500 | loss_llama=2.0974 | loss_qwen=1.5486 | grad_norm=0.43 | sec/step~2.63
  step 20/500 | loss_llama=1.7190 | loss_qwen=1.3753 | grad_norm=0.43 | sec/step~2.31
  step 30/500 | loss_llama=1.8185 | loss_qwen=1.3984 | grad_norm=0.73 | sec/step~2.20
  step 40/500 | loss_llama=1.8442 | loss_qwen=1.4607 | grad_norm=0.58 | sec/step~2.15
  step 50/500 | loss_llama=2.1195 | loss_qwen=1.7164 | grad_norm=0.51 | sec/step~2.14
  step 60/500 | loss_llama=1.5005 | loss_qwen=1.0069 | grad_norm=0.98 | sec/step~2.12
  step 70/500 | loss_llama=1.9714 | loss_qwen=1.5075 | grad_norm=0.32 | sec/step~2.13
  step 80/500 | loss_llama=2.2603 | loss_qwen=1.7871 | grad_norm=0.33 | sec/step~2.13
  step 90/500 | loss_llama=1.9774 | loss_qwen=1.5368 | grad_norm=0.57 | sec/step~2.14
  step 100/500 | loss_llama=1.7101 | loss_qwen=1.3238 | grad_norm=0.35 | sec/step~2.13
  step 110/500 | loss_llama=2.0255 | loss_qwen=1.5561 | grad_norm=0.51 | sec/step~2.13
  step 120/500 | loss_llama=1.6420 | loss_qwen=1.2051 | grad_norm=0.54 | sec/step~2.13
  step 130/500 | loss_llama=2.0428 | loss_qwen=1.5846 | grad_norm=0.51 | sec/step~2.22
  step 140/500 | loss_llama=2.2412 | loss_qwen=1.7701 | grad_norm=0.55 | sec/step~2.24
  step 150/500 | loss_llama=2.0872 | loss_qwen=1.5188 | grad_norm=0.59 | sec/step~2.23
  step 160/500 | loss_llama=2.4105 | loss_qwen=1.9130 | grad_norm=0.63 | sec/step~2.18
  step 170/500 | loss_llama=1.5519 | loss_qwen=1.1680 | grad_norm=0.37 | sec/step~2.15
  step 180/500 | loss_llama=2.0051 | loss_qwen=1.4959 | grad_norm=0.39 | sec/step~2.14
  step 190/500 | loss_llama=1.8609 | loss_qwen=1.5941 | grad_norm=0.43 | sec/step~2.14
  step 200/500 | loss_llama=2.1460 | loss_qwen=1.6457 | grad_norm=0.60 | sec/step~2.13
  step 210/500 | loss_llama=1.9815 | loss_qwen=1.5894 | grad_norm=0.57 | sec/step~2.13
  step 220/500 | loss_llama=1.9439 | loss_qwen=1.5049 | grad_norm=0.48 | sec/step~2.13
  step 230/500 | loss_llama=1.5115 | loss_qwen=1.1493 | grad_norm=0.69 | sec/step~2.14
  step 240/500 | loss_llama=1.8428 | loss_qwen=1.4336 | grad_norm=0.34 | sec/step~2.13
  step 250/500 | loss_llama=2.0770 | loss_qwen=1.6793 | grad_norm=0.43 | sec/step~2.13
  step 260/500 | loss_llama=2.2846 | loss_qwen=1.8190 | grad_norm=0.39 | sec/step~2.13
  step 270/500 | loss_llama=1.7357 | loss_qwen=1.2545 | grad_norm=0.33 | sec/step~2.14
  step 280/500 | loss_llama=2.8285 | loss_qwen=2.2340 | grad_norm=0.41 | sec/step~2.14
  step 290/500 | loss_llama=1.7763 | loss_qwen=1.2646 | grad_norm=0.51 | sec/step~2.14
  step 300/500 | loss_llama=1.9721 | loss_qwen=1.6088 | grad_norm=0.51 | sec/step~2.14
  step 310/500 | loss_llama=1.5942 | loss_qwen=1.2474 | grad_norm=0.37 | sec/step~2.14
  step 320/500 | loss_llama=1.6841 | loss_qwen=1.2028 | grad_norm=0.62 | sec/step~2.14
  step 330/500 | loss_llama=1.9269 | loss_qwen=1.5006 | grad_norm=0.41 | sec/step~2.14
  step 340/500 | loss_llama=1.8080 | loss_qwen=1.3447 | grad_norm=0.45 | sec/step~2.13
  step 350/500 | loss_llama=2.2802 | loss_qwen=1.8821 | grad_norm=0.56 | sec/step~2.13
  step 360/500 | loss_llama=1.8617 | loss_qwen=1.3534 | grad_norm=0.39 | sec/step~2.13
  step 370/500 | loss_llama=1.8741 | loss_qwen=1.4307 | grad_norm=0.57 | sec/step~2.13
  step 380/500 | loss_llama=2.1038 | loss_qwen=1.6541 | grad_norm=0.62 | sec/step~2.13
  step 390/500 | loss_llama=1.8453 | loss_qwen=1.4401 | grad_norm=0.47 | sec/step~2.12
  step 400/500 | loss_llama=1.8551 | loss_qwen=1.5250 | grad_norm=0.57 | sec/step~2.13
  step 410/500 | loss_llama=1.7648 | loss_qwen=1.3543 | grad_norm=0.40 | sec/step~2.12
  step 420/500 | loss_llama=1.7181 | loss_qwen=1.3469 | grad_norm=0.50 | sec/step~2.14
  step 430/500 | loss_llama=2.0833 | loss_qwen=1.6662 | grad_norm=0.48 | sec/step~2.13
  step 440/500 | loss_llama=1.9624 | loss_qwen=1.4257 | grad_norm=0.60 | sec/step~2.13
  step 450/500 | loss_llama=2.1242 | loss_qwen=1.6589 | grad_norm=0.38 | sec/step~2.14
  step 460/500 | loss_llama=1.7596 | loss_qwen=1.4577 | grad_norm=0.41 | sec/step~2.16
  step 470/500 | loss_llama=2.7043 | loss_qwen=2.2054 | grad_norm=0.53 | sec/step~2.14
  step 480/500 | loss_llama=1.8505 | loss_qwen=1.4689 | grad_norm=0.56 | sec/step~2.14
  step 490/500 | loss_llama=2.2484 | loss_qwen=1.8819 | grad_norm=0.48 | sec/step~2.13
  step 500/500 | loss_llama=1.8976 | loss_qwen=1.4599 | grad_norm=0.40 | sec/step~2.13
  ✅ Saved checkpoint at step 3000
Saved encoder/adapters/state to runs/squad_m16_small_20250909_225821/ckpt
