Starting training at Sat Oct 11 12:02:46 PDT 2025

/projects/m000066/sujinesh/LatentWire/.venv/lib/python3.9/site-packages/transformers/utils/hub.py:128: FutureWarning: Using `TRANSFORMERS_CACHE` is deprecated and will be removed in v5 of Transformers. Use `HF_HOME` instead.
  warnings.warn(

Configuration:
  model_id: meta-llama/Meta-Llama-3.1-8B-Instruct
  compress_dim: 512
  compress_method: pca
  input_dim: 4096
  pca_samples: 80000
  adapter_hidden_mult: 4
  adapter_dropout: 0.1
  adapter_lr: 0.0005
  samples: 10000
  epochs: 3
  batch_size: 64
  eval_every: 1
  eval_samples: 500
  save_dir: runs/stage1_adapter_only
  diagnostic_log: runs/stage1_adapter_only/logs/diagnostics.jsonl
============================================================
STAGE 1 PHASE 1: PURE RECONSTRUCTION TRAINING
Model: meta-llama/Meta-Llama-3.1-8B-Instruct
Compression: 4096 → 512 (8.0× compression)
Training samples: 10000
PCA samples: 80000
============================================================

GPU Information:
  CUDA available: Yes
  GPU count: 4
  GPU 0: NVIDIA H100 80GB HBM3 (85.0 GB)
  GPU 1: NVIDIA H100 80GB HBM3 (85.0 GB)
  GPU 2: NVIDIA H100 80GB HBM3 (85.0 GB)
  GPU 3: NVIDIA H100 80GB HBM3 (85.0 GB)

Logging diagnostics to: runs/stage1_adapter_only/logs/diagnostics.jsonl

Loading model...
Downloading shards:   0%|          | 0/4 [00:00<?, ?it/s]Downloading shards: 100%|██████████| 4/4 [00:00<00:00, 3342.74it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:01<00:04,  1.39s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:02<00:02,  1.34s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:03<00:01,  1.17s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:04<00:00,  1.09it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:04<00:00,  1.05s/it]

Creating adapter...
Adapter parameters: 19,952,641

Loading dataset...
Training samples: 10000
Validation samples: 500

Fitting PCA compressor on 80,000 samples...
Collecting embeddings for PCA:   0%|          | 0/80000 [00:00<?, ?it/s]Collecting embeddings for PCA:   0%|          | 1/80000 [00:00<2:35:32,  8.57it/s]Collecting embeddings for PCA:   0%|          | 79/80000 [00:00<03:11, 416.36it/s]Collecting embeddings for PCA:   0%|          | 133/80000 [00:00<02:50, 467.18it/s]Collecting embeddings for PCA:   0%|          | 328/80000 [00:00<01:17, 1025.09it/s]Collecting embeddings for PCA:   1%|          | 539/80000 [00:00<00:56, 1404.73it/s]Collecting embeddings for PCA:   1%|          | 767/80000 [00:00<00:47, 1677.78it/s]Collecting embeddings for PCA:   1%|          | 937/80000 [00:00<00:47, 1669.14it/s]Collecting embeddings for PCA:   1%|▏         | 1176/80000 [00:00<00:41, 1891.20it/s]Collecting embeddings for PCA:   2%|▏         | 1407/80000 [00:00<00:38, 2018.82it/s]Collecting embeddings for PCA:   2%|▏         | 1657/80000 [00:01<00:36, 2164.98it/s]Collecting embeddings for PCA:   2%|▏         | 1894/80000 [00:01<00:35, 2226.28it/s]Collecting embeddings for PCA:   3%|▎         | 2118/80000 [00:01<00:35, 2218.17it/s]Collecting embeddings for PCA:   3%|▎         | 2341/80000 [00:01<00:34, 2221.06it/s]Collecting embeddings for PCA:   3%|▎         | 2564/80000 [00:01<00:43, 1768.73it/s]Collecting embeddings for PCA:   3%|▎         | 2756/80000 [00:01<01:15, 1018.02it/s]Collecting embeddings for PCA:   4%|▎         | 2984/80000 [00:02<01:02, 1232.25it/s]Collecting embeddings for PCA:   4%|▍         | 3204/80000 [00:02<00:54, 1420.77it/s]Collecting embeddings for PCA:   4%|▍         | 3432/80000 [00:02<00:47, 1607.82it/s]Collecting embeddings for PCA:   5%|▍         | 3656/80000 [00:02<00:43, 1757.84it/s]Collecting embeddings for PCA:   5%|▍         | 3891/80000 [00:02<00:39, 1907.05it/s]Collecting embeddings for PCA:   5%|▌         | 4114/80000 [00:02<00:38, 1991.86it/s]Collecting embeddings for PCA:   5%|▌         | 4346/80000 [00:02<00:36, 2070.39it/s]Collecting embeddings for PCA:   6%|▌         | 4567/80000 [00:02<00:38, 1974.30it/s]Collecting embeddings for PCA:   6%|▌         | 4800/80000 [00:02<00:36, 2069.39it/s]Collecting embeddings for PCA:   6%|▋         | 5015/80000 [00:02<00:36, 2039.70it/s]Collecting embeddings for PCA:   7%|▋         | 5225/80000 [00:03<00:49, 1515.42it/s]Collecting embeddings for PCA:   7%|▋         | 5400/80000 [00:03<01:07, 1105.78it/s]Collecting embeddings for PCA:   7%|▋         | 5541/80000 [00:03<01:04, 1157.25it/s]Collecting embeddings for PCA:   7%|▋         | 5760/80000 [00:03<00:54, 1372.93it/s]Collecting embeddings for PCA:   7%|▋         | 5957/80000 [00:03<00:49, 1510.19it/s]Collecting embeddings for PCA:   8%|▊         | 6131/80000 [00:03<00:50, 1456.07it/s]Collecting embeddings for PCA:   8%|▊         | 6293/80000 [00:04<00:50, 1458.12it/s]Collecting embeddings for PCA:   8%|▊         | 6450/80000 [00:04<00:51, 1440.02it/s]Collecting embeddings for PCA:   8%|▊         | 6683/80000 [00:04<00:43, 1671.35it/s]Collecting embeddings for PCA:   9%|▊         | 6908/80000 [00:04<00:39, 1828.60it/s]Collecting embeddings for PCA:   9%|▉         | 7124/80000 [00:04<00:37, 1919.59it/s]Collecting embeddings for PCA:   9%|▉         | 7328/80000 [00:04<00:37, 1929.18it/s]Collecting embeddings for PCA:   9%|▉         | 7526/80000 [00:04<00:44, 1635.01it/s]Collecting embeddings for PCA:  10%|▉         | 7700/80000 [00:05<01:18, 924.19it/s] Collecting embeddings for PCA:  10%|▉         | 7881/80000 [00:05<01:07, 1074.04it/s]Collecting embeddings for PCA:  10%|█         | 8093/80000 [00:05<00:56, 1276.74it/s]Collecting embeddings for PCA:  10%|█         | 8290/80000 [00:05<00:50, 1427.06it/s]Collecting embeddings for PCA:  11%|█         | 8509/80000 [00:05<00:44, 1607.27it/s]Collecting embeddings for PCA:  11%|█         | 8698/80000 [00:05<00:42, 1664.90it/s]Collecting embeddings for PCA:  11%|█         | 8924/80000 [00:05<00:39, 1821.50it/s]Collecting embeddings for PCA:  11%|█▏        | 9151/80000 [00:05<00:36, 1941.43it/s]Collecting embeddings for PCA:  12%|█▏        | 9358/80000 [00:05<00:36, 1952.11it/s]Collecting embeddings for PCA:  12%|█▏        | 9569/80000 [00:06<00:35, 1996.40it/s]Collecting embeddings for PCA:  12%|█▏        | 9776/80000 [00:06<00:35, 1994.63it/s]Collecting embeddings for PCA:  12%|█▏        | 9981/80000 [00:06<00:47, 1462.99it/s]Collecting embeddings for PCA:  13%|█▎        | 10151/80000 [00:06<01:06, 1055.78it/s]Collecting embeddings for PCA:  13%|█▎        | 10338/80000 [00:06<00:57, 1206.65it/s]Collecting embeddings for PCA:  13%|█▎        | 10564/80000 [00:06<00:48, 1427.75it/s]Collecting embeddings for PCA:  13%|█▎        | 10785/80000 [00:06<00:43, 1608.45it/s]Collecting embeddings for PCA:  14%|█▎        | 10989/80000 [00:07<00:40, 1697.30it/s]Collecting embeddings for PCA:  14%|█▍        | 11180/80000 [00:07<00:42, 1635.16it/s]Collecting embeddings for PCA:  14%|█▍        | 11396/80000 [00:07<00:38, 1768.75it/s]Collecting embeddings for PCA:  15%|█▍        | 11610/80000 [00:07<00:36, 1868.05it/s]Collecting embeddings for PCA:  15%|█▍        | 11825/80000 [00:07<00:35, 1945.06it/s]Collecting embeddings for PCA:  15%|█▌        | 12027/80000 [00:07<00:37, 1829.54it/s]Collecting embeddings for PCA:  15%|█▌        | 12244/80000 [00:07<00:35, 1922.11it/s]Collecting embeddings for PCA:  16%|█▌        | 12442/80000 [00:07<00:48, 1398.71it/s]Collecting embeddings for PCA:  16%|█▌        | 12606/80000 [00:08<01:09, 970.82it/s] Collecting embeddings for PCA:  16%|█▌        | 12817/80000 [00:08<00:57, 1171.91it/s]Collecting embeddings for PCA:  16%|█▋        | 13037/80000 [00:08<00:48, 1378.82it/s]Collecting embeddings for PCA:  17%|█▋        | 13247/80000 [00:08<00:43, 1538.28it/s]Collecting embeddings for PCA:  17%|█▋        | 13464/80000 [00:08<00:39, 1689.85it/s]Collecting embeddings for PCA:  17%|█▋        | 13666/80000 [00:08<00:37, 1773.63it/s]Collecting embeddings for PCA:  17%|█▋        | 13876/80000 [00:08<00:35, 1860.77it/s]Collecting embeddings for PCA:  18%|█▊        | 14091/80000 [00:08<00:33, 1938.63it/s]Collecting embeddings for PCA:  18%|█▊        | 14296/80000 [00:09<00:33, 1969.87it/s]Collecting embeddings for PCA:  18%|█▊        | 14501/80000 [00:09<00:35, 1836.17it/s]Collecting embeddings for PCA:  18%|█▊        | 14704/80000 [00:09<00:34, 1873.75it/s]Collecting embeddings for PCA:  19%|█▊        | 14897/80000 [00:09<00:40, 1618.39it/s]Collecting embeddings for PCA:  19%|█▉        | 15069/80000 [00:09<01:05, 990.08it/s] Collecting embeddings for PCA:  19%|█▉        | 15204/80000 [00:09<01:02, 1034.36it/s]Collecting embeddings for PCA:  19%|█▉        | 15419/80000 [00:10<00:51, 1256.26it/s]Collecting embeddings for PCA:  20%|█▉        | 15623/80000 [00:10<00:45, 1429.88it/s]Collecting embeddings for PCA:  20%|█▉        | 15826/80000 [00:10<00:40, 1574.14it/s]Collecting embeddings for PCA:  20%|██        | 16018/80000 [00:10<00:38, 1661.73it/s]Collecting embeddings for PCA:  20%|██        | 16217/80000 [00:10<00:36, 1747.14it/s]Collecting embeddings for PCA:  21%|██        | 16420/80000 [00:10<00:34, 1821.05it/s]Collecting embeddings for PCA:  21%|██        | 16626/80000 [00:10<00:33, 1886.84it/s]Collecting embeddings for PCA:  21%|██        | 16822/80000 [00:10<00:33, 1875.82it/s]Collecting embeddings for PCA:  21%|██▏       | 17033/80000 [00:10<00:32, 1940.73it/s]Collecting embeddings for PCA:  22%|██▏       | 17231/80000 [00:10<00:37, 1671.23it/s]Collecting embeddings for PCA:  22%|██▏       | 17408/80000 [00:11<01:04, 963.70it/s] Collecting embeddings for PCA:  22%|██▏       | 17555/80000 [00:11<00:59, 1051.28it/s]Collecting embeddings for PCA:  22%|██▏       | 17754/80000 [00:11<00:50, 1239.07it/s]Collecting embeddings for PCA:  22%|██▏       | 17962/80000 [00:11<00:43, 1425.95it/s]Collecting embeddings for PCA:  23%|██▎       | 18152/80000 [00:11<00:40, 1539.84it/s]Collecting embeddings for PCA:  23%|██▎       | 18330/80000 [00:11<00:39, 1562.78it/s]Collecting embeddings for PCA:  23%|██▎       | 18531/80000 [00:11<00:36, 1680.24it/s]Collecting embeddings for PCA:  23%|██▎       | 18713/80000 [00:12<00:36, 1674.60it/s]Collecting embeddings for PCA:  24%|██▎       | 18919/80000 [00:12<00:34, 1779.29it/s]Collecting embeddings for PCA:  24%|██▍       | 19107/80000 [00:12<00:33, 1803.18it/s]Collecting embeddings for PCA:  24%|██▍       | 19309/80000 [00:12<00:32, 1863.76it/s]Collecting embeddings for PCA:  24%|██▍       | 19500/80000 [00:12<00:38, 1553.18it/s]Collecting embeddings for PCA:  25%|██▍       | 19667/80000 [00:12<01:05, 925.73it/s] Collecting embeddings for PCA:  25%|██▍       | 19869/80000 [00:13<00:53, 1117.06it/s]Collecting embeddings for PCA:  25%|██▌       | 20081/80000 [00:13<00:45, 1317.47it/s]Collecting embeddings for PCA:  25%|██▌       | 20277/80000 [00:13<00:40, 1460.22it/s]Collecting embeddings for PCA:  26%|██▌       | 20478/80000 [00:13<00:37, 1589.48it/s]Collecting embeddings for PCA:  26%|██▌       | 20662/80000 [00:13<00:37, 1590.19it/s]Collecting embeddings for PCA:  26%|██▌       | 20863/80000 [00:13<00:34, 1699.18it/s]Collecting embeddings for PCA:  26%|██▋       | 21064/80000 [00:13<00:33, 1782.09it/s]Collecting embeddings for PCA:  27%|██▋       | 21271/80000 [00:13<00:31, 1862.30it/s]Collecting embeddings for PCA:  27%|██▋       | 21466/80000 [00:13<00:31, 1845.60it/s]Collecting embeddings for PCA:  27%|██▋       | 21662/80000 [00:13<00:31, 1877.79it/s]Collecting embeddings for PCA:  27%|██▋       | 21854/80000 [00:14<00:37, 1540.46it/s]Collecting embeddings for PCA:  28%|██▊       | 22021/80000 [00:14<01:01, 936.08it/s] Collecting embeddings for PCA:  28%|██▊       | 22185/80000 [00:14<00:54, 1059.74it/s]Collecting embeddings for PCA:  28%|██▊       | 22387/80000 [00:14<00:46, 1252.05it/s]Collecting embeddings for PCA:  28%|██▊       | 22577/80000 [00:14<00:41, 1396.51it/s]Collecting embeddings for PCA:  28%|██▊       | 22775/80000 [00:14<00:37, 1536.47it/s]Collecting embeddings for PCA:  29%|██▊       | 22974/80000 [00:15<00:34, 1651.79it/s]Collecting embeddings for PCA:  29%|██▉       | 23183/80000 [00:15<00:32, 1768.73it/s]Collecting embeddings for PCA:  29%|██▉       | 23384/80000 [00:15<00:30, 1834.08it/s]Collecting embeddings for PCA:  29%|██▉       | 23580/80000 [00:15<00:30, 1868.71it/s]Collecting embeddings for PCA:  30%|██▉       | 23775/80000 [00:15<00:33, 1699.76it/s]Collecting embeddings for PCA:  30%|██▉       | 23975/80000 [00:15<00:31, 1780.61it/s]Collecting embeddings for PCA:  30%|███       | 24160/80000 [00:15<00:35, 1581.38it/s]Collecting embeddings for PCA:  30%|███       | 24327/80000 [00:16<00:59, 928.37it/s] Collecting embeddings for PCA:  31%|███       | 24457/80000 [00:16<00:55, 992.88it/s]Collecting embeddings for PCA:  31%|███       | 24647/80000 [00:16<00:47, 1174.43it/s]Collecting embeddings for PCA:  31%|███       | 24841/80000 [00:16<00:41, 1344.62it/s]Collecting embeddings for PCA:  31%|███▏      | 25043/80000 [00:16<00:36, 1505.94it/s]Collecting embeddings for PCA:  32%|███▏      | 25218/80000 [00:16<00:35, 1564.56it/s]Collecting embeddings for PCA:  32%|███▏      | 25415/80000 [00:16<00:32, 1672.87it/s]Collecting embeddings for PCA:  32%|███▏      | 25599/80000 [00:16<00:31, 1718.61it/s]Collecting embeddings for PCA:  32%|███▏      | 25792/80000 [00:16<00:30, 1777.72it/s]Collecting embeddings for PCA:  32%|███▏      | 25982/80000 [00:17<00:29, 1810.81it/s]Collecting embeddings for PCA:  33%|███▎      | 26186/80000 [00:17<00:28, 1874.91it/s]Collecting embeddings for PCA:  33%|███▎      | 26378/80000 [00:17<00:30, 1737.76it/s]Collecting embeddings for PCA:  33%|███▎      | 26557/80000 [00:17<00:51, 1035.23it/s]Collecting embeddings for PCA:  33%|███▎      | 26698/80000 [00:17<00:56, 951.53it/s] Collecting embeddings for PCA:  34%|███▎      | 26886/80000 [00:17<00:47, 1127.40it/s]Collecting embeddings for PCA:  34%|███▍      | 27081/80000 [00:17<00:40, 1302.32it/s]Collecting embeddings for PCA:  34%|███▍      | 27274/80000 [00:18<00:36, 1448.47it/s]Collecting embeddings for PCA:  34%|███▍      | 27442/80000 [00:18<00:35, 1487.80it/s]Collecting embeddings for PCA:  35%|███▍      | 27628/80000 [00:18<00:33, 1582.51it/s]Collecting embeddings for PCA:  35%|███▍      | 27826/80000 [00:18<00:30, 1689.91it/s]Collecting embeddings for PCA:  35%|███▌      | 28017/80000 [00:18<00:29, 1745.79it/s]Collecting embeddings for PCA:  35%|███▌      | 28200/80000 [00:18<00:29, 1762.78it/s]Collecting embeddings for PCA:  35%|███▌      | 28398/80000 [00:18<00:28, 1823.68it/s]Collecting embeddings for PCA:  36%|███▌      | 28585/80000 [00:18<00:30, 1671.26it/s]Collecting embeddings for PCA:  36%|███▌      | 28758/80000 [00:19<00:50, 1008.03it/s]Collecting embeddings for PCA:  36%|███▌      | 28894/80000 [00:19<00:52, 978.98it/s] Collecting embeddings for PCA:  36%|███▋      | 29084/80000 [00:19<00:43, 1159.96it/s]Collecting embeddings for PCA:  37%|███▋      | 29273/80000 [00:19<00:38, 1320.50it/s]Collecting embeddings for PCA:  37%|███▋      | 29465/80000 [00:19<00:34, 1462.86it/s]Collecting embeddings for PCA:  37%|███▋      | 29653/80000 [00:19<00:32, 1568.93it/s]Collecting embeddings for PCA:  37%|███▋      | 29826/80000 [00:19<00:32, 1563.96it/s]Collecting embeddings for PCA:  38%|███▊      | 30011/80000 [00:19<00:30, 1639.26it/s]Collecting embeddings for PCA:  38%|███▊      | 30211/80000 [00:20<00:28, 1738.43it/s]Collecting embeddings for PCA:  38%|███▊      | 30406/80000 [00:20<00:27, 1797.41it/s]Collecting embeddings for PCA:  38%|███▊      | 30591/80000 [00:20<00:28, 1708.58it/s]Collecting embeddings for PCA:  38%|███▊      | 30767/80000 [00:20<00:29, 1643.43it/s]Collecting embeddings for PCA:  39%|███▊      | 30935/80000 [00:20<00:40, 1197.47it/s]Collecting embeddings for PCA:  39%|███▉      | 31074/80000 [00:20<00:56, 869.78it/s] Collecting embeddings for PCA:  39%|███▉      | 31231/80000 [00:20<00:48, 997.19it/s]Collecting embeddings for PCA:  39%|███▉      | 31412/80000 [00:21<00:41, 1163.91it/s]Collecting embeddings for PCA:  40%|███▉      | 31615/80000 [00:21<00:35, 1360.76it/s]Collecting embeddings for PCA:  40%|███▉      | 31798/80000 [00:21<00:32, 1475.53it/s]Collecting embeddings for PCA:  40%|███▉      | 31992/80000 [00:21<00:30, 1595.74it/s]Collecting embeddings for PCA:  40%|████      | 32181/80000 [00:21<00:28, 1674.75it/s]Collecting embeddings for PCA:  40%|████      | 32370/80000 [00:21<00:27, 1733.24it/s]Collecting embeddings for PCA:  41%|████      | 32566/80000 [00:21<00:26, 1795.04it/s]Collecting embeddings for PCA:  41%|████      | 32752/80000 [00:21<00:27, 1713.95it/s]Collecting embeddings for PCA:  41%|████      | 32936/80000 [00:21<00:26, 1748.03it/s]Collecting embeddings for PCA:  41%|████▏     | 33115/80000 [00:22<00:33, 1399.97it/s]Collecting embeddings for PCA:  42%|████▏     | 33269/80000 [00:22<00:54, 855.42it/s] Collecting embeddings for PCA:  42%|████▏     | 33396/80000 [00:22<00:50, 926.95it/s]Collecting embeddings for PCA:  42%|████▏     | 33600/80000 [00:22<00:40, 1147.09it/s]Collecting embeddings for PCA:  42%|████▏     | 33793/80000 [00:22<00:35, 1318.99it/s]Collecting embeddings for PCA:  42%|████▏     | 33986/80000 [00:22<00:31, 1460.70it/s]Collecting embeddings for PCA:  43%|████▎     | 34156/80000 [00:22<00:30, 1484.01it/s]Collecting embeddings for PCA:  43%|████▎     | 34354/80000 [00:23<00:28, 1611.68it/s]Collecting embeddings for PCA:  43%|████▎     | 34548/80000 [00:23<00:26, 1700.00it/s]Collecting embeddings for PCA:  43%|████▎     | 34735/80000 [00:23<00:25, 1742.22it/s]Collecting embeddings for PCA:  44%|████▎     | 34928/80000 [00:23<00:25, 1757.01it/s]Collecting embeddings for PCA:  44%|████▍     | 35109/80000 [00:23<00:25, 1733.13it/s]Collecting embeddings for PCA:  44%|████▍     | 35286/80000 [00:23<00:30, 1484.99it/s]Collecting embeddings for PCA:  44%|████▍     | 35443/80000 [00:23<00:45, 974.81it/s] Collecting embeddings for PCA:  44%|████▍     | 35568/80000 [00:24<00:48, 925.12it/s]Collecting embeddings for PCA:  45%|████▍     | 35718/80000 [00:24<00:42, 1038.66it/s]Collecting embeddings for PCA:  45%|████▍     | 35886/80000 [00:24<00:37, 1178.46it/s]Collecting embeddings for PCA:  45%|████▌     | 36075/80000 [00:24<00:32, 1348.59it/s]Collecting embeddings for PCA:  45%|████▌     | 36229/80000 [00:24<00:31, 1396.29it/s]Collecting embeddings for PCA:  46%|████▌     | 36414/80000 [00:24<00:28, 1514.79it/s]Collecting embeddings for PCA:  46%|████▌     | 36611/80000 [00:24<00:26, 1637.48it/s]Collecting embeddings for PCA:  46%|████▌     | 36798/80000 [00:24<00:25, 1702.91it/s]Collecting embeddings for PCA:  46%|████▌     | 36975/80000 [00:24<00:25, 1690.18it/s]Collecting embeddings for PCA:  46%|████▋     | 37159/80000 [00:25<00:24, 1728.06it/s]Collecting embeddings for PCA:  47%|████▋     | 37335/80000 [00:25<00:29, 1446.46it/s]Collecting embeddings for PCA:  47%|████▋     | 37490/80000 [00:25<00:33, 1251.78it/s]Collecting embeddings for PCA:  47%|████▋     | 37626/80000 [00:25<00:53, 796.42it/s] Collecting embeddings for PCA:  47%|████▋     | 37777/80000 [00:25<00:45, 920.88it/s]Collecting embeddings for PCA:  47%|████▋     | 37971/80000 [00:25<00:37, 1124.30it/s]Collecting embeddings for PCA:  48%|████▊     | 38150/80000 [00:26<00:32, 1271.15it/s]Collecting embeddings for PCA:  48%|████▊     | 38318/80000 [00:26<00:30, 1368.09it/s]Collecting embeddings for PCA:  48%|████▊     | 38485/80000 [00:26<00:28, 1444.65it/s]Collecting embeddings for PCA:  48%|████▊     | 38668/80000 [00:26<00:26, 1547.63it/s]Collecting embeddings for PCA:  49%|████▊     | 38863/80000 [00:26<00:24, 1654.77it/s]Collecting embeddings for PCA:  49%|████▉     | 39038/80000 [00:26<00:25, 1628.16it/s]Collecting embeddings for PCA:  49%|████▉     | 39226/80000 [00:26<00:24, 1697.66it/s]Collecting embeddings for PCA:  49%|████▉     | 39401/80000 [00:26<00:28, 1408.53it/s]Collecting embeddings for PCA:  49%|████▉     | 39554/80000 [00:27<00:47, 859.25it/s] Collecting embeddings for PCA:  50%|████▉     | 39674/80000 [00:27<00:54, 742.15it/s]Collecting embeddings for PCA:  50%|████▉     | 39834/80000 [00:27<00:49, 810.58it/s]Collecting embeddings for PCA:  50%|████▉     | 39992/80000 [00:27<00:46, 863.33it/s]Collecting embeddings for PCA:  50%|█████     | 40120/80000 [00:27<00:52, 760.54it/s]Collecting embeddings for PCA:  50%|█████     | 40286/80000 [00:28<00:43, 922.04it/s]Collecting embeddings for PCA:  50%|█████     | 40399/80000 [00:28<00:41, 955.77it/s]Collecting embeddings for PCA:  51%|█████     | 40557/80000 [00:28<00:35, 1095.67it/s]Collecting embeddings for PCA:  51%|█████     | 40729/80000 [00:28<00:31, 1246.36it/s]Collecting embeddings for PCA:  51%|█████     | 40879/80000 [00:28<00:30, 1294.35it/s]Collecting embeddings for PCA:  51%|█████▏    | 41019/80000 [00:28<00:42, 925.51it/s] Collecting embeddings for PCA:  51%|█████▏    | 41133/80000 [00:29<01:00, 642.70it/s]Collecting embeddings for PCA:  52%|█████▏    | 41223/80000 [00:29<01:06, 583.49it/s]Collecting embeddings for PCA:  52%|█████▏    | 41405/80000 [00:29<00:48, 789.80it/s]Collecting embeddings for PCA:  52%|█████▏    | 41574/80000 [00:29<00:39, 962.54it/s]Collecting embeddings for PCA:  52%|█████▏    | 41756/80000 [00:29<00:33, 1147.35it/s]Collecting embeddings for PCA:  52%|█████▏    | 41945/80000 [00:29<00:28, 1321.51it/s]Collecting embeddings for PCA:  53%|█████▎    | 42106/80000 [00:29<00:27, 1393.63it/s]Collecting embeddings for PCA:  53%|█████▎    | 42282/80000 [00:29<00:25, 1488.36it/s]Collecting embeddings for PCA:  53%|█████▎    | 42453/80000 [00:29<00:24, 1549.01it/s]Collecting embeddings for PCA:  53%|█████▎    | 42630/80000 [00:30<00:23, 1609.99it/s]Collecting embeddings for PCA:  53%|█████▎    | 42799/80000 [00:30<00:25, 1484.02it/s]Collecting embeddings for PCA:  54%|█████▎    | 42955/80000 [00:30<00:38, 974.28it/s] Collecting embeddings for PCA:  54%|█████▍    | 43080/80000 [00:30<00:45, 812.54it/s]Collecting embeddings for PCA:  54%|█████▍    | 43224/80000 [00:30<00:39, 927.89it/s]Collecting embeddings for PCA:  54%|█████▍    | 43407/80000 [00:30<00:32, 1115.15it/s]Collecting embeddings for PCA:  54%|█████▍    | 43578/80000 [00:31<00:29, 1249.53it/s]Collecting embeddings for PCA:  55%|█████▍    | 43748/80000 [00:31<00:26, 1359.10it/s]Collecting embeddings for PCA:  55%|█████▍    | 43933/80000 [00:31<00:24, 1485.63it/s]Collecting embeddings for PCA:  55%|█████▌    | 44108/80000 [00:31<00:23, 1556.25it/s]Collecting embeddings for PCA:  55%|█████▌    | 44274/80000 [00:31<00:22, 1563.08it/s]Collecting embeddings for PCA:  56%|█████▌    | 44467/80000 [00:31<00:21, 1665.55it/s]Collecting embeddings for PCA:  56%|█████▌    | 44640/80000 [00:31<00:21, 1683.62it/s]Collecting embeddings for PCA:  56%|█████▌    | 44813/80000 [00:31<00:20, 1680.48it/s]Collecting embeddings for PCA:  56%|█████▌    | 44984/80000 [00:31<00:25, 1371.88it/s]Collecting embeddings for PCA:  56%|█████▋    | 45133/80000 [00:32<00:41, 833.78it/s] Collecting embeddings for PCA:  57%|█████▋    | 45249/80000 [00:32<00:40, 868.51it/s]Collecting embeddings for PCA:  57%|█████▋    | 45436/80000 [00:32<00:32, 1065.18it/s]Collecting embeddings for PCA:  57%|█████▋    | 45613/80000 [00:32<00:28, 1219.73it/s]Collecting embeddings for PCA:  57%|█████▋    | 45797/80000 [00:32<00:25, 1360.38it/s]Collecting embeddings for PCA:  57%|█████▋    | 45955/80000 [00:32<00:24, 1415.79it/s]Collecting embeddings for PCA:  58%|█████▊    | 46138/80000 [00:32<00:22, 1525.72it/s]Collecting embeddings for PCA:  58%|█████▊    | 46315/80000 [00:33<00:21, 1592.74it/s]Collecting embeddings for PCA:  58%|█████▊    | 46484/80000 [00:33<00:20, 1603.97it/s]Collecting embeddings for PCA:  58%|█████▊    | 46669/80000 [00:33<00:19, 1669.62it/s]Collecting embeddings for PCA:  59%|█████▊    | 46845/80000 [00:33<00:19, 1692.75it/s]Collecting embeddings for PCA:  59%|█████▉    | 47018/80000 [00:33<00:20, 1627.80it/s]Collecting embeddings for PCA:  59%|█████▉    | 47184/80000 [00:33<00:27, 1176.10it/s]Collecting embeddings for PCA:  59%|█████▉    | 47321/80000 [00:34<00:42, 761.06it/s] Collecting embeddings for PCA:  59%|█████▉    | 47435/80000 [00:34<00:39, 823.21it/s]Collecting embeddings for PCA:  59%|█████▉    | 47584/80000 [00:34<00:34, 951.18it/s]Collecting embeddings for PCA:  60%|█████▉    | 47705/80000 [00:34<00:32, 991.33it/s]Collecting embeddings for PCA:  60%|█████▉    | 47824/80000 [00:34<00:31, 1011.95it/s]Collecting embeddings for PCA:  60%|█████▉    | 47939/80000 [00:34<00:31, 1024.82it/s]Collecting embeddings for PCA:  60%|██████    | 48122/80000 [00:34<00:25, 1229.79it/s]Collecting embeddings for PCA:  60%|██████    | 48262/80000 [00:34<00:24, 1273.51it/s]Collecting embeddings for PCA:  61%|██████    | 48437/80000 [00:34<00:22, 1403.82it/s]Collecting embeddings for PCA:  61%|██████    | 48600/80000 [00:34<00:21, 1467.11it/s]Collecting embeddings for PCA:  61%|██████    | 48759/80000 [00:35<00:20, 1500.93it/s]Collecting embeddings for PCA:  61%|██████    | 48913/80000 [00:35<00:29, 1064.27it/s]Collecting embeddings for PCA:  61%|██████▏   | 49040/80000 [00:35<00:40, 770.35it/s] Collecting embeddings for PCA:  61%|██████▏   | 49164/80000 [00:35<00:36, 855.19it/s]Collecting embeddings for PCA:  62%|██████▏   | 49328/80000 [00:35<00:30, 1016.50it/s]Collecting embeddings for PCA:  62%|██████▏   | 49503/80000 [00:35<00:25, 1183.01it/s]Collecting embeddings for PCA:  62%|██████▏   | 49685/80000 [00:36<00:22, 1338.71it/s]Collecting embeddings for PCA:  62%|██████▏   | 49853/80000 [00:36<00:21, 1427.24it/s]Collecting embeddings for PCA:  63%|██████▎   | 50028/80000 [00:36<00:19, 1514.12it/s]Collecting embeddings for PCA:  63%|██████▎   | 50197/80000 [00:36<00:19, 1562.32it/s]Collecting embeddings for PCA:  63%|██████▎   | 50362/80000 [00:36<00:18, 1569.63it/s]Collecting embeddings for PCA:  63%|██████▎   | 50545/80000 [00:36<00:18, 1619.57it/s]Collecting embeddings for PCA:  63%|██████▎   | 50711/80000 [00:36<00:18, 1572.72it/s]Collecting embeddings for PCA:  64%|██████▎   | 50872/80000 [00:36<00:21, 1373.28it/s]Collecting embeddings for PCA:  64%|██████▍   | 51016/80000 [00:37<00:30, 945.31it/s] Collecting embeddings for PCA:  64%|██████▍   | 51132/80000 [00:37<00:37, 776.56it/s]Collecting embeddings for PCA:  64%|██████▍   | 51303/80000 [00:37<00:31, 925.45it/s]Collecting embeddings for PCA:  64%|██████▍   | 51477/80000 [00:37<00:26, 1091.63it/s]Collecting embeddings for PCA:  65%|██████▍   | 51636/80000 [00:37<00:23, 1198.88it/s]Collecting embeddings for PCA:  65%|██████▍   | 51806/80000 [00:37<00:21, 1318.34it/s]Collecting embeddings for PCA:  65%|██████▍   | 51967/80000 [00:37<00:20, 1392.16it/s]Collecting embeddings for PCA:  65%|██████▌   | 52147/80000 [00:37<00:18, 1500.87it/s]Collecting embeddings for PCA:  65%|██████▌   | 52318/80000 [00:38<00:17, 1550.54it/s]Collecting embeddings for PCA:  66%|██████▌   | 52481/80000 [00:38<00:17, 1562.64it/s]Collecting embeddings for PCA:  66%|██████▌   | 52660/80000 [00:38<00:16, 1627.55it/s]Collecting embeddings for PCA:  66%|██████▌   | 52827/80000 [00:38<00:17, 1596.68it/s]Collecting embeddings for PCA:  66%|██████▌   | 52990/80000 [00:38<00:20, 1296.56it/s]Collecting embeddings for PCA:  66%|██████▋   | 53131/80000 [00:38<00:34, 768.10it/s] Collecting embeddings for PCA:  67%|██████▋   | 53265/80000 [00:39<00:30, 865.63it/s]Collecting embeddings for PCA:  67%|██████▋   | 53442/80000 [00:39<00:25, 1042.46it/s]Collecting embeddings for PCA:  67%|██████▋   | 53617/80000 [00:39<00:22, 1197.10it/s]Collecting embeddings for PCA:  67%|██████▋   | 53771/80000 [00:39<00:20, 1278.49it/s]Collecting embeddings for PCA:  67%|██████▋   | 53947/80000 [00:39<00:18, 1394.69it/s]Collecting embeddings for PCA:  68%|██████▊   | 54113/80000 [00:39<00:17, 1462.90it/s]Collecting embeddings for PCA:  68%|██████▊   | 54293/80000 [00:39<00:16, 1549.70it/s]Collecting embeddings for PCA:  68%|██████▊   | 54458/80000 [00:39<00:16, 1563.84it/s]Collecting embeddings for PCA:  68%|██████▊   | 54632/80000 [00:39<00:15, 1613.30it/s]Collecting embeddings for PCA:  68%|██████▊   | 54799/80000 [00:39<00:15, 1621.89it/s]Collecting embeddings for PCA:  69%|██████▊   | 54965/80000 [00:40<00:19, 1286.17it/s]Collecting embeddings for PCA:  69%|██████▉   | 55107/80000 [00:40<00:32, 775.67it/s] Collecting embeddings for PCA:  69%|██████▉   | 55267/80000 [00:40<00:26, 917.13it/s]Collecting embeddings for PCA:  69%|██████▉   | 55444/80000 [00:40<00:22, 1084.94it/s]Collecting embeddings for PCA:  69%|██████▉   | 55599/80000 [00:40<00:20, 1185.71it/s]Collecting embeddings for PCA:  70%|██████▉   | 55679/80000 [00:40<00:17, 1361.80it/s]
Traceback (most recent call last):
  File "/projects/m000066/sujinesh/LatentWire/train_adapter_only_phase1.py", line 548, in main
    best_f1 = train_adapter_phase1(args)
  File "/projects/m000066/sujinesh/LatentWire/train_adapter_only_phase1.py", line 225, in train_adapter_phase1
    embeds = model.get_input_embeddings()(input_ids)
  File "/projects/m000066/sujinesh/LatentWire/.venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/projects/m000066/sujinesh/LatentWire/.venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/projects/m000066/sujinesh/LatentWire/.venv/lib/python3.9/site-packages/accelerate/hooks.py", line 175, in new_forward
    output = module._old_forward(*args, **kwargs)
  File "/projects/m000066/sujinesh/LatentWire/.venv/lib/python3.9/site-packages/torch/nn/modules/sparse.py", line 164, in forward
    return F.embedding(
  File "/projects/m000066/sujinesh/LatentWire/.venv/lib/python3.9/site-packages/torch/nn/functional.py", line 2267, in embedding
    return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 2.00 MiB. GPU 0 has a total capacity of 79.19 GiB of which 3.00 MiB is free. Including non-PyTorch memory, this process has 79.18 GiB memory in use. Of the allocated memory 77.88 GiB is allocated by PyTorch, and 718.29 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

============================================================
ERROR: Training failed!
============================================================
Error: CUDA out of memory. Tried to allocate 2.00 MiB. GPU 0 has a total capacity of 79.19 GiB of which 3.00 MiB is free. Including non-PyTorch memory, this process has 79.18 GiB memory in use. Of the allocated memory 77.88 GiB is allocated by PyTorch, and 718.29 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
