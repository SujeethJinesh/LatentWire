Starting training at Sat Oct 11 20:04:41 PDT 2025

/projects/m000066/sujinesh/LatentWire/.venv/lib/python3.9/site-packages/transformers/utils/hub.py:128: FutureWarning: Using `TRANSFORMERS_CACHE` is deprecated and will be removed in v5 of Transformers. Use `HF_HOME` instead.
  warnings.warn(

Configuration:
  model_id: meta-llama/Meta-Llama-3.1-8B-Instruct
  compress_dim: 1024
  compress_method: pca
  input_dim: 4096
  pca_samples: 5000
  adapter_hidden_mult: 4
  adapter_dropout: 0.1
  adapter_lr: 0.0005
  samples: 10000
  epochs: 3
  batch_size: 64
  eval_every: 1
  eval_samples: 100
  save_dir: runs/stage1_adapter_only
  diagnostic_log: runs/stage1_adapter_only/logs/diagnostics.jsonl
============================================================
STAGE 1 PHASE 1: PURE RECONSTRUCTION TRAINING
Model: meta-llama/Meta-Llama-3.1-8B-Instruct
Compression: 4096 → 1024 (4.0× compression)
Training samples: 10000
PCA samples: 5000
============================================================

GPU Information:
  CUDA available: Yes
  GPU count: 4
  GPU 0: NVIDIA H100 80GB HBM3 (85.0 GB)
  GPU 1: NVIDIA H100 80GB HBM3 (85.0 GB)
  GPU 2: NVIDIA H100 80GB HBM3 (85.0 GB)
  GPU 3: NVIDIA H100 80GB HBM3 (85.0 GB)

Logging diagnostics to: runs/stage1_adapter_only/logs/diagnostics.jsonl

Loading model...
Downloading shards:   0%|          | 0/4 [00:00<?, ?it/s]Downloading shards: 100%|██████████| 4/4 [00:00<00:00, 3441.48it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:01<00:04,  1.39s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:02<00:02,  1.15s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:03<00:01,  1.22s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:03<00:00,  1.19it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:03<00:00,  1.02it/s]

Creating adapter...
Adapter parameters: 50,374,657

Loading dataset...
Training samples: 10000
Validation samples: 500

Fitting PCA compressor on 5,000 samples...

GPU memory status:
  GPU 0: 80.9 GB free / 85.0 GB total (allocated: 3.3 GB)
  GPU 1: 80.1 GB free / 85.0 GB total (allocated: 4.4 GB)
  GPU 2: 80.1 GB free / 85.0 GB total (allocated: 4.4 GB)
  GPU 3: 80.3 GB free / 85.0 GB total (allocated: 4.1 GB)

Using GPU 0 for PCA (80.9 GB free)
Collecting embeddings...
Collecting embeddings:   0%|          | 0/79 [00:00<?, ?it/s]Collecting embeddings:   3%|▎         | 2/79 [00:00<00:04, 18.28it/s]Collecting embeddings:   9%|▉         | 7/79 [00:00<00:02, 35.26it/s]Collecting embeddings:  16%|█▋        | 13/79 [00:00<00:01, 43.25it/s]Collecting embeddings:  24%|██▍       | 19/79 [00:00<00:01, 46.59it/s]Collecting embeddings:  30%|███       | 24/79 [00:00<00:01, 39.67it/s]Collecting embeddings:  38%|███▊      | 30/79 [00:00<00:01, 43.89it/s]Collecting embeddings:  46%|████▌     | 36/79 [00:00<00:00, 46.58it/s]Collecting embeddings:  53%|█████▎    | 42/79 [00:00<00:00, 48.41it/s]Collecting embeddings:  59%|█████▉    | 47/79 [00:01<00:00, 48.81it/s]Collecting embeddings:  66%|██████▌   | 52/79 [00:01<00:00, 43.70it/s]Collecting embeddings:  72%|███████▏  | 57/79 [00:01<00:00, 31.55it/s]Collecting embeddings:  77%|███████▋  | 61/79 [00:01<00:00, 30.47it/s]Collecting embeddings:  82%|████████▏ | 65/79 [00:01<00:00, 29.34it/s]Collecting embeddings:  89%|████████▊ | 70/79 [00:01<00:00, 32.97it/s]Collecting embeddings:  96%|█████████▌| 76/79 [00:01<00:00, 37.97it/s]Collecting embeddings: 100%|██████████| 79/79 [00:02<00:00, 39.09it/s]
Concatenating 863,997 embedding vectors...
  Fitting PCA on GPU with 863,997 embedding vectors...
  Computing top 1024 components via randomized SVD...
  PCA captured variance (top 1024 components): 100.0%
✓ PCA fitted on 863,997 embedding vectors

============================================================
TRAINING
============================================================

Epoch 1/3:   0%|          | 0/156 [00:00<?, ?it/s]Epoch 1/3:   0%|          | 0/156 [00:00<?, ?it/s, loss=0.9991, cos_sim=0.001]Epoch 1/3:   1%|          | 1/156 [00:00<00:37,  4.10it/s, loss=0.9991, cos_sim=0.001]Epoch 1/3:   1%|          | 1/156 [00:00<00:37,  4.10it/s, loss=0.8805, cos_sim=0.120]Epoch 1/3:   1%|          | 1/156 [00:00<00:37,  4.10it/s, loss=0.7679, cos_sim=0.232]Epoch 1/3:   1%|          | 1/156 [00:00<00:37,  4.10it/s, loss=0.7080, cos_sim=0.293]Epoch 1/3:   3%|▎         | 4/156 [00:00<00:12, 12.10it/s, loss=0.7080, cos_sim=0.293]Epoch 1/3:   3%|▎         | 4/156 [00:00<00:12, 12.10it/s, loss=0.6635, cos_sim=0.336]Epoch 1/3:   3%|▎         | 4/156 [00:00<00:12, 12.10it/s, loss=0.6229, cos_sim=0.377]Epoch 1/3:   3%|▎         | 4/156 [00:00<00:12, 12.10it/s, loss=0.5889, cos_sim=0.412]Epoch 1/3:   4%|▍         | 7/156 [00:00<00:09, 16.47it/s, loss=0.5889, cos_sim=0.412]Epoch 1/3:   4%|▍         | 7/156 [00:00<00:09, 16.47it/s, loss=0.5715, cos_sim=0.430]Epoch 1/3:   4%|▍         | 7/156 [00:00<00:09, 16.47it/s, loss=0.5489, cos_sim=0.451]Epoch 1/3:   4%|▍         | 7/156 [00:00<00:09, 16.47it/s, loss=0.5309, cos_sim=0.469]Epoch 1/3:   6%|▋         | 10/156 [00:00<00:07, 18.88it/s, loss=0.5309, cos_sim=0.469]Epoch 1/3:   6%|▋         | 10/156 [00:00<00:07, 18.88it/s, loss=0.5112, cos_sim=0.490]Epoch 1/3:   6%|▋         | 10/156 [00:00<00:07, 18.88it/s, loss=0.4954, cos_sim=0.504]Epoch 1/3:   6%|▋         | 10/156 [00:00<00:07, 18.88it/s, loss=0.4768, cos_sim=0.523]Epoch 1/3:   8%|▊         | 13/156 [00:00<00:06, 20.72it/s, loss=0.4768, cos_sim=0.523]Epoch 1/3:   8%|▊         | 13/156 [00:00<00:06, 20.72it/s, loss=0.4631, cos_sim=0.539]Epoch 1/3:   8%|▊         | 13/156 [00:00<00:06, 20.72it/s, loss=0.4489, cos_sim=0.551]Epoch 1/3:   8%|▊         | 13/156 [00:00<00:06, 20.72it/s, loss=0.4366, cos_sim=0.562]Epoch 1/3:  10%|█         | 16/156 [00:00<00:06, 21.63it/s, loss=0.4366, cos_sim=0.562]Epoch 1/3:  10%|█         | 16/156 [00:00<00:06, 21.63it/s, loss=0.4230, cos_sim=0.578]Epoch 1/3:  10%|█         | 16/156 [00:00<00:06, 21.63it/s, loss=0.4043, cos_sim=0.598]Epoch 1/3:  10%|█         | 16/156 [00:01<00:06, 21.63it/s, loss=0.4002, cos_sim=0.602]Epoch 1/3:  12%|█▏        | 19/156 [00:01<00:07, 19.42it/s, loss=0.4002, cos_sim=0.602]Epoch 1/3:  12%|█▏        | 19/156 [00:01<00:07, 19.42it/s, loss=0.3878, cos_sim=0.613]Epoch 1/3:  12%|█▏        | 19/156 [00:01<00:07, 19.42it/s, loss=0.3804, cos_sim=0.621]Epoch 1/3:  12%|█▏        | 19/156 [00:01<00:07, 19.42it/s, loss=0.3635, cos_sim=0.637]Epoch 1/3:  14%|█▍        | 22/156 [00:01<00:09, 14.12it/s, loss=0.3635, cos_sim=0.637]Epoch 1/3:  14%|█▍        | 22/156 [00:01<00:09, 14.12it/s, loss=0.3645, cos_sim=0.637]Epoch 1/3:  14%|█▍        | 22/156 [00:01<00:09, 14.12it/s, loss=0.3422, cos_sim=0.660]Epoch 1/3:  15%|█▌        | 24/156 [00:01<00:09, 13.90it/s, loss=0.3422, cos_sim=0.660]Epoch 1/3:  15%|█▌        | 24/156 [00:01<00:09, 13.90it/s, loss=0.3405, cos_sim=0.660]Epoch 1/3:  15%|█▌        | 24/156 [00:01<00:09, 13.90it/s, loss=0.3303, cos_sim=0.672]Epoch 1/3:  15%|█▌        | 24/156 [00:01<00:09, 13.90it/s, loss=0.3194, cos_sim=0.680]Epoch 1/3:  17%|█▋        | 27/156 [00:01<00:08, 15.93it/s, loss=0.3194, cos_sim=0.680]Epoch 1/3:  17%|█▋        | 27/156 [00:01<00:08, 15.93it/s, loss=0.3094, cos_sim=0.691]Epoch 1/3:  17%|█▋        | 27/156 [00:01<00:08, 15.93it/s, loss=0.3014, cos_sim=0.699]Epoch 1/3:  17%|█▋        | 27/156 [00:01<00:08, 15.93it/s, loss=0.2995, cos_sim=0.699]Epoch 1/3:  19%|█▉        | 30/156 [00:01<00:07, 17.72it/s, loss=0.2995, cos_sim=0.699]Epoch 1/3:  19%|█▉        | 30/156 [00:01<00:07, 17.72it/s, loss=0.2890, cos_sim=0.711]Epoch 1/3:  19%|█▉        | 30/156 [00:01<00:07, 17.72it/s, loss=0.2813, cos_sim=0.719]Epoch 1/3:  19%|█▉        | 30/156 [00:01<00:07, 17.72it/s, loss=0.2698, cos_sim=0.730]Epoch 1/3:  21%|██        | 33/156 [00:01<00:06, 19.29it/s, loss=0.2698, cos_sim=0.730]Epoch 1/3:  21%|██        | 33/156 [00:01<00:06, 19.29it/s, loss=0.2644, cos_sim=0.734]Epoch 1/3:  21%|██        | 33/156 [00:02<00:06, 19.29it/s, loss=0.2565, cos_sim=0.742]Epoch 1/3:  21%|██        | 33/156 [00:02<00:06, 19.29it/s, loss=0.2524, cos_sim=0.750]Epoch 1/3:  23%|██▎       | 36/156 [00:02<00:05, 20.52it/s, loss=0.2524, cos_sim=0.750]Epoch 1/3:  23%|██▎       | 36/156 [00:02<00:05, 20.52it/s, loss=0.2492, cos_sim=0.750]Epoch 1/3:  23%|██▎       | 36/156 [00:02<00:05, 20.52it/s, loss=0.2451, cos_sim=0.754]Epoch 1/3:  23%|██▎       | 36/156 [00:02<00:05, 20.52it/s, loss=0.2352, cos_sim=0.766]Epoch 1/3:  25%|██▌       | 39/156 [00:02<00:05, 21.43it/s, loss=0.2352, cos_sim=0.766]Epoch 1/3:  25%|██▌       | 39/156 [00:02<00:05, 21.43it/s, loss=0.2324, cos_sim=0.770]Epoch 1/3:  25%|██▌       | 39/156 [00:02<00:05, 21.43it/s, loss=0.2292, cos_sim=0.770]Epoch 1/3:  25%|██▌       | 39/156 [00:02<00:05, 21.43it/s, loss=0.2241, cos_sim=0.777]Epoch 1/3:  27%|██▋       | 42/156 [00:02<00:05, 22.13it/s, loss=0.2241, cos_sim=0.777]Epoch 1/3:  27%|██▋       | 42/156 [00:02<00:05, 22.13it/s, loss=0.2223, cos_sim=0.777]Epoch 1/3:  27%|██▋       | 42/156 [00:02<00:05, 22.13it/s, loss=0.2159, cos_sim=0.785]Epoch 1/3:  27%|██▋       | 42/156 [00:02<00:05, 22.13it/s, loss=0.2140, cos_sim=0.785]Epoch 1/3:  29%|██▉       | 45/156 [00:02<00:04, 22.82it/s, loss=0.2140, cos_sim=0.785]Epoch 1/3:  29%|██▉       | 45/156 [00:02<00:04, 22.82it/s, loss=0.2047, cos_sim=0.797]Epoch 1/3:  29%|██▉       | 45/156 [00:02<00:04, 22.82it/s, loss=0.2037, cos_sim=0.797]Epoch 1/3:  29%|██▉       | 45/156 [00:02<00:04, 22.82it/s, loss=0.1981, cos_sim=0.801]Epoch 1/3:  31%|███       | 48/156 [00:02<00:04, 23.17it/s, loss=0.1981, cos_sim=0.801]Epoch 1/3:  31%|███       | 48/156 [00:02<00:04, 23.17it/s, loss=0.1993, cos_sim=0.801]Epoch 1/3:  31%|███       | 48/156 [00:02<00:04, 23.17it/s, loss=0.1969, cos_sim=0.805]Epoch 1/3:  31%|███       | 48/156 [00:02<00:04, 23.17it/s, loss=0.1973, cos_sim=0.805]Epoch 1/3:  33%|███▎      | 51/156 [00:02<00:04, 23.43it/s, loss=0.1973, cos_sim=0.805]Epoch 1/3:  33%|███▎      | 51/156 [00:02<00:04, 23.43it/s, loss=0.1886, cos_sim=0.812]Epoch 1/3:  33%|███▎      | 51/156 [00:02<00:04, 23.43it/s, loss=0.1827, cos_sim=0.816]Epoch 1/3:  33%|███▎      | 51/156 [00:02<00:04, 23.43it/s, loss=0.1857, cos_sim=0.816]Epoch 1/3:  35%|███▍      | 54/156 [00:02<00:04, 22.85it/s, loss=0.1857, cos_sim=0.816]Epoch 1/3:  35%|███▍      | 54/156 [00:02<00:04, 22.85it/s, loss=0.1821, cos_sim=0.820]Epoch 1/3:  35%|███▍      | 54/156 [00:02<00:04, 22.85it/s, loss=0.1807, cos_sim=0.820]Epoch 1/3:  35%|███▍      | 54/156 [00:02<00:04, 22.85it/s, loss=0.1744, cos_sim=0.828]Epoch 1/3:  37%|███▋      | 57/156 [00:03<00:05, 18.31it/s, loss=0.1744, cos_sim=0.828]Epoch 1/3:  37%|███▋      | 57/156 [00:03<00:05, 18.31it/s, loss=0.1727, cos_sim=0.828]Epoch 1/3:  37%|███▋      | 57/156 [00:03<00:05, 18.31it/s, loss=0.1666, cos_sim=0.836]Epoch 1/3:  37%|███▋      | 57/156 [00:03<00:05, 18.31it/s, loss=0.1670, cos_sim=0.832]Epoch 1/3:  38%|███▊      | 60/156 [00:03<00:05, 17.37it/s, loss=0.1670, cos_sim=0.832]Epoch 1/3:  38%|███▊      | 60/156 [00:03<00:05, 17.37it/s, loss=0.1658, cos_sim=0.836]Epoch 1/3:  38%|███▊      | 60/156 [00:03<00:05, 17.37it/s, loss=0.1676, cos_sim=0.832]Epoch 1/3:  40%|███▉      | 62/156 [00:03<00:05, 16.17it/s, loss=0.1676, cos_sim=0.832]Epoch 1/3:  40%|███▉      | 62/156 [00:03<00:05, 16.17it/s, loss=0.1640, cos_sim=0.836]Epoch 1/3:  40%|███▉      | 62/156 [00:03<00:05, 16.17it/s, loss=0.1619, cos_sim=0.840]Epoch 1/3:  41%|████      | 64/156 [00:03<00:05, 15.43it/s, loss=0.1619, cos_sim=0.840]Epoch 1/3:  41%|████      | 64/156 [00:03<00:05, 15.43it/s, loss=0.1613, cos_sim=0.840]Epoch 1/3:  41%|████      | 64/156 [00:03<00:05, 15.43it/s, loss=0.1603, cos_sim=0.840]Epoch 1/3:  41%|████      | 64/156 [00:03<00:05, 15.43it/s, loss=0.1585, cos_sim=0.844]Epoch 1/3:  43%|████▎     | 67/156 [00:03<00:05, 17.17it/s, loss=0.1585, cos_sim=0.844]Epoch 1/3:  43%|████▎     | 67/156 [00:03<00:05, 17.17it/s, loss=0.1570, cos_sim=0.844]Epoch 1/3:  43%|████▎     | 67/156 [00:03<00:05, 17.17it/s, loss=0.1554, cos_sim=0.844]Epoch 1/3:  43%|████▎     | 67/156 [00:03<00:05, 17.17it/s, loss=0.1542, cos_sim=0.848]Epoch 1/3:  45%|████▍     | 70/156 [00:03<00:04, 18.83it/s, loss=0.1542, cos_sim=0.848]Epoch 1/3:  45%|████▍     | 70/156 [00:03<00:04, 18.83it/s, loss=0.1514, cos_sim=0.848]Epoch 1/3:  45%|████▍     | 70/156 [00:03<00:04, 18.83it/s, loss=0.1498, cos_sim=0.852]Epoch 1/3:  45%|████▍     | 70/156 [00:03<00:04, 18.83it/s, loss=0.1509, cos_sim=0.852]Epoch 1/3:  47%|████▋     | 73/156 [00:03<00:04, 20.04it/s, loss=0.1509, cos_sim=0.852]Epoch 1/3:  47%|████▋     | 73/156 [00:04<00:04, 20.04it/s, loss=0.1478, cos_sim=0.852]Epoch 1/3:  47%|████▋     | 73/156 [00:04<00:04, 20.04it/s, loss=0.1470, cos_sim=0.855]Epoch 1/3:  47%|████▋     | 73/156 [00:04<00:04, 20.04it/s, loss=0.1453, cos_sim=0.855]Epoch 1/3:  49%|████▊     | 76/156 [00:04<00:03, 21.11it/s, loss=0.1453, cos_sim=0.855]Epoch 1/3:  49%|████▊     | 76/156 [00:04<00:03, 21.11it/s, loss=0.1435, cos_sim=0.855]Epoch 1/3:  49%|████▊     | 76/156 [00:04<00:03, 21.11it/s, loss=0.1434, cos_sim=0.855]Epoch 1/3:  49%|████▊     | 76/156 [00:04<00:03, 21.11it/s, loss=0.1436, cos_sim=0.855]Epoch 1/3:  51%|█████     | 79/156 [00:04<00:03, 21.76it/s, loss=0.1436, cos_sim=0.855]Epoch 1/3:  51%|█████     | 79/156 [00:04<00:03, 21.76it/s, loss=0.1420, cos_sim=0.859]Epoch 1/3:  51%|█████     | 79/156 [00:04<00:03, 21.76it/s, loss=0.1400, cos_sim=0.859]Epoch 1/3:  51%|█████     | 79/156 [00:04<00:03, 21.76it/s, loss=0.1450, cos_sim=0.855]Epoch 1/3:  53%|█████▎    | 82/156 [00:04<00:03, 21.63it/s, loss=0.1450, cos_sim=0.855]Epoch 1/3:  53%|█████▎    | 82/156 [00:04<00:03, 21.63it/s, loss=0.1429, cos_sim=0.859]Epoch 1/3:  53%|█████▎    | 82/156 [00:04<00:03, 21.63it/s, loss=0.1377, cos_sim=0.863]Epoch 1/3:  53%|█████▎    | 82/156 [00:04<00:03, 21.63it/s, loss=0.1428, cos_sim=0.859]Epoch 1/3:  54%|█████▍    | 85/156 [00:04<00:03, 21.84it/s, loss=0.1428, cos_sim=0.859]Epoch 1/3:  54%|█████▍    | 85/156 [00:04<00:03, 21.84it/s, loss=0.1386, cos_sim=0.863]Epoch 1/3:  54%|█████▍    | 85/156 [00:04<00:03, 21.84it/s, loss=0.1410, cos_sim=0.859]Epoch 1/3:  54%|█████▍    | 85/156 [00:04<00:03, 21.84it/s, loss=0.1350, cos_sim=0.867]Epoch 1/3:  56%|█████▋    | 88/156 [00:04<00:03, 22.31it/s, loss=0.1350, cos_sim=0.867]Epoch 1/3:  56%|█████▋    | 88/156 [00:04<00:03, 22.31it/s, loss=0.1373, cos_sim=0.863]Epoch 1/3:  56%|█████▋    | 88/156 [00:04<00:03, 22.31it/s, loss=0.1375, cos_sim=0.863]Epoch 1/3:  56%|█████▋    | 88/156 [00:04<00:03, 22.31it/s, loss=0.1360, cos_sim=0.863]Epoch 1/3:  58%|█████▊    | 91/156 [00:04<00:02, 21.76it/s, loss=0.1360, cos_sim=0.863]Epoch 1/3:  58%|█████▊    | 91/156 [00:04<00:02, 21.76it/s, loss=0.1361, cos_sim=0.863]Epoch 1/3:  58%|█████▊    | 91/156 [00:04<00:02, 21.76it/s, loss=0.1298, cos_sim=0.871]Epoch 1/3:  58%|█████▊    | 91/156 [00:04<00:02, 21.76it/s, loss=0.1310, cos_sim=0.871]Epoch 1/3:  60%|██████    | 94/156 [00:04<00:03, 20.48it/s, loss=0.1310, cos_sim=0.871]Epoch 1/3:  60%|██████    | 94/156 [00:04<00:03, 20.48it/s, loss=0.1327, cos_sim=0.867]Epoch 1/3:  60%|██████    | 94/156 [00:05<00:03, 20.48it/s, loss=0.1324, cos_sim=0.867]Epoch 1/3:  60%|██████    | 94/156 [00:05<00:03, 20.48it/s, loss=0.1321, cos_sim=0.867]Epoch 1/3:  62%|██████▏   | 97/156 [00:05<00:03, 18.26it/s, loss=0.1321, cos_sim=0.867]Epoch 1/3:  62%|██████▏   | 97/156 [00:05<00:03, 18.26it/s, loss=0.1271, cos_sim=0.875]Epoch 1/3:  62%|██████▏   | 97/156 [00:05<00:03, 18.26it/s, loss=0.1309, cos_sim=0.871]Epoch 1/3:  62%|██████▏   | 97/156 [00:05<00:03, 18.26it/s, loss=0.1303, cos_sim=0.871]Starting from v4.46, the `logits` model output will have the same type as the model (except at train time, where it will always be FP32)
Epoch 1/3:  64%|██████▍   | 100/156 [00:06<00:07,  7.84it/s, loss=0.1303, cos_sim=0.871]Epoch 1/3:  64%|██████▍   | 100/156 [00:06<00:07,  7.84it/s, loss=0.1317, cos_sim=0.867]Epoch 1/3:  64%|██████▍   | 100/156 [00:06<00:07,  7.84it/s, loss=0.1278, cos_sim=0.871]Epoch 1/3:  64%|██████▍   | 100/156 [00:06<00:07,  7.84it/s, loss=0.1333, cos_sim=0.867]Epoch 1/3:  66%|██████▌   | 103/156 [00:06<00:05,  9.79it/s, loss=0.1333, cos_sim=0.867]Epoch 1/3:  66%|██████▌   | 103/156 [00:06<00:05,  9.79it/s, loss=0.1273, cos_sim=0.875]Epoch 1/3:  66%|██████▌   | 103/156 [00:06<00:05,  9.79it/s, loss=0.1321, cos_sim=0.867]Epoch 1/3:  66%|██████▌   | 103/156 [00:06<00:05,  9.79it/s, loss=0.1305, cos_sim=0.871]Epoch 1/3:  68%|██████▊   | 106/156 [00:06<00:04, 11.89it/s, loss=0.1305, cos_sim=0.871]Epoch 1/3:  68%|██████▊   | 106/156 [00:06<00:04, 11.89it/s, loss=0.1301, cos_sim=0.871]Epoch 1/3:  68%|██████▊   | 106/156 [00:06<00:04, 11.89it/s, loss=0.1271, cos_sim=0.875]Epoch 1/3:  68%|██████▊   | 106/156 [00:06<00:04, 11.89it/s, loss=0.1281, cos_sim=0.871]Epoch 1/3:  70%|██████▉   | 109/156 [00:06<00:03, 14.00it/s, loss=0.1281, cos_sim=0.871]Epoch 1/3:  70%|██████▉   | 109/156 [00:06<00:03, 14.00it/s, loss=0.1274, cos_sim=0.875]Epoch 1/3:  70%|██████▉   | 109/156 [00:06<00:03, 14.00it/s, loss=0.1223, cos_sim=0.879]Epoch 1/3:  70%|██████▉   | 109/156 [00:06<00:03, 14.00it/s, loss=0.1300, cos_sim=0.871]Epoch 1/3:  72%|███████▏  | 112/156 [00:06<00:02, 15.95it/s, loss=0.1300, cos_sim=0.871]Epoch 1/3:  72%|███████▏  | 112/156 [00:06<00:02, 15.95it/s, loss=0.1310, cos_sim=0.871]Epoch 1/3:  72%|███████▏  | 112/156 [00:06<00:02, 15.95it/s, loss=0.1282, cos_sim=0.871]Epoch 1/3:  72%|███████▏  | 112/156 [00:06<00:02, 15.95it/s, loss=0.1257, cos_sim=0.875]Epoch 1/3:  74%|███████▎  | 115/156 [00:06<00:02, 17.70it/s, loss=0.1257, cos_sim=0.875]Epoch 1/3:  74%|███████▎  | 115/156 [00:06<00:02, 17.70it/s, loss=0.1286, cos_sim=0.871]Epoch 1/3:  74%|███████▎  | 115/156 [00:06<00:02, 17.70it/s, loss=0.1258, cos_sim=0.875]Epoch 1/3:  74%|███████▎  | 115/156 [00:06<00:02, 17.70it/s, loss=0.1255, cos_sim=0.875]Epoch 1/3:  76%|███████▌  | 118/156 [00:06<00:02, 18.64it/s, loss=0.1255, cos_sim=0.875]Epoch 1/3:  76%|███████▌  | 118/156 [00:06<00:02, 18.64it/s, loss=0.1273, cos_sim=0.875]Epoch 1/3:  76%|███████▌  | 118/156 [00:06<00:02, 18.64it/s, loss=0.1220, cos_sim=0.879]Epoch 1/3:  76%|███████▌  | 118/156 [00:06<00:02, 18.64it/s, loss=0.1296, cos_sim=0.871]Epoch 1/3:  78%|███████▊  | 121/156 [00:06<00:01, 18.18it/s, loss=0.1296, cos_sim=0.871]Epoch 1/3:  78%|███████▊  | 121/156 [00:07<00:01, 18.18it/s, loss=0.1272, cos_sim=0.875]Epoch 1/3:  78%|███████▊  | 121/156 [00:07<00:01, 18.18it/s, loss=0.1225, cos_sim=0.879]Epoch 1/3:  78%|███████▊  | 121/156 [00:07<00:01, 18.18it/s, loss=0.1199, cos_sim=0.879]Epoch 1/3:  79%|███████▉  | 124/156 [00:07<00:02, 15.42it/s, loss=0.1199, cos_sim=0.879]Epoch 1/3:  79%|███████▉  | 124/156 [00:07<00:02, 15.42it/s, loss=0.1208, cos_sim=0.879]Epoch 1/3:  79%|███████▉  | 124/156 [00:07<00:02, 15.42it/s, loss=0.1275, cos_sim=0.875]Epoch 1/3:  79%|███████▉  | 124/156 [00:07<00:02, 15.42it/s, loss=0.1180, cos_sim=0.883]Epoch 1/3:  81%|████████▏ | 127/156 [00:07<00:01, 15.50it/s, loss=0.1180, cos_sim=0.883]Epoch 1/3:  81%|████████▏ | 127/156 [00:07<00:01, 15.50it/s, loss=0.1233, cos_sim=0.879]Epoch 1/3:  81%|████████▏ | 127/156 [00:07<00:01, 15.50it/s, loss=0.1231, cos_sim=0.879]Epoch 1/3:  81%|████████▏ | 127/156 [00:07<00:01, 15.50it/s, loss=0.1219, cos_sim=0.879]Epoch 1/3:  83%|████████▎ | 130/156 [00:07<00:01, 15.52it/s, loss=0.1219, cos_sim=0.879]Epoch 1/3:  83%|████████▎ | 130/156 [00:07<00:01, 15.52it/s, loss=0.1215, cos_sim=0.879]Epoch 1/3:  83%|████████▎ | 130/156 [00:07<00:01, 15.52it/s, loss=0.1243, cos_sim=0.875]Epoch 1/3:  83%|████████▎ | 130/156 [00:07<00:01, 15.52it/s, loss=0.1188, cos_sim=0.883]Epoch 1/3:  85%|████████▌ | 133/156 [00:07<00:01, 17.04it/s, loss=0.1188, cos_sim=0.883]Epoch 1/3:  85%|████████▌ | 133/156 [00:07<00:01, 17.04it/s, loss=0.1229, cos_sim=0.879]Epoch 1/3:  85%|████████▌ | 133/156 [00:07<00:01, 17.04it/s, loss=0.1227, cos_sim=0.879]Epoch 1/3:  85%|████████▌ | 133/156 [00:07<00:01, 17.04it/s, loss=0.1241, cos_sim=0.875]Epoch 1/3:  87%|████████▋ | 136/156 [00:07<00:01, 18.69it/s, loss=0.1241, cos_sim=0.875]Epoch 1/3:  87%|████████▋ | 136/156 [00:07<00:01, 18.69it/s, loss=0.1221, cos_sim=0.879]Epoch 1/3:  87%|████████▋ | 136/156 [00:07<00:01, 18.69it/s, loss=0.1214, cos_sim=0.879]Epoch 1/3:  87%|████████▋ | 136/156 [00:08<00:01, 18.69it/s, loss=0.1198, cos_sim=0.883]Epoch 1/3:  89%|████████▉ | 139/156 [00:08<00:00, 19.66it/s, loss=0.1198, cos_sim=0.883]Epoch 1/3:  89%|████████▉ | 139/156 [00:08<00:00, 19.66it/s, loss=0.1212, cos_sim=0.879]Epoch 1/3:  89%|████████▉ | 139/156 [00:08<00:00, 19.66it/s, loss=0.1203, cos_sim=0.879]Epoch 1/3:  89%|████████▉ | 139/156 [00:08<00:00, 19.66it/s, loss=0.1226, cos_sim=0.879]Epoch 1/3:  91%|█████████ | 142/156 [00:08<00:00, 20.70it/s, loss=0.1226, cos_sim=0.879]Epoch 1/3:  91%|█████████ | 142/156 [00:08<00:00, 20.70it/s, loss=0.1180, cos_sim=0.883]Epoch 1/3:  91%|█████████ | 142/156 [00:08<00:00, 20.70it/s, loss=0.1225, cos_sim=0.879]Epoch 1/3:  91%|█████████ | 142/156 [00:08<00:00, 20.70it/s, loss=0.1157, cos_sim=0.887]Epoch 1/3:  93%|█████████▎| 145/156 [00:08<00:00, 21.57it/s, loss=0.1157, cos_sim=0.887]Epoch 1/3:  93%|█████████▎| 145/156 [00:08<00:00, 21.57it/s, loss=0.1150, cos_sim=0.887]Epoch 1/3:  93%|█████████▎| 145/156 [00:08<00:00, 21.57it/s, loss=0.1159, cos_sim=0.887]Epoch 1/3:  93%|█████████▎| 145/156 [00:08<00:00, 21.57it/s, loss=0.1173, cos_sim=0.883]Epoch 1/3:  95%|█████████▍| 148/156 [00:08<00:00, 22.26it/s, loss=0.1173, cos_sim=0.883]Epoch 1/3:  95%|█████████▍| 148/156 [00:08<00:00, 22.26it/s, loss=0.1199, cos_sim=0.883]Epoch 1/3:  95%|█████████▍| 148/156 [00:08<00:00, 22.26it/s, loss=0.1176, cos_sim=0.883]Epoch 1/3:  95%|█████████▍| 148/156 [00:08<00:00, 22.26it/s, loss=0.1180, cos_sim=0.883]Epoch 1/3:  97%|█████████▋| 151/156 [00:08<00:00, 22.63it/s, loss=0.1180, cos_sim=0.883]Epoch 1/3:  97%|█████████▋| 151/156 [00:08<00:00, 22.63it/s, loss=0.1164, cos_sim=0.883]Epoch 1/3:  97%|█████████▋| 151/156 [00:08<00:00, 22.63it/s, loss=0.1221, cos_sim=0.879]Epoch 1/3:  97%|█████████▋| 151/156 [00:08<00:00, 22.63it/s, loss=0.1233, cos_sim=0.879]Epoch 1/3:  99%|█████████▊| 154/156 [00:08<00:00, 23.03it/s, loss=0.1233, cos_sim=0.879]Epoch 1/3:  99%|█████████▊| 154/156 [00:08<00:00, 23.03it/s, loss=0.1170, cos_sim=0.883]Epoch 1/3:  99%|█████████▊| 154/156 [00:08<00:00, 23.03it/s, loss=0.1204, cos_sim=0.879]Epoch 1/3: 100%|██████████| 156/156 [00:08<00:00, 17.86it/s, loss=0.1204, cos_sim=0.879]

  Quick eval (first example):
    Expected: 'Dane'
    Generated: 'the name of Tesla's brother was Dane.'
    Norm ratio: 1.000 | Cosine: 0.809
  Avg norm ratio: 1.000 | Avg cosine: 0.825

  Step 100: Quick F1 = 38.1%

Epoch 1 complete:
  Avg loss: 0.2171
  Avg cosine similarity: 0.784
  Avg relative error: 0.728

Running full evaluation...

================================================================================
EVALUATION DIAGNOSTICS (Batched with size 32)
================================================================================
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:  25%|██▌       | 1/4 [00:00<00:02,  1.05it/s]Evaluating:  50%|█████     | 2/4 [00:01<00:01,  1.21it/s]Evaluating:  75%|███████▌  | 3/4 [00:02<00:00,  1.10it/s]Evaluating: 100%|██████████| 4/4 [00:03<00:00,  1.37it/s]Evaluating: 100%|██████████| 4/4 [00:03<00:00,  1.27it/s]

────────────────────────────────────────────────────────────────────────────────
Example 1:
  Question: Context: Tesla was the fourth of five children. He had an older brother named Da...
  Expected: 'Dane'
  Generated: 'the name of Tesla's brother was Dane.  Dane was killed in a horse-riding accident when'

  Embedding diagnostics:
    Original norm:  0.31
    Reconstructed norm: 0.31
    Ratio: 1.000 (OK)
    Cosine similarity: 0.820

  Token-level reconstruction (first example only):
    Original tokens:  <|begin_of_text|>Context: Tesla was the fourth of five children. He had an older brother named Dane and three sisters, Milka, Angelina and Marica. Dan...
    Reconstructed →:  <|begin_of_text|>Context: Tesla was the fourth of five children. He had an older brother named Dane and three sisters, Milka, Angelina and Marica. Dan...

────────────────────────────────────────────────────────────────────────────────
Example 2:
  Question: Context: Islamists have asked the question, "If Islam is a way of life, how can ...
  Expected: 'Muslims'
  Generated: 'A) Islam
B) Islamism
C) Muslim
D) Muslimism
The'

  Embedding diagnostics:
    Original norm:  0.36
    Reconstructed norm: 0.36
    Ratio: 1.000 (OK)
    Cosine similarity: 0.852

────────────────────────────────────────────────────────────────────────────────
Example 3:
  Question: Context: The concept environmental determinism served as a moral justification f...
  Expected: 'orientalism and tropicality'
  Generated: 'A) Orientalism and tropicality
B) Colonialism and imperialism
C) Racism'

  Embedding diagnostics:
    Original norm:  0.31
    Reconstructed norm: 0.31
    Ratio: 1.000 (OK)
    Cosine similarity: 0.859

================================================================================
  F1: 0.227
  EM: 0.000
  → New best F1! Saved checkpoint
Epoch 2/3:   0%|          | 0/156 [00:00<?, ?it/s]Epoch 2/3:   0%|          | 0/156 [00:00<?, ?it/s, loss=0.1167, cos_sim=0.883]Epoch 2/3:   0%|          | 0/156 [00:00<?, ?it/s, loss=0.1203, cos_sim=0.879]Epoch 2/3:   0%|          | 0/156 [00:00<?, ?it/s, loss=0.1168, cos_sim=0.883]Epoch 2/3:   2%|▏         | 3/156 [00:00<00:07, 21.68it/s, loss=0.1168, cos_sim=0.883]Epoch 2/3:   2%|▏         | 3/156 [00:00<00:07, 21.68it/s, loss=0.1114, cos_sim=0.891]Epoch 2/3:   2%|▏         | 3/156 [00:00<00:07, 21.68it/s, loss=0.1187, cos_sim=0.883]Epoch 2/3:   2%|▏         | 3/156 [00:00<00:07, 21.68it/s, loss=0.1164, cos_sim=0.883]Epoch 2/3:   4%|▍         | 6/156 [00:00<00:07, 21.00it/s, loss=0.1164, cos_sim=0.883]Epoch 2/3:   4%|▍         | 6/156 [00:00<00:07, 21.00it/s, loss=0.1167, cos_sim=0.883]Epoch 2/3:   4%|▍         | 6/156 [00:00<00:07, 21.00it/s, loss=0.1230, cos_sim=0.879]Epoch 2/3:   4%|▍         | 6/156 [00:00<00:07, 21.00it/s, loss=0.1164, cos_sim=0.883]Epoch 2/3:   6%|▌         | 9/156 [00:00<00:09, 15.68it/s, loss=0.1164, cos_sim=0.883]Epoch 2/3:   6%|▌         | 9/156 [00:00<00:09, 15.68it/s, loss=0.1181, cos_sim=0.883]Epoch 2/3:   6%|▌         | 9/156 [00:00<00:09, 15.68it/s, loss=0.1144, cos_sim=0.887]Epoch 2/3:   6%|▌         | 9/156 [00:00<00:09, 15.68it/s, loss=0.1212, cos_sim=0.879]Epoch 2/3:   8%|▊         | 12/156 [00:00<00:09, 15.56it/s, loss=0.1212, cos_sim=0.879]Epoch 2/3:   8%|▊         | 12/156 [00:00<00:09, 15.56it/s, loss=0.1219, cos_sim=0.879]Epoch 2/3:   8%|▊         | 12/156 [00:00<00:09, 15.56it/s, loss=0.1195, cos_sim=0.883]Epoch 2/3:   9%|▉         | 14/156 [00:00<00:09, 14.82it/s, loss=0.1195, cos_sim=0.883]Epoch 2/3:   9%|▉         | 14/156 [00:00<00:09, 14.82it/s, loss=0.1119, cos_sim=0.891]Epoch 2/3:   9%|▉         | 14/156 [00:00<00:09, 14.82it/s, loss=0.1095, cos_sim=0.891]Epoch 2/3:   9%|▉         | 14/156 [00:01<00:09, 14.82it/s, loss=0.1119, cos_sim=0.891]Epoch 2/3:  11%|█         | 17/156 [00:01<00:08, 17.35it/s, loss=0.1119, cos_sim=0.891]Epoch 2/3:  11%|█         | 17/156 [00:01<00:08, 17.35it/s, loss=0.1143, cos_sim=0.887]Epoch 2/3:  11%|█         | 17/156 [00:01<00:08, 17.35it/s, loss=0.1120, cos_sim=0.891]Epoch 2/3:  12%|█▏        | 19/156 [00:01<00:08, 16.07it/s, loss=0.1120, cos_sim=0.891]Epoch 2/3:  12%|█▏        | 19/156 [00:01<00:08, 16.07it/s, loss=0.1118, cos_sim=0.891]Epoch 2/3:  12%|█▏        | 19/156 [00:01<00:08, 16.07it/s, loss=0.1164, cos_sim=0.883]Epoch 2/3:  12%|█▏        | 19/156 [00:01<00:08, 16.07it/s, loss=0.1145, cos_sim=0.887]Epoch 2/3:  14%|█▍        | 22/156 [00:01<00:07, 17.93it/s, loss=0.1145, cos_sim=0.887]Epoch 2/3:  14%|█▍        | 22/156 [00:01<00:07, 17.93it/s, loss=0.1147, cos_sim=0.887]Epoch 2/3:  14%|█▍        | 22/156 [00:01<00:07, 17.93it/s, loss=0.1138, cos_sim=0.887]Epoch 2/3:  14%|█▍        | 22/156 [00:01<00:07, 17.93it/s, loss=0.1147, cos_sim=0.887]Epoch 2/3:  16%|█▌        | 25/156 [00:01<00:06, 19.51it/s, loss=0.1147, cos_sim=0.887]Epoch 2/3:  16%|█▌        | 25/156 [00:01<00:06, 19.51it/s, loss=0.1148, cos_sim=0.887]Epoch 2/3:  16%|█▌        | 25/156 [00:01<00:06, 19.51it/s, loss=0.1178, cos_sim=0.883]Epoch 2/3:  16%|█▌        | 25/156 [00:01<00:06, 19.51it/s, loss=0.1139, cos_sim=0.887]Epoch 2/3:  18%|█▊        | 28/156 [00:01<00:06, 20.67it/s, loss=0.1139, cos_sim=0.887]Epoch 2/3:  18%|█▊        | 28/156 [00:01<00:06, 20.67it/s, loss=0.1117, cos_sim=0.891]Epoch 2/3:  18%|█▊        | 28/156 [00:01<00:06, 20.67it/s, loss=0.1173, cos_sim=0.883]Epoch 2/3:  18%|█▊        | 28/156 [00:01<00:06, 20.67it/s, loss=0.1149, cos_sim=0.887]Epoch 2/3:  20%|█▉        | 31/156 [00:01<00:05, 21.74it/s, loss=0.1149, cos_sim=0.887]Epoch 2/3:  20%|█▉        | 31/156 [00:01<00:05, 21.74it/s, loss=0.1145, cos_sim=0.887]Epoch 2/3:  20%|█▉        | 31/156 [00:01<00:05, 21.74it/s, loss=0.1188, cos_sim=0.883]Epoch 2/3:  20%|█▉        | 31/156 [00:01<00:05, 21.74it/s, loss=0.1163, cos_sim=0.883]Epoch 2/3:  22%|██▏       | 34/156 [00:01<00:05, 22.19it/s, loss=0.1163, cos_sim=0.883]Epoch 2/3:  22%|██▏       | 34/156 [00:01<00:05, 22.19it/s, loss=0.1132, cos_sim=0.887]Epoch 2/3:  22%|██▏       | 34/156 [00:01<00:05, 22.19it/s, loss=0.1160, cos_sim=0.887]Epoch 2/3:  22%|██▏       | 34/156 [00:01<00:05, 22.19it/s, loss=0.1138, cos_sim=0.887]Epoch 2/3:  24%|██▎       | 37/156 [00:01<00:05, 22.55it/s, loss=0.1138, cos_sim=0.887]Epoch 2/3:  24%|██▎       | 37/156 [00:01<00:05, 22.55it/s, loss=0.1141, cos_sim=0.887]Epoch 2/3:  24%|██▎       | 37/156 [00:02<00:05, 22.55it/s, loss=0.1158, cos_sim=0.887]Epoch 2/3:  24%|██▎       | 37/156 [00:02<00:05, 22.55it/s, loss=0.1124, cos_sim=0.887]Epoch 2/3:  26%|██▌       | 40/156 [00:02<00:05, 22.74it/s, loss=0.1124, cos_sim=0.887]Epoch 2/3:  26%|██▌       | 40/156 [00:02<00:05, 22.74it/s, loss=0.1131, cos_sim=0.887]Epoch 2/3:  26%|██▌       | 40/156 [00:02<00:05, 22.74it/s, loss=0.1131, cos_sim=0.887]Epoch 2/3:  26%|██▌       | 40/156 [00:02<00:05, 22.74it/s, loss=0.1084, cos_sim=0.891]Epoch 2/3:  28%|██▊       | 43/156 [00:02<00:04, 22.79it/s, loss=0.1084, cos_sim=0.891]Epoch 2/3:  28%|██▊       | 43/156 [00:02<00:04, 22.79it/s, loss=0.1166, cos_sim=0.883]Epoch 2/3:  28%|██▊       | 43/156 [00:02<00:04, 22.79it/s, loss=0.1186, cos_sim=0.883]Epoch 2/3:  28%|██▊       | 43/156 [00:02<00:04, 22.79it/s, loss=0.1128, cos_sim=0.887]Epoch 2/3:  29%|██▉       | 46/156 [00:02<00:10, 10.06it/s, loss=0.1128, cos_sim=0.887]Epoch 2/3:  29%|██▉       | 46/156 [00:02<00:10, 10.06it/s, loss=0.1143, cos_sim=0.887]Epoch 2/3:  29%|██▉       | 46/156 [00:03<00:10, 10.06it/s, loss=0.1178, cos_sim=0.883]Epoch 2/3:  31%|███       | 48/156 [00:03<00:10, 10.61it/s, loss=0.1178, cos_sim=0.883]Epoch 2/3:  31%|███       | 48/156 [00:03<00:10, 10.61it/s, loss=0.1107, cos_sim=0.891]Epoch 2/3:  31%|███       | 48/156 [00:03<00:10, 10.61it/s, loss=0.1151, cos_sim=0.887]Epoch 2/3:  31%|███       | 48/156 [00:03<00:10, 10.61it/s, loss=0.1142, cos_sim=0.887]Epoch 2/3:  33%|███▎      | 51/156 [00:03<00:08, 12.70it/s, loss=0.1142, cos_sim=0.887]Epoch 2/3:  33%|███▎      | 51/156 [00:03<00:08, 12.70it/s, loss=0.1103, cos_sim=0.891]Epoch 2/3:  33%|███▎      | 51/156 [00:03<00:08, 12.70it/s, loss=0.1123, cos_sim=0.887]Epoch 2/3:  33%|███▎      | 51/156 [00:03<00:08, 12.70it/s, loss=0.1114, cos_sim=0.891]Epoch 2/3:  35%|███▍      | 54/156 [00:03<00:06, 14.92it/s, loss=0.1114, cos_sim=0.891]Epoch 2/3:  35%|███▍      | 54/156 [00:03<00:06, 14.92it/s, loss=0.1110, cos_sim=0.891]Epoch 2/3:  35%|███▍      | 54/156 [00:03<00:06, 14.92it/s, loss=0.1116, cos_sim=0.891]Epoch 2/3:  35%|███▍      | 54/156 [00:03<00:06, 14.92it/s, loss=0.1137, cos_sim=0.887]Epoch 2/3:  37%|███▋      | 57/156 [00:03<00:05, 16.85it/s, loss=0.1137, cos_sim=0.887]Epoch 2/3:  37%|███▋      | 57/156 [00:03<00:05, 16.85it/s, loss=0.1120, cos_sim=0.891]Epoch 2/3:  37%|███▋      | 57/156 [00:03<00:05, 16.85it/s, loss=0.1121, cos_sim=0.891]Epoch 2/3:  37%|███▋      | 57/156 [00:03<00:05, 16.85it/s, loss=0.1106, cos_sim=0.891]Epoch 2/3:  38%|███▊      | 60/156 [00:03<00:05, 18.37it/s, loss=0.1106, cos_sim=0.891]Epoch 2/3:  38%|███▊      | 60/156 [00:03<00:05, 18.37it/s, loss=0.1119, cos_sim=0.891]Epoch 2/3:  38%|███▊      | 60/156 [00:03<00:05, 18.37it/s, loss=0.1104, cos_sim=0.891]Epoch 2/3:  38%|███▊      | 60/156 [00:03<00:05, 18.37it/s, loss=0.1045, cos_sim=0.895]Epoch 2/3:  40%|████      | 63/156 [00:03<00:04, 19.64it/s, loss=0.1045, cos_sim=0.895]Epoch 2/3:  40%|████      | 63/156 [00:03<00:04, 19.64it/s, loss=0.1104, cos_sim=0.891]Epoch 2/3:  40%|████      | 63/156 [00:03<00:04, 19.64it/s, loss=0.1128, cos_sim=0.887]Epoch 2/3:  40%|████      | 63/156 [00:03<00:04, 19.64it/s, loss=0.1107, cos_sim=0.891]Epoch 2/3:  42%|████▏     | 66/156 [00:03<00:04, 20.72it/s, loss=0.1107, cos_sim=0.891]Epoch 2/3:  42%|████▏     | 66/156 [00:03<00:04, 20.72it/s, loss=0.1136, cos_sim=0.887]Epoch 2/3:  42%|████▏     | 66/156 [00:03<00:04, 20.72it/s, loss=0.1151, cos_sim=0.887]Epoch 2/3:  42%|████▏     | 66/156 [00:03<00:04, 20.72it/s, loss=0.1056, cos_sim=0.895]Epoch 2/3:  44%|████▍     | 69/156 [00:03<00:04, 21.55it/s, loss=0.1056, cos_sim=0.895]Epoch 2/3:  44%|████▍     | 69/156 [00:03<00:04, 21.55it/s, loss=0.1102, cos_sim=0.891]Epoch 2/3:  44%|████▍     | 69/156 [00:04<00:04, 21.55it/s, loss=0.1099, cos_sim=0.891]Epoch 2/3:  44%|████▍     | 69/156 [00:04<00:04, 21.55it/s, loss=0.1115, cos_sim=0.891]Epoch 2/3:  46%|████▌     | 72/156 [00:04<00:03, 22.24it/s, loss=0.1115, cos_sim=0.891]Epoch 2/3:  46%|████▌     | 72/156 [00:04<00:03, 22.24it/s, loss=0.1094, cos_sim=0.891]Epoch 2/3:  46%|████▌     | 72/156 [00:04<00:03, 22.24it/s, loss=0.1110, cos_sim=0.891]Epoch 2/3:  46%|████▌     | 72/156 [00:04<00:03, 22.24it/s, loss=0.1096, cos_sim=0.891]Epoch 2/3:  48%|████▊     | 75/156 [00:04<00:03, 22.28it/s, loss=0.1096, cos_sim=0.891]Epoch 2/3:  48%|████▊     | 75/156 [00:04<00:03, 22.28it/s, loss=0.1124, cos_sim=0.887]Epoch 2/3:  48%|████▊     | 75/156 [00:04<00:03, 22.28it/s, loss=0.1106, cos_sim=0.891]Epoch 2/3:  48%|████▊     | 75/156 [00:04<00:03, 22.28it/s, loss=0.1121, cos_sim=0.891]Epoch 2/3:  50%|█████     | 78/156 [00:04<00:03, 20.05it/s, loss=0.1121, cos_sim=0.891]Epoch 2/3:  50%|█████     | 78/156 [00:04<00:03, 20.05it/s, loss=0.1149, cos_sim=0.887]Epoch 2/3:  50%|█████     | 78/156 [00:04<00:03, 20.05it/s, loss=0.1055, cos_sim=0.895]Epoch 2/3:  50%|█████     | 78/156 [00:04<00:03, 20.05it/s, loss=0.1138, cos_sim=0.887]Epoch 2/3:  52%|█████▏    | 81/156 [00:04<00:04, 18.38it/s, loss=0.1138, cos_sim=0.887]Epoch 2/3:  52%|█████▏    | 81/156 [00:04<00:04, 18.38it/s, loss=0.1157, cos_sim=0.887]Epoch 2/3:  52%|█████▏    | 81/156 [00:04<00:04, 18.38it/s, loss=0.1091, cos_sim=0.891]Epoch 2/3:  53%|█████▎    | 83/156 [00:04<00:04, 16.99it/s, loss=0.1091, cos_sim=0.891]Epoch 2/3:  53%|█████▎    | 83/156 [00:04<00:04, 16.99it/s, loss=0.1140, cos_sim=0.887]Epoch 2/3:  53%|█████▎    | 83/156 [00:04<00:04, 16.99it/s, loss=0.1165, cos_sim=0.883]Epoch 2/3:  54%|█████▍    | 85/156 [00:04<00:04, 15.87it/s, loss=0.1165, cos_sim=0.883]Epoch 2/3:  54%|█████▍    | 85/156 [00:04<00:04, 15.87it/s, loss=0.1079, cos_sim=0.895]Epoch 2/3:  54%|█████▍    | 85/156 [00:04<00:04, 15.87it/s, loss=0.1127, cos_sim=0.887]Epoch 2/3:  54%|█████▍    | 85/156 [00:05<00:04, 15.87it/s, loss=0.1118, cos_sim=0.891]Epoch 2/3:  56%|█████▋    | 88/156 [00:05<00:04, 15.71it/s, loss=0.1118, cos_sim=0.891]Epoch 2/3:  56%|█████▋    | 88/156 [00:05<00:04, 15.71it/s, loss=0.1118, cos_sim=0.891]Epoch 2/3:  56%|█████▋    | 88/156 [00:05<00:04, 15.71it/s, loss=0.1077, cos_sim=0.895]Epoch 2/3:  56%|█████▋    | 88/156 [00:05<00:04, 15.71it/s, loss=0.1122, cos_sim=0.891]Epoch 2/3:  58%|█████▊    | 91/156 [00:05<00:03, 17.68it/s, loss=0.1122, cos_sim=0.891]Epoch 2/3:  58%|█████▊    | 91/156 [00:05<00:03, 17.68it/s, loss=0.1091, cos_sim=0.891]Epoch 2/3:  58%|█████▊    | 91/156 [00:05<00:03, 17.68it/s, loss=0.1137, cos_sim=0.887]Epoch 2/3:  58%|█████▊    | 91/156 [00:05<00:03, 17.68it/s, loss=0.1072, cos_sim=0.895]Epoch 2/3:  60%|██████    | 94/156 [00:05<00:03, 18.95it/s, loss=0.1072, cos_sim=0.895]Epoch 2/3:  60%|██████    | 94/156 [00:05<00:03, 18.95it/s, loss=0.1131, cos_sim=0.887]Epoch 2/3:  60%|██████    | 94/156 [00:05<00:03, 18.95it/s, loss=0.1086, cos_sim=0.891]Epoch 2/3:  60%|██████    | 94/156 [00:05<00:03, 18.95it/s, loss=0.1112, cos_sim=0.891]Epoch 2/3:  62%|██████▏   | 97/156 [00:05<00:02, 20.15it/s, loss=0.1112, cos_sim=0.891]Epoch 2/3:  62%|██████▏   | 97/156 [00:05<00:02, 20.15it/s, loss=0.1104, cos_sim=0.891]Epoch 2/3:  62%|██████▏   | 97/156 [00:05<00:02, 20.15it/s, loss=0.1089, cos_sim=0.891]Epoch 2/3:  62%|██████▏   | 97/156 [00:05<00:02, 20.15it/s, loss=0.1097, cos_sim=0.891]Epoch 2/3:  64%|██████▍   | 100/156 [00:05<00:02, 21.32it/s, loss=0.1097, cos_sim=0.891]Epoch 2/3:  64%|██████▍   | 100/156 [00:05<00:02, 21.32it/s, loss=0.1086, cos_sim=0.891]Epoch 2/3:  64%|██████▍   | 100/156 [00:05<00:02, 21.32it/s, loss=0.1048, cos_sim=0.895]Epoch 2/3:  64%|██████▍   | 100/156 [00:05<00:02, 21.32it/s, loss=0.1080, cos_sim=0.895]Epoch 2/3:  66%|██████▌   | 103/156 [00:05<00:02, 22.20it/s, loss=0.1080, cos_sim=0.895]Epoch 2/3:  66%|██████▌   | 103/156 [00:05<00:02, 22.20it/s, loss=0.1066, cos_sim=0.895]Epoch 2/3:  66%|██████▌   | 103/156 [00:05<00:02, 22.20it/s, loss=0.1170, cos_sim=0.883]Epoch 2/3:  66%|██████▌   | 103/156 [00:05<00:02, 22.20it/s, loss=0.1100, cos_sim=0.891]Epoch 2/3:  68%|██████▊   | 106/156 [00:05<00:02, 22.66it/s, loss=0.1100, cos_sim=0.891]Epoch 2/3:  68%|██████▊   | 106/156 [00:05<00:02, 22.66it/s, loss=0.1068, cos_sim=0.895]Epoch 2/3:  68%|██████▊   | 106/156 [00:05<00:02, 22.66it/s, loss=0.1076, cos_sim=0.895]Epoch 2/3:  68%|██████▊   | 106/156 [00:05<00:02, 22.66it/s, loss=0.1088, cos_sim=0.891]Epoch 2/3:  70%|██████▉   | 109/156 [00:05<00:02, 23.00it/s, loss=0.1088, cos_sim=0.891]Epoch 2/3:  70%|██████▉   | 109/156 [00:05<00:02, 23.00it/s, loss=0.1109, cos_sim=0.891]Epoch 2/3:  70%|██████▉   | 109/156 [00:06<00:02, 23.00it/s, loss=0.1145, cos_sim=0.887]Epoch 2/3:  70%|██████▉   | 109/156 [00:06<00:02, 23.00it/s, loss=0.1113, cos_sim=0.891]Epoch 2/3:  72%|███████▏  | 112/156 [00:06<00:01, 23.24it/s, loss=0.1113, cos_sim=0.891]Epoch 2/3:  72%|███████▏  | 112/156 [00:06<00:01, 23.24it/s, loss=0.1057, cos_sim=0.895]Epoch 2/3:  72%|███████▏  | 112/156 [00:06<00:01, 23.24it/s, loss=0.1079, cos_sim=0.895]Epoch 2/3:  72%|███████▏  | 112/156 [00:06<00:01, 23.24it/s, loss=0.1042, cos_sim=0.898]Epoch 2/3:  74%|███████▎  | 115/156 [00:06<00:01, 23.31it/s, loss=0.1042, cos_sim=0.898]Epoch 2/3:  74%|███████▎  | 115/156 [00:06<00:01, 23.31it/s, loss=0.1086, cos_sim=0.891]Epoch 2/3:  74%|███████▎  | 115/156 [00:06<00:01, 23.31it/s, loss=0.1083, cos_sim=0.895]Epoch 2/3:  74%|███████▎  | 115/156 [00:06<00:01, 23.31it/s, loss=0.1059, cos_sim=0.895]Epoch 2/3:  76%|███████▌  | 118/156 [00:06<00:01, 21.51it/s, loss=0.1059, cos_sim=0.895]Epoch 2/3:  76%|███████▌  | 118/156 [00:06<00:01, 21.51it/s, loss=0.1064, cos_sim=0.895]Epoch 2/3:  76%|███████▌  | 118/156 [00:06<00:01, 21.51it/s, loss=0.1080, cos_sim=0.895]Epoch 2/3:  76%|███████▌  | 118/156 [00:06<00:01, 21.51it/s, loss=0.1151, cos_sim=0.887]Epoch 2/3:  78%|███████▊  | 121/156 [00:06<00:01, 18.13it/s, loss=0.1151, cos_sim=0.887]Epoch 2/3:  78%|███████▊  | 121/156 [00:06<00:01, 18.13it/s, loss=0.1098, cos_sim=0.891]Epoch 2/3:  78%|███████▊  | 121/156 [00:06<00:01, 18.13it/s, loss=0.1086, cos_sim=0.891]Epoch 2/3:  79%|███████▉  | 123/156 [00:06<00:01, 16.76it/s, loss=0.1086, cos_sim=0.891]Epoch 2/3:  79%|███████▉  | 123/156 [00:06<00:01, 16.76it/s, loss=0.1058, cos_sim=0.895]Epoch 2/3:  79%|███████▉  | 123/156 [00:06<00:01, 16.76it/s, loss=0.1072, cos_sim=0.895]Epoch 2/3:  80%|████████  | 125/156 [00:06<00:01, 15.71it/s, loss=0.1072, cos_sim=0.895]Epoch 2/3:  80%|████████  | 125/156 [00:06<00:01, 15.71it/s, loss=0.1102, cos_sim=0.891]Epoch 2/3:  80%|████████  | 125/156 [00:06<00:01, 15.71it/s, loss=0.1144, cos_sim=0.887]Epoch 2/3:  80%|████████  | 125/156 [00:07<00:01, 15.71it/s, loss=0.1092, cos_sim=0.891]Epoch 2/3:  82%|████████▏ | 128/156 [00:07<00:01, 15.62it/s, loss=0.1092, cos_sim=0.891]Epoch 2/3:  82%|████████▏ | 128/156 [00:07<00:01, 15.62it/s, loss=0.1105, cos_sim=0.891]Epoch 2/3:  82%|████████▏ | 128/156 [00:07<00:01, 15.62it/s, loss=0.1112, cos_sim=0.891]Epoch 2/3:  82%|████████▏ | 128/156 [00:07<00:01, 15.62it/s, loss=0.1096, cos_sim=0.891]Epoch 2/3:  84%|████████▍ | 131/156 [00:07<00:01, 17.62it/s, loss=0.1096, cos_sim=0.891]Epoch 2/3:  84%|████████▍ | 131/156 [00:07<00:01, 17.62it/s, loss=0.1103, cos_sim=0.891]Epoch 2/3:  84%|████████▍ | 131/156 [00:07<00:01, 17.62it/s, loss=0.1075, cos_sim=0.895]Epoch 2/3:  84%|████████▍ | 131/156 [00:07<00:01, 17.62it/s, loss=0.1081, cos_sim=0.895]Epoch 2/3:  86%|████████▌ | 134/156 [00:07<00:01, 19.19it/s, loss=0.1081, cos_sim=0.895]Epoch 2/3:  86%|████████▌ | 134/156 [00:07<00:01, 19.19it/s, loss=0.1083, cos_sim=0.895]Epoch 2/3:  86%|████████▌ | 134/156 [00:07<00:01, 19.19it/s, loss=0.1056, cos_sim=0.895]Epoch 2/3:  86%|████████▌ | 134/156 [00:07<00:01, 19.19it/s, loss=0.1132, cos_sim=0.887]Epoch 2/3:  88%|████████▊ | 137/156 [00:07<00:00, 20.53it/s, loss=0.1132, cos_sim=0.887]Epoch 2/3:  88%|████████▊ | 137/156 [00:07<00:00, 20.53it/s, loss=0.1107, cos_sim=0.891]Epoch 2/3:  88%|████████▊ | 137/156 [00:07<00:00, 20.53it/s, loss=0.1105, cos_sim=0.891]Epoch 2/3:  88%|████████▊ | 137/156 [00:07<00:00, 20.53it/s, loss=0.1054, cos_sim=0.895]Epoch 2/3:  90%|████████▉ | 140/156 [00:07<00:00, 21.55it/s, loss=0.1054, cos_sim=0.895]Epoch 2/3:  90%|████████▉ | 140/156 [00:07<00:00, 21.55it/s, loss=0.1134, cos_sim=0.887]Epoch 2/3:  90%|████████▉ | 140/156 [00:07<00:00, 21.55it/s, loss=0.1023, cos_sim=0.898]Epoch 2/3:  90%|████████▉ | 140/156 [00:07<00:00, 21.55it/s, loss=0.1039, cos_sim=0.898]Epoch 2/3:  92%|█████████▏| 143/156 [00:07<00:00, 22.23it/s, loss=0.1039, cos_sim=0.898]Epoch 2/3:  92%|█████████▏| 143/156 [00:07<00:00, 22.23it/s, loss=0.1135, cos_sim=0.887]Epoch 2/3:  92%|█████████▏| 143/156 [00:08<00:00, 22.23it/s, loss=0.1103, cos_sim=0.891]Epoch 2/3:  92%|█████████▏| 143/156 [00:08<00:00, 22.23it/s, loss=0.1109, cos_sim=0.891]Epoch 2/3:  94%|█████████▎| 146/156 [00:08<00:00, 13.97it/s, loss=0.1109, cos_sim=0.891]Epoch 2/3:  94%|█████████▎| 146/156 [00:08<00:00, 13.97it/s, loss=0.1130, cos_sim=0.887]Epoch 2/3:  94%|█████████▎| 146/156 [00:08<00:00, 13.97it/s, loss=0.1078, cos_sim=0.895]Epoch 2/3:  94%|█████████▎| 146/156 [00:08<00:00, 13.97it/s, loss=0.1098, cos_sim=0.891]Epoch 2/3:  96%|█████████▌| 149/156 [00:08<00:00, 15.90it/s, loss=0.1098, cos_sim=0.891]Epoch 2/3:  96%|█████████▌| 149/156 [00:08<00:00, 15.90it/s, loss=0.1057, cos_sim=0.895]Epoch 2/3:  96%|█████████▌| 149/156 [00:08<00:00, 15.90it/s, loss=0.1097, cos_sim=0.891]Epoch 2/3:  96%|█████████▌| 149/156 [00:08<00:00, 15.90it/s, loss=0.1067, cos_sim=0.895]Epoch 2/3:  97%|█████████▋| 152/156 [00:08<00:00, 16.77it/s, loss=0.1067, cos_sim=0.895]Epoch 2/3:  97%|█████████▋| 152/156 [00:08<00:00, 16.77it/s, loss=0.1091, cos_sim=0.891]Epoch 2/3:  97%|█████████▋| 152/156 [00:08<00:00, 16.77it/s, loss=0.1092, cos_sim=0.891]Epoch 2/3:  99%|█████████▊| 154/156 [00:08<00:00, 14.85it/s, loss=0.1092, cos_sim=0.891]Epoch 2/3:  99%|█████████▊| 154/156 [00:08<00:00, 14.85it/s, loss=0.1083, cos_sim=0.895]Epoch 2/3:  99%|█████████▊| 154/156 [00:08<00:00, 14.85it/s, loss=0.1090, cos_sim=0.891]Epoch 2/3: 100%|██████████| 156/156 [00:08<00:00, 14.34it/s, loss=0.1090, cos_sim=0.891]Epoch 2/3: 100%|██████████| 156/156 [00:08<00:00, 17.87it/s, loss=0.1090, cos_sim=0.891]

  Quick eval (first example):
    Expected: 'Dane'
    Generated: 'the name of Tesla's brother was Dane.'
    Norm ratio: 1.000 | Cosine: 0.824
  Avg norm ratio: 1.000 | Avg cosine: 0.842

  Step 200: Quick F1 = 28.7%

  Quick eval (first example):
    Expected: 'Dane'
    Generated: 'the name of Tesla's brother was Dane.'
    Norm ratio: 1.000 | Cosine: 0.828
  Avg norm ratio: 1.000 | Avg cosine: 0.848

  Step 300: Quick F1 = 42.9%

Epoch 2 complete:
  Avg loss: 0.1117
  Avg cosine similarity: 0.889
  Avg relative error: 0.567

Running full evaluation...

================================================================================
EVALUATION DIAGNOSTICS (Batched with size 32)
================================================================================
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:  25%|██▌       | 1/4 [00:00<00:02,  1.31it/s]Evaluating:  50%|█████     | 2/4 [00:01<00:01,  1.33it/s]Evaluating:  75%|███████▌  | 3/4 [00:02<00:00,  1.14it/s]Evaluating: 100%|██████████| 4/4 [00:02<00:00,  1.42it/s]Evaluating: 100%|██████████| 4/4 [00:02<00:00,  1.34it/s]

────────────────────────────────────────────────────────────────────────────────
Example 1:
  Question: Context: Tesla was the fourth of five children. He had an older brother named Da...
  Expected: 'Dane'
  Generated: 'the name of Tesla's brother was Dane.  Dane was killed in a horse-riding accident when'

  Embedding diagnostics:
    Original norm:  0.31
    Reconstructed norm: 0.31
    Ratio: 1.000 (OK)
    Cosine similarity: 0.828

  Token-level reconstruction (first example only):
    Original tokens:  <|begin_of_text|>Context: Tesla was the fourth of five children. He had an older brother named Dane and three sisters, Milka, Angelina and Marica. Dan...
    Reconstructed →:  <|begin_of_text|>Context: Tesla was the fourth of five children. He had an older brother named Dane and three sisters, Milka, Angelina and Marica. Dan...

────────────────────────────────────────────────────────────────────────────────
Example 2:
  Question: Context: Islamists have asked the question, "If Islam is a way of life, how can ...
  Expected: 'Muslims'
  Generated: 'A) Islam
B) Islamism
C) Muslim
D) Muslimism
The'

  Embedding diagnostics:
    Original norm:  0.36
    Reconstructed norm: 0.36
    Ratio: 1.000 (OK)
    Cosine similarity: 0.863

────────────────────────────────────────────────────────────────────────────────
Example 3:
  Question: Context: The concept environmental determinism served as a moral justification f...
  Expected: 'orientalism and tropicality'
  Generated: 'A) Orientalism and tropicality
B) Colonialism and imperialism
C) Racism'

  Embedding diagnostics:
    Original norm:  0.31
    Reconstructed norm: 0.31
    Ratio: 1.000 (OK)
    Cosine similarity: 0.867

================================================================================
  F1: 0.241
  EM: 0.000
  → New best F1! Saved checkpoint
Epoch 3/3:   0%|          | 0/156 [00:00<?, ?it/s]Epoch 3/3:   0%|          | 0/156 [00:00<?, ?it/s, loss=0.1079, cos_sim=0.895]Epoch 3/3:   0%|          | 0/156 [00:00<?, ?it/s, loss=0.1081, cos_sim=0.895]Epoch 3/3:   0%|          | 0/156 [00:00<?, ?it/s, loss=0.1111, cos_sim=0.891]Epoch 3/3:   2%|▏         | 3/156 [00:00<00:06, 22.79it/s, loss=0.1111, cos_sim=0.891]Epoch 3/3:   2%|▏         | 3/156 [00:00<00:06, 22.79it/s, loss=0.1075, cos_sim=0.895]Epoch 3/3:   2%|▏         | 3/156 [00:00<00:06, 22.79it/s, loss=0.1107, cos_sim=0.891]Epoch 3/3:   2%|▏         | 3/156 [00:00<00:06, 22.79it/s, loss=0.1073, cos_sim=0.895]Epoch 3/3:   4%|▍         | 6/156 [00:00<00:06, 23.18it/s, loss=0.1073, cos_sim=0.895]Epoch 3/3:   4%|▍         | 6/156 [00:00<00:06, 23.18it/s, loss=0.1056, cos_sim=0.895]Epoch 3/3:   4%|▍         | 6/156 [00:00<00:06, 23.18it/s, loss=0.1099, cos_sim=0.891]Epoch 3/3:   4%|▍         | 6/156 [00:00<00:06, 23.18it/s, loss=0.1085, cos_sim=0.891]Epoch 3/3:   6%|▌         | 9/156 [00:00<00:07, 19.44it/s, loss=0.1085, cos_sim=0.891]Epoch 3/3:   6%|▌         | 9/156 [00:00<00:07, 19.44it/s, loss=0.1060, cos_sim=0.895]Epoch 3/3:   6%|▌         | 9/156 [00:00<00:07, 19.44it/s, loss=0.1069, cos_sim=0.895]Epoch 3/3:   6%|▌         | 9/156 [00:00<00:07, 19.44it/s, loss=0.1044, cos_sim=0.898]Epoch 3/3:   8%|▊         | 12/156 [00:00<00:08, 16.99it/s, loss=0.1044, cos_sim=0.898]Epoch 3/3:   8%|▊         | 12/156 [00:00<00:08, 16.99it/s, loss=0.1060, cos_sim=0.895]Epoch 3/3:   8%|▊         | 12/156 [00:00<00:08, 16.99it/s, loss=0.1052, cos_sim=0.895]Epoch 3/3:   9%|▉         | 14/156 [00:00<00:09, 15.71it/s, loss=0.1052, cos_sim=0.895]Epoch 3/3:   9%|▉         | 14/156 [00:00<00:09, 15.71it/s, loss=0.1049, cos_sim=0.895]Epoch 3/3:   9%|▉         | 14/156 [00:00<00:09, 15.71it/s, loss=0.1064, cos_sim=0.895]Epoch 3/3:   9%|▉         | 14/156 [00:01<00:09, 15.71it/s, loss=0.1074, cos_sim=0.895]Epoch 3/3:  11%|█         | 17/156 [00:01<00:08, 15.62it/s, loss=0.1074, cos_sim=0.895]Epoch 3/3:  11%|█         | 17/156 [00:01<00:08, 15.62it/s, loss=0.1020, cos_sim=0.898]Epoch 3/3:  11%|█         | 17/156 [00:01<00:08, 15.62it/s, loss=0.1057, cos_sim=0.895]Epoch 3/3:  12%|█▏        | 19/156 [00:01<00:09, 14.92it/s, loss=0.1057, cos_sim=0.895]Epoch 3/3:  12%|█▏        | 19/156 [00:01<00:09, 14.92it/s, loss=0.1072, cos_sim=0.895]Epoch 3/3:  12%|█▏        | 19/156 [00:01<00:09, 14.92it/s, loss=0.1055, cos_sim=0.895]Epoch 3/3:  12%|█▏        | 19/156 [00:01<00:09, 14.92it/s, loss=0.1109, cos_sim=0.891]Epoch 3/3:  14%|█▍        | 22/156 [00:01<00:07, 17.12it/s, loss=0.1109, cos_sim=0.891]Epoch 3/3:  14%|█▍        | 22/156 [00:01<00:07, 17.12it/s, loss=0.1101, cos_sim=0.891]Epoch 3/3:  14%|█▍        | 22/156 [00:01<00:07, 17.12it/s, loss=0.1052, cos_sim=0.895]Epoch 3/3:  14%|█▍        | 22/156 [00:01<00:07, 17.12it/s, loss=0.1063, cos_sim=0.895]Epoch 3/3:  16%|█▌        | 25/156 [00:01<00:06, 18.94it/s, loss=0.1063, cos_sim=0.895]Epoch 3/3:  16%|█▌        | 25/156 [00:01<00:06, 18.94it/s, loss=0.1085, cos_sim=0.891]Epoch 3/3:  16%|█▌        | 25/156 [00:01<00:06, 18.94it/s, loss=0.1127, cos_sim=0.887]Epoch 3/3:  16%|█▌        | 25/156 [00:01<00:06, 18.94it/s, loss=0.1041, cos_sim=0.898]Epoch 3/3:  18%|█▊        | 28/156 [00:01<00:06, 20.15it/s, loss=0.1041, cos_sim=0.898]Epoch 3/3:  18%|█▊        | 28/156 [00:01<00:06, 20.15it/s, loss=0.1058, cos_sim=0.895]Epoch 3/3:  18%|█▊        | 28/156 [00:01<00:06, 20.15it/s, loss=0.1038, cos_sim=0.898]Epoch 3/3:  18%|█▊        | 28/156 [00:01<00:06, 20.15it/s, loss=0.1064, cos_sim=0.895]Epoch 3/3:  20%|█▉        | 31/156 [00:01<00:05, 21.23it/s, loss=0.1064, cos_sim=0.895]Epoch 3/3:  20%|█▉        | 31/156 [00:01<00:05, 21.23it/s, loss=0.1087, cos_sim=0.891]Epoch 3/3:  20%|█▉        | 31/156 [00:01<00:05, 21.23it/s, loss=0.1026, cos_sim=0.898]Epoch 3/3:  20%|█▉        | 31/156 [00:01<00:05, 21.23it/s, loss=0.1086, cos_sim=0.891]Epoch 3/3:  22%|██▏       | 34/156 [00:01<00:05, 21.99it/s, loss=0.1086, cos_sim=0.891]Epoch 3/3:  22%|██▏       | 34/156 [00:01<00:05, 21.99it/s, loss=0.1093, cos_sim=0.891]Epoch 3/3:  22%|██▏       | 34/156 [00:01<00:05, 21.99it/s, loss=0.1083, cos_sim=0.895]Epoch 3/3:  22%|██▏       | 34/156 [00:01<00:05, 21.99it/s, loss=0.1072, cos_sim=0.895]Epoch 3/3:  24%|██▎       | 37/156 [00:01<00:05, 22.50it/s, loss=0.1072, cos_sim=0.895]Epoch 3/3:  24%|██▎       | 37/156 [00:01<00:05, 22.50it/s, loss=0.1045, cos_sim=0.895]Epoch 3/3:  24%|██▎       | 37/156 [00:01<00:05, 22.50it/s, loss=0.1038, cos_sim=0.898]Epoch 3/3:  24%|██▎       | 37/156 [00:02<00:05, 22.50it/s, loss=0.1076, cos_sim=0.895]Epoch 3/3:  26%|██▌       | 40/156 [00:02<00:05, 23.02it/s, loss=0.1076, cos_sim=0.895]Epoch 3/3:  26%|██▌       | 40/156 [00:02<00:05, 23.02it/s, loss=0.1094, cos_sim=0.891]Epoch 3/3:  26%|██▌       | 40/156 [00:02<00:05, 23.02it/s, loss=0.1069, cos_sim=0.895]Epoch 3/3:  26%|██▌       | 40/156 [00:02<00:05, 23.02it/s, loss=0.1041, cos_sim=0.898]Epoch 3/3:  28%|██▊       | 43/156 [00:02<00:04, 23.35it/s, loss=0.1041, cos_sim=0.898]Epoch 3/3:  28%|██▊       | 43/156 [00:02<00:04, 23.35it/s, loss=0.1057, cos_sim=0.895]Epoch 3/3:  28%|██▊       | 43/156 [00:02<00:04, 23.35it/s, loss=0.1029, cos_sim=0.898]Epoch 3/3:  28%|██▊       | 43/156 [00:02<00:04, 23.35it/s, loss=0.1069, cos_sim=0.895]Epoch 3/3:  29%|██▉       | 46/156 [00:02<00:04, 23.77it/s, loss=0.1069, cos_sim=0.895]Epoch 3/3:  29%|██▉       | 46/156 [00:02<00:04, 23.77it/s, loss=0.1105, cos_sim=0.891]Epoch 3/3:  29%|██▉       | 46/156 [00:02<00:04, 23.77it/s, loss=0.1111, cos_sim=0.891]Epoch 3/3:  29%|██▉       | 46/156 [00:02<00:04, 23.77it/s, loss=0.1057, cos_sim=0.895]Epoch 3/3:  31%|███▏      | 49/156 [00:02<00:04, 22.11it/s, loss=0.1057, cos_sim=0.895]Epoch 3/3:  31%|███▏      | 49/156 [00:02<00:04, 22.11it/s, loss=0.1054, cos_sim=0.895]Epoch 3/3:  31%|███▏      | 49/156 [00:02<00:04, 22.11it/s, loss=0.1094, cos_sim=0.891]Epoch 3/3:  31%|███▏      | 49/156 [00:02<00:04, 22.11it/s, loss=0.1089, cos_sim=0.891]Epoch 3/3:  33%|███▎      | 52/156 [00:02<00:05, 18.14it/s, loss=0.1089, cos_sim=0.891]Epoch 3/3:  33%|███▎      | 52/156 [00:02<00:05, 18.14it/s, loss=0.1102, cos_sim=0.891]Epoch 3/3:  33%|███▎      | 52/156 [00:02<00:05, 18.14it/s, loss=0.1075, cos_sim=0.895]Epoch 3/3:  33%|███▎      | 52/156 [00:02<00:05, 18.14it/s, loss=0.1089, cos_sim=0.891]Epoch 3/3:  35%|███▌      | 55/156 [00:02<00:05, 17.21it/s, loss=0.1089, cos_sim=0.891]Epoch 3/3:  35%|███▌      | 55/156 [00:02<00:05, 17.21it/s, loss=0.1095, cos_sim=0.891]Epoch 3/3:  35%|███▌      | 55/156 [00:02<00:05, 17.21it/s, loss=0.1092, cos_sim=0.891]Epoch 3/3:  35%|███▌      | 55/156 [00:02<00:05, 17.21it/s, loss=0.1067, cos_sim=0.895]Epoch 3/3:  37%|███▋      | 58/156 [00:03<00:06, 14.92it/s, loss=0.1067, cos_sim=0.895]Epoch 3/3:  37%|███▋      | 58/156 [00:03<00:06, 14.92it/s, loss=0.1132, cos_sim=0.887]Epoch 3/3:  37%|███▋      | 58/156 [00:03<00:06, 14.92it/s, loss=0.1131, cos_sim=0.887]Epoch 3/3:  37%|███▋      | 58/156 [00:03<00:06, 14.92it/s, loss=0.1051, cos_sim=0.895]Epoch 3/3:  39%|███▉      | 61/156 [00:03<00:05, 16.72it/s, loss=0.1051, cos_sim=0.895]Epoch 3/3:  39%|███▉      | 61/156 [00:03<00:05, 16.72it/s, loss=0.1027, cos_sim=0.898]Epoch 3/3:  39%|███▉      | 61/156 [00:03<00:05, 16.72it/s, loss=0.1054, cos_sim=0.895]Epoch 3/3:  39%|███▉      | 61/156 [00:03<00:05, 16.72it/s, loss=0.1076, cos_sim=0.895]Epoch 3/3:  41%|████      | 64/156 [00:03<00:05, 18.28it/s, loss=0.1076, cos_sim=0.895]Epoch 3/3:  41%|████      | 64/156 [00:03<00:05, 18.28it/s, loss=0.1116, cos_sim=0.891]Epoch 3/3:  41%|████      | 64/156 [00:03<00:05, 18.28it/s, loss=0.1041, cos_sim=0.898]Epoch 3/3:  41%|████      | 64/156 [00:03<00:05, 18.28it/s, loss=0.1105, cos_sim=0.891]Epoch 3/3:  43%|████▎     | 67/156 [00:03<00:04, 19.58it/s, loss=0.1105, cos_sim=0.891]Epoch 3/3:  43%|████▎     | 67/156 [00:03<00:04, 19.58it/s, loss=0.1043, cos_sim=0.898]Epoch 3/3:  43%|████▎     | 67/156 [00:03<00:04, 19.58it/s, loss=0.1084, cos_sim=0.891]Epoch 3/3:  43%|████▎     | 67/156 [00:03<00:04, 19.58it/s, loss=0.1071, cos_sim=0.895]Epoch 3/3:  45%|████▍     | 70/156 [00:03<00:04, 20.57it/s, loss=0.1071, cos_sim=0.895]Epoch 3/3:  45%|████▍     | 70/156 [00:03<00:04, 20.57it/s, loss=0.1065, cos_sim=0.895]Epoch 3/3:  45%|████▍     | 70/156 [00:03<00:04, 20.57it/s, loss=0.1102, cos_sim=0.891]Epoch 3/3:  45%|████▍     | 70/156 [00:03<00:04, 20.57it/s, loss=0.1102, cos_sim=0.891]Epoch 3/3:  47%|████▋     | 73/156 [00:03<00:03, 21.47it/s, loss=0.1102, cos_sim=0.891]Epoch 3/3:  47%|████▋     | 73/156 [00:03<00:03, 21.47it/s, loss=0.1059, cos_sim=0.895]Epoch 3/3:  47%|████▋     | 73/156 [00:03<00:03, 21.47it/s, loss=0.1121, cos_sim=0.891]Epoch 3/3:  47%|████▋     | 73/156 [00:03<00:03, 21.47it/s, loss=0.1044, cos_sim=0.898]Epoch 3/3:  49%|████▊     | 76/156 [00:03<00:03, 22.23it/s, loss=0.1044, cos_sim=0.898]Epoch 3/3:  49%|████▊     | 76/156 [00:03<00:03, 22.23it/s, loss=0.1064, cos_sim=0.895]Epoch 3/3:  49%|████▊     | 76/156 [00:03<00:03, 22.23it/s, loss=0.1069, cos_sim=0.895]Epoch 3/3:  49%|████▊     | 76/156 [00:04<00:03, 22.23it/s, loss=0.1074, cos_sim=0.895]Epoch 3/3:  51%|█████     | 79/156 [00:04<00:03, 22.73it/s, loss=0.1074, cos_sim=0.895]Epoch 3/3:  51%|█████     | 79/156 [00:04<00:03, 22.73it/s, loss=0.1092, cos_sim=0.891]Epoch 3/3:  51%|█████     | 79/156 [00:04<00:03, 22.73it/s, loss=0.1080, cos_sim=0.895]Epoch 3/3:  51%|█████     | 79/156 [00:04<00:03, 22.73it/s, loss=0.1060, cos_sim=0.895]Epoch 3/3:  53%|█████▎    | 82/156 [00:04<00:03, 23.09it/s, loss=0.1060, cos_sim=0.895]Epoch 3/3:  53%|█████▎    | 82/156 [00:04<00:03, 23.09it/s, loss=0.1103, cos_sim=0.891]Epoch 3/3:  53%|█████▎    | 82/156 [00:04<00:03, 23.09it/s, loss=0.1105, cos_sim=0.891]Epoch 3/3:  53%|█████▎    | 82/156 [00:04<00:03, 23.09it/s, loss=0.1112, cos_sim=0.891]Epoch 3/3:  54%|█████▍    | 85/156 [00:04<00:03, 23.29it/s, loss=0.1112, cos_sim=0.891]Epoch 3/3:  54%|█████▍    | 85/156 [00:04<00:03, 23.29it/s, loss=0.1050, cos_sim=0.895]Epoch 3/3:  54%|█████▍    | 85/156 [00:04<00:03, 23.29it/s, loss=0.1089, cos_sim=0.891]Epoch 3/3:  54%|█████▍    | 85/156 [00:04<00:03, 23.29it/s, loss=0.1132, cos_sim=0.887]Epoch 3/3:  56%|█████▋    | 88/156 [00:05<00:07,  9.26it/s, loss=0.1132, cos_sim=0.887]Epoch 3/3:  56%|█████▋    | 88/156 [00:05<00:07,  9.26it/s, loss=0.1081, cos_sim=0.895]Epoch 3/3:  56%|█████▋    | 88/156 [00:05<00:07,  9.26it/s, loss=0.1068, cos_sim=0.895]Epoch 3/3:  56%|█████▋    | 88/156 [00:05<00:07,  9.26it/s, loss=0.1114, cos_sim=0.891]Epoch 3/3:  58%|█████▊    | 91/156 [00:05<00:05, 11.28it/s, loss=0.1114, cos_sim=0.891]Epoch 3/3:  58%|█████▊    | 91/156 [00:05<00:05, 11.28it/s, loss=0.1031, cos_sim=0.898]Epoch 3/3:  58%|█████▊    | 91/156 [00:05<00:05, 11.28it/s, loss=0.1070, cos_sim=0.895]Epoch 3/3:  58%|█████▊    | 91/156 [00:05<00:05, 11.28it/s, loss=0.1070, cos_sim=0.895]Epoch 3/3:  60%|██████    | 94/156 [00:05<00:04, 13.23it/s, loss=0.1070, cos_sim=0.895]Epoch 3/3:  60%|██████    | 94/156 [00:05<00:04, 13.23it/s, loss=0.1069, cos_sim=0.895]Epoch 3/3:  60%|██████    | 94/156 [00:05<00:04, 13.23it/s, loss=0.1055, cos_sim=0.895]Epoch 3/3:  60%|██████    | 94/156 [00:05<00:04, 13.23it/s, loss=0.1025, cos_sim=0.898]Epoch 3/3:  62%|██████▏   | 97/156 [00:05<00:03, 15.27it/s, loss=0.1025, cos_sim=0.898]Epoch 3/3:  62%|██████▏   | 97/156 [00:05<00:03, 15.27it/s, loss=0.1053, cos_sim=0.895]Epoch 3/3:  62%|██████▏   | 97/156 [00:05<00:03, 15.27it/s, loss=0.1039, cos_sim=0.898]Epoch 3/3:  62%|██████▏   | 97/156 [00:05<00:03, 15.27it/s, loss=0.1079, cos_sim=0.895]Epoch 3/3:  64%|██████▍   | 100/156 [00:05<00:03, 17.10it/s, loss=0.1079, cos_sim=0.895]Epoch 3/3:  64%|██████▍   | 100/156 [00:05<00:03, 17.10it/s, loss=0.1044, cos_sim=0.898]Epoch 3/3:  64%|██████▍   | 100/156 [00:05<00:03, 17.10it/s, loss=0.1109, cos_sim=0.891]Epoch 3/3:  64%|██████▍   | 100/156 [00:05<00:03, 17.10it/s, loss=0.1101, cos_sim=0.891]Epoch 3/3:  66%|██████▌   | 103/156 [00:05<00:02, 18.67it/s, loss=0.1101, cos_sim=0.891]Epoch 3/3:  66%|██████▌   | 103/156 [00:05<00:02, 18.67it/s, loss=0.1040, cos_sim=0.898]Epoch 3/3:  66%|██████▌   | 103/156 [00:05<00:02, 18.67it/s, loss=0.1054, cos_sim=0.895]Epoch 3/3:  66%|██████▌   | 103/156 [00:05<00:02, 18.67it/s, loss=0.1087, cos_sim=0.891]Epoch 3/3:  68%|██████▊   | 106/156 [00:05<00:02, 19.99it/s, loss=0.1087, cos_sim=0.891]Epoch 3/3:  68%|██████▊   | 106/156 [00:05<00:02, 19.99it/s, loss=0.1028, cos_sim=0.898]Epoch 3/3:  68%|██████▊   | 106/156 [00:05<00:02, 19.99it/s, loss=0.1059, cos_sim=0.895]Epoch 3/3:  68%|██████▊   | 106/156 [00:05<00:02, 19.99it/s, loss=0.1097, cos_sim=0.891]Epoch 3/3:  70%|██████▉   | 109/156 [00:05<00:02, 20.95it/s, loss=0.1097, cos_sim=0.891]Epoch 3/3:  70%|██████▉   | 109/156 [00:05<00:02, 20.95it/s, loss=0.1058, cos_sim=0.895]Epoch 3/3:  70%|██████▉   | 109/156 [00:06<00:02, 20.95it/s, loss=0.1029, cos_sim=0.898]Epoch 3/3:  70%|██████▉   | 109/156 [00:06<00:02, 20.95it/s, loss=0.1075, cos_sim=0.895]Epoch 3/3:  72%|███████▏  | 112/156 [00:06<00:02, 21.75it/s, loss=0.1075, cos_sim=0.895]Epoch 3/3:  72%|███████▏  | 112/156 [00:06<00:02, 21.75it/s, loss=0.1085, cos_sim=0.891]Epoch 3/3:  72%|███████▏  | 112/156 [00:06<00:02, 21.75it/s, loss=0.1089, cos_sim=0.891]Epoch 3/3:  72%|███████▏  | 112/156 [00:06<00:02, 21.75it/s, loss=0.1070, cos_sim=0.895]Epoch 3/3:  74%|███████▎  | 115/156 [00:06<00:01, 22.24it/s, loss=0.1070, cos_sim=0.895]Epoch 3/3:  74%|███████▎  | 115/156 [00:06<00:01, 22.24it/s, loss=0.1084, cos_sim=0.891]Epoch 3/3:  74%|███████▎  | 115/156 [00:06<00:01, 22.24it/s, loss=0.1068, cos_sim=0.895]Epoch 3/3:  74%|███████▎  | 115/156 [00:06<00:01, 22.24it/s, loss=0.1060, cos_sim=0.895]Epoch 3/3:  76%|███████▌  | 118/156 [00:06<00:01, 20.75it/s, loss=0.1060, cos_sim=0.895]Epoch 3/3:  76%|███████▌  | 118/156 [00:06<00:01, 20.75it/s, loss=0.1102, cos_sim=0.891]Epoch 3/3:  76%|███████▌  | 118/156 [00:06<00:01, 20.75it/s, loss=0.1086, cos_sim=0.891]Epoch 3/3:  76%|███████▌  | 118/156 [00:06<00:01, 20.75it/s, loss=0.1080, cos_sim=0.895]Epoch 3/3:  78%|███████▊  | 121/156 [00:06<00:01, 17.75it/s, loss=0.1080, cos_sim=0.895]Epoch 3/3:  78%|███████▊  | 121/156 [00:06<00:01, 17.75it/s, loss=0.1068, cos_sim=0.895]Epoch 3/3:  78%|███████▊  | 121/156 [00:06<00:01, 17.75it/s, loss=0.1085, cos_sim=0.891]Epoch 3/3:  79%|███████▉  | 123/156 [00:06<00:01, 16.51it/s, loss=0.1085, cos_sim=0.891]Epoch 3/3:  79%|███████▉  | 123/156 [00:06<00:01, 16.51it/s, loss=0.1068, cos_sim=0.895]Epoch 3/3:  79%|███████▉  | 123/156 [00:06<00:01, 16.51it/s, loss=0.1070, cos_sim=0.895]Epoch 3/3:  79%|███████▉  | 123/156 [00:06<00:01, 16.51it/s, loss=0.1072, cos_sim=0.895]Epoch 3/3:  81%|████████  | 126/156 [00:06<00:01, 18.16it/s, loss=0.1072, cos_sim=0.895]Epoch 3/3:  81%|████████  | 126/156 [00:06<00:01, 18.16it/s, loss=0.1056, cos_sim=0.895]Epoch 3/3:  81%|████████  | 126/156 [00:07<00:01, 18.16it/s, loss=0.1066, cos_sim=0.895]Epoch 3/3:  82%|████████▏ | 128/156 [00:07<00:01, 14.54it/s, loss=0.1066, cos_sim=0.895]Epoch 3/3:  82%|████████▏ | 128/156 [00:07<00:01, 14.54it/s, loss=0.1080, cos_sim=0.895]Epoch 3/3:  82%|████████▏ | 128/156 [00:07<00:01, 14.54it/s, loss=0.1060, cos_sim=0.895]Epoch 3/3:  83%|████████▎ | 130/156 [00:07<00:01, 15.57it/s, loss=0.1060, cos_sim=0.895]Epoch 3/3:  83%|████████▎ | 130/156 [00:07<00:01, 15.57it/s, loss=0.1096, cos_sim=0.891]Epoch 3/3:  83%|████████▎ | 130/156 [00:07<00:01, 15.57it/s, loss=0.1035, cos_sim=0.898]Epoch 3/3:  83%|████████▎ | 130/156 [00:07<00:01, 15.57it/s, loss=0.1114, cos_sim=0.891]Epoch 3/3:  85%|████████▌ | 133/156 [00:07<00:01, 17.75it/s, loss=0.1114, cos_sim=0.891]Epoch 3/3:  85%|████████▌ | 133/156 [00:07<00:01, 17.75it/s, loss=0.1115, cos_sim=0.891]Epoch 3/3:  85%|████████▌ | 133/156 [00:07<00:01, 17.75it/s, loss=0.1053, cos_sim=0.895]Epoch 3/3:  85%|████████▌ | 133/156 [00:07<00:01, 17.75it/s, loss=0.1025, cos_sim=0.898]Epoch 3/3:  87%|████████▋ | 136/156 [00:07<00:01, 19.38it/s, loss=0.1025, cos_sim=0.898]Epoch 3/3:  87%|████████▋ | 136/156 [00:07<00:01, 19.38it/s, loss=0.1045, cos_sim=0.895]Epoch 3/3:  87%|████████▋ | 136/156 [00:07<00:01, 19.38it/s, loss=0.1073, cos_sim=0.895]Epoch 3/3:  87%|████████▋ | 136/156 [00:07<00:01, 19.38it/s, loss=0.1058, cos_sim=0.895]Epoch 3/3:  89%|████████▉ | 139/156 [00:07<00:00, 20.61it/s, loss=0.1058, cos_sim=0.895]Epoch 3/3:  89%|████████▉ | 139/156 [00:07<00:00, 20.61it/s, loss=0.1094, cos_sim=0.891]Epoch 3/3:  89%|████████▉ | 139/156 [00:07<00:00, 20.61it/s, loss=0.1065, cos_sim=0.895]Epoch 3/3:  89%|████████▉ | 139/156 [00:07<00:00, 20.61it/s, loss=0.1069, cos_sim=0.895]Epoch 3/3:  91%|█████████ | 142/156 [00:07<00:00, 21.51it/s, loss=0.1069, cos_sim=0.895]Epoch 3/3:  91%|█████████ | 142/156 [00:07<00:00, 21.51it/s, loss=0.1038, cos_sim=0.898]Epoch 3/3:  91%|█████████ | 142/156 [00:07<00:00, 21.51it/s, loss=0.1048, cos_sim=0.895]Epoch 3/3:  91%|█████████ | 142/156 [00:07<00:00, 21.51it/s, loss=0.1137, cos_sim=0.887]Epoch 3/3:  93%|█████████▎| 145/156 [00:07<00:00, 22.19it/s, loss=0.1137, cos_sim=0.887]Epoch 3/3:  93%|█████████▎| 145/156 [00:07<00:00, 22.19it/s, loss=0.1056, cos_sim=0.895]Epoch 3/3:  93%|█████████▎| 145/156 [00:07<00:00, 22.19it/s, loss=0.1097, cos_sim=0.891]Epoch 3/3:  93%|█████████▎| 145/156 [00:07<00:00, 22.19it/s, loss=0.1109, cos_sim=0.891]Epoch 3/3:  95%|█████████▍| 148/156 [00:07<00:00, 22.57it/s, loss=0.1109, cos_sim=0.891]Epoch 3/3:  95%|█████████▍| 148/156 [00:08<00:00, 22.57it/s, loss=0.1058, cos_sim=0.895]Epoch 3/3:  95%|█████████▍| 148/156 [00:08<00:00, 22.57it/s, loss=0.1064, cos_sim=0.895]Epoch 3/3:  95%|█████████▍| 148/156 [00:08<00:00, 22.57it/s, loss=0.1058, cos_sim=0.895]Epoch 3/3:  97%|█████████▋| 151/156 [00:08<00:00, 23.04it/s, loss=0.1058, cos_sim=0.895]Epoch 3/3:  97%|█████████▋| 151/156 [00:08<00:00, 23.04it/s, loss=0.1083, cos_sim=0.895]Epoch 3/3:  97%|█████████▋| 151/156 [00:08<00:00, 23.04it/s, loss=0.1078, cos_sim=0.895]Epoch 3/3:  97%|█████████▋| 151/156 [00:08<00:00, 23.04it/s, loss=0.1073, cos_sim=0.895]Epoch 3/3:  99%|█████████▊| 154/156 [00:08<00:00, 23.27it/s, loss=0.1073, cos_sim=0.895]Epoch 3/3:  99%|█████████▊| 154/156 [00:08<00:00, 23.27it/s, loss=0.1112, cos_sim=0.891]Epoch 3/3:  99%|█████████▊| 154/156 [00:08<00:00, 23.27it/s, loss=0.1084, cos_sim=0.891]Epoch 3/3: 100%|██████████| 156/156 [00:08<00:00, 18.71it/s, loss=0.1084, cos_sim=0.891]

  Quick eval (first example):
    Expected: 'Dane'
    Generated: 'the name of Tesla's brother was Dane.'
    Norm ratio: 1.000 | Cosine: 0.828
  Avg norm ratio: 1.000 | Avg cosine: 0.848

  Step 400: Quick F1 = 28.7%

Epoch 3 complete:
  Avg loss: 0.1073
  Avg cosine similarity: 0.894
  Avg relative error: 0.557

Running full evaluation...

================================================================================
EVALUATION DIAGNOSTICS (Batched with size 32)
================================================================================
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:  25%|██▌       | 1/4 [00:00<00:02,  1.13it/s]Evaluating:  50%|█████     | 2/4 [00:01<00:01,  1.25it/s]Evaluating:  75%|███████▌  | 3/4 [00:02<00:00,  1.06it/s]Evaluating: 100%|██████████| 4/4 [00:03<00:00,  1.33it/s]Evaluating: 100%|██████████| 4/4 [00:03<00:00,  1.25it/s]

────────────────────────────────────────────────────────────────────────────────
Example 1:
  Question: Context: Tesla was the fourth of five children. He had an older brother named Da...
  Expected: 'Dane'
  Generated: 'the name of Tesla's brother was Dane.  Dane was killed in a horse-riding accident when'

  Embedding diagnostics:
    Original norm:  0.31
    Reconstructed norm: 0.31
    Ratio: 1.000 (OK)
    Cosine similarity: 0.828

  Token-level reconstruction (first example only):
    Original tokens:  <|begin_of_text|>Context: Tesla was the fourth of five children. He had an older brother named Dane and three sisters, Milka, Angelina and Marica. Dan...
    Reconstructed →:  <|begin_of_text|>Context: Tesla was the fourth of five children. He had an older brother named Dane and three sisters, Milka, Angelina and Marica. Dan...

────────────────────────────────────────────────────────────────────────────────
Example 2:
  Question: Context: Islamists have asked the question, "If Islam is a way of life, how can ...
  Expected: 'Muslims'
  Generated: 'A) Islam
B) Islamism
C) Muslim
D) Muslimism
The'

  Embedding diagnostics:
    Original norm:  0.36
    Reconstructed norm: 0.36
    Ratio: 1.000 (OK)
    Cosine similarity: 0.863

────────────────────────────────────────────────────────────────────────────────
Example 3:
  Question: Context: The concept environmental determinism served as a moral justification f...
  Expected: 'orientalism and tropicality'
  Generated: 'A) Orientalism and tropicality
B) Colonialism and imperialism
C) Racism'

  Embedding diagnostics:
    Original norm:  0.31
    Reconstructed norm: 0.31
    Ratio: 1.000 (OK)
    Cosine similarity: 0.867

================================================================================
  F1: 0.240
  EM: 0.000

============================================================
Training complete!
Best F1: 0.241
============================================================

============================================================
PHASE 1 RESULTS
============================================================
Best F1: 24.1%
❌ BELOW TARGET: Investigation needed
   Check: PCA quality, adapter capacity, or training setup
============================================================

=== Training Complete at Sat Oct 11 20:05:41 PDT 2025 ===
Running evaluation...
<string>:6: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
Best checkpoint from epoch 2
Best F1: 0.241

====================================
STAGE 1 PHASE 1 RESULTS SUMMARY
====================================
  Compression: 4096 → 1024
  Method: pca
  Best F1: 24.1%
  Achieved in epoch: 2

  ❌ NEEDS INVESTIGATION: Either compression too lossy or architecture issue.

Logs saved to:
  - runs/stage1_adapter_only/logs/training.log
  - runs/stage1_adapter_only/logs/diagnostics.jsonl
