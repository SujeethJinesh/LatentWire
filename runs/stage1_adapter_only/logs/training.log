Starting training at Sat Oct 11 14:05:48 PDT 2025

/projects/m000066/sujinesh/LatentWire/.venv/lib/python3.9/site-packages/transformers/utils/hub.py:128: FutureWarning: Using `TRANSFORMERS_CACHE` is deprecated and will be removed in v5 of Transformers. Use `HF_HOME` instead.
  warnings.warn(

Configuration:
  model_id: meta-llama/Meta-Llama-3.1-8B-Instruct
  compress_dim: 512
  compress_method: pca
  input_dim: 4096
  pca_samples: 80000
  adapter_hidden_mult: 4
  adapter_dropout: 0.1
  adapter_lr: 0.0005
  samples: 10000
  epochs: 3
  batch_size: 64
  eval_every: 1
  eval_samples: 500
  save_dir: runs/stage1_adapter_only
  diagnostic_log: runs/stage1_adapter_only/logs/diagnostics.jsonl
============================================================
STAGE 1 PHASE 1: PURE RECONSTRUCTION TRAINING
Model: meta-llama/Meta-Llama-3.1-8B-Instruct
Compression: 4096 → 512 (8.0× compression)
Training samples: 10000
PCA samples: 80000
============================================================

GPU Information:
  CUDA available: Yes
  GPU count: 4
  GPU 0: NVIDIA H100 80GB HBM3 (85.0 GB)
  GPU 1: NVIDIA H100 80GB HBM3 (85.0 GB)
  GPU 2: NVIDIA H100 80GB HBM3 (85.0 GB)
  GPU 3: NVIDIA H100 80GB HBM3 (85.0 GB)

Logging diagnostics to: runs/stage1_adapter_only/logs/diagnostics.jsonl

Loading model...
Downloading shards:   0%|          | 0/4 [00:00<?, ?it/s]Downloading shards: 100%|██████████| 4/4 [00:00<00:00, 2138.31it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:07<00:21,  7.17s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:14<00:14,  7.31s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:21<00:07,  7.26s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:23<00:00,  5.04s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:23<00:00,  5.86s/it]

Creating adapter...
Adapter parameters: 19,952,641

Loading dataset...
Training samples: 10000
Validation samples: 500

Fitting PCA compressor on 80,000 samples...
Collecting embeddings for PCA:   0%|          | 0/80000 [00:00<?, ?it/s]Collecting embeddings for PCA:   0%|          | 94/80000 [00:00<01:25, 939.07it/s]Collecting embeddings for PCA:   0%|          | 308/80000 [00:00<00:48, 1642.52it/s]Collecting embeddings for PCA:   1%|          | 513/80000 [00:00<00:43, 1806.83it/s]Collecting embeddings for PCA:   1%|          | 731/80000 [00:00<00:40, 1951.99it/s]Collecting embeddings for PCA:   1%|          | 945/80000 [00:00<00:39, 2019.36it/s]Collecting embeddings for PCA:   1%|▏         | 1147/80000 [00:01<02:56, 447.88it/s]Collecting embeddings for PCA:   2%|▏         | 1364/80000 [00:01<02:07, 614.54it/s]Collecting embeddings for PCA:   2%|▏         | 1605/80000 [00:01<01:34, 832.81it/s]Collecting embeddings for PCA:   2%|▏         | 1822/80000 [00:01<01:15, 1030.50it/s]Collecting embeddings for PCA:   3%|▎         | 2020/80000 [00:02<02:20, 554.03it/s] Collecting embeddings for PCA:   3%|▎         | 2170/80000 [00:02<01:59, 651.80it/s]Collecting embeddings for PCA:   3%|▎         | 2317/80000 [00:02<01:53, 685.97it/s]Collecting embeddings for PCA:   3%|▎         | 2444/80000 [00:03<01:54, 677.76it/s]Collecting embeddings for PCA:   3%|▎         | 2552/80000 [00:03<01:50, 699.32it/s]Collecting embeddings for PCA:   3%|▎         | 2742/80000 [00:03<01:25, 903.82it/s]Collecting embeddings for PCA:   4%|▎         | 2939/80000 [00:03<01:09, 1112.16it/s]Collecting embeddings for PCA:   4%|▍         | 3087/80000 [00:04<02:41, 475.52it/s] Collecting embeddings for PCA:   4%|▍         | 3203/80000 [00:04<02:22, 537.30it/s]Collecting embeddings for PCA:   4%|▍         | 3308/80000 [00:04<02:13, 574.24it/s]Collecting embeddings for PCA:   4%|▍         | 3404/80000 [00:04<02:02, 622.76it/s]Collecting embeddings for PCA:   4%|▍         | 3497/80000 [00:04<02:08, 594.09it/s]Collecting embeddings for PCA:   5%|▍         | 3707/80000 [00:04<01:27, 867.42it/s]Collecting embeddings for PCA:   5%|▍         | 3926/80000 [00:05<01:06, 1139.72it/s]Collecting embeddings for PCA:   5%|▌         | 4076/80000 [00:05<02:38, 479.12it/s] Collecting embeddings for PCA:   5%|▌         | 4259/80000 [00:05<01:59, 631.74it/s]Collecting embeddings for PCA:   5%|▌         | 4391/80000 [00:06<01:46, 706.77it/s]Collecting embeddings for PCA:   6%|▌         | 4517/80000 [00:06<02:10, 578.88it/s]Collecting embeddings for PCA:   6%|▌         | 4666/80000 [00:06<01:46, 709.60it/s]Collecting embeddings for PCA:   6%|▌         | 4887/80000 [00:06<01:17, 964.30it/s]Collecting embeddings for PCA:   6%|▋         | 5033/80000 [00:07<02:42, 460.71it/s]Collecting embeddings for PCA:   7%|▋         | 5259/80000 [00:07<01:54, 655.10it/s]Collecting embeddings for PCA:   7%|▋         | 5417/80000 [00:07<01:35, 778.52it/s]Collecting embeddings for PCA:   7%|▋         | 5565/80000 [00:07<01:33, 796.65it/s]Collecting embeddings for PCA:   7%|▋         | 5694/80000 [00:07<01:28, 842.48it/s]Collecting embeddings for PCA:   7%|▋         | 5815/80000 [00:08<01:36, 772.16it/s]Collecting embeddings for PCA:   8%|▊         | 6000/80000 [00:08<02:51, 431.15it/s]Collecting embeddings for PCA:   8%|▊         | 6177/80000 [00:08<02:09, 572.03it/s]Collecting embeddings for PCA:   8%|▊         | 6415/80000 [00:09<01:31, 808.32it/s]Collecting embeddings for PCA:   8%|▊         | 6608/80000 [00:09<01:14, 983.01it/s]Collecting embeddings for PCA:   8%|▊         | 6769/80000 [00:09<01:19, 924.96it/s]Collecting embeddings for PCA:   9%|▊         | 6906/80000 [00:09<01:43, 705.54it/s]Collecting embeddings for PCA:   9%|▉         | 7014/80000 [00:10<03:27, 351.38it/s]Collecting embeddings for PCA:   9%|▉         | 7248/80000 [00:10<02:16, 533.54it/s]Collecting embeddings for PCA:   9%|▉         | 7474/80000 [00:10<01:38, 733.38it/s]Collecting embeddings for PCA:  10%|▉         | 7630/80000 [00:10<01:37, 739.29it/s]Collecting embeddings for PCA:  10%|▉         | 7762/80000 [00:11<01:49, 661.31it/s]Collecting embeddings for PCA:  10%|▉         | 7869/80000 [00:11<01:43, 694.53it/s]Collecting embeddings for PCA:  10%|█         | 8000/80000 [00:12<03:16, 366.52it/s]Collecting embeddings for PCA:  10%|█         | 8214/80000 [00:12<02:12, 542.13it/s]Collecting embeddings for PCA:  10%|█         | 8396/80000 [00:12<01:47, 663.44it/s]Collecting embeddings for PCA:  11%|█         | 8516/80000 [00:12<01:37, 733.25it/s]Collecting embeddings for PCA:  11%|█         | 8634/80000 [00:12<01:47, 661.57it/s]Collecting embeddings for PCA:  11%|█         | 8732/80000 [00:12<01:54, 620.71it/s]Collecting embeddings for PCA:  11%|█         | 8949/80000 [00:13<01:20, 883.50it/s]Collecting embeddings for PCA:  11%|█▏        | 9073/80000 [00:13<02:47, 424.54it/s]Collecting embeddings for PCA:  12%|█▏        | 9293/80000 [00:13<02:01, 582.92it/s]Collecting embeddings for PCA:  12%|█▏        | 9469/80000 [00:14<01:36, 727.46it/s]Collecting embeddings for PCA:  12%|█▏        | 9592/80000 [00:14<01:28, 798.46it/s]Collecting embeddings for PCA:  12%|█▏        | 9714/80000 [00:14<01:45, 666.23it/s]Collecting embeddings for PCA:  12%|█▏        | 9813/80000 [00:14<01:39, 702.84it/s]Collecting embeddings for PCA:  12%|█▏        | 9959/80000 [00:14<01:23, 843.07it/s]Collecting embeddings for PCA:  13%|█▎        | 10069/80000 [00:15<03:00, 387.27it/s]Collecting embeddings for PCA:  13%|█▎        | 10303/80000 [00:15<01:54, 610.65it/s]Collecting embeddings for PCA:  13%|█▎        | 10541/80000 [00:15<01:20, 859.03it/s]Collecting embeddings for PCA:  13%|█▎        | 10704/80000 [00:15<01:10, 987.83it/s]Collecting embeddings for PCA:  14%|█▎        | 10865/80000 [00:15<01:13, 938.99it/s]Collecting embeddings for PCA:  14%|█▍        | 11003/80000 [00:16<02:58, 386.75it/s]Collecting embeddings for PCA:  14%|█▍        | 11226/80000 [00:16<02:03, 557.62it/s]Collecting embeddings for PCA:  14%|█▍        | 11437/80000 [00:17<01:32, 738.77it/s]Collecting embeddings for PCA:  15%|█▍        | 11659/80000 [00:17<01:11, 950.49it/s]Collecting embeddings for PCA:  15%|█▍        | 11837/80000 [00:17<01:04, 1062.32it/s]Collecting embeddings for PCA:  15%|█▌        | 12008/80000 [00:18<02:47, 404.97it/s] Collecting embeddings for PCA:  15%|█▌        | 12242/80000 [00:18<01:58, 569.61it/s]Collecting embeddings for PCA:  16%|█▌        | 12464/80000 [00:18<01:30, 748.59it/s]Collecting embeddings for PCA:  16%|█▌        | 12657/80000 [00:18<01:14, 906.74it/s]Collecting embeddings for PCA:  16%|█▌        | 12888/80000 [00:18<00:59, 1131.95it/s]Collecting embeddings for PCA:  16%|█▋        | 13084/80000 [00:19<02:32, 439.02it/s] Collecting embeddings for PCA:  17%|█▋        | 13311/80000 [00:19<01:52, 591.60it/s]Collecting embeddings for PCA:  17%|█▋        | 13522/80000 [00:20<01:28, 752.90it/s]Collecting embeddings for PCA:  17%|█▋        | 13711/80000 [00:20<01:13, 902.74it/s]Collecting embeddings for PCA:  17%|█▋        | 13944/80000 [00:20<00:58, 1128.88it/s]Collecting embeddings for PCA:  18%|█▊        | 14142/80000 [00:21<02:32, 432.67it/s] Collecting embeddings for PCA:  18%|█▊        | 14362/80000 [00:21<01:53, 576.62it/s]Collecting embeddings for PCA:  18%|█▊        | 14540/80000 [00:21<01:33, 701.81it/s]Collecting embeddings for PCA:  18%|█▊        | 14731/80000 [00:21<01:16, 857.96it/s]Collecting embeddings for PCA:  19%|█▊        | 14919/80000 [00:21<01:03, 1017.16it/s]Collecting embeddings for PCA:  19%|█▉        | 15099/80000 [00:22<02:43, 398.07it/s] Collecting embeddings for PCA:  19%|█▉        | 15287/80000 [00:23<02:04, 519.58it/s]Collecting embeddings for PCA:  19%|█▉        | 15528/80000 [00:23<01:29, 717.54it/s]Collecting embeddings for PCA:  20%|█▉        | 15754/80000 [00:23<01:10, 917.65it/s]Collecting embeddings for PCA:  20%|█▉        | 15979/80000 [00:23<00:56, 1126.13it/s]Collecting embeddings for PCA:  20%|██        | 16180/80000 [00:24<02:03, 514.73it/s] Collecting embeddings for PCA:  20%|██        | 16327/80000 [00:24<02:03, 513.74it/s]Collecting embeddings for PCA:  21%|██        | 16520/80000 [00:24<01:36, 659.43it/s]Collecting embeddings for PCA:  21%|██        | 16752/80000 [00:24<01:12, 871.94it/s]Collecting embeddings for PCA:  21%|██        | 16982/80000 [00:24<00:57, 1091.85it/s]Collecting embeddings for PCA:  21%|██▏       | 17168/80000 [00:25<02:01, 517.33it/s] Collecting embeddings for PCA:  22%|██▏       | 17305/80000 [00:25<01:50, 568.22it/s]Collecting embeddings for PCA:  22%|██▏       | 17427/80000 [00:26<01:47, 580.79it/s]Collecting embeddings for PCA:  22%|██▏       | 17531/80000 [00:26<01:42, 607.17it/s]Collecting embeddings for PCA:  22%|██▏       | 17752/80000 [00:26<01:13, 847.84it/s]Collecting embeddings for PCA:  22%|██▏       | 17985/80000 [00:26<00:55, 1109.14it/s]Collecting embeddings for PCA:  23%|██▎       | 18148/80000 [00:27<03:04, 335.96it/s] Collecting embeddings for PCA:  23%|██▎       | 18382/80000 [00:27<02:07, 483.72it/s]Collecting embeddings for PCA:  23%|██▎       | 18620/80000 [00:28<01:32, 664.16it/s]Collecting embeddings for PCA:  24%|██▎       | 18848/80000 [00:28<01:11, 857.73it/s]Collecting embeddings for PCA:  24%|██▍       | 19041/80000 [00:29<02:46, 366.22it/s]Collecting embeddings for PCA:  24%|██▍       | 19181/80000 [00:29<02:22, 426.50it/s]Collecting embeddings for PCA:  24%|██▍       | 19418/80000 [00:29<01:41, 598.81it/s]Collecting embeddings for PCA:  25%|██▍       | 19643/80000 [00:29<01:16, 784.23it/s]Collecting embeddings for PCA:  25%|██▍       | 19873/80000 [00:29<01:00, 993.74it/s]Collecting embeddings for PCA:  25%|██▌       | 20068/80000 [00:31<02:40, 373.49it/s]Collecting embeddings for PCA:  25%|██▌       | 20259/80000 [00:31<02:03, 482.57it/s]Collecting embeddings for PCA:  26%|██▌       | 20496/80000 [00:31<01:30, 656.36it/s]Collecting embeddings for PCA:  26%|██▌       | 20726/80000 [00:31<01:09, 847.29it/s]Collecting embeddings for PCA:  26%|██▌       | 20949/80000 [00:31<00:56, 1044.16it/s]Collecting embeddings for PCA:  26%|██▋       | 21153/80000 [00:33<02:35, 377.39it/s] Collecting embeddings for PCA:  27%|██▋       | 21389/80000 [00:33<01:53, 515.92it/s]Collecting embeddings for PCA:  27%|██▋       | 21613/80000 [00:33<01:26, 672.31it/s]Collecting embeddings for PCA:  27%|██▋       | 21841/80000 [00:33<01:07, 856.67it/s]Collecting embeddings for PCA:  28%|██▊       | 22042/80000 [00:34<02:41, 359.87it/s]Collecting embeddings for PCA:  28%|██▊       | 22266/80000 [00:34<01:59, 484.49it/s]Collecting embeddings for PCA:  28%|██▊       | 22493/80000 [00:34<01:29, 639.01it/s]Collecting embeddings for PCA:  28%|██▊       | 22708/80000 [00:35<01:11, 805.20it/s]Collecting embeddings for PCA:  29%|██▊       | 22945/80000 [00:35<00:56, 1017.31it/s]Collecting embeddings for PCA:  29%|██▉       | 23152/80000 [00:36<02:27, 385.55it/s] Collecting embeddings for PCA:  29%|██▉       | 23348/80000 [00:36<01:54, 495.71it/s]Collecting embeddings for PCA:  29%|██▉       | 23538/80000 [00:36<01:30, 623.32it/s]Collecting embeddings for PCA:  30%|██▉       | 23770/80000 [00:36<01:08, 818.05it/s]Collecting embeddings for PCA:  30%|██▉       | 23996/80000 [00:36<00:54, 1021.35it/s]Collecting embeddings for PCA:  30%|███       | 24197/80000 [00:38<02:29, 372.17it/s] Collecting embeddings for PCA:  31%|███       | 24428/80000 [00:38<01:49, 507.51it/s]Collecting embeddings for PCA:  31%|███       | 24618/80000 [00:38<01:27, 633.69it/s]Collecting embeddings for PCA:  31%|███       | 24795/80000 [00:38<01:12, 756.62it/s]Collecting embeddings for PCA:  31%|███       | 24984/80000 [00:38<01:00, 914.72it/s]Collecting embeddings for PCA:  31%|███▏      | 25162/80000 [00:40<02:44, 334.29it/s]Collecting embeddings for PCA:  32%|███▏      | 25387/80000 [00:40<01:56, 467.92it/s]Collecting embeddings for PCA:  32%|███▏      | 25544/80000 [00:40<01:36, 563.58it/s]Collecting embeddings for PCA:  32%|███▏      | 25716/80000 [00:40<01:18, 695.00it/s]Collecting embeddings for PCA:  32%|███▏      | 25888/80000 [00:40<01:04, 838.19it/s]Collecting embeddings for PCA:  33%|███▎      | 26051/80000 [00:42<03:04, 292.70it/s]Collecting embeddings for PCA:  33%|███▎      | 26264/80000 [00:42<02:09, 415.73it/s]Collecting embeddings for PCA:  33%|███▎      | 26500/80000 [00:42<01:31, 585.36it/s]Collecting embeddings for PCA:  33%|███▎      | 26673/80000 [00:42<01:18, 676.52it/s]Collecting embeddings for PCA:  34%|███▎      | 26886/80000 [00:42<01:01, 866.58it/s]Collecting embeddings for PCA:  34%|███▍      | 27060/80000 [00:43<02:41, 327.64it/s]Collecting embeddings for PCA:  34%|███▍      | 27286/80000 [00:44<01:54, 459.68it/s]Collecting embeddings for PCA:  34%|███▍      | 27517/80000 [00:44<01:24, 624.05it/s]Collecting embeddings for PCA:  35%|███▍      | 27758/80000 [00:44<01:03, 825.29it/s]Collecting embeddings for PCA:  35%|███▍      | 27991/80000 [00:44<00:50, 1033.46it/s]Collecting embeddings for PCA:  35%|███▌      | 28199/80000 [00:45<02:14, 384.71it/s] Collecting embeddings for PCA:  36%|███▌      | 28414/80000 [00:45<01:41, 508.30it/s]Collecting embeddings for PCA:  36%|███▌      | 28642/80000 [00:45<01:16, 669.37it/s]Collecting embeddings for PCA:  36%|███▌      | 28871/80000 [00:46<00:59, 855.67it/s]