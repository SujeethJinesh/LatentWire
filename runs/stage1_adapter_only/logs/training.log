Starting training at Sat Oct 11 19:34:56 PDT 2025

/projects/m000066/sujinesh/LatentWire/.venv/lib/python3.9/site-packages/transformers/utils/hub.py:128: FutureWarning: Using `TRANSFORMERS_CACHE` is deprecated and will be removed in v5 of Transformers. Use `HF_HOME` instead.
  warnings.warn(

Configuration:
  model_id: meta-llama/Meta-Llama-3.1-8B-Instruct
  compress_dim: 1024
  compress_method: pca
  input_dim: 4096
  pca_samples: 5000
  adapter_hidden_mult: 4
  adapter_dropout: 0.1
  adapter_lr: 0.0005
  samples: 10000
  epochs: 3
  batch_size: 64
  eval_every: 1
  eval_samples: 100
  save_dir: runs/stage1_adapter_only
  diagnostic_log: runs/stage1_adapter_only/logs/diagnostics.jsonl
============================================================
STAGE 1 PHASE 1: PURE RECONSTRUCTION TRAINING
Model: meta-llama/Meta-Llama-3.1-8B-Instruct
Compression: 4096 → 1024 (4.0× compression)
Training samples: 10000
PCA samples: 5000
============================================================

GPU Information:
  CUDA available: Yes
  GPU count: 4
  GPU 0: NVIDIA H100 80GB HBM3 (85.0 GB)
  GPU 1: NVIDIA H100 80GB HBM3 (85.0 GB)
  GPU 2: NVIDIA H100 80GB HBM3 (85.0 GB)
  GPU 3: NVIDIA H100 80GB HBM3 (85.0 GB)

Logging diagnostics to: runs/stage1_adapter_only/logs/diagnostics.jsonl

Loading model...
Downloading shards:   0%|          | 0/4 [00:00<?, ?it/s]Downloading shards: 100%|██████████| 4/4 [00:00<00:00, 3468.52it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:01<00:04,  1.38s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:02<00:02,  1.15s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:03<00:01,  1.23s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:03<00:00,  1.19it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:03<00:00,  1.02it/s]

Creating adapter...
Adapter parameters: 50,374,657

Loading dataset...
Training samples: 10000
Validation samples: 500

Fitting PCA compressor on 5,000 samples...

GPU memory status:
  GPU 0: 80.9 GB free / 85.0 GB total (allocated: 3.3 GB)
  GPU 1: 80.1 GB free / 85.0 GB total (allocated: 4.4 GB)
  GPU 2: 80.1 GB free / 85.0 GB total (allocated: 4.4 GB)
  GPU 3: 80.3 GB free / 85.0 GB total (allocated: 4.1 GB)

Using GPU 0 for PCA (80.9 GB free)
Collecting embeddings...
Collecting embeddings:   0%|          | 0/79 [00:00<?, ?it/s]Collecting embeddings:   3%|▎         | 2/79 [00:00<00:04, 17.90it/s]Collecting embeddings:   9%|▉         | 7/79 [00:00<00:02, 35.25it/s]Collecting embeddings:  16%|█▋        | 13/79 [00:00<00:01, 42.92it/s]Collecting embeddings:  24%|██▍       | 19/79 [00:00<00:01, 46.21it/s]Collecting embeddings:  30%|███       | 24/79 [00:00<00:01, 47.03it/s]Collecting embeddings:  37%|███▋      | 29/79 [00:00<00:01, 39.14it/s]Collecting embeddings:  43%|████▎     | 34/79 [00:00<00:01, 30.82it/s]Collecting embeddings:  49%|████▉     | 39/79 [00:01<00:01, 30.81it/s]Collecting embeddings:  56%|█████▌    | 44/79 [00:01<00:01, 30.59it/s]Collecting embeddings:  62%|██████▏   | 49/79 [00:01<00:00, 34.01it/s]Collecting embeddings:  70%|██████▉   | 55/79 [00:01<00:00, 38.65it/s]Collecting embeddings:  77%|███████▋  | 61/79 [00:01<00:00, 42.10it/s]Collecting embeddings:  85%|████████▍ | 67/79 [00:01<00:00, 44.92it/s]Collecting embeddings:  91%|█████████ | 72/79 [00:01<00:00, 46.11it/s]Collecting embeddings:  99%|█████████▊| 78/79 [00:01<00:00, 47.79it/s]Collecting embeddings: 100%|██████████| 79/79 [00:01<00:00, 40.21it/s]
Concatenating 863,997 embedding vectors...
  Fitting PCA on GPU with 863,997 embedding vectors...
  Computing top 1024 components via randomized SVD...
  PCA captured variance (top 1024 components): 100.0%
✓ PCA fitted on 863,997 embedding vectors

============================================================
TRAINING
============================================================

Epoch 1/3:   0%|          | 0/156 [00:00<?, ?it/s]Epoch 1/3:   0%|          | 0/156 [00:00<?, ?it/s, loss=0.9980, cos_sim=0.002]Epoch 1/3:   1%|          | 1/156 [00:00<00:37,  4.17it/s, loss=0.9980, cos_sim=0.002]Epoch 1/3:   1%|          | 1/156 [00:00<00:37,  4.17it/s, loss=0.8804, cos_sim=0.120]Epoch 1/3:   1%|          | 1/156 [00:00<00:37,  4.17it/s, loss=0.7717, cos_sim=0.229]Epoch 1/3:   1%|          | 1/156 [00:00<00:37,  4.17it/s, loss=0.7096, cos_sim=0.291]Epoch 1/3:   3%|▎         | 4/156 [00:00<00:12, 12.26it/s, loss=0.7096, cos_sim=0.291]Epoch 1/3:   3%|▎         | 4/156 [00:00<00:12, 12.26it/s, loss=0.6678, cos_sim=0.332]Epoch 1/3:   3%|▎         | 4/156 [00:00<00:12, 12.26it/s, loss=0.6264, cos_sim=0.375]Epoch 1/3:   3%|▎         | 4/156 [00:00<00:12, 12.26it/s, loss=0.5952, cos_sim=0.404]Epoch 1/3:   4%|▍         | 7/156 [00:00<00:09, 16.54it/s, loss=0.5952, cos_sim=0.404]Epoch 1/3:   4%|▍         | 7/156 [00:00<00:09, 16.54it/s, loss=0.5649, cos_sim=0.436]Epoch 1/3:   4%|▍         | 7/156 [00:00<00:09, 16.54it/s, loss=0.5489, cos_sim=0.451]Epoch 1/3:   4%|▍         | 7/156 [00:00<00:09, 16.54it/s, loss=0.5277, cos_sim=0.473]Epoch 1/3:   6%|▋         | 10/156 [00:00<00:07, 19.07it/s, loss=0.5277, cos_sim=0.473]Epoch 1/3:   6%|▋         | 10/156 [00:00<00:07, 19.07it/s, loss=0.5094, cos_sim=0.490]Epoch 1/3:   6%|▋         | 10/156 [00:00<00:07, 19.07it/s, loss=0.4947, cos_sim=0.504]Epoch 1/3:   6%|▋         | 10/156 [00:00<00:07, 19.07it/s, loss=0.4803, cos_sim=0.520]Epoch 1/3:   8%|▊         | 13/156 [00:00<00:06, 20.59it/s, loss=0.4803, cos_sim=0.520]Epoch 1/3:   8%|▊         | 13/156 [00:00<00:06, 20.59it/s, loss=0.4661, cos_sim=0.535]Epoch 1/3:   8%|▊         | 13/156 [00:00<00:06, 20.59it/s, loss=0.4529, cos_sim=0.547]Epoch 1/3:   8%|▊         | 13/156 [00:00<00:06, 20.59it/s, loss=0.4363, cos_sim=0.562]Epoch 1/3:  10%|█         | 16/156 [00:00<00:07, 19.60it/s, loss=0.4363, cos_sim=0.562]Epoch 1/3:  10%|█         | 16/156 [00:00<00:07, 19.60it/s, loss=0.4236, cos_sim=0.578]Epoch 1/3:  10%|█         | 16/156 [00:01<00:07, 19.60it/s, loss=0.4112, cos_sim=0.590]Epoch 1/3:  10%|█         | 16/156 [00:01<00:07, 19.60it/s, loss=0.3984, cos_sim=0.602]Epoch 1/3:  12%|█▏        | 19/156 [00:01<00:08, 17.04it/s, loss=0.3984, cos_sim=0.602]Epoch 1/3:  12%|█▏        | 19/156 [00:01<00:08, 17.04it/s, loss=0.3912, cos_sim=0.609]Epoch 1/3:  12%|█▏        | 19/156 [00:01<00:08, 17.04it/s, loss=0.3780, cos_sim=0.621]Epoch 1/3:  13%|█▎        | 21/156 [00:01<00:09, 14.02it/s, loss=0.3780, cos_sim=0.621]Epoch 1/3:  13%|█▎        | 21/156 [00:01<00:09, 14.02it/s, loss=0.3683, cos_sim=0.633]Epoch 1/3:  13%|█▎        | 21/156 [00:01<00:09, 14.02it/s, loss=0.3614, cos_sim=0.641]Epoch 1/3:  13%|█▎        | 21/156 [00:01<00:09, 14.02it/s, loss=0.3521, cos_sim=0.648]Epoch 1/3:  15%|█▌        | 24/156 [00:01<00:09, 14.39it/s, loss=0.3521, cos_sim=0.648]Epoch 1/3:  15%|█▌        | 24/156 [00:01<00:09, 14.39it/s, loss=0.3305, cos_sim=0.672]Epoch 1/3:  15%|█▌        | 24/156 [00:01<00:09, 14.39it/s, loss=0.3281, cos_sim=0.672]Epoch 1/3:  15%|█▌        | 24/156 [00:01<00:09, 14.39it/s, loss=0.3200, cos_sim=0.680]Epoch 1/3:  17%|█▋        | 27/156 [00:01<00:07, 16.63it/s, loss=0.3200, cos_sim=0.680]Epoch 1/3:  17%|█▋        | 27/156 [00:01<00:07, 16.63it/s, loss=0.3162, cos_sim=0.684]Epoch 1/3:  17%|█▋        | 27/156 [00:01<00:07, 16.63it/s, loss=0.3046, cos_sim=0.695]Epoch 1/3:  17%|█▋        | 27/156 [00:01<00:07, 16.63it/s, loss=0.2867, cos_sim=0.715]Epoch 1/3:  19%|█▉        | 30/156 [00:01<00:06, 18.31it/s, loss=0.2867, cos_sim=0.715]Epoch 1/3:  19%|█▉        | 30/156 [00:01<00:06, 18.31it/s, loss=0.2890, cos_sim=0.711]Epoch 1/3:  19%|█▉        | 30/156 [00:01<00:06, 18.31it/s, loss=0.2889, cos_sim=0.711]Epoch 1/3:  19%|█▉        | 30/156 [00:01<00:06, 18.31it/s, loss=0.2783, cos_sim=0.723]Epoch 1/3:  21%|██        | 33/156 [00:01<00:06, 19.74it/s, loss=0.2783, cos_sim=0.723]Epoch 1/3:  21%|██        | 33/156 [00:01<00:06, 19.74it/s, loss=0.2696, cos_sim=0.730]Epoch 1/3:  21%|██        | 33/156 [00:02<00:06, 19.74it/s, loss=0.2576, cos_sim=0.742]Epoch 1/3:  21%|██        | 33/156 [00:02<00:06, 19.74it/s, loss=0.2544, cos_sim=0.746]Epoch 1/3:  23%|██▎       | 36/156 [00:02<00:05, 20.82it/s, loss=0.2544, cos_sim=0.746]Epoch 1/3:  23%|██▎       | 36/156 [00:02<00:05, 20.82it/s, loss=0.2469, cos_sim=0.754]Epoch 1/3:  23%|██▎       | 36/156 [00:02<00:05, 20.82it/s, loss=0.2470, cos_sim=0.754]Epoch 1/3:  23%|██▎       | 36/156 [00:02<00:05, 20.82it/s, loss=0.2387, cos_sim=0.762]Epoch 1/3:  25%|██▌       | 39/156 [00:02<00:05, 21.81it/s, loss=0.2387, cos_sim=0.762]Epoch 1/3:  25%|██▌       | 39/156 [00:02<00:05, 21.81it/s, loss=0.2349, cos_sim=0.766]Epoch 1/3:  25%|██▌       | 39/156 [00:02<00:05, 21.81it/s, loss=0.2284, cos_sim=0.773]Epoch 1/3:  25%|██▌       | 39/156 [00:02<00:05, 21.81it/s, loss=0.2243, cos_sim=0.777]Epoch 1/3:  27%|██▋       | 42/156 [00:02<00:05, 22.34it/s, loss=0.2243, cos_sim=0.777]Epoch 1/3:  27%|██▋       | 42/156 [00:02<00:05, 22.34it/s, loss=0.2206, cos_sim=0.781]Epoch 1/3:  27%|██▋       | 42/156 [00:02<00:05, 22.34it/s, loss=0.2123, cos_sim=0.789]Epoch 1/3:  27%|██▋       | 42/156 [00:02<00:05, 22.34it/s, loss=0.2140, cos_sim=0.785]Epoch 1/3:  29%|██▉       | 45/156 [00:02<00:04, 22.86it/s, loss=0.2140, cos_sim=0.785]Epoch 1/3:  29%|██▉       | 45/156 [00:02<00:04, 22.86it/s, loss=0.2043, cos_sim=0.797]Epoch 1/3:  29%|██▉       | 45/156 [00:02<00:04, 22.86it/s, loss=0.2023, cos_sim=0.797]Epoch 1/3:  29%|██▉       | 45/156 [00:02<00:04, 22.86it/s, loss=0.2008, cos_sim=0.801]Epoch 1/3:  31%|███       | 48/156 [00:02<00:04, 23.19it/s, loss=0.2008, cos_sim=0.801]Epoch 1/3:  31%|███       | 48/156 [00:02<00:04, 23.19it/s, loss=0.2002, cos_sim=0.801]Epoch 1/3:  31%|███       | 48/156 [00:02<00:04, 23.19it/s, loss=0.1928, cos_sim=0.809]Epoch 1/3:  31%|███       | 48/156 [00:02<00:04, 23.19it/s, loss=0.1910, cos_sim=0.809]Epoch 1/3:  33%|███▎      | 51/156 [00:02<00:04, 23.32it/s, loss=0.1910, cos_sim=0.809]Epoch 1/3:  33%|███▎      | 51/156 [00:02<00:04, 23.32it/s, loss=0.1871, cos_sim=0.812]Epoch 1/3:  33%|███▎      | 51/156 [00:02<00:04, 23.32it/s, loss=0.1929, cos_sim=0.809]Epoch 1/3:  33%|███▎      | 51/156 [00:02<00:04, 23.32it/s, loss=0.1837, cos_sim=0.816]Epoch 1/3:  35%|███▍      | 54/156 [00:02<00:04, 22.74it/s, loss=0.1837, cos_sim=0.816]Epoch 1/3:  35%|███▍      | 54/156 [00:02<00:04, 22.74it/s, loss=0.1798, cos_sim=0.820]Epoch 1/3:  35%|███▍      | 54/156 [00:02<00:04, 22.74it/s, loss=0.1810, cos_sim=0.820]Epoch 1/3:  35%|███▍      | 54/156 [00:03<00:04, 22.74it/s, loss=0.1774, cos_sim=0.824]Epoch 1/3:  37%|███▋      | 57/156 [00:03<00:05, 18.31it/s, loss=0.1774, cos_sim=0.824]Epoch 1/3:  37%|███▋      | 57/156 [00:03<00:05, 18.31it/s, loss=0.1702, cos_sim=0.832]Epoch 1/3:  37%|███▋      | 57/156 [00:03<00:05, 18.31it/s, loss=0.1636, cos_sim=0.836]Epoch 1/3:  37%|███▋      | 57/156 [00:03<00:05, 18.31it/s, loss=0.1657, cos_sim=0.836]Epoch 1/3:  38%|███▊      | 60/156 [00:03<00:06, 15.62it/s, loss=0.1657, cos_sim=0.836]Epoch 1/3:  38%|███▊      | 60/156 [00:03<00:06, 15.62it/s, loss=0.1704, cos_sim=0.832]Epoch 1/3:  38%|███▊      | 60/156 [00:03<00:06, 15.62it/s, loss=0.1631, cos_sim=0.836]Epoch 1/3:  38%|███▊      | 60/156 [00:03<00:06, 15.62it/s, loss=0.1603, cos_sim=0.840]Epoch 1/3:  40%|████      | 63/156 [00:03<00:05, 17.27it/s, loss=0.1603, cos_sim=0.840]Epoch 1/3:  40%|████      | 63/156 [00:03<00:05, 17.27it/s, loss=0.1621, cos_sim=0.840]Epoch 1/3:  40%|████      | 63/156 [00:03<00:05, 17.27it/s, loss=0.1638, cos_sim=0.836]Epoch 1/3:  42%|████▏     | 65/156 [00:03<00:05, 16.16it/s, loss=0.1638, cos_sim=0.836]Epoch 1/3:  42%|████▏     | 65/156 [00:03<00:05, 16.16it/s, loss=0.1574, cos_sim=0.844]Epoch 1/3:  42%|████▏     | 65/156 [00:03<00:05, 16.16it/s, loss=0.1570, cos_sim=0.844]Epoch 1/3:  42%|████▏     | 65/156 [00:03<00:05, 16.16it/s, loss=0.1534, cos_sim=0.848]Epoch 1/3:  44%|████▎     | 68/156 [00:03<00:04, 17.95it/s, loss=0.1534, cos_sim=0.848]Epoch 1/3:  44%|████▎     | 68/156 [00:03<00:04, 17.95it/s, loss=0.1524, cos_sim=0.848]Epoch 1/3:  44%|████▎     | 68/156 [00:03<00:04, 17.95it/s, loss=0.1568, cos_sim=0.844]Epoch 1/3:  44%|████▎     | 68/156 [00:03<00:04, 17.95it/s, loss=0.1516, cos_sim=0.848]Epoch 1/3:  46%|████▌     | 71/156 [00:03<00:04, 19.48it/s, loss=0.1516, cos_sim=0.848]Epoch 1/3:  46%|████▌     | 71/156 [00:03<00:04, 19.48it/s, loss=0.1516, cos_sim=0.848]Epoch 1/3:  46%|████▌     | 71/156 [00:03<00:04, 19.48it/s, loss=0.1449, cos_sim=0.855]Epoch 1/3:  46%|████▌     | 71/156 [00:03<00:04, 19.48it/s, loss=0.1497, cos_sim=0.852]Epoch 1/3:  47%|████▋     | 74/156 [00:03<00:03, 20.87it/s, loss=0.1497, cos_sim=0.852]Epoch 1/3:  47%|████▋     | 74/156 [00:04<00:03, 20.87it/s, loss=0.1477, cos_sim=0.852]Epoch 1/3:  47%|████▋     | 74/156 [00:04<00:03, 20.87it/s, loss=0.1435, cos_sim=0.855]Epoch 1/3:  47%|████▋     | 74/156 [00:04<00:03, 20.87it/s, loss=0.1449, cos_sim=0.855]Epoch 1/3:  49%|████▉     | 77/156 [00:04<00:03, 21.71it/s, loss=0.1449, cos_sim=0.855]Epoch 1/3:  49%|████▉     | 77/156 [00:04<00:03, 21.71it/s, loss=0.1421, cos_sim=0.859]Epoch 1/3:  49%|████▉     | 77/156 [00:04<00:03, 21.71it/s, loss=0.1446, cos_sim=0.855]Epoch 1/3:  49%|████▉     | 77/156 [00:04<00:03, 21.71it/s, loss=0.1426, cos_sim=0.859]Epoch 1/3:  51%|█████▏    | 80/156 [00:04<00:03, 22.10it/s, loss=0.1426, cos_sim=0.859]Epoch 1/3:  51%|█████▏    | 80/156 [00:04<00:03, 22.10it/s, loss=0.1400, cos_sim=0.859]Epoch 1/3:  51%|█████▏    | 80/156 [00:04<00:03, 22.10it/s, loss=0.1417, cos_sim=0.859]Epoch 1/3:  51%|█████▏    | 80/156 [00:04<00:03, 22.10it/s, loss=0.1422, cos_sim=0.859]Epoch 1/3:  53%|█████▎    | 83/156 [00:04<00:03, 22.53it/s, loss=0.1422, cos_sim=0.859]Epoch 1/3:  53%|█████▎    | 83/156 [00:04<00:03, 22.53it/s, loss=0.1428, cos_sim=0.859]Epoch 1/3:  53%|█████▎    | 83/156 [00:04<00:03, 22.53it/s, loss=0.1411, cos_sim=0.859]Epoch 1/3:  53%|█████▎    | 83/156 [00:04<00:03, 22.53it/s, loss=0.1434, cos_sim=0.855]Epoch 1/3:  55%|█████▌    | 86/156 [00:04<00:03, 22.82it/s, loss=0.1434, cos_sim=0.855]Epoch 1/3:  55%|█████▌    | 86/156 [00:04<00:03, 22.82it/s, loss=0.1335, cos_sim=0.867]Epoch 1/3:  55%|█████▌    | 86/156 [00:04<00:03, 22.82it/s, loss=0.1372, cos_sim=0.863]Epoch 1/3:  55%|█████▌    | 86/156 [00:04<00:03, 22.82it/s, loss=0.1322, cos_sim=0.867]Epoch 1/3:  57%|█████▋    | 89/156 [00:04<00:02, 23.25it/s, loss=0.1322, cos_sim=0.867]Epoch 1/3:  57%|█████▋    | 89/156 [00:04<00:02, 23.25it/s, loss=0.1385, cos_sim=0.863]Epoch 1/3:  57%|█████▋    | 89/156 [00:04<00:02, 23.25it/s, loss=0.1347, cos_sim=0.867]Epoch 1/3:  57%|█████▋    | 89/156 [00:04<00:02, 23.25it/s, loss=0.1347, cos_sim=0.867]Epoch 1/3:  59%|█████▉    | 92/156 [00:04<00:02, 23.04it/s, loss=0.1347, cos_sim=0.867]Epoch 1/3:  59%|█████▉    | 92/156 [00:04<00:02, 23.04it/s, loss=0.1372, cos_sim=0.863]Epoch 1/3:  59%|█████▉    | 92/156 [00:04<00:02, 23.04it/s, loss=0.1332, cos_sim=0.867]Epoch 1/3:  59%|█████▉    | 92/156 [00:04<00:02, 23.04it/s, loss=0.1358, cos_sim=0.863]Epoch 1/3:  61%|██████    | 95/156 [00:04<00:02, 21.04it/s, loss=0.1358, cos_sim=0.863]Epoch 1/3:  61%|██████    | 95/156 [00:04<00:02, 21.04it/s, loss=0.1359, cos_sim=0.863]Epoch 1/3:  61%|██████    | 95/156 [00:05<00:02, 21.04it/s, loss=0.1363, cos_sim=0.863]Epoch 1/3:  61%|██████    | 95/156 [00:05<00:02, 21.04it/s, loss=0.1282, cos_sim=0.871]Epoch 1/3:  63%|██████▎   | 98/156 [00:05<00:03, 18.59it/s, loss=0.1282, cos_sim=0.871]Epoch 1/3:  63%|██████▎   | 98/156 [00:05<00:03, 18.59it/s, loss=0.1360, cos_sim=0.863]Epoch 1/3:  63%|██████▎   | 98/156 [00:05<00:03, 18.59it/s, loss=0.1298, cos_sim=0.871]Starting from v4.46, the `logits` model output will have the same type as the model (except at train time, where it will always be FP32)
Epoch 1/3:  64%|██████▍   | 100/156 [00:06<00:08,  6.77it/s, loss=0.1298, cos_sim=0.871]Epoch 1/3:  64%|██████▍   | 100/156 [00:06<00:08,  6.77it/s, loss=0.1366, cos_sim=0.863]Epoch 1/3:  64%|██████▍   | 100/156 [00:06<00:08,  6.77it/s, loss=0.1297, cos_sim=0.871]Epoch 1/3:  64%|██████▍   | 100/156 [00:06<00:08,  6.77it/s, loss=0.1291, cos_sim=0.871]Epoch 1/3:  66%|██████▌   | 103/156 [00:06<00:06,  8.76it/s, loss=0.1291, cos_sim=0.871]Epoch 1/3:  66%|██████▌   | 103/156 [00:06<00:06,  8.76it/s, loss=0.1321, cos_sim=0.867]Epoch 1/3:  66%|██████▌   | 103/156 [00:06<00:06,  8.76it/s, loss=0.1282, cos_sim=0.871]Epoch 1/3:  66%|██████▌   | 103/156 [00:06<00:06,  8.76it/s, loss=0.1266, cos_sim=0.875]Epoch 1/3:  68%|██████▊   | 106/156 [00:06<00:04, 10.95it/s, loss=0.1266, cos_sim=0.875]Epoch 1/3:  68%|██████▊   | 106/156 [00:06<00:04, 10.95it/s, loss=0.1311, cos_sim=0.871]Epoch 1/3:  68%|██████▊   | 106/156 [00:06<00:04, 10.95it/s, loss=0.1299, cos_sim=0.871]Epoch 1/3:  68%|██████▊   | 106/156 [00:06<00:04, 10.95it/s, loss=0.1282, cos_sim=0.871]Epoch 1/3:  70%|██████▉   | 109/156 [00:06<00:03, 13.20it/s, loss=0.1282, cos_sim=0.871]Epoch 1/3:  70%|██████▉   | 109/156 [00:06<00:03, 13.20it/s, loss=0.1262, cos_sim=0.875]Epoch 1/3:  70%|██████▉   | 109/156 [00:06<00:03, 13.20it/s, loss=0.1316, cos_sim=0.867]Epoch 1/3:  70%|██████▉   | 109/156 [00:06<00:03, 13.20it/s, loss=0.1241, cos_sim=0.875]Epoch 1/3:  72%|███████▏  | 112/156 [00:06<00:02, 15.29it/s, loss=0.1241, cos_sim=0.875]Epoch 1/3:  72%|███████▏  | 112/156 [00:06<00:02, 15.29it/s, loss=0.1267, cos_sim=0.875]Epoch 1/3:  72%|███████▏  | 112/156 [00:06<00:02, 15.29it/s, loss=0.1247, cos_sim=0.875]Epoch 1/3:  72%|███████▏  | 112/156 [00:06<00:02, 15.29it/s, loss=0.1230, cos_sim=0.879]Epoch 1/3:  74%|███████▎  | 115/156 [00:06<00:02, 16.89it/s, loss=0.1230, cos_sim=0.879]Epoch 1/3:  74%|███████▎  | 115/156 [00:06<00:02, 16.89it/s, loss=0.1247, cos_sim=0.875]Epoch 1/3:  74%|███████▎  | 115/156 [00:06<00:02, 16.89it/s, loss=0.1257, cos_sim=0.875]Epoch 1/3:  74%|███████▎  | 115/156 [00:06<00:02, 16.89it/s, loss=0.1252, cos_sim=0.875]Epoch 1/3:  76%|███████▌  | 118/156 [00:06<00:02, 16.90it/s, loss=0.1252, cos_sim=0.875]Epoch 1/3:  76%|███████▌  | 118/156 [00:07<00:02, 16.90it/s, loss=0.1245, cos_sim=0.875]Epoch 1/3:  76%|███████▌  | 118/156 [00:07<00:02, 16.90it/s, loss=0.1268, cos_sim=0.875]Epoch 1/3:  76%|███████▌  | 118/156 [00:07<00:02, 16.90it/s, loss=0.1234, cos_sim=0.879]Epoch 1/3:  78%|███████▊  | 121/156 [00:07<00:02, 14.75it/s, loss=0.1234, cos_sim=0.879]Epoch 1/3:  78%|███████▊  | 121/156 [00:07<00:02, 14.75it/s, loss=0.1280, cos_sim=0.871]Epoch 1/3:  78%|███████▊  | 121/156 [00:07<00:02, 14.75it/s, loss=0.1277, cos_sim=0.871]Epoch 1/3:  78%|███████▊  | 121/156 [00:07<00:02, 14.75it/s, loss=0.1276, cos_sim=0.875]Epoch 1/3:  79%|███████▉  | 124/156 [00:07<00:02, 14.97it/s, loss=0.1276, cos_sim=0.875]Epoch 1/3:  79%|███████▉  | 124/156 [00:07<00:02, 14.97it/s, loss=0.1256, cos_sim=0.875]Epoch 1/3:  79%|███████▉  | 124/156 [00:07<00:02, 14.97it/s, loss=0.1233, cos_sim=0.879]Epoch 1/3:  79%|███████▉  | 124/156 [00:07<00:02, 14.97it/s, loss=0.1247, cos_sim=0.875]Epoch 1/3:  81%|████████▏ | 127/156 [00:07<00:01, 15.08it/s, loss=0.1247, cos_sim=0.875]Epoch 1/3:  81%|████████▏ | 127/156 [00:07<00:01, 15.08it/s, loss=0.1242, cos_sim=0.875]Epoch 1/3:  81%|████████▏ | 127/156 [00:07<00:01, 15.08it/s, loss=0.1189, cos_sim=0.883]Epoch 1/3:  81%|████████▏ | 127/156 [00:07<00:01, 15.08it/s, loss=0.1264, cos_sim=0.875]Epoch 1/3:  83%|████████▎ | 130/156 [00:07<00:01, 16.77it/s, loss=0.1264, cos_sim=0.875]Epoch 1/3:  83%|████████▎ | 130/156 [00:07<00:01, 16.77it/s, loss=0.1234, cos_sim=0.879]Epoch 1/3:  83%|████████▎ | 130/156 [00:07<00:01, 16.77it/s, loss=0.1201, cos_sim=0.879]Epoch 1/3:  83%|████████▎ | 130/156 [00:07<00:01, 16.77it/s, loss=0.1189, cos_sim=0.883]Epoch 1/3:  85%|████████▌ | 133/156 [00:07<00:01, 18.33it/s, loss=0.1189, cos_sim=0.883]Epoch 1/3:  85%|████████▌ | 133/156 [00:07<00:01, 18.33it/s, loss=0.1185, cos_sim=0.883]Epoch 1/3:  85%|████████▌ | 133/156 [00:07<00:01, 18.33it/s, loss=0.1235, cos_sim=0.879]Epoch 1/3:  85%|████████▌ | 133/156 [00:07<00:01, 18.33it/s, loss=0.1255, cos_sim=0.875]Epoch 1/3:  87%|████████▋ | 136/156 [00:07<00:01, 19.76it/s, loss=0.1255, cos_sim=0.875]Epoch 1/3:  87%|████████▋ | 136/156 [00:07<00:01, 19.76it/s, loss=0.1189, cos_sim=0.883]Epoch 1/3:  87%|████████▋ | 136/156 [00:08<00:01, 19.76it/s, loss=0.1225, cos_sim=0.879]Epoch 1/3:  87%|████████▋ | 136/156 [00:08<00:01, 19.76it/s, loss=0.1204, cos_sim=0.879]Epoch 1/3:  89%|████████▉ | 139/156 [00:08<00:00, 20.75it/s, loss=0.1204, cos_sim=0.879]Epoch 1/3:  89%|████████▉ | 139/156 [00:08<00:00, 20.75it/s, loss=0.1243, cos_sim=0.875]Epoch 1/3:  89%|████████▉ | 139/156 [00:08<00:00, 20.75it/s, loss=0.1201, cos_sim=0.879]Epoch 1/3:  89%|████████▉ | 139/156 [00:08<00:00, 20.75it/s, loss=0.1176, cos_sim=0.883]Epoch 1/3:  91%|█████████ | 142/156 [00:08<00:00, 21.58it/s, loss=0.1176, cos_sim=0.883]Epoch 1/3:  91%|█████████ | 142/156 [00:08<00:00, 21.58it/s, loss=0.1138, cos_sim=0.887]Epoch 1/3:  91%|█████████ | 142/156 [00:08<00:00, 21.58it/s, loss=0.1189, cos_sim=0.883]Epoch 1/3:  91%|█████████ | 142/156 [00:08<00:00, 21.58it/s, loss=0.1205, cos_sim=0.879]Epoch 1/3:  93%|█████████▎| 145/156 [00:08<00:00, 22.22it/s, loss=0.1205, cos_sim=0.879]Epoch 1/3:  93%|█████████▎| 145/156 [00:08<00:00, 22.22it/s, loss=0.1178, cos_sim=0.883]Epoch 1/3:  93%|█████████▎| 145/156 [00:08<00:00, 22.22it/s, loss=0.1225, cos_sim=0.879]Epoch 1/3:  93%|█████████▎| 145/156 [00:08<00:00, 22.22it/s, loss=0.1203, cos_sim=0.879]Epoch 1/3:  95%|█████████▍| 148/156 [00:08<00:00, 22.67it/s, loss=0.1203, cos_sim=0.879]Epoch 1/3:  95%|█████████▍| 148/156 [00:08<00:00, 22.67it/s, loss=0.1221, cos_sim=0.879]Epoch 1/3:  95%|█████████▍| 148/156 [00:08<00:00, 22.67it/s, loss=0.1267, cos_sim=0.875]Epoch 1/3:  95%|█████████▍| 148/156 [00:08<00:00, 22.67it/s, loss=0.1186, cos_sim=0.883]Epoch 1/3:  97%|█████████▋| 151/156 [00:08<00:00, 23.03it/s, loss=0.1186, cos_sim=0.883]Epoch 1/3:  97%|█████████▋| 151/156 [00:08<00:00, 23.03it/s, loss=0.1187, cos_sim=0.883]Epoch 1/3:  97%|█████████▋| 151/156 [00:08<00:00, 23.03it/s, loss=0.1203, cos_sim=0.879]Epoch 1/3:  97%|█████████▋| 151/156 [00:08<00:00, 23.03it/s, loss=0.1187, cos_sim=0.883]Epoch 1/3:  99%|█████████▊| 154/156 [00:08<00:00, 23.33it/s, loss=0.1187, cos_sim=0.883]Epoch 1/3:  99%|█████████▊| 154/156 [00:08<00:00, 23.33it/s, loss=0.1198, cos_sim=0.883]Epoch 1/3:  99%|█████████▊| 154/156 [00:08<00:00, 23.33it/s, loss=0.1204, cos_sim=0.879]Epoch 1/3: 100%|██████████| 156/156 [00:08<00:00, 17.76it/s, loss=0.1204, cos_sim=0.879]

  Quick eval (first example):
    Expected: 'Dane'
    Generated: 'Context: Tesla was the fourth of five children.'
    Norm ratio: 1.000 | Cosine: 0.809
  Avg norm ratio: 1.000 | Avg cosine: 0.824

  Step 100: Quick F1 = 28.8%

Epoch 1 complete:
  Avg loss: 0.2175
  Avg cosine similarity: 0.783
  Avg relative error: 0.729

Running full evaluation...

================================================================================
EVALUATION DIAGNOSTICS (Batched with size 32)
================================================================================
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:  25%|██▌       | 1/4 [00:00<00:02,  1.05it/s]Evaluating:  50%|█████     | 2/4 [00:01<00:01,  1.19it/s]Evaluating:  75%|███████▌  | 3/4 [00:02<00:00,  1.13it/s]Evaluating: 100%|██████████| 4/4 [00:03<00:00,  1.39it/s]Evaluating: 100%|██████████| 4/4 [00:03<00:00,  1.28it/s]

────────────────────────────────────────────────────────────────────────────────
Example 1:
  Question: Context: Tesla was the fourth of five children. He had an older brother named Da...
  Expected: 'Dane'
  Generated: 'Context: Tesla was the fourth of five children. He had an older brother named Dane and three sisters'

  Embedding diagnostics:
    Original norm:  0.31
    Reconstructed norm: 0.31
    Ratio: 1.000 (OK)
    Cosine similarity: 0.820

  Token-level reconstruction (first example only):
    Original tokens:  <|begin_of_text|>Context: Tesla was the fourth of five children. He had an older brother named Dane and three sisters, Milka, Angelina and Marica. Dan...
    Reconstructed →:  <|begin_of_text|>Context: Tesla was the fourth of five children. He had an older brother named Dane and three sisters, Milka, Angelina and Marica. Dan...

────────────────────────────────────────────────────────────────────────────────
Example 2:
  Question: Context: Islamists have asked the question, "If Islam is a way of life, how can ...
  Expected: 'Muslims'
  Generated: 'A) Islamism
B) Islam
C) Political Islam
D) Islamists'

  Embedding diagnostics:
    Original norm:  0.36
    Reconstructed norm: 0.36
    Ratio: 1.000 (OK)
    Cosine similarity: 0.852

────────────────────────────────────────────────────────────────────────────────
Example 3:
  Question: Context: The concept environmental determinism served as a moral justification f...
  Expected: 'orientalism and tropicality'
  Generated: 'A) Orientalism and tropicality
B) Colonialism and imperialism
C) Racism'

  Embedding diagnostics:
    Original norm:  0.31
    Reconstructed norm: 0.31
    Ratio: 1.000 (OK)
    Cosine similarity: 0.859

================================================================================
  F1: 0.221
  EM: 0.000
  → New best F1! Saved checkpoint
Epoch 2/3:   0%|          | 0/156 [00:00<?, ?it/s]Epoch 2/3:   0%|          | 0/156 [00:00<?, ?it/s, loss=0.1191, cos_sim=0.883]Epoch 2/3:   0%|          | 0/156 [00:00<?, ?it/s, loss=0.1172, cos_sim=0.883]Epoch 2/3:   0%|          | 0/156 [00:00<?, ?it/s, loss=0.1177, cos_sim=0.883]Epoch 2/3:   2%|▏         | 3/156 [00:00<00:06, 22.64it/s, loss=0.1177, cos_sim=0.883]Epoch 2/3:   2%|▏         | 3/156 [00:00<00:06, 22.64it/s, loss=0.1171, cos_sim=0.883]Epoch 2/3:   2%|▏         | 3/156 [00:00<00:06, 22.64it/s, loss=0.1114, cos_sim=0.891]Epoch 2/3:   2%|▏         | 3/156 [00:00<00:06, 22.64it/s, loss=0.1177, cos_sim=0.883]Epoch 2/3:   4%|▍         | 6/156 [00:00<00:10, 14.18it/s, loss=0.1177, cos_sim=0.883]Epoch 2/3:   4%|▍         | 6/156 [00:00<00:10, 14.18it/s, loss=0.1195, cos_sim=0.883]Epoch 2/3:   4%|▍         | 6/156 [00:00<00:10, 14.18it/s, loss=0.1134, cos_sim=0.887]Epoch 2/3:   4%|▍         | 6/156 [00:00<00:10, 14.18it/s, loss=0.1190, cos_sim=0.883]Epoch 2/3:   6%|▌         | 9/156 [00:00<00:09, 14.75it/s, loss=0.1190, cos_sim=0.883]Epoch 2/3:   6%|▌         | 9/156 [00:00<00:09, 14.75it/s, loss=0.1142, cos_sim=0.887]Epoch 2/3:   6%|▌         | 9/156 [00:00<00:09, 14.75it/s, loss=0.1139, cos_sim=0.887]Epoch 2/3:   6%|▌         | 9/156 [00:00<00:09, 14.75it/s, loss=0.1122, cos_sim=0.887]Epoch 2/3:   8%|▊         | 12/156 [00:00<00:09, 15.02it/s, loss=0.1122, cos_sim=0.887]Epoch 2/3:   8%|▊         | 12/156 [00:00<00:09, 15.02it/s, loss=0.1171, cos_sim=0.883]Epoch 2/3:   8%|▊         | 12/156 [00:00<00:09, 15.02it/s, loss=0.1185, cos_sim=0.883]Epoch 2/3:   8%|▊         | 12/156 [00:00<00:09, 15.02it/s, loss=0.1208, cos_sim=0.879]Epoch 2/3:  10%|▉         | 15/156 [00:00<00:09, 15.10it/s, loss=0.1208, cos_sim=0.879]Epoch 2/3:  10%|▉         | 15/156 [00:01<00:09, 15.10it/s, loss=0.1175, cos_sim=0.883]Epoch 2/3:  10%|▉         | 15/156 [00:01<00:09, 15.10it/s, loss=0.1138, cos_sim=0.887]Epoch 2/3:  10%|▉         | 15/156 [00:01<00:09, 15.10it/s, loss=0.1187, cos_sim=0.883]Epoch 2/3:  12%|█▏        | 18/156 [00:01<00:07, 17.32it/s, loss=0.1187, cos_sim=0.883]Epoch 2/3:  12%|█▏        | 18/156 [00:01<00:07, 17.32it/s, loss=0.1165, cos_sim=0.883]Epoch 2/3:  12%|█▏        | 18/156 [00:01<00:07, 17.32it/s, loss=0.1127, cos_sim=0.887]Epoch 2/3:  12%|█▏        | 18/156 [00:01<00:07, 17.32it/s, loss=0.1104, cos_sim=0.891]Epoch 2/3:  13%|█▎        | 21/156 [00:01<00:07, 18.72it/s, loss=0.1104, cos_sim=0.891]Epoch 2/3:  13%|█▎        | 21/156 [00:01<00:07, 18.72it/s, loss=0.1145, cos_sim=0.887]Epoch 2/3:  13%|█▎        | 21/156 [00:01<00:07, 18.72it/s, loss=0.1175, cos_sim=0.883]Epoch 2/3:  13%|█▎        | 21/156 [00:01<00:07, 18.72it/s, loss=0.1146, cos_sim=0.887]Epoch 2/3:  15%|█▌        | 24/156 [00:01<00:06, 20.03it/s, loss=0.1146, cos_sim=0.887]Epoch 2/3:  15%|█▌        | 24/156 [00:01<00:06, 20.03it/s, loss=0.1114, cos_sim=0.891]Epoch 2/3:  15%|█▌        | 24/156 [00:01<00:06, 20.03it/s, loss=0.1091, cos_sim=0.891]Epoch 2/3:  15%|█▌        | 24/156 [00:01<00:06, 20.03it/s, loss=0.1147, cos_sim=0.887]Epoch 2/3:  17%|█▋        | 27/156 [00:01<00:06, 21.14it/s, loss=0.1147, cos_sim=0.887]Epoch 2/3:  17%|█▋        | 27/156 [00:01<00:06, 21.14it/s, loss=0.1151, cos_sim=0.887]Epoch 2/3:  17%|█▋        | 27/156 [00:01<00:06, 21.14it/s, loss=0.1150, cos_sim=0.887]Epoch 2/3:  17%|█▋        | 27/156 [00:01<00:06, 21.14it/s, loss=0.1126, cos_sim=0.887]Epoch 2/3:  19%|█▉        | 30/156 [00:01<00:05, 21.82it/s, loss=0.1126, cos_sim=0.887]Epoch 2/3:  19%|█▉        | 30/156 [00:01<00:05, 21.82it/s, loss=0.1151, cos_sim=0.887]Epoch 2/3:  19%|█▉        | 30/156 [00:01<00:05, 21.82it/s, loss=0.1109, cos_sim=0.891]Epoch 2/3:  19%|█▉        | 30/156 [00:01<00:05, 21.82it/s, loss=0.1174, cos_sim=0.883]Epoch 2/3:  21%|██        | 33/156 [00:01<00:05, 22.52it/s, loss=0.1174, cos_sim=0.883]Epoch 2/3:  21%|██        | 33/156 [00:01<00:05, 22.52it/s, loss=0.1129, cos_sim=0.887]Epoch 2/3:  21%|██        | 33/156 [00:01<00:05, 22.52it/s, loss=0.1098, cos_sim=0.891]Epoch 2/3:  21%|██        | 33/156 [00:01<00:05, 22.52it/s, loss=0.1095, cos_sim=0.891]Epoch 2/3:  23%|██▎       | 36/156 [00:01<00:05, 22.04it/s, loss=0.1095, cos_sim=0.891]Epoch 2/3:  23%|██▎       | 36/156 [00:01<00:05, 22.04it/s, loss=0.1151, cos_sim=0.887]Epoch 2/3:  23%|██▎       | 36/156 [00:01<00:05, 22.04it/s, loss=0.1123, cos_sim=0.887]Epoch 2/3:  23%|██▎       | 36/156 [00:02<00:05, 22.04it/s, loss=0.1158, cos_sim=0.887]Epoch 2/3:  25%|██▌       | 39/156 [00:02<00:05, 22.41it/s, loss=0.1158, cos_sim=0.887]Epoch 2/3:  25%|██▌       | 39/156 [00:02<00:05, 22.41it/s, loss=0.1111, cos_sim=0.891]Epoch 2/3:  25%|██▌       | 39/156 [00:02<00:05, 22.41it/s, loss=0.1113, cos_sim=0.891]Epoch 2/3:  25%|██▌       | 39/156 [00:02<00:05, 22.41it/s, loss=0.1105, cos_sim=0.891]Epoch 2/3:  27%|██▋       | 42/156 [00:02<00:04, 22.90it/s, loss=0.1105, cos_sim=0.891]Epoch 2/3:  27%|██▋       | 42/156 [00:02<00:04, 22.90it/s, loss=0.1181, cos_sim=0.883]Epoch 2/3:  27%|██▋       | 42/156 [00:02<00:04, 22.90it/s, loss=0.1107, cos_sim=0.891]Epoch 2/3:  27%|██▋       | 42/156 [00:02<00:04, 22.90it/s, loss=0.1079, cos_sim=0.895]Epoch 2/3:  29%|██▉       | 45/156 [00:02<00:11,  9.87it/s, loss=0.1079, cos_sim=0.895]Epoch 2/3:  29%|██▉       | 45/156 [00:02<00:11,  9.87it/s, loss=0.1195, cos_sim=0.883]Epoch 2/3:  29%|██▉       | 45/156 [00:02<00:11,  9.87it/s, loss=0.1181, cos_sim=0.883]Epoch 2/3:  29%|██▉       | 45/156 [00:02<00:11,  9.87it/s, loss=0.1099, cos_sim=0.891]Epoch 2/3:  31%|███       | 48/156 [00:02<00:09, 11.89it/s, loss=0.1099, cos_sim=0.891]Epoch 2/3:  31%|███       | 48/156 [00:03<00:09, 11.89it/s, loss=0.1140, cos_sim=0.887]Epoch 2/3:  31%|███       | 48/156 [00:03<00:09, 11.89it/s, loss=0.1114, cos_sim=0.891]Epoch 2/3:  31%|███       | 48/156 [00:03<00:09, 11.89it/s, loss=0.1141, cos_sim=0.887]Epoch 2/3:  33%|███▎      | 51/156 [00:03<00:07, 14.00it/s, loss=0.1141, cos_sim=0.887]Epoch 2/3:  33%|███▎      | 51/156 [00:03<00:07, 14.00it/s, loss=0.1128, cos_sim=0.887]Epoch 2/3:  33%|███▎      | 51/156 [00:03<00:07, 14.00it/s, loss=0.1138, cos_sim=0.887]Epoch 2/3:  33%|███▎      | 51/156 [00:03<00:07, 14.00it/s, loss=0.1104, cos_sim=0.891]Epoch 2/3:  35%|███▍      | 54/156 [00:03<00:06, 16.08it/s, loss=0.1104, cos_sim=0.891]Epoch 2/3:  35%|███▍      | 54/156 [00:03<00:06, 16.08it/s, loss=0.1108, cos_sim=0.891]Epoch 2/3:  35%|███▍      | 54/156 [00:03<00:06, 16.08it/s, loss=0.1146, cos_sim=0.887]Epoch 2/3:  35%|███▍      | 54/156 [00:03<00:06, 16.08it/s, loss=0.1097, cos_sim=0.891]Epoch 2/3:  37%|███▋      | 57/156 [00:03<00:05, 17.89it/s, loss=0.1097, cos_sim=0.891]Epoch 2/3:  37%|███▋      | 57/156 [00:03<00:05, 17.89it/s, loss=0.1148, cos_sim=0.887]Epoch 2/3:  37%|███▋      | 57/156 [00:03<00:05, 17.89it/s, loss=0.1118, cos_sim=0.891]Epoch 2/3:  37%|███▋      | 57/156 [00:03<00:05, 17.89it/s, loss=0.1087, cos_sim=0.891]Epoch 2/3:  38%|███▊      | 60/156 [00:03<00:04, 19.34it/s, loss=0.1087, cos_sim=0.891]Epoch 2/3:  38%|███▊      | 60/156 [00:03<00:04, 19.34it/s, loss=0.1098, cos_sim=0.891]Epoch 2/3:  38%|███▊      | 60/156 [00:03<00:04, 19.34it/s, loss=0.1121, cos_sim=0.891]Epoch 2/3:  38%|███▊      | 60/156 [00:03<00:04, 19.34it/s, loss=0.1144, cos_sim=0.887]Epoch 2/3:  40%|████      | 63/156 [00:03<00:04, 20.54it/s, loss=0.1144, cos_sim=0.887]Epoch 2/3:  40%|████      | 63/156 [00:03<00:04, 20.54it/s, loss=0.1119, cos_sim=0.891]Epoch 2/3:  40%|████      | 63/156 [00:03<00:04, 20.54it/s, loss=0.1108, cos_sim=0.891]Epoch 2/3:  40%|████      | 63/156 [00:03<00:04, 20.54it/s, loss=0.1128, cos_sim=0.887]Epoch 2/3:  42%|████▏     | 66/156 [00:03<00:04, 21.20it/s, loss=0.1128, cos_sim=0.887]Epoch 2/3:  42%|████▏     | 66/156 [00:03<00:04, 21.20it/s, loss=0.1111, cos_sim=0.891]Epoch 2/3:  42%|████▏     | 66/156 [00:03<00:04, 21.20it/s, loss=0.1135, cos_sim=0.887]Epoch 2/3:  42%|████▏     | 66/156 [00:03<00:04, 21.20it/s, loss=0.1070, cos_sim=0.895]Epoch 2/3:  44%|████▍     | 69/156 [00:03<00:03, 22.01it/s, loss=0.1070, cos_sim=0.895]Epoch 2/3:  44%|████▍     | 69/156 [00:03<00:03, 22.01it/s, loss=0.1118, cos_sim=0.891]Epoch 2/3:  44%|████▍     | 69/156 [00:03<00:03, 22.01it/s, loss=0.1088, cos_sim=0.891]Epoch 2/3:  44%|████▍     | 69/156 [00:03<00:03, 22.01it/s, loss=0.1086, cos_sim=0.891]Epoch 2/3:  46%|████▌     | 72/156 [00:03<00:03, 22.56it/s, loss=0.1086, cos_sim=0.891]Epoch 2/3:  46%|████▌     | 72/156 [00:04<00:03, 22.56it/s, loss=0.1088, cos_sim=0.891]Epoch 2/3:  46%|████▌     | 72/156 [00:04<00:03, 22.56it/s, loss=0.1146, cos_sim=0.887]Epoch 2/3:  46%|████▌     | 72/156 [00:04<00:03, 22.56it/s, loss=0.1111, cos_sim=0.891]Epoch 2/3:  48%|████▊     | 75/156 [00:04<00:03, 20.42it/s, loss=0.1111, cos_sim=0.891]Epoch 2/3:  48%|████▊     | 75/156 [00:04<00:03, 20.42it/s, loss=0.1127, cos_sim=0.887]Epoch 2/3:  48%|████▊     | 75/156 [00:04<00:03, 20.42it/s, loss=0.1130, cos_sim=0.887]Epoch 2/3:  48%|████▊     | 75/156 [00:04<00:03, 20.42it/s, loss=0.1101, cos_sim=0.891]Epoch 2/3:  50%|█████     | 78/156 [00:04<00:04, 18.18it/s, loss=0.1101, cos_sim=0.891]Epoch 2/3:  50%|█████     | 78/156 [00:04<00:04, 18.18it/s, loss=0.1121, cos_sim=0.891]Epoch 2/3:  50%|█████     | 78/156 [00:04<00:04, 18.18it/s, loss=0.1109, cos_sim=0.891]Epoch 2/3:  51%|█████▏    | 80/156 [00:04<00:04, 16.75it/s, loss=0.1109, cos_sim=0.891]Epoch 2/3:  51%|█████▏    | 80/156 [00:04<00:04, 16.75it/s, loss=0.1119, cos_sim=0.891]Epoch 2/3:  51%|█████▏    | 80/156 [00:04<00:04, 16.75it/s, loss=0.1090, cos_sim=0.891]Epoch 2/3:  53%|█████▎    | 82/156 [00:04<00:04, 15.72it/s, loss=0.1090, cos_sim=0.891]Epoch 2/3:  53%|█████▎    | 82/156 [00:04<00:04, 15.72it/s, loss=0.1136, cos_sim=0.887]Epoch 2/3:  53%|█████▎    | 82/156 [00:04<00:04, 15.72it/s, loss=0.1129, cos_sim=0.887]Epoch 2/3:  54%|█████▍    | 84/156 [00:04<00:04, 14.98it/s, loss=0.1129, cos_sim=0.887]Epoch 2/3:  54%|█████▍    | 84/156 [00:04<00:04, 14.98it/s, loss=0.1105, cos_sim=0.891]Epoch 2/3:  54%|█████▍    | 84/156 [00:04<00:04, 14.98it/s, loss=0.1095, cos_sim=0.891]Epoch 2/3:  54%|█████▍    | 84/156 [00:04<00:04, 14.98it/s, loss=0.1149, cos_sim=0.887]Epoch 2/3:  56%|█████▌    | 87/156 [00:04<00:03, 17.30it/s, loss=0.1149, cos_sim=0.887]Epoch 2/3:  56%|█████▌    | 87/156 [00:04<00:03, 17.30it/s, loss=0.1098, cos_sim=0.891]Epoch 2/3:  56%|█████▌    | 87/156 [00:05<00:03, 17.30it/s, loss=0.1182, cos_sim=0.883]Epoch 2/3:  56%|█████▌    | 87/156 [00:05<00:03, 17.30it/s, loss=0.1146, cos_sim=0.887]Epoch 2/3:  58%|█████▊    | 90/156 [00:05<00:03, 18.81it/s, loss=0.1146, cos_sim=0.887]Epoch 2/3:  58%|█████▊    | 90/156 [00:05<00:03, 18.81it/s, loss=0.1121, cos_sim=0.891]Epoch 2/3:  58%|█████▊    | 90/156 [00:05<00:03, 18.81it/s, loss=0.1086, cos_sim=0.891]Epoch 2/3:  58%|█████▊    | 90/156 [00:05<00:03, 18.81it/s, loss=0.1107, cos_sim=0.891]Epoch 2/3:  60%|█████▉    | 93/156 [00:05<00:03, 20.17it/s, loss=0.1107, cos_sim=0.891]Epoch 2/3:  60%|█████▉    | 93/156 [00:05<00:03, 20.17it/s, loss=0.1092, cos_sim=0.891]Epoch 2/3:  60%|█████▉    | 93/156 [00:05<00:03, 20.17it/s, loss=0.1127, cos_sim=0.887]Epoch 2/3:  60%|█████▉    | 93/156 [00:05<00:03, 20.17it/s, loss=0.1101, cos_sim=0.891]Epoch 2/3:  62%|██████▏   | 96/156 [00:05<00:02, 21.22it/s, loss=0.1101, cos_sim=0.891]Epoch 2/3:  62%|██████▏   | 96/156 [00:05<00:02, 21.22it/s, loss=0.1115, cos_sim=0.891]Epoch 2/3:  62%|██████▏   | 96/156 [00:05<00:02, 21.22it/s, loss=0.1100, cos_sim=0.891]Epoch 2/3:  62%|██████▏   | 96/156 [00:05<00:02, 21.22it/s, loss=0.1128, cos_sim=0.887]Epoch 2/3:  63%|██████▎   | 99/156 [00:05<00:02, 22.01it/s, loss=0.1128, cos_sim=0.887]Epoch 2/3:  63%|██████▎   | 99/156 [00:05<00:02, 22.01it/s, loss=0.1112, cos_sim=0.891]Epoch 2/3:  63%|██████▎   | 99/156 [00:05<00:02, 22.01it/s, loss=0.1115, cos_sim=0.891]Epoch 2/3:  63%|██████▎   | 99/156 [00:05<00:02, 22.01it/s, loss=0.1081, cos_sim=0.895]Epoch 2/3:  65%|██████▌   | 102/156 [00:05<00:02, 22.59it/s, loss=0.1081, cos_sim=0.895]Epoch 2/3:  65%|██████▌   | 102/156 [00:05<00:02, 22.59it/s, loss=0.1101, cos_sim=0.891]Epoch 2/3:  65%|██████▌   | 102/156 [00:05<00:02, 22.59it/s, loss=0.1085, cos_sim=0.891]Epoch 2/3:  65%|██████▌   | 102/156 [00:05<00:02, 22.59it/s, loss=0.1105, cos_sim=0.891]Epoch 2/3:  67%|██████▋   | 105/156 [00:05<00:02, 23.00it/s, loss=0.1105, cos_sim=0.891]Epoch 2/3:  67%|██████▋   | 105/156 [00:05<00:02, 23.00it/s, loss=0.1138, cos_sim=0.887]Epoch 2/3:  67%|██████▋   | 105/156 [00:05<00:02, 23.00it/s, loss=0.1094, cos_sim=0.891]Epoch 2/3:  67%|██████▋   | 105/156 [00:05<00:02, 23.00it/s, loss=0.1076, cos_sim=0.895]Epoch 2/3:  69%|██████▉   | 108/156 [00:05<00:02, 23.22it/s, loss=0.1076, cos_sim=0.895]Epoch 2/3:  69%|██████▉   | 108/156 [00:05<00:02, 23.22it/s, loss=0.1150, cos_sim=0.887]Epoch 2/3:  69%|██████▉   | 108/156 [00:05<00:02, 23.22it/s, loss=0.1126, cos_sim=0.887]Epoch 2/3:  69%|██████▉   | 108/156 [00:05<00:02, 23.22it/s, loss=0.1143, cos_sim=0.887]Epoch 2/3:  71%|███████   | 111/156 [00:05<00:01, 23.47it/s, loss=0.1143, cos_sim=0.887]Epoch 2/3:  71%|███████   | 111/156 [00:05<00:01, 23.47it/s, loss=0.1061, cos_sim=0.895]Epoch 2/3:  71%|███████   | 111/156 [00:06<00:01, 23.47it/s, loss=0.1101, cos_sim=0.891]Epoch 2/3:  71%|███████   | 111/156 [00:06<00:01, 23.47it/s, loss=0.1118, cos_sim=0.891]Epoch 2/3:  73%|███████▎  | 114/156 [00:06<00:01, 23.04it/s, loss=0.1118, cos_sim=0.891]Epoch 2/3:  73%|███████▎  | 114/156 [00:06<00:01, 23.04it/s, loss=0.1136, cos_sim=0.887]Epoch 2/3:  73%|███████▎  | 114/156 [00:06<00:01, 23.04it/s, loss=0.1109, cos_sim=0.891]Epoch 2/3:  73%|███████▎  | 114/156 [00:06<00:01, 23.04it/s, loss=0.1057, cos_sim=0.895]Epoch 2/3:  75%|███████▌  | 117/156 [00:06<00:02, 18.03it/s, loss=0.1057, cos_sim=0.895]Epoch 2/3:  75%|███████▌  | 117/156 [00:06<00:02, 18.03it/s, loss=0.1083, cos_sim=0.895]Epoch 2/3:  75%|███████▌  | 117/156 [00:06<00:02, 18.03it/s, loss=0.1066, cos_sim=0.895]Epoch 2/3:  75%|███████▌  | 117/156 [00:06<00:02, 18.03it/s, loss=0.1135, cos_sim=0.887]Epoch 2/3:  77%|███████▋  | 120/156 [00:06<00:02, 16.99it/s, loss=0.1135, cos_sim=0.887]Epoch 2/3:  77%|███████▋  | 120/156 [00:06<00:02, 16.99it/s, loss=0.1131, cos_sim=0.887]Epoch 2/3:  77%|███████▋  | 120/156 [00:06<00:02, 16.99it/s, loss=0.1078, cos_sim=0.895]Epoch 2/3:  77%|███████▋  | 120/156 [00:06<00:02, 16.99it/s, loss=0.1083, cos_sim=0.895]Epoch 2/3:  79%|███████▉  | 123/156 [00:06<00:02, 16.48it/s, loss=0.1083, cos_sim=0.895]Epoch 2/3:  79%|███████▉  | 123/156 [00:06<00:02, 16.48it/s, loss=0.1110, cos_sim=0.891]Epoch 2/3:  79%|███████▉  | 123/156 [00:06<00:02, 16.48it/s, loss=0.1102, cos_sim=0.891]Epoch 2/3:  80%|████████  | 125/156 [00:06<00:01, 15.59it/s, loss=0.1102, cos_sim=0.891]Epoch 2/3:  80%|████████  | 125/156 [00:06<00:01, 15.59it/s, loss=0.1132, cos_sim=0.887]Epoch 2/3:  80%|████████  | 125/156 [00:06<00:01, 15.59it/s, loss=0.1073, cos_sim=0.895]Epoch 2/3:  80%|████████  | 125/156 [00:07<00:01, 15.59it/s, loss=0.1102, cos_sim=0.891]Epoch 2/3:  82%|████████▏ | 128/156 [00:07<00:01, 17.65it/s, loss=0.1102, cos_sim=0.891]Epoch 2/3:  82%|████████▏ | 128/156 [00:07<00:01, 17.65it/s, loss=0.1119, cos_sim=0.891]Epoch 2/3:  82%|████████▏ | 128/156 [00:07<00:01, 17.65it/s, loss=0.1068, cos_sim=0.895]Epoch 2/3:  82%|████████▏ | 128/156 [00:07<00:01, 17.65it/s, loss=0.1072, cos_sim=0.895]Epoch 2/3:  84%|████████▍ | 131/156 [00:07<00:01, 18.81it/s, loss=0.1072, cos_sim=0.895]Epoch 2/3:  84%|████████▍ | 131/156 [00:07<00:01, 18.81it/s, loss=0.1117, cos_sim=0.891]Epoch 2/3:  84%|████████▍ | 131/156 [00:07<00:01, 18.81it/s, loss=0.1085, cos_sim=0.891]Epoch 2/3:  85%|████████▌ | 133/156 [00:07<00:01, 17.80it/s, loss=0.1085, cos_sim=0.891]Epoch 2/3:  85%|████████▌ | 133/156 [00:07<00:01, 17.80it/s, loss=0.1099, cos_sim=0.891]Epoch 2/3:  85%|████████▌ | 133/156 [00:07<00:01, 17.80it/s, loss=0.1127, cos_sim=0.887]Epoch 2/3:  87%|████████▋ | 135/156 [00:07<00:01, 17.04it/s, loss=0.1127, cos_sim=0.887]Epoch 2/3:  87%|████████▋ | 135/156 [00:07<00:01, 17.04it/s, loss=0.1096, cos_sim=0.891]Epoch 2/3:  87%|████████▋ | 135/156 [00:07<00:01, 17.04it/s, loss=0.1115, cos_sim=0.891]Epoch 2/3:  87%|████████▋ | 135/156 [00:07<00:01, 17.04it/s, loss=0.1104, cos_sim=0.891]Epoch 2/3:  88%|████████▊ | 138/156 [00:07<00:00, 18.58it/s, loss=0.1104, cos_sim=0.891]Epoch 2/3:  88%|████████▊ | 138/156 [00:07<00:00, 18.58it/s, loss=0.1091, cos_sim=0.891]Epoch 2/3:  88%|████████▊ | 138/156 [00:07<00:00, 18.58it/s, loss=0.1101, cos_sim=0.891]Epoch 2/3:  88%|████████▊ | 138/156 [00:07<00:00, 18.58it/s, loss=0.1073, cos_sim=0.895]Epoch 2/3:  90%|█████████ | 141/156 [00:07<00:00, 20.23it/s, loss=0.1073, cos_sim=0.895]Epoch 2/3:  90%|█████████ | 141/156 [00:07<00:00, 20.23it/s, loss=0.1074, cos_sim=0.895]Epoch 2/3:  90%|█████████ | 141/156 [00:07<00:00, 20.23it/s, loss=0.1038, cos_sim=0.898]Epoch 2/3:  90%|█████████ | 141/156 [00:07<00:00, 20.23it/s, loss=0.1092, cos_sim=0.891]Epoch 2/3:  92%|█████████▏| 144/156 [00:08<00:00, 13.17it/s, loss=0.1092, cos_sim=0.891]Epoch 2/3:  92%|█████████▏| 144/156 [00:08<00:00, 13.17it/s, loss=0.1101, cos_sim=0.891]Epoch 2/3:  92%|█████████▏| 144/156 [00:08<00:00, 13.17it/s, loss=0.1046, cos_sim=0.895]Epoch 2/3:  94%|█████████▎| 146/156 [00:08<00:00, 13.62it/s, loss=0.1046, cos_sim=0.895]Epoch 2/3:  94%|█████████▎| 146/156 [00:08<00:00, 13.62it/s, loss=0.1084, cos_sim=0.891]Epoch 2/3:  94%|█████████▎| 146/156 [00:08<00:00, 13.62it/s, loss=0.1105, cos_sim=0.891]Epoch 2/3:  95%|█████████▍| 148/156 [00:08<00:00, 12.58it/s, loss=0.1105, cos_sim=0.891]Epoch 2/3:  95%|█████████▍| 148/156 [00:08<00:00, 12.58it/s, loss=0.1105, cos_sim=0.891]Epoch 2/3:  95%|█████████▍| 148/156 [00:08<00:00, 12.58it/s, loss=0.1094, cos_sim=0.891]Epoch 2/3:  95%|█████████▍| 148/156 [00:08<00:00, 12.58it/s, loss=0.1075, cos_sim=0.895]Epoch 2/3:  97%|█████████▋| 151/156 [00:08<00:00, 13.47it/s, loss=0.1075, cos_sim=0.895]Epoch 2/3:  97%|█████████▋| 151/156 [00:08<00:00, 13.47it/s, loss=0.1091, cos_sim=0.891]Epoch 2/3:  97%|█████████▋| 151/156 [00:08<00:00, 13.47it/s, loss=0.1077, cos_sim=0.895]Epoch 2/3:  97%|█████████▋| 151/156 [00:08<00:00, 13.47it/s, loss=0.1048, cos_sim=0.895]Epoch 2/3:  99%|█████████▊| 154/156 [00:08<00:00, 12.80it/s, loss=0.1048, cos_sim=0.895]Epoch 2/3:  99%|█████████▊| 154/156 [00:08<00:00, 12.80it/s, loss=0.1078, cos_sim=0.895]Epoch 2/3:  99%|█████████▊| 154/156 [00:08<00:00, 12.80it/s, loss=0.1112, cos_sim=0.891]Epoch 2/3: 100%|██████████| 156/156 [00:08<00:00, 17.47it/s, loss=0.1112, cos_sim=0.891]

  Quick eval (first example):
    Expected: 'Dane'
    Generated: 'Explanation: Dane. Tesla's brother was named'
    Norm ratio: 1.000 | Cosine: 0.824
  Avg norm ratio: 1.000 | Avg cosine: 0.842

  Step 200: Quick F1 = 35.6%

  Quick eval (first example):
    Expected: 'Dane'
    Generated: ': Dane.  Dane was killed in a horse'
    Norm ratio: 1.000 | Cosine: 0.828
  Avg norm ratio: 1.000 | Avg cosine: 0.847

  Step 300: Quick F1 = 38.0%

Epoch 2 complete:
  Avg loss: 0.1118
  Avg cosine similarity: 0.889
  Avg relative error: 0.567

Running full evaluation...

================================================================================
EVALUATION DIAGNOSTICS (Batched with size 32)
================================================================================
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:  25%|██▌       | 1/4 [00:00<00:02,  1.36it/s]Evaluating:  50%|█████     | 2/4 [00:01<00:01,  1.07it/s]Evaluating:  75%|███████▌  | 3/4 [00:02<00:00,  1.19it/s]Evaluating: 100%|██████████| 4/4 [00:03<00:00,  1.32it/s]Evaluating: 100%|██████████| 4/4 [00:03<00:00,  1.26it/s]

────────────────────────────────────────────────────────────────────────────────
Example 1:
  Question: Context: Tesla was the fourth of five children. He had an older brother named Da...
  Expected: 'Dane'
  Generated: ': Dane.  Dane was killed in a horse-riding accident when Nikola was five.  Tesla'

  Embedding diagnostics:
    Original norm:  0.31
    Reconstructed norm: 0.31
    Ratio: 1.000 (OK)
    Cosine similarity: 0.828

  Token-level reconstruction (first example only):
    Original tokens:  <|begin_of_text|>Context: Tesla was the fourth of five children. He had an older brother named Dane and three sisters, Milka, Angelina and Marica. Dan...
    Reconstructed →:  <|begin_of_text|>Context: Tesla was the fourth of five children. He had an older brother named Dane and three sisters, Milka, Angelina and Marica. Dan...

────────────────────────────────────────────────────────────────────────────────
Example 2:
  Question: Context: Islamists have asked the question, "If Islam is a way of life, how can ...
  Expected: 'Muslims'
  Generated: 'A) Islamism
B) Islam
C) Political Islam
D) Islamists'

  Embedding diagnostics:
    Original norm:  0.36
    Reconstructed norm: 0.36
    Ratio: 1.000 (OK)
    Cosine similarity: 0.863

────────────────────────────────────────────────────────────────────────────────
Example 3:
  Question: Context: The concept environmental determinism served as a moral justification f...
  Expected: 'orientalism and tropicality'
  Generated: 'A) Orientalism and tropicality
B) Colonialism and imperialism
C) Environmentalism'

  Embedding diagnostics:
    Original norm:  0.31
    Reconstructed norm: 0.31
    Ratio: 1.000 (OK)
    Cosine similarity: 0.863

================================================================================
  F1: 0.240
  EM: 0.000
  → New best F1! Saved checkpoint
Epoch 3/3:   0%|          | 0/156 [00:00<?, ?it/s]Epoch 3/3:   0%|          | 0/156 [00:00<?, ?it/s, loss=0.1057, cos_sim=0.895]Epoch 3/3:   0%|          | 0/156 [00:00<?, ?it/s, loss=0.1074, cos_sim=0.895]Epoch 3/3:   0%|          | 0/156 [00:00<?, ?it/s, loss=0.1073, cos_sim=0.895]Epoch 3/3:   2%|▏         | 3/156 [00:00<00:06, 22.67it/s, loss=0.1073, cos_sim=0.895]Epoch 3/3:   2%|▏         | 3/156 [00:00<00:06, 22.67it/s, loss=0.1052, cos_sim=0.895]Epoch 3/3:   2%|▏         | 3/156 [00:00<00:06, 22.67it/s, loss=0.1146, cos_sim=0.887]Epoch 3/3:   2%|▏         | 3/156 [00:00<00:06, 22.67it/s, loss=0.1061, cos_sim=0.895]Epoch 3/3:   4%|▍         | 6/156 [00:00<00:06, 23.05it/s, loss=0.1061, cos_sim=0.895]Epoch 3/3:   4%|▍         | 6/156 [00:00<00:06, 23.05it/s, loss=0.1064, cos_sim=0.895]Epoch 3/3:   4%|▍         | 6/156 [00:00<00:06, 23.05it/s, loss=0.1065, cos_sim=0.895]Epoch 3/3:   4%|▍         | 6/156 [00:00<00:06, 23.05it/s, loss=0.1054, cos_sim=0.895]Epoch 3/3:   6%|▌         | 9/156 [00:00<00:06, 23.58it/s, loss=0.1054, cos_sim=0.895]Epoch 3/3:   6%|▌         | 9/156 [00:00<00:06, 23.58it/s, loss=0.1075, cos_sim=0.895]Epoch 3/3:   6%|▌         | 9/156 [00:00<00:06, 23.58it/s, loss=0.1044, cos_sim=0.898]Epoch 3/3:   6%|▌         | 9/156 [00:00<00:06, 23.58it/s, loss=0.1084, cos_sim=0.891]Epoch 3/3:   8%|▊         | 12/156 [00:00<00:06, 23.96it/s, loss=0.1084, cos_sim=0.891]Epoch 3/3:   8%|▊         | 12/156 [00:00<00:06, 23.96it/s, loss=0.1094, cos_sim=0.891]Epoch 3/3:   8%|▊         | 12/156 [00:00<00:06, 23.96it/s, loss=0.1086, cos_sim=0.891]Epoch 3/3:   8%|▊         | 12/156 [00:00<00:06, 23.96it/s, loss=0.1043, cos_sim=0.898]Epoch 3/3:  10%|▉         | 15/156 [00:00<00:05, 24.13it/s, loss=0.1043, cos_sim=0.898]Epoch 3/3:  10%|▉         | 15/156 [00:00<00:05, 24.13it/s, loss=0.1103, cos_sim=0.891]Epoch 3/3:  10%|▉         | 15/156 [00:00<00:05, 24.13it/s, loss=0.1060, cos_sim=0.895]Epoch 3/3:  10%|▉         | 15/156 [00:00<00:05, 24.13it/s, loss=0.1082, cos_sim=0.895]Epoch 3/3:  12%|█▏        | 18/156 [00:00<00:05, 23.83it/s, loss=0.1082, cos_sim=0.895]Epoch 3/3:  12%|█▏        | 18/156 [00:00<00:05, 23.83it/s, loss=0.1096, cos_sim=0.891]Epoch 3/3:  12%|█▏        | 18/156 [00:00<00:05, 23.83it/s, loss=0.1047, cos_sim=0.895]Epoch 3/3:  12%|█▏        | 18/156 [00:00<00:05, 23.83it/s, loss=0.1084, cos_sim=0.891]Epoch 3/3:  13%|█▎        | 21/156 [00:00<00:05, 24.12it/s, loss=0.1084, cos_sim=0.891]Epoch 3/3:  13%|█▎        | 21/156 [00:00<00:05, 24.12it/s, loss=0.1116, cos_sim=0.891]Epoch 3/3:  13%|█▎        | 21/156 [00:00<00:05, 24.12it/s, loss=0.1053, cos_sim=0.895]Epoch 3/3:  13%|█▎        | 21/156 [00:01<00:05, 24.12it/s, loss=0.1038, cos_sim=0.898]Epoch 3/3:  15%|█▌        | 24/156 [00:01<00:05, 23.45it/s, loss=0.1038, cos_sim=0.898]Epoch 3/3:  15%|█▌        | 24/156 [00:01<00:05, 23.45it/s, loss=0.1113, cos_sim=0.891]Epoch 3/3:  15%|█▌        | 24/156 [00:01<00:05, 23.45it/s, loss=0.1111, cos_sim=0.891]Epoch 3/3:  15%|█▌        | 24/156 [00:01<00:05, 23.45it/s, loss=0.1074, cos_sim=0.895]Epoch 3/3:  17%|█▋        | 27/156 [00:01<00:05, 22.09it/s, loss=0.1074, cos_sim=0.895]Epoch 3/3:  17%|█▋        | 27/156 [00:01<00:05, 22.09it/s, loss=0.1066, cos_sim=0.895]Epoch 3/3:  17%|█▋        | 27/156 [00:01<00:05, 22.09it/s, loss=0.1081, cos_sim=0.895]Epoch 3/3:  17%|█▋        | 27/156 [00:01<00:05, 22.09it/s, loss=0.1016, cos_sim=0.898]Epoch 3/3:  19%|█▉        | 30/156 [00:01<00:07, 16.23it/s, loss=0.1016, cos_sim=0.898]Epoch 3/3:  19%|█▉        | 30/156 [00:01<00:07, 16.23it/s, loss=0.1086, cos_sim=0.891]Epoch 3/3:  19%|█▉        | 30/156 [00:01<00:07, 16.23it/s, loss=0.1079, cos_sim=0.895]Epoch 3/3:  21%|██        | 32/156 [00:01<00:08, 15.45it/s, loss=0.1079, cos_sim=0.895]Epoch 3/3:  21%|██        | 32/156 [00:01<00:08, 15.45it/s, loss=0.1086, cos_sim=0.891]Epoch 3/3:  21%|██        | 32/156 [00:01<00:08, 15.45it/s, loss=0.1080, cos_sim=0.895]Epoch 3/3:  21%|██        | 32/156 [00:01<00:08, 15.45it/s, loss=0.1025, cos_sim=0.898]Epoch 3/3:  22%|██▏       | 35/156 [00:01<00:07, 15.47it/s, loss=0.1025, cos_sim=0.898]Epoch 3/3:  22%|██▏       | 35/156 [00:01<00:07, 15.47it/s, loss=0.1098, cos_sim=0.891]Epoch 3/3:  22%|██▏       | 35/156 [00:01<00:07, 15.47it/s, loss=0.1090, cos_sim=0.891]Epoch 3/3:  22%|██▏       | 35/156 [00:01<00:07, 15.47it/s, loss=0.1086, cos_sim=0.891]Epoch 3/3:  24%|██▍       | 38/156 [00:01<00:06, 17.18it/s, loss=0.1086, cos_sim=0.891]Epoch 3/3:  24%|██▍       | 38/156 [00:01<00:06, 17.18it/s, loss=0.1027, cos_sim=0.898]Epoch 3/3:  24%|██▍       | 38/156 [00:02<00:06, 17.18it/s, loss=0.1074, cos_sim=0.895]Epoch 3/3:  24%|██▍       | 38/156 [00:02<00:06, 17.18it/s, loss=0.1096, cos_sim=0.891]Epoch 3/3:  26%|██▋       | 41/156 [00:02<00:06, 18.91it/s, loss=0.1096, cos_sim=0.891]Epoch 3/3:  26%|██▋       | 41/156 [00:02<00:06, 18.91it/s, loss=0.1089, cos_sim=0.891]Epoch 3/3:  26%|██▋       | 41/156 [00:02<00:06, 18.91it/s, loss=0.1077, cos_sim=0.895]Epoch 3/3:  26%|██▋       | 41/156 [00:02<00:06, 18.91it/s, loss=0.1080, cos_sim=0.895]Epoch 3/3:  28%|██▊       | 44/156 [00:02<00:05, 20.22it/s, loss=0.1080, cos_sim=0.895]Epoch 3/3:  28%|██▊       | 44/156 [00:02<00:05, 20.22it/s, loss=0.1086, cos_sim=0.891]Epoch 3/3:  28%|██▊       | 44/156 [00:02<00:05, 20.22it/s, loss=0.1035, cos_sim=0.898]Epoch 3/3:  28%|██▊       | 44/156 [00:02<00:05, 20.22it/s, loss=0.1074, cos_sim=0.895]Epoch 3/3:  30%|███       | 47/156 [00:02<00:05, 21.26it/s, loss=0.1074, cos_sim=0.895]Epoch 3/3:  30%|███       | 47/156 [00:02<00:05, 21.26it/s, loss=0.1082, cos_sim=0.895]Epoch 3/3:  30%|███       | 47/156 [00:02<00:05, 21.26it/s, loss=0.1086, cos_sim=0.891]Epoch 3/3:  30%|███       | 47/156 [00:02<00:05, 21.26it/s, loss=0.1082, cos_sim=0.895]Epoch 3/3:  32%|███▏      | 50/156 [00:02<00:04, 22.01it/s, loss=0.1082, cos_sim=0.895]Epoch 3/3:  32%|███▏      | 50/156 [00:02<00:04, 22.01it/s, loss=0.1081, cos_sim=0.895]Epoch 3/3:  32%|███▏      | 50/156 [00:02<00:04, 22.01it/s, loss=0.1077, cos_sim=0.895]Epoch 3/3:  32%|███▏      | 50/156 [00:02<00:04, 22.01it/s, loss=0.1105, cos_sim=0.891]Epoch 3/3:  34%|███▍      | 53/156 [00:02<00:04, 22.66it/s, loss=0.1105, cos_sim=0.891]Epoch 3/3:  34%|███▍      | 53/156 [00:02<00:04, 22.66it/s, loss=0.1135, cos_sim=0.887]Epoch 3/3:  34%|███▍      | 53/156 [00:02<00:04, 22.66it/s, loss=0.1082, cos_sim=0.895]Epoch 3/3:  34%|███▍      | 53/156 [00:02<00:04, 22.66it/s, loss=0.1073, cos_sim=0.895]Epoch 3/3:  36%|███▌      | 56/156 [00:02<00:04, 23.07it/s, loss=0.1073, cos_sim=0.895]Epoch 3/3:  36%|███▌      | 56/156 [00:02<00:04, 23.07it/s, loss=0.1049, cos_sim=0.895]Epoch 3/3:  36%|███▌      | 56/156 [00:02<00:04, 23.07it/s, loss=0.1044, cos_sim=0.898]Epoch 3/3:  36%|███▌      | 56/156 [00:02<00:04, 23.07it/s, loss=0.1088, cos_sim=0.891]Epoch 3/3:  38%|███▊      | 59/156 [00:02<00:04, 23.24it/s, loss=0.1088, cos_sim=0.891]Epoch 3/3:  38%|███▊      | 59/156 [00:02<00:04, 23.24it/s, loss=0.1087, cos_sim=0.891]Epoch 3/3:  38%|███▊      | 59/156 [00:02<00:04, 23.24it/s, loss=0.1111, cos_sim=0.891]Epoch 3/3:  38%|███▊      | 59/156 [00:02<00:04, 23.24it/s, loss=0.1064, cos_sim=0.895]Epoch 3/3:  40%|███▉      | 62/156 [00:02<00:04, 23.17it/s, loss=0.1064, cos_sim=0.895]Epoch 3/3:  40%|███▉      | 62/156 [00:02<00:04, 23.17it/s, loss=0.1067, cos_sim=0.895]Epoch 3/3:  40%|███▉      | 62/156 [00:03<00:04, 23.17it/s, loss=0.1099, cos_sim=0.891]Epoch 3/3:  40%|███▉      | 62/156 [00:03<00:04, 23.17it/s, loss=0.1113, cos_sim=0.891]Epoch 3/3:  42%|████▏     | 65/156 [00:03<00:04, 22.56it/s, loss=0.1113, cos_sim=0.891]Epoch 3/3:  42%|████▏     | 65/156 [00:03<00:04, 22.56it/s, loss=0.1077, cos_sim=0.895]Epoch 3/3:  42%|████▏     | 65/156 [00:03<00:04, 22.56it/s, loss=0.1040, cos_sim=0.898]Epoch 3/3:  42%|████▏     | 65/156 [00:03<00:04, 22.56it/s, loss=0.1100, cos_sim=0.891]Epoch 3/3:  44%|████▎     | 68/156 [00:03<00:05, 16.00it/s, loss=0.1100, cos_sim=0.891]Epoch 3/3:  44%|████▎     | 68/156 [00:03<00:05, 16.00it/s, loss=0.1174, cos_sim=0.883]Epoch 3/3:  44%|████▎     | 68/156 [00:03<00:05, 16.00it/s, loss=0.1110, cos_sim=0.891]Epoch 3/3:  44%|████▎     | 68/156 [00:03<00:05, 16.00it/s, loss=0.1048, cos_sim=0.895]Epoch 3/3:  46%|████▌     | 71/156 [00:03<00:04, 17.63it/s, loss=0.1048, cos_sim=0.895]Epoch 3/3:  46%|████▌     | 71/156 [00:03<00:04, 17.63it/s, loss=0.1109, cos_sim=0.891]Epoch 3/3:  46%|████▌     | 71/156 [00:03<00:04, 17.63it/s, loss=0.1041, cos_sim=0.898]Epoch 3/3:  46%|████▌     | 71/156 [00:03<00:04, 17.63it/s, loss=0.1040, cos_sim=0.898]Epoch 3/3:  47%|████▋     | 74/156 [00:03<00:04, 17.04it/s, loss=0.1040, cos_sim=0.898]Epoch 3/3:  47%|████▋     | 74/156 [00:03<00:04, 17.04it/s, loss=0.1056, cos_sim=0.895]Epoch 3/3:  47%|████▋     | 74/156 [00:03<00:04, 17.04it/s, loss=0.1083, cos_sim=0.895]Epoch 3/3:  49%|████▊     | 76/156 [00:03<00:04, 16.03it/s, loss=0.1083, cos_sim=0.895]Epoch 3/3:  49%|████▊     | 76/156 [00:03<00:04, 16.03it/s, loss=0.1073, cos_sim=0.895]Epoch 3/3:  49%|████▊     | 76/156 [00:03<00:04, 16.03it/s, loss=0.1059, cos_sim=0.895]Epoch 3/3:  49%|████▊     | 76/156 [00:04<00:04, 16.03it/s, loss=0.1055, cos_sim=0.895]Epoch 3/3:  51%|█████     | 79/156 [00:04<00:04, 17.58it/s, loss=0.1055, cos_sim=0.895]Epoch 3/3:  51%|█████     | 79/156 [00:04<00:04, 17.58it/s, loss=0.1062, cos_sim=0.895]Epoch 3/3:  51%|█████     | 79/156 [00:04<00:04, 17.58it/s, loss=0.1081, cos_sim=0.895]Epoch 3/3:  51%|█████     | 79/156 [00:04<00:04, 17.58it/s, loss=0.1052, cos_sim=0.895]Epoch 3/3:  53%|█████▎    | 82/156 [00:04<00:03, 19.13it/s, loss=0.1052, cos_sim=0.895]Epoch 3/3:  53%|█████▎    | 82/156 [00:04<00:03, 19.13it/s, loss=0.1056, cos_sim=0.895]Epoch 3/3:  53%|█████▎    | 82/156 [00:04<00:03, 19.13it/s, loss=0.1055, cos_sim=0.895]Epoch 3/3:  53%|█████▎    | 82/156 [00:04<00:03, 19.13it/s, loss=0.1030, cos_sim=0.898]Epoch 3/3:  54%|█████▍    | 85/156 [00:04<00:03, 20.37it/s, loss=0.1030, cos_sim=0.898]Epoch 3/3:  54%|█████▍    | 85/156 [00:04<00:03, 20.37it/s, loss=0.1087, cos_sim=0.891]Epoch 3/3:  54%|█████▍    | 85/156 [00:04<00:03, 20.37it/s, loss=0.1096, cos_sim=0.891]Epoch 3/3:  54%|█████▍    | 85/156 [00:04<00:03, 20.37it/s, loss=0.1068, cos_sim=0.895]Epoch 3/3:  56%|█████▋    | 88/156 [00:04<00:05, 13.49it/s, loss=0.1068, cos_sim=0.895]Epoch 3/3:  56%|█████▋    | 88/156 [00:04<00:05, 13.49it/s, loss=0.1061, cos_sim=0.895]Epoch 3/3:  56%|█████▋    | 88/156 [00:04<00:05, 13.49it/s, loss=0.1072, cos_sim=0.895]Epoch 3/3:  56%|█████▋    | 88/156 [00:04<00:05, 13.49it/s, loss=0.1062, cos_sim=0.895]Epoch 3/3:  58%|█████▊    | 91/156 [00:04<00:04, 15.59it/s, loss=0.1062, cos_sim=0.895]Epoch 3/3:  58%|█████▊    | 91/156 [00:04<00:04, 15.59it/s, loss=0.1058, cos_sim=0.895]Epoch 3/3:  58%|█████▊    | 91/156 [00:04<00:04, 15.59it/s, loss=0.1114, cos_sim=0.891]Epoch 3/3:  58%|█████▊    | 91/156 [00:04<00:04, 15.59it/s, loss=0.1064, cos_sim=0.895]Epoch 3/3:  60%|██████    | 94/156 [00:04<00:03, 17.50it/s, loss=0.1064, cos_sim=0.895]Epoch 3/3:  60%|██████    | 94/156 [00:04<00:03, 17.50it/s, loss=0.1108, cos_sim=0.891]Epoch 3/3:  60%|██████    | 94/156 [00:04<00:03, 17.50it/s, loss=0.1052, cos_sim=0.895]Epoch 3/3:  60%|██████    | 94/156 [00:05<00:03, 17.50it/s, loss=0.1044, cos_sim=0.898]Epoch 3/3:  62%|██████▏   | 97/156 [00:05<00:03, 18.70it/s, loss=0.1044, cos_sim=0.898]Epoch 3/3:  62%|██████▏   | 97/156 [00:05<00:03, 18.70it/s, loss=0.1078, cos_sim=0.895]Epoch 3/3:  62%|██████▏   | 97/156 [00:05<00:03, 18.70it/s, loss=0.1080, cos_sim=0.895]Epoch 3/3:  62%|██████▏   | 97/156 [00:05<00:03, 18.70it/s, loss=0.1056, cos_sim=0.895]Epoch 3/3:  64%|██████▍   | 100/156 [00:05<00:03, 18.16it/s, loss=0.1056, cos_sim=0.895]Epoch 3/3:  64%|██████▍   | 100/156 [00:05<00:03, 18.16it/s, loss=0.1039, cos_sim=0.898]Epoch 3/3:  64%|██████▍   | 100/156 [00:05<00:03, 18.16it/s, loss=0.1104, cos_sim=0.891]Epoch 3/3:  65%|██████▌   | 102/156 [00:05<00:03, 16.62it/s, loss=0.1104, cos_sim=0.891]Epoch 3/3:  65%|██████▌   | 102/156 [00:05<00:03, 16.62it/s, loss=0.1043, cos_sim=0.898]Epoch 3/3:  65%|██████▌   | 102/156 [00:05<00:03, 16.62it/s, loss=0.1075, cos_sim=0.895]Epoch 3/3:  67%|██████▋   | 104/156 [00:05<00:03, 15.51it/s, loss=0.1075, cos_sim=0.895]Epoch 3/3:  67%|██████▋   | 104/156 [00:05<00:03, 15.51it/s, loss=0.1044, cos_sim=0.898]Epoch 3/3:  67%|██████▋   | 104/156 [00:05<00:03, 15.51it/s, loss=0.1119, cos_sim=0.891]Epoch 3/3:  68%|██████▊   | 106/156 [00:05<00:03, 14.72it/s, loss=0.1119, cos_sim=0.891]Epoch 3/3:  68%|██████▊   | 106/156 [00:05<00:03, 14.72it/s, loss=0.1083, cos_sim=0.895]Epoch 3/3:  68%|██████▊   | 106/156 [00:05<00:03, 14.72it/s, loss=0.1103, cos_sim=0.891]Epoch 3/3:  68%|██████▊   | 106/156 [00:05<00:03, 14.72it/s, loss=0.1056, cos_sim=0.895]Epoch 3/3:  70%|██████▉   | 109/156 [00:05<00:03, 14.76it/s, loss=0.1056, cos_sim=0.895]Epoch 3/3:  70%|██████▉   | 109/156 [00:05<00:03, 14.76it/s, loss=0.1059, cos_sim=0.895]Epoch 3/3:  70%|██████▉   | 109/156 [00:05<00:03, 14.76it/s, loss=0.1066, cos_sim=0.895]Epoch 3/3:  70%|██████▉   | 109/156 [00:06<00:03, 14.76it/s, loss=0.1084, cos_sim=0.891]Epoch 3/3:  72%|███████▏  | 112/156 [00:06<00:02, 16.55it/s, loss=0.1084, cos_sim=0.891]Epoch 3/3:  72%|███████▏  | 112/156 [00:06<00:02, 16.55it/s, loss=0.1080, cos_sim=0.895]Epoch 3/3:  72%|███████▏  | 112/156 [00:06<00:02, 16.55it/s, loss=0.1066, cos_sim=0.895]Epoch 3/3:  72%|███████▏  | 112/156 [00:06<00:02, 16.55it/s, loss=0.1076, cos_sim=0.895]Epoch 3/3:  74%|███████▎  | 115/156 [00:06<00:02, 17.88it/s, loss=0.1076, cos_sim=0.895]Epoch 3/3:  74%|███████▎  | 115/156 [00:06<00:02, 17.88it/s, loss=0.1009, cos_sim=0.898]Epoch 3/3:  74%|███████▎  | 115/156 [00:06<00:02, 17.88it/s, loss=0.1068, cos_sim=0.895]Epoch 3/3:  74%|███████▎  | 115/156 [00:06<00:02, 17.88it/s, loss=0.1091, cos_sim=0.891]Epoch 3/3:  76%|███████▌  | 118/156 [00:06<00:01, 19.06it/s, loss=0.1091, cos_sim=0.891]Epoch 3/3:  76%|███████▌  | 118/156 [00:06<00:01, 19.06it/s, loss=0.1075, cos_sim=0.895]Epoch 3/3:  76%|███████▌  | 118/156 [00:06<00:01, 19.06it/s, loss=0.1056, cos_sim=0.895]Epoch 3/3:  76%|███████▌  | 118/156 [00:06<00:01, 19.06it/s, loss=0.1116, cos_sim=0.891]Epoch 3/3:  78%|███████▊  | 121/156 [00:06<00:01, 19.76it/s, loss=0.1116, cos_sim=0.891]Epoch 3/3:  78%|███████▊  | 121/156 [00:06<00:01, 19.76it/s, loss=0.1064, cos_sim=0.895]Epoch 3/3:  78%|███████▊  | 121/156 [00:06<00:01, 19.76it/s, loss=0.1024, cos_sim=0.898]Epoch 3/3:  78%|███████▊  | 121/156 [00:06<00:01, 19.76it/s, loss=0.1060, cos_sim=0.895]Epoch 3/3:  79%|███████▉  | 124/156 [00:06<00:01, 20.48it/s, loss=0.1060, cos_sim=0.895]Epoch 3/3:  79%|███████▉  | 124/156 [00:06<00:01, 20.48it/s, loss=0.1089, cos_sim=0.891]Epoch 3/3:  79%|███████▉  | 124/156 [00:06<00:01, 20.48it/s, loss=0.1074, cos_sim=0.895]Epoch 3/3:  79%|███████▉  | 124/156 [00:06<00:01, 20.48it/s, loss=0.1117, cos_sim=0.891]Epoch 3/3:  81%|████████▏ | 127/156 [00:06<00:01, 21.24it/s, loss=0.1117, cos_sim=0.891]Epoch 3/3:  81%|████████▏ | 127/156 [00:06<00:01, 21.24it/s, loss=0.1088, cos_sim=0.891]Epoch 3/3:  81%|████████▏ | 127/156 [00:06<00:01, 21.24it/s, loss=0.1077, cos_sim=0.895]Epoch 3/3:  81%|████████▏ | 127/156 [00:06<00:01, 21.24it/s, loss=0.1098, cos_sim=0.891]Epoch 3/3:  83%|████████▎ | 130/156 [00:06<00:01, 21.44it/s, loss=0.1098, cos_sim=0.891]Epoch 3/3:  83%|████████▎ | 130/156 [00:06<00:01, 21.44it/s, loss=0.1073, cos_sim=0.895]Epoch 3/3:  83%|████████▎ | 130/156 [00:06<00:01, 21.44it/s, loss=0.1075, cos_sim=0.895]Epoch 3/3:  83%|████████▎ | 130/156 [00:06<00:01, 21.44it/s, loss=0.1079, cos_sim=0.895]Epoch 3/3:  85%|████████▌ | 133/156 [00:06<00:01, 21.55it/s, loss=0.1079, cos_sim=0.895]Epoch 3/3:  85%|████████▌ | 133/156 [00:07<00:01, 21.55it/s, loss=0.1072, cos_sim=0.895]Epoch 3/3:  85%|████████▌ | 133/156 [00:07<00:01, 21.55it/s, loss=0.1121, cos_sim=0.891]Epoch 3/3:  85%|████████▌ | 133/156 [00:07<00:01, 21.55it/s, loss=0.1077, cos_sim=0.895]Epoch 3/3:  87%|████████▋ | 136/156 [00:07<00:00, 21.25it/s, loss=0.1077, cos_sim=0.895]Epoch 3/3:  87%|████████▋ | 136/156 [00:07<00:00, 21.25it/s, loss=0.1080, cos_sim=0.895]Epoch 3/3:  87%|████████▋ | 136/156 [00:07<00:00, 21.25it/s, loss=0.1114, cos_sim=0.891]Epoch 3/3:  87%|████████▋ | 136/156 [00:07<00:00, 21.25it/s, loss=0.1051, cos_sim=0.895]Epoch 3/3:  89%|████████▉ | 139/156 [00:07<00:00, 19.15it/s, loss=0.1051, cos_sim=0.895]Epoch 3/3:  89%|████████▉ | 139/156 [00:07<00:00, 19.15it/s, loss=0.1083, cos_sim=0.895]Epoch 3/3:  89%|████████▉ | 139/156 [00:07<00:00, 19.15it/s, loss=0.1078, cos_sim=0.895]Epoch 3/3:  90%|█████████ | 141/156 [00:07<00:00, 16.98it/s, loss=0.1078, cos_sim=0.895]Epoch 3/3:  90%|█████████ | 141/156 [00:07<00:00, 16.98it/s, loss=0.1058, cos_sim=0.895]Epoch 3/3:  90%|█████████ | 141/156 [00:07<00:00, 16.98it/s, loss=0.1080, cos_sim=0.895]Epoch 3/3:  92%|█████████▏| 143/156 [00:07<00:00, 15.61it/s, loss=0.1080, cos_sim=0.895]Epoch 3/3:  92%|█████████▏| 143/156 [00:07<00:00, 15.61it/s, loss=0.1074, cos_sim=0.895]Epoch 3/3:  92%|█████████▏| 143/156 [00:07<00:00, 15.61it/s, loss=0.1095, cos_sim=0.891]Epoch 3/3:  93%|█████████▎| 145/156 [00:07<00:00, 14.62it/s, loss=0.1095, cos_sim=0.891]Epoch 3/3:  93%|█████████▎| 145/156 [00:07<00:00, 14.62it/s, loss=0.1066, cos_sim=0.895]Epoch 3/3:  93%|█████████▎| 145/156 [00:07<00:00, 14.62it/s, loss=0.1127, cos_sim=0.887]Epoch 3/3:  93%|█████████▎| 145/156 [00:07<00:00, 14.62it/s, loss=0.1045, cos_sim=0.895]Epoch 3/3:  95%|█████████▍| 148/156 [00:08<00:00, 14.51it/s, loss=0.1045, cos_sim=0.895]Epoch 3/3:  95%|█████████▍| 148/156 [00:08<00:00, 14.51it/s, loss=0.1035, cos_sim=0.898]Epoch 3/3:  95%|█████████▍| 148/156 [00:08<00:00, 14.51it/s, loss=0.1103, cos_sim=0.891]Epoch 3/3:  95%|█████████▍| 148/156 [00:08<00:00, 14.51it/s, loss=0.1109, cos_sim=0.891]Epoch 3/3:  97%|█████████▋| 151/156 [00:08<00:00, 16.32it/s, loss=0.1109, cos_sim=0.891]Epoch 3/3:  97%|█████████▋| 151/156 [00:08<00:00, 16.32it/s, loss=0.1037, cos_sim=0.898]Epoch 3/3:  97%|█████████▋| 151/156 [00:08<00:00, 16.32it/s, loss=0.1079, cos_sim=0.895]Epoch 3/3:  97%|█████████▋| 151/156 [00:08<00:00, 16.32it/s, loss=0.1084, cos_sim=0.891]Epoch 3/3:  99%|█████████▊| 154/156 [00:08<00:00, 17.91it/s, loss=0.1084, cos_sim=0.891]Epoch 3/3:  99%|█████████▊| 154/156 [00:08<00:00, 17.91it/s, loss=0.1040, cos_sim=0.898]Epoch 3/3:  99%|█████████▊| 154/156 [00:08<00:00, 17.91it/s, loss=0.1048, cos_sim=0.895]Epoch 3/3: 100%|██████████| 156/156 [00:08<00:00, 18.65it/s, loss=0.1048, cos_sim=0.895]

  Quick eval (first example):
    Expected: 'Dane'
    Generated: ': Dane.  Dane was killed in a horse'
    Norm ratio: 1.000 | Cosine: 0.828
  Avg norm ratio: 1.000 | Avg cosine: 0.848

  Step 400: Quick F1 = 38.0%

Epoch 3 complete:
  Avg loss: 0.1075
  Avg cosine similarity: 0.894
  Avg relative error: 0.558

Running full evaluation...

================================================================================
EVALUATION DIAGNOSTICS (Batched with size 32)
================================================================================
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:  25%|██▌       | 1/4 [00:00<00:02,  1.35it/s]Evaluating:  50%|█████     | 2/4 [00:01<00:01,  1.14it/s]Evaluating:  75%|███████▌  | 3/4 [00:02<00:00,  1.23it/s]Evaluating: 100%|██████████| 4/4 [00:03<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:03<00:00,  1.26it/s]

────────────────────────────────────────────────────────────────────────────────
Example 1:
  Question: Context: Tesla was the fourth of five children. He had an older brother named Da...
  Expected: 'Dane'
  Generated: ': Dane.  Dane was killed in a horse-riding accident when Nikola was five.  Tesla'

  Embedding diagnostics:
    Original norm:  0.31
    Reconstructed norm: 0.31
    Ratio: 1.000 (OK)
    Cosine similarity: 0.828

  Token-level reconstruction (first example only):
    Original tokens:  <|begin_of_text|>Context: Tesla was the fourth of five children. He had an older brother named Dane and three sisters, Milka, Angelina and Marica. Dan...
    Reconstructed →:  <|begin_of_text|>Context: Tesla was the fourth of five children. He had an older brother named Dane and three sisters, Milka, Angelina and Marica. Dan...

────────────────────────────────────────────────────────────────────────────────
Example 2:
  Question: Context: Islamists have asked the question, "If Islam is a way of life, how can ...
  Expected: 'Muslims'
  Generated: 'A) Islamism
B) Islam
C) Political Islam
D) Islamists'

  Embedding diagnostics:
    Original norm:  0.36
    Reconstructed norm: 0.36
    Ratio: 1.000 (OK)
    Cosine similarity: 0.863

────────────────────────────────────────────────────────────────────────────────
Example 3:
  Question: Context: The concept environmental determinism served as a moral justification f...
  Expected: 'orientalism and tropicality'
  Generated: 'A) Orientalism and tropicality
B) Colonialism and imperialism
C) Environmentalism'

  Embedding diagnostics:
    Original norm:  0.31
    Reconstructed norm: 0.31
    Ratio: 1.000 (OK)
    Cosine similarity: 0.867

================================================================================
  F1: 0.232
  EM: 0.000

============================================================
Training complete!
Best F1: 0.240
============================================================

============================================================
PHASE 1 RESULTS
============================================================
Best F1: 24.0%
❌ BELOW TARGET: Investigation needed
   Check: PCA quality, adapter capacity, or training setup
============================================================

=== Training Complete at Sat Oct 11 19:35:56 PDT 2025 ===
Running evaluation...
<string>:6: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
Best checkpoint from epoch 2
Best F1: 0.240

====================================
STAGE 1 PHASE 1 RESULTS SUMMARY
====================================
  Compression: 4096 → 1024
  Method: pca
  Best F1: 24.0%
  Achieved in epoch: 2

  ❌ NEEDS INVESTIGATION: Either compression too lossy or architecture issue.

Logs saved to:
  - runs/stage1_adapter_only/logs/training.log
  - runs/stage1_adapter_only/logs/diagnostics.jsonl
