Starting training at Sat Oct 11 14:17:19 PDT 2025

/projects/m000066/sujinesh/LatentWire/.venv/lib/python3.9/site-packages/transformers/utils/hub.py:128: FutureWarning: Using `TRANSFORMERS_CACHE` is deprecated and will be removed in v5 of Transformers. Use `HF_HOME` instead.
  warnings.warn(

Configuration:
  model_id: meta-llama/Meta-Llama-3.1-8B-Instruct
  compress_dim: 512
  compress_method: pca
  input_dim: 4096
  pca_samples: 80000
  adapter_hidden_mult: 4
  adapter_dropout: 0.1
  adapter_lr: 0.0005
  samples: 10000
  epochs: 3
  batch_size: 64
  eval_every: 1
  eval_samples: 500
  save_dir: runs/stage1_adapter_only
  diagnostic_log: runs/stage1_adapter_only/logs/diagnostics.jsonl
============================================================
STAGE 1 PHASE 1: PURE RECONSTRUCTION TRAINING
Model: meta-llama/Meta-Llama-3.1-8B-Instruct
Compression: 4096 → 512 (8.0× compression)
Training samples: 10000
PCA samples: 80000
============================================================

GPU Information:
  CUDA available: Yes
  GPU count: 4
  GPU 0: NVIDIA H100 80GB HBM3 (85.0 GB)
  GPU 1: NVIDIA H100 80GB HBM3 (85.0 GB)
  GPU 2: NVIDIA H100 80GB HBM3 (85.0 GB)
  GPU 3: NVIDIA H100 80GB HBM3 (85.0 GB)

Logging diagnostics to: runs/stage1_adapter_only/logs/diagnostics.jsonl

Loading model...
Downloading shards:   0%|          | 0/4 [00:00<?, ?it/s]Downloading shards: 100%|██████████| 4/4 [00:00<00:00, 1960.64it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:06<00:20,  6.86s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:14<00:14,  7.20s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:21<00:07,  7.18s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:23<00:00,  5.02s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:23<00:00,  5.79s/it]

Creating adapter...
Adapter parameters: 19,952,641

Loading dataset...
Training samples: 10000
Validation samples: 500

Fitting PCA compressor on 80,000 samples...
Collecting embeddings for PCA:   0%|          | 0/1250 [00:00<?, ?it/s]Collecting embeddings for PCA:   0%|          | 1/1250 [00:28<9:44:58, 28.10s/it]Collecting embeddings for PCA:   0%|          | 2/1250 [01:24<15:28:14, 44.63s/it]Collecting embeddings for PCA:   0%|          | 3/1250 [02:20<17:21:36, 50.12s/it]Collecting embeddings for PCA:   0%|          | 4/1250 [03:17<18:09:48, 52.48s/it]Collecting embeddings for PCA:   0%|          | 5/1250 [04:11<18:27:13, 53.36s/it]Collecting embeddings for PCA:   0%|          | 6/1250 [05:06<18:31:15, 53.60s/it]Collecting embeddings for PCA:   1%|          | 7/1250 [05:59<18:31:50, 53.67s/it]Collecting embeddings for PCA:   1%|          | 8/1250 [06:56<18:47:59, 54.49s/it]Collecting embeddings for PCA:   1%|          | 9/1250 [07:50<18:49:10, 54.59s/it]Collecting embeddings for PCA:   1%|          | 10/1250 [08:43<18:38:10, 54.11s/it]Collecting embeddings for PCA:   1%|          | 11/1250 [09:37<18:34:21, 53.96s/it]Collecting embeddings for PCA:   1%|          | 12/1250 [10:33<18:47:45, 54.66s/it]Collecting embeddings for PCA:   1%|          | 13/1250 [11:28<18:49:44, 54.80s/it]Collecting embeddings for PCA:   1%|          | 14/1250 [12:23<18:49:28, 54.83s/it]Collecting embeddings for PCA:   1%|          | 15/1250 [13:21<19:04:15, 55.59s/it]Collecting embeddings for PCA:   1%|▏         | 16/1250 [14:16<18:58:58, 55.38s/it]Collecting embeddings for PCA:   1%|▏         | 17/1250 [15:12<19:06:07, 55.77s/it]Collecting embeddings for PCA:   1%|▏         | 18/1250 [16:08<19:07:27, 55.88s/it]Collecting embeddings for PCA:   2%|▏         | 19/1250 [17:04<19:06:58, 55.90s/it]Collecting embeddings for PCA:   2%|▏         | 20/1250 [17:59<18:59:33, 55.59s/it]Collecting embeddings for PCA:   2%|▏         | 21/1250 [18:54<18:51:04, 55.22s/it]Collecting embeddings for PCA:   2%|▏         | 22/1250 [19:49<18:53:57, 55.41s/it]Collecting embeddings for PCA:   2%|▏         | 23/1250 [20:41<18:31:27, 54.35s/it]Collecting embeddings for PCA:   2%|▏         | 24/1250 [21:36<18:32:15, 54.43s/it]Collecting embeddings for PCA:   2%|▏         | 25/1250 [22:29<18:25:38, 54.15s/it]Collecting embeddings for PCA:   2%|▏         | 26/1250 [23:23<18:18:27, 53.85s/it]Collecting embeddings for PCA:   2%|▏         | 27/1250 [24:18<18:29:58, 54.45s/it]Collecting embeddings for PCA:   2%|▏         | 28/1250 [25:15<18:39:56, 54.99s/it]Collecting embeddings for PCA:   2%|▏         | 29/1250 [26:10<18:39:11, 55.00s/it]Collecting embeddings for PCA:   2%|▏         | 30/1250 [27:04<18:36:35, 54.91s/it]