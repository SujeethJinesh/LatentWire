Starting training at Sat Oct 11 11:48:17 PDT 2025

/projects/m000066/sujinesh/LatentWire/.venv/lib/python3.9/site-packages/transformers/utils/hub.py:128: FutureWarning: Using `TRANSFORMERS_CACHE` is deprecated and will be removed in v5 of Transformers. Use `HF_HOME` instead.
  warnings.warn(

Configuration:
  model_id: meta-llama/Meta-Llama-3.1-8B-Instruct
  compress_dim: 512
  compress_method: pca
  input_dim: 4096
  adapter_hidden_mult: 4
  adapter_dropout: 0.1
  adapter_lr: 0.0005
  samples: 10000
  epochs: 3
  batch_size: 64
  recon_weight: 1.0
  ce_weight: 1.0
  eval_every: 1
  eval_samples: 500
  save_dir: runs/stage1_adapter_only
  diagnostic_log: runs/stage1_adapter_only/logs/diagnostics.jsonl
============================================================
ADAPTER-ONLY TRAINING
Model: meta-llama/Meta-Llama-3.1-8B-Instruct
Compression: 4096 → 512
Samples: 10000
============================================================

GPU Information:
  CUDA available: Yes
  Number of GPUs: 4
  GPU 0: NVIDIA H100 80GB HBM3 (85.0 GB)
  GPU 1: NVIDIA H100 80GB HBM3 (85.0 GB)
  GPU 2: NVIDIA H100 80GB HBM3 (85.0 GB)
  GPU 3: NVIDIA H100 80GB HBM3 (85.0 GB)
Logging diagnostics to: runs/stage1_adapter_only/logs/diagnostics.jsonl
Downloading shards:   0%|          | 0/4 [00:00<?, ?it/s]Downloading shards: 100%|██████████| 4/4 [00:00<00:00, 3739.91it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:01<00:04,  1.39s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:02<00:02,  1.34s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:03<00:01,  1.25s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:04<00:00,  1.10it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:04<00:00,  1.05s/it]

Adapter params: 19,952,641

Fitting compressor...
Collecting embeddings:   0%|          | 0/100 [00:00<?, ?it/s]Collecting embeddings:  23%|██▎       | 23/100 [00:00<00:00, 224.81it/s]Collecting embeddings:  62%|██████▏   | 62/100 [00:00<00:00, 315.05it/s]Collecting embeddings: 100%|██████████| 100/100 [00:00<00:00, 449.74it/s]
Compressor fitted on 17408 embedding vectors

Training adapter...
Epoch 1/3:   0%|          | 0/156 [00:00<?, ?it/s]Epoch 1/3:   0%|          | 0/156 [00:02<?, ?it/s, loss=13.9564, recon=0.9999, ce=12.9565]Epoch 1/3:   1%|          | 1/156 [00:02<06:52,  2.66s/it, loss=13.9564, recon=0.9999, ce=12.9565]Epoch 1/3:   1%|          | 1/156 [00:04<06:52,  2.66s/it, loss=14.0855, recon=1.0001, ce=13.0854]Epoch 1/3:   1%|▏         | 2/156 [00:04<05:37,  2.19s/it, loss=14.0855, recon=1.0001, ce=13.0854]Epoch 1/3:   1%|▏         | 2/156 [00:06<05:37,  2.19s/it, loss=11.6892, recon=1.0002, ce=10.6890]Epoch 1/3:   2%|▏         | 3/156 [00:06<05:12,  2.04s/it, loss=11.6892, recon=1.0002, ce=10.6890]Epoch 1/3:   2%|▏         | 3/156 [00:08<05:12,  2.04s/it, loss=10.5601, recon=1.0004, ce=9.5597] Epoch 1/3:   3%|▎         | 4/156 [00:08<05:00,  1.98s/it, loss=10.5601, recon=1.0004, ce=9.5597]Epoch 1/3:   3%|▎         | 4/156 [00:10<05:00,  1.98s/it, loss=9.7349, recon=1.0005, ce=8.7344] Epoch 1/3:   3%|▎         | 5/156 [00:10<04:52,  1.94s/it, loss=9.7349, recon=1.0005, ce=8.7344]Epoch 1/3:   3%|▎         | 5/156 [00:11<04:52,  1.94s/it, loss=9.2045, recon=1.0008, ce=8.2038]Epoch 1/3:   4%|▍         | 6/156 [00:11<04:46,  1.91s/it, loss=9.2045, recon=1.0008, ce=8.2038]Epoch 1/3:   4%|▍         | 6/156 [00:13<04:46,  1.91s/it, loss=8.5221, recon=1.0010, ce=7.5210]Epoch 1/3:   4%|▍         | 7/156 [00:13<04:42,  1.90s/it, loss=8.5221, recon=1.0010, ce=7.5210]Epoch 1/3:   4%|▍         | 7/156 [00:15<04:42,  1.90s/it, loss=7.6802, recon=1.0013, ce=6.6789]Epoch 1/3:   5%|▌         | 8/156 [00:15<04:39,  1.89s/it, loss=7.6802, recon=1.0013, ce=6.6789]Epoch 1/3:   5%|▌         | 8/156 [00:17<04:39,  1.89s/it, loss=7.3242, recon=1.0015, ce=6.3227]Epoch 1/3:   6%|▌         | 9/156 [00:17<04:36,  1.88s/it, loss=7.3242, recon=1.0015, ce=6.3227]Epoch 1/3:   6%|▌         | 9/156 [00:19<04:36,  1.88s/it, loss=6.1881, recon=1.0017, ce=5.1864]Epoch 1/3:   6%|▋         | 10/156 [00:19<04:34,  1.88s/it, loss=6.1881, recon=1.0017, ce=5.1864]Epoch 1/3:   6%|▋         | 10/156 [00:21<04:34,  1.88s/it, loss=6.1577, recon=1.0019, ce=5.1558]Epoch 1/3:   7%|▋         | 11/156 [00:21<04:32,  1.88s/it, loss=6.1577, recon=1.0019, ce=5.1558]Epoch 1/3:   7%|▋         | 11/156 [00:23<04:32,  1.88s/it, loss=6.1620, recon=1.0020, ce=5.1600]Epoch 1/3:   8%|▊         | 12/156 [00:23<04:30,  1.88s/it, loss=6.1620, recon=1.0020, ce=5.1600]Epoch 1/3:   8%|▊         | 12/156 [00:25<04:30,  1.88s/it, loss=6.1843, recon=1.0020, ce=5.1823]Epoch 1/3:   8%|▊         | 13/156 [00:25<04:28,  1.88s/it, loss=6.1843, recon=1.0020, ce=5.1823]Epoch 1/3:   8%|▊         | 13/156 [00:26<04:28,  1.88s/it, loss=5.9094, recon=1.0020, ce=4.9074]Epoch 1/3:   9%|▉         | 14/156 [00:26<04:26,  1.87s/it, loss=5.9094, recon=1.0020, ce=4.9074]Epoch 1/3:   9%|▉         | 14/156 [00:28<04:26,  1.87s/it, loss=5.9585, recon=1.0021, ce=4.9565]Epoch 1/3:  10%|▉         | 15/156 [00:28<04:23,  1.87s/it, loss=5.9585, recon=1.0021, ce=4.9565]Epoch 1/3:  10%|▉         | 15/156 [00:30<04:23,  1.87s/it, loss=5.7820, recon=1.0020, ce=4.7799]Epoch 1/3:  10%|█         | 16/156 [00:30<04:22,  1.87s/it, loss=5.7820, recon=1.0020, ce=4.7799]Epoch 1/3:  10%|█         | 16/156 [00:32<04:22,  1.87s/it, loss=5.6248, recon=1.0020, ce=4.6228]Epoch 1/3:  11%|█         | 17/156 [00:32<04:20,  1.87s/it, loss=5.6248, recon=1.0020, ce=4.6228]Epoch 1/3:  11%|█         | 17/156 [00:34<04:20,  1.87s/it, loss=5.6220, recon=1.0019, ce=4.6201]Epoch 1/3:  12%|█▏        | 18/156 [00:34<04:18,  1.87s/it, loss=5.6220, recon=1.0019, ce=4.6201]Epoch 1/3:  12%|█▏        | 18/156 [00:36<04:18,  1.87s/it, loss=5.7350, recon=1.0018, ce=4.7332]Epoch 1/3:  12%|█▏        | 19/156 [00:36<04:16,  1.87s/it, loss=5.7350, recon=1.0018, ce=4.7332]Epoch 1/3:  12%|█▏        | 19/156 [00:38<04:16,  1.87s/it, loss=5.7612, recon=1.0017, ce=4.7596]Epoch 1/3:  13%|█▎        | 20/156 [00:38<04:13,  1.87s/it, loss=5.7612, recon=1.0017, ce=4.7596]Epoch 1/3:  13%|█▎        | 20/156 [00:40<04:13,  1.87s/it, loss=5.2214, recon=1.0016, ce=4.2198]Epoch 1/3:  13%|█▎        | 21/156 [00:40<04:12,  1.87s/it, loss=5.2214, recon=1.0016, ce=4.2198]Epoch 1/3:  13%|█▎        | 21/156 [00:41<04:12,  1.87s/it, loss=5.5081, recon=1.0014, ce=4.5067]Epoch 1/3:  14%|█▍        | 22/156 [00:41<04:10,  1.87s/it, loss=5.5081, recon=1.0014, ce=4.5067]Epoch 1/3:  14%|█▍        | 22/156 [00:43<04:10,  1.87s/it, loss=5.4510, recon=1.0013, ce=4.4498]Epoch 1/3:  15%|█▍        | 23/156 [00:43<04:08,  1.87s/it, loss=5.4510, recon=1.0013, ce=4.4498]Epoch 1/3:  15%|█▍        | 23/156 [00:45<04:08,  1.87s/it, loss=4.8670, recon=1.0011, ce=3.8659]Epoch 1/3:  15%|█▌        | 24/156 [00:45<04:06,  1.87s/it, loss=4.8670, recon=1.0011, ce=3.8659]Epoch 1/3:  15%|█▌        | 24/156 [00:47<04:06,  1.87s/it, loss=5.3036, recon=1.0010, ce=4.3026]Epoch 1/3:  16%|█▌        | 25/156 [00:47<04:05,  1.87s/it, loss=5.3036, recon=1.0010, ce=4.3026]Epoch 1/3:  16%|█▌        | 25/156 [00:49<04:05,  1.87s/it, loss=5.1676, recon=1.0008, ce=4.1668]Epoch 1/3:  17%|█▋        | 26/156 [00:49<04:03,  1.87s/it, loss=5.1676, recon=1.0008, ce=4.1668]Epoch 1/3:  17%|█▋        | 26/156 [00:51<04:03,  1.87s/it, loss=5.1267, recon=1.0007, ce=4.1261]Epoch 1/3:  17%|█▋        | 27/156 [00:51<04:01,  1.87s/it, loss=5.1267, recon=1.0007, ce=4.1261]Epoch 1/3:  17%|█▋        | 27/156 [00:53<04:01,  1.87s/it, loss=5.1231, recon=1.0005, ce=4.1226]Epoch 1/3:  18%|█▊        | 28/156 [00:53<03:59,  1.87s/it, loss=5.1231, recon=1.0005, ce=4.1226]Epoch 1/3:  18%|█▊        | 28/156 [00:54<03:59,  1.87s/it, loss=5.3373, recon=1.0004, ce=4.3370]Epoch 1/3:  19%|█▊        | 29/156 [00:54<03:56,  1.86s/it, loss=5.3373, recon=1.0004, ce=4.3370]Epoch 1/3:  19%|█▊        | 29/156 [00:56<03:56,  1.86s/it, loss=4.9526, recon=1.0002, ce=3.9523]Epoch 1/3:  19%|█▉        | 30/156 [00:56<03:54,  1.86s/it, loss=4.9526, recon=1.0002, ce=3.9523]Epoch 1/3:  19%|█▉        | 30/156 [00:58<03:54,  1.86s/it, loss=5.1616, recon=1.0001, ce=4.1615]Epoch 1/3:  20%|█▉        | 31/156 [00:58<03:52,  1.86s/it, loss=5.1616, recon=1.0001, ce=4.1615]Epoch 1/3:  20%|█▉        | 31/156 [01:00<03:52,  1.86s/it, loss=5.2972, recon=0.9999, ce=4.2973]Epoch 1/3:  21%|██        | 32/156 [01:00<03:49,  1.85s/it, loss=5.2972, recon=0.9999, ce=4.2973]Epoch 1/3:  21%|██        | 32/156 [01:02<03:49,  1.85s/it, loss=4.8117, recon=0.9998, ce=3.8119]Epoch 1/3:  21%|██        | 33/156 [01:02<03:48,  1.86s/it, loss=4.8117, recon=0.9998, ce=3.8119]Epoch 1/3:  21%|██        | 33/156 [01:04<03:48,  1.86s/it, loss=5.1287, recon=0.9996, ce=4.1291]Epoch 1/3:  22%|██▏       | 34/156 [01:04<03:47,  1.86s/it, loss=5.1287, recon=0.9996, ce=4.1291]Epoch 1/3:  22%|██▏       | 34/156 [01:06<03:47,  1.86s/it, loss=5.1568, recon=0.9995, ce=4.1573]Epoch 1/3:  22%|██▏       | 35/156 [01:06<03:45,  1.87s/it, loss=5.1568, recon=0.9995, ce=4.1573]Epoch 1/3:  22%|██▏       | 35/156 [01:08<03:45,  1.87s/it, loss=4.8353, recon=0.9993, ce=3.8360]Epoch 1/3:  23%|██▎       | 36/156 [01:08<03:43,  1.87s/it, loss=4.8353, recon=0.9993, ce=3.8360]Epoch 1/3:  23%|██▎       | 36/156 [01:09<03:43,  1.87s/it, loss=4.7666, recon=0.9992, ce=3.7675]Epoch 1/3:  24%|██▎       | 37/156 [01:09<03:42,  1.87s/it, loss=4.7666, recon=0.9992, ce=3.7675]Epoch 1/3:  24%|██▎       | 37/156 [01:11<03:42,  1.87s/it, loss=4.6576, recon=0.9990, ce=3.6586]Epoch 1/3:  24%|██▍       | 38/156 [01:11<03:40,  1.87s/it, loss=4.6576, recon=0.9990, ce=3.6586]Epoch 1/3:  24%|██▍       | 38/156 [01:13<03:40,  1.87s/it, loss=4.6256, recon=0.9989, ce=3.6267]Epoch 1/3:  25%|██▌       | 39/156 [01:13<03:39,  1.87s/it, loss=4.6256, recon=0.9989, ce=3.6267]Epoch 1/3:  25%|██▌       | 39/156 [01:15<03:39,  1.87s/it, loss=4.8785, recon=0.9987, ce=3.8798]Epoch 1/3:  26%|██▌       | 40/156 [01:15<03:37,  1.87s/it, loss=4.8785, recon=0.9987, ce=3.8798]Epoch 1/3:  26%|██▌       | 40/156 [01:17<03:37,  1.87s/it, loss=5.0941, recon=0.9986, ce=4.0956]Epoch 1/3:  26%|██▋       | 41/156 [01:17<03:34,  1.86s/it, loss=5.0941, recon=0.9986, ce=4.0956]Epoch 1/3:  26%|██▋       | 41/156 [01:19<03:34,  1.86s/it, loss=4.6214, recon=0.9985, ce=3.6229]Epoch 1/3:  27%|██▋       | 42/156 [01:19<03:33,  1.87s/it, loss=4.6214, recon=0.9985, ce=3.6229]Epoch 1/3:  27%|██▋       | 42/156 [01:21<03:33,  1.87s/it, loss=4.9599, recon=0.9983, ce=3.9615]Epoch 1/3:  28%|██▊       | 43/156 [01:21<03:31,  1.87s/it, loss=4.9599, recon=0.9983, ce=3.9615]Epoch 1/3:  28%|██▊       | 43/156 [01:23<03:31,  1.87s/it, loss=4.5332, recon=0.9982, ce=3.5351]Epoch 1/3:  28%|██▊       | 44/156 [01:23<03:29,  1.87s/it, loss=4.5332, recon=0.9982, ce=3.5351]Epoch 1/3:  28%|██▊       | 44/156 [01:24<03:29,  1.87s/it, loss=4.7364, recon=0.9981, ce=3.7384]Epoch 1/3:  29%|██▉       | 45/156 [01:24<03:28,  1.87s/it, loss=4.7364, recon=0.9981, ce=3.7384]Epoch 1/3:  29%|██▉       | 45/156 [01:26<03:28,  1.87s/it, loss=4.6610, recon=0.9979, ce=3.6631]Epoch 1/3:  29%|██▉       | 46/156 [01:26<03:26,  1.88s/it, loss=4.6610, recon=0.9979, ce=3.6631]Epoch 1/3:  29%|██▉       | 46/156 [01:28<03:26,  1.88s/it, loss=4.7408, recon=0.9978, ce=3.7430]Epoch 1/3:  30%|███       | 47/156 [01:28<03:24,  1.88s/it, loss=4.7408, recon=0.9978, ce=3.7430]Epoch 1/3:  30%|███       | 47/156 [01:30<03:24,  1.88s/it, loss=4.4312, recon=0.9977, ce=3.4336]Epoch 1/3:  31%|███       | 48/156 [01:30<03:22,  1.88s/it, loss=4.4312, recon=0.9977, ce=3.4336]Epoch 1/3:  31%|███       | 48/156 [01:32<03:22,  1.88s/it, loss=4.5518, recon=0.9976, ce=3.5542]Epoch 1/3:  31%|███▏      | 49/156 [01:32<03:20,  1.87s/it, loss=4.5518, recon=0.9976, ce=3.5542]Epoch 1/3:  31%|███▏      | 49/156 [01:34<03:20,  1.87s/it, loss=4.7490, recon=0.9974, ce=3.7515]Epoch 1/3:  32%|███▏      | 50/156 [01:34<03:19,  1.88s/it, loss=4.7490, recon=0.9974, ce=3.7515]Epoch 1/3:  32%|███▏      | 50/156 [01:36<03:19,  1.88s/it, loss=4.6480, recon=0.9973, ce=3.6507]Epoch 1/3:  33%|███▎      | 51/156 [01:36<03:17,  1.88s/it, loss=4.6480, recon=0.9973, ce=3.6507]Epoch 1/3:  33%|███▎      | 51/156 [01:38<03:17,  1.88s/it, loss=4.3974, recon=0.9972, ce=3.4001]Epoch 1/3:  33%|███▎      | 52/156 [01:38<03:15,  1.88s/it, loss=4.3974, recon=0.9972, ce=3.4001]Epoch 1/3:  33%|███▎      | 52/156 [01:39<03:15,  1.88s/it, loss=4.5575, recon=0.9971, ce=3.5604]Epoch 1/3:  34%|███▍      | 53/156 [01:39<03:13,  1.88s/it, loss=4.5575, recon=0.9971, ce=3.5604]Epoch 1/3:  34%|███▍      | 53/156 [01:41<03:13,  1.88s/it, loss=4.6970, recon=0.9970, ce=3.7000]Epoch 1/3:  35%|███▍      | 54/156 [01:41<03:11,  1.88s/it, loss=4.6970, recon=0.9970, ce=3.7000]Epoch 1/3:  35%|███▍      | 54/156 [01:43<03:11,  1.88s/it, loss=4.4517, recon=0.9970, ce=3.4548]Epoch 1/3:  35%|███▌      | 55/156 [01:43<03:09,  1.87s/it, loss=4.4517, recon=0.9970, ce=3.4548]Epoch 1/3:  35%|███▌      | 55/156 [01:45<03:09,  1.87s/it, loss=4.4244, recon=0.9969, ce=3.4275]Epoch 1/3:  36%|███▌      | 56/156 [01:45<03:07,  1.87s/it, loss=4.4244, recon=0.9969, ce=3.4275]Epoch 1/3:  36%|███▌      | 56/156 [01:47<03:07,  1.87s/it, loss=4.2130, recon=0.9967, ce=3.2163]Epoch 1/3:  37%|███▋      | 57/156 [01:47<03:05,  1.87s/it, loss=4.2130, recon=0.9967, ce=3.2163]Epoch 1/3:  37%|███▋      | 57/156 [01:49<03:05,  1.87s/it, loss=4.4640, recon=0.9966, ce=3.4674]Epoch 1/3:  37%|███▋      | 58/156 [01:49<03:04,  1.88s/it, loss=4.4640, recon=0.9966, ce=3.4674]Epoch 1/3:  37%|███▋      | 58/156 [01:51<03:04,  1.88s/it, loss=4.4395, recon=0.9966, ce=3.4429]Epoch 1/3:  38%|███▊      | 59/156 [01:51<03:02,  1.88s/it, loss=4.4395, recon=0.9966, ce=3.4429]Epoch 1/3:  38%|███▊      | 59/156 [01:53<03:02,  1.88s/it, loss=4.4256, recon=0.9964, ce=3.4291]Epoch 1/3:  38%|███▊      | 60/156 [01:53<03:00,  1.88s/it, loss=4.4256, recon=0.9964, ce=3.4291]Epoch 1/3:  38%|███▊      | 60/156 [01:54<03:00,  1.88s/it, loss=4.3587, recon=0.9963, ce=3.3624]Epoch 1/3:  39%|███▉      | 61/156 [01:54<02:58,  1.88s/it, loss=4.3587, recon=0.9963, ce=3.3624]Epoch 1/3:  39%|███▉      | 61/156 [01:56<02:58,  1.88s/it, loss=4.4581, recon=0.9962, ce=3.4619]Epoch 1/3:  40%|███▉      | 62/156 [01:56<02:56,  1.88s/it, loss=4.4581, recon=0.9962, ce=3.4619]Epoch 1/3:  40%|███▉      | 62/156 [01:58<02:56,  1.88s/it, loss=4.3096, recon=0.9960, ce=3.3136]Epoch 1/3:  40%|████      | 63/156 [01:58<02:53,  1.87s/it, loss=4.3096, recon=0.9960, ce=3.3136]Epoch 1/3:  40%|████      | 63/156 [02:00<02:53,  1.87s/it, loss=4.2983, recon=0.9959, ce=3.3024]Epoch 1/3:  41%|████      | 64/156 [02:00<02:51,  1.86s/it, loss=4.2983, recon=0.9959, ce=3.3024]Epoch 1/3:  41%|████      | 64/156 [02:02<02:51,  1.86s/it, loss=4.2824, recon=0.9958, ce=3.2867]Epoch 1/3:  42%|████▏     | 65/156 [02:02<02:50,  1.87s/it, loss=4.2824, recon=0.9958, ce=3.2867]Epoch 1/3:  42%|████▏     | 65/156 [02:04<02:50,  1.87s/it, loss=4.4431, recon=0.9957, ce=3.4474]Epoch 1/3:  42%|████▏     | 66/156 [02:04<02:48,  1.87s/it, loss=4.4431, recon=0.9957, ce=3.4474]Epoch 1/3:  42%|████▏     | 66/156 [02:06<02:48,  1.87s/it, loss=4.3236, recon=0.9956, ce=3.3280]Epoch 1/3:  43%|████▎     | 67/156 [02:06<02:46,  1.88s/it, loss=4.3236, recon=0.9956, ce=3.3280]Epoch 1/3:  43%|████▎     | 67/156 [02:08<02:46,  1.88s/it, loss=4.4548, recon=0.9954, ce=3.4594]Epoch 1/3:  44%|████▎     | 68/156 [02:08<02:45,  1.88s/it, loss=4.4548, recon=0.9954, ce=3.4594]Epoch 1/3:  44%|████▎     | 68/156 [02:09<02:45,  1.88s/it, loss=4.4189, recon=0.9952, ce=3.4236]Epoch 1/3:  44%|████▍     | 69/156 [02:09<02:43,  1.88s/it, loss=4.4189, recon=0.9952, ce=3.4236]Epoch 1/3:  44%|████▍     | 69/156 [02:11<02:43,  1.88s/it, loss=4.1971, recon=0.9951, ce=3.2020]Epoch 1/3:  45%|████▍     | 70/156 [02:11<02:41,  1.87s/it, loss=4.1971, recon=0.9951, ce=3.2020]Epoch 1/3:  45%|████▍     | 70/156 [02:13<02:41,  1.87s/it, loss=4.2682, recon=0.9949, ce=3.2733]Epoch 1/3:  46%|████▌     | 71/156 [02:13<02:38,  1.86s/it, loss=4.2682, recon=0.9949, ce=3.2733]Epoch 1/3:  46%|████▌     | 71/156 [02:15<02:38,  1.86s/it, loss=4.0092, recon=0.9948, ce=3.0144]Epoch 1/3:  46%|████▌     | 72/156 [02:15<02:36,  1.87s/it, loss=4.0092, recon=0.9948, ce=3.0144]Epoch 1/3:  46%|████▌     | 72/156 [02:17<02:36,  1.87s/it, loss=4.1278, recon=0.9946, ce=3.1332]Epoch 1/3:  47%|████▋     | 73/156 [02:17<02:34,  1.86s/it, loss=4.1278, recon=0.9946, ce=3.1332]Epoch 1/3:  47%|████▋     | 73/156 [02:19<02:34,  1.86s/it, loss=4.1568, recon=0.9945, ce=3.1623]Epoch 1/3:  47%|████▋     | 74/156 [02:19<02:32,  1.87s/it, loss=4.1568, recon=0.9945, ce=3.1623]Epoch 1/3:  47%|████▋     | 74/156 [02:21<02:32,  1.87s/it, loss=4.1919, recon=0.9943, ce=3.1976]Epoch 1/3:  48%|████▊     | 75/156 [02:21<02:31,  1.87s/it, loss=4.1919, recon=0.9943, ce=3.1976]Epoch 1/3:  48%|████▊     | 75/156 [02:22<02:31,  1.87s/it, loss=4.1311, recon=0.9943, ce=3.1368]Epoch 1/3:  49%|████▊     | 76/156 [02:22<02:29,  1.87s/it, loss=4.1311, recon=0.9943, ce=3.1368]Epoch 1/3:  49%|████▊     | 76/156 [02:24<02:29,  1.87s/it, loss=3.7635, recon=0.9941, ce=2.7693]Epoch 1/3:  49%|████▉     | 77/156 [02:24<02:28,  1.87s/it, loss=3.7635, recon=0.9941, ce=2.7693]Epoch 1/3:  49%|████▉     | 77/156 [02:26<02:28,  1.87s/it, loss=4.2662, recon=0.9940, ce=3.2722]Epoch 1/3:  50%|█████     | 78/156 [02:26<02:26,  1.88s/it, loss=4.2662, recon=0.9940, ce=3.2722]Epoch 1/3:  50%|█████     | 78/156 [02:28<02:26,  1.88s/it, loss=4.1424, recon=0.9938, ce=3.1486]Epoch 1/3:  51%|█████     | 79/156 [02:28<02:24,  1.88s/it, loss=4.1424, recon=0.9938, ce=3.1486]Epoch 1/3:  51%|█████     | 79/156 [02:30<02:24,  1.88s/it, loss=4.0686, recon=0.9936, ce=3.0749]Epoch 1/3:  51%|█████▏    | 80/156 [02:30<02:22,  1.88s/it, loss=4.0686, recon=0.9936, ce=3.0749]Epoch 1/3:  51%|█████▏    | 80/156 [02:32<02:22,  1.88s/it, loss=4.0960, recon=0.9934, ce=3.1026]Epoch 1/3:  52%|█████▏    | 81/156 [02:32<02:21,  1.88s/it, loss=4.0960, recon=0.9934, ce=3.1026]Epoch 1/3:  52%|█████▏    | 81/156 [02:34<02:21,  1.88s/it, loss=3.9968, recon=0.9932, ce=3.0036]Epoch 1/3:  53%|█████▎    | 82/156 [02:34<02:19,  1.88s/it, loss=3.9968, recon=0.9932, ce=3.0036]Epoch 1/3:  53%|█████▎    | 82/156 [02:36<02:19,  1.88s/it, loss=3.9025, recon=0.9930, ce=2.9095]Epoch 1/3:  53%|█████▎    | 83/156 [02:36<02:17,  1.88s/it, loss=3.9025, recon=0.9930, ce=2.9095]Epoch 1/3:  53%|█████▎    | 83/156 [02:38<02:17,  1.88s/it, loss=3.7451, recon=0.9928, ce=2.7523]Epoch 1/3:  54%|█████▍    | 84/156 [02:38<02:15,  1.88s/it, loss=3.7451, recon=0.9928, ce=2.7523]Epoch 1/3:  54%|█████▍    | 84/156 [02:39<02:15,  1.88s/it, loss=3.8322, recon=0.9927, ce=2.8396]Epoch 1/3:  54%|█████▍    | 85/156 [02:39<02:13,  1.88s/it, loss=3.8322, recon=0.9927, ce=2.8396]Epoch 1/3:  54%|█████▍    | 85/156 [02:41<02:13,  1.88s/it, loss=3.9322, recon=0.9925, ce=2.9397]Epoch 1/3:  55%|█████▌    | 86/156 [02:41<02:10,  1.87s/it, loss=3.9322, recon=0.9925, ce=2.9397]Epoch 1/3:  55%|█████▌    | 86/156 [02:43<02:10,  1.87s/it, loss=3.8554, recon=0.9923, ce=2.8632]Epoch 1/3:  56%|█████▌    | 87/156 [02:43<02:08,  1.86s/it, loss=3.8554, recon=0.9923, ce=2.8632]Epoch 1/3:  56%|█████▌    | 87/156 [02:45<02:08,  1.86s/it, loss=3.9676, recon=0.9921, ce=2.9755]Epoch 1/3:  56%|█████▋    | 88/156 [02:45<02:07,  1.87s/it, loss=3.9676, recon=0.9921, ce=2.9755]Epoch 1/3:  56%|█████▋    | 88/156 [02:47<02:07,  1.87s/it, loss=4.2138, recon=0.9919, ce=3.2220]Epoch 1/3:  57%|█████▋    | 89/156 [02:47<02:05,  1.87s/it, loss=4.2138, recon=0.9919, ce=3.2220]Epoch 1/3:  57%|█████▋    | 89/156 [02:49<02:05,  1.87s/it, loss=3.7397, recon=0.9917, ce=2.7481]Epoch 1/3:  58%|█████▊    | 90/156 [02:49<02:03,  1.87s/it, loss=3.7397, recon=0.9917, ce=2.7481]Epoch 1/3:  58%|█████▊    | 90/156 [02:51<02:03,  1.87s/it, loss=3.9173, recon=0.9914, ce=2.9259]Epoch 1/3:  58%|█████▊    | 91/156 [02:51<02:02,  1.88s/it, loss=3.9173, recon=0.9914, ce=2.9259]Epoch 1/3:  58%|█████▊    | 91/156 [02:52<02:02,  1.88s/it, loss=3.8694, recon=0.9911, ce=2.8782]Epoch 1/3:  59%|█████▉    | 92/156 [02:52<02:00,  1.88s/it, loss=3.8694, recon=0.9911, ce=2.8782]Epoch 1/3:  59%|█████▉    | 92/156 [02:54<02:00,  1.88s/it, loss=3.8103, recon=0.9910, ce=2.8193]Epoch 1/3:  60%|█████▉    | 93/156 [02:54<01:58,  1.88s/it, loss=3.8103, recon=0.9910, ce=2.8193]Epoch 1/3:  60%|█████▉    | 93/156 [02:56<01:58,  1.88s/it, loss=3.9600, recon=0.9908, ce=2.9692]Epoch 1/3:  60%|██████    | 94/156 [02:56<01:56,  1.88s/it, loss=3.9600, recon=0.9908, ce=2.9692]Epoch 1/3:  60%|██████    | 94/156 [02:58<01:56,  1.88s/it, loss=3.8165, recon=0.9905, ce=2.8260]Epoch 1/3:  61%|██████    | 95/156 [02:58<01:54,  1.88s/it, loss=3.8165, recon=0.9905, ce=2.8260]Epoch 1/3:  61%|██████    | 95/156 [03:00<01:54,  1.88s/it, loss=3.8627, recon=0.9904, ce=2.8723]Epoch 1/3:  62%|██████▏   | 96/156 [03:00<01:52,  1.88s/it, loss=3.8627, recon=0.9904, ce=2.8723]Epoch 1/3:  62%|██████▏   | 96/156 [03:02<01:52,  1.88s/it, loss=3.9055, recon=0.9901, ce=2.9154]Epoch 1/3:  62%|██████▏   | 97/156 [03:02<01:50,  1.88s/it, loss=3.9055, recon=0.9901, ce=2.9154]Epoch 1/3:  62%|██████▏   | 97/156 [03:04<01:50,  1.88s/it, loss=3.6162, recon=0.9898, ce=2.6263]Epoch 1/3:  63%|██████▎   | 98/156 [03:04<01:48,  1.88s/it, loss=3.6162, recon=0.9898, ce=2.6263]Epoch 1/3:  63%|██████▎   | 98/156 [03:06<01:48,  1.88s/it, loss=3.8816, recon=0.9896, ce=2.8920]Epoch 1/3:  63%|██████▎   | 99/156 [03:06<01:46,  1.87s/it, loss=3.8816, recon=0.9896, ce=2.8920]Epoch 1/3:  63%|██████▎   | 99/156 [03:07<01:46,  1.87s/it, loss=3.7082, recon=0.9893, ce=2.7189]/projects/m000066/sujinesh/LatentWire/.venv/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/projects/m000066/sujinesh/LatentWire/.venv/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
The attention mask is not set and cannot be inferred from input because pad token is same as eos token. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Starting from v4.46, the `logits` model output will have the same type as the model (except at train time, where it will always be FP32)
Epoch 1/3:  64%|██████▍   | 100/156 [03:08<01:50,  1.97s/it, loss=3.7082, recon=0.9893, ce=2.7189]Epoch 1/3:  64%|██████▍   | 100/156 [03:10<01:50,  1.97s/it, loss=3.6890, recon=0.9890, ce=2.6999]Epoch 1/3:  65%|██████▍   | 101/156 [03:10<01:47,  1.95s/it, loss=3.6890, recon=0.9890, ce=2.6999]Epoch 1/3:  65%|██████▍   | 101/156 [03:12<01:47,  1.95s/it, loss=3.6964, recon=0.9887, ce=2.7077]Epoch 1/3:  65%|██████▌   | 102/156 [03:12<01:44,  1.93s/it, loss=3.6964, recon=0.9887, ce=2.7077]Epoch 1/3:  65%|██████▌   | 102/156 [03:13<01:44,  1.93s/it, loss=3.6025, recon=0.9885, ce=2.6140]Epoch 1/3:  66%|██████▌   | 103/156 [03:13<01:41,  1.91s/it, loss=3.6025, recon=0.9885, ce=2.6140]Epoch 1/3:  66%|██████▌   | 103/156 [03:15<01:41,  1.91s/it, loss=3.7934, recon=0.9882, ce=2.8051]Epoch 1/3:  67%|██████▋   | 104/156 [03:15<01:38,  1.90s/it, loss=3.7934, recon=0.9882, ce=2.8051]Epoch 1/3:  67%|██████▋   | 104/156 [03:17<01:38,  1.90s/it, loss=3.7828, recon=0.9879, ce=2.7949]Epoch 1/3:  67%|██████▋   | 105/156 [03:17<01:36,  1.90s/it, loss=3.7828, recon=0.9879, ce=2.7949]Epoch 1/3:  67%|██████▋   | 105/156 [03:19<01:36,  1.90s/it, loss=3.7422, recon=0.9877, ce=2.7545]Epoch 1/3:  68%|██████▊   | 106/156 [03:19<01:34,  1.89s/it, loss=3.7422, recon=0.9877, ce=2.7545]Epoch 1/3:  68%|██████▊   | 106/156 [03:21<01:34,  1.89s/it, loss=3.6465, recon=0.9874, ce=2.6590]Epoch 1/3:  69%|██████▊   | 107/156 [03:21<01:32,  1.88s/it, loss=3.6465, recon=0.9874, ce=2.6590]Epoch 1/3:  69%|██████▊   | 107/156 [03:23<01:32,  1.88s/it, loss=3.5205, recon=0.9872, ce=2.5333]Epoch 1/3:  69%|██████▉   | 108/156 [03:23<01:30,  1.88s/it, loss=3.5205, recon=0.9872, ce=2.5333]Epoch 1/3:  69%|██████▉   | 108/156 [03:25<01:30,  1.88s/it, loss=3.5481, recon=0.9869, ce=2.5612]Epoch 1/3:  70%|██████▉   | 109/156 [03:25<01:28,  1.88s/it, loss=3.5481, recon=0.9869, ce=2.5612]Epoch 1/3:  70%|██████▉   | 109/156 [03:27<01:28,  1.88s/it, loss=3.5753, recon=0.9866, ce=2.5887]Epoch 1/3:  71%|███████   | 110/156 [03:27<01:26,  1.88s/it, loss=3.5753, recon=0.9866, ce=2.5887]Epoch 1/3:  71%|███████   | 110/156 [03:28<01:26,  1.88s/it, loss=3.6609, recon=0.9862, ce=2.6746]Epoch 1/3:  71%|███████   | 111/156 [03:28<01:24,  1.88s/it, loss=3.6609, recon=0.9862, ce=2.6746]Epoch 1/3:  71%|███████   | 111/156 [03:30<01:24,  1.88s/it, loss=3.6549, recon=0.9859, ce=2.6691]Epoch 1/3:  72%|███████▏  | 112/156 [03:30<01:22,  1.88s/it, loss=3.6549, recon=0.9859, ce=2.6691]Epoch 1/3:  72%|███████▏  | 112/156 [03:32<01:22,  1.88s/it, loss=3.5624, recon=0.9856, ce=2.5768]Epoch 1/3:  72%|███████▏  | 113/156 [03:32<01:20,  1.88s/it, loss=3.5624, recon=0.9856, ce=2.5768]Epoch 1/3:  72%|███████▏  | 113/156 [03:34<01:20,  1.88s/it, loss=3.6898, recon=0.9853, ce=2.7045]Epoch 1/3:  73%|███████▎  | 114/156 [03:34<01:18,  1.88s/it, loss=3.6898, recon=0.9853, ce=2.7045]Epoch 1/3:  73%|███████▎  | 114/156 [03:36<01:18,  1.88s/it, loss=3.4597, recon=0.9850, ce=2.4747]Epoch 1/3:  74%|███████▎  | 115/156 [03:36<01:17,  1.88s/it, loss=3.4597, recon=0.9850, ce=2.4747]Epoch 1/3:  74%|███████▎  | 115/156 [03:38<01:17,  1.88s/it, loss=3.7120, recon=0.9847, ce=2.7273]Epoch 1/3:  74%|███████▍  | 116/156 [03:38<01:14,  1.87s/it, loss=3.7120, recon=0.9847, ce=2.7273]Epoch 1/3:  74%|███████▍  | 116/156 [03:40<01:14,  1.87s/it, loss=3.4427, recon=0.9846, ce=2.4581]Epoch 1/3:  75%|███████▌  | 117/156 [03:40<01:12,  1.87s/it, loss=3.4427, recon=0.9846, ce=2.4581]Epoch 1/3:  75%|███████▌  | 117/156 [03:42<01:12,  1.87s/it, loss=3.5518, recon=0.9843, ce=2.5675]Epoch 1/3:  76%|███████▌  | 118/156 [03:42<01:11,  1.87s/it, loss=3.5518, recon=0.9843, ce=2.5675]Epoch 1/3:  76%|███████▌  | 118/156 [03:43<01:11,  1.87s/it, loss=3.5083, recon=0.9838, ce=2.5245]Epoch 1/3:  76%|███████▋  | 119/156 [03:43<01:09,  1.88s/it, loss=3.5083, recon=0.9838, ce=2.5245]Epoch 1/3:  76%|███████▋  | 119/156 [03:45<01:09,  1.88s/it, loss=3.6243, recon=0.9835, ce=2.6408]Epoch 1/3:  77%|███████▋  | 120/156 [03:45<01:07,  1.88s/it, loss=3.6243, recon=0.9835, ce=2.6408]Epoch 1/3:  77%|███████▋  | 120/156 [03:47<01:07,  1.88s/it, loss=3.5925, recon=0.9832, ce=2.6094]Epoch 1/3:  78%|███████▊  | 121/156 [03:47<01:05,  1.87s/it, loss=3.5925, recon=0.9832, ce=2.6094]Epoch 1/3:  78%|███████▊  | 121/156 [03:49<01:05,  1.87s/it, loss=3.5817, recon=0.9829, ce=2.5988]Epoch 1/3:  78%|███████▊  | 122/156 [03:49<01:03,  1.87s/it, loss=3.5817, recon=0.9829, ce=2.5988]Epoch 1/3:  78%|███████▊  | 122/156 [03:51<01:03,  1.87s/it, loss=3.4816, recon=0.9826, ce=2.4990]Epoch 1/3:  79%|███████▉  | 123/156 [03:51<01:01,  1.87s/it, loss=3.4816, recon=0.9826, ce=2.4990]Epoch 1/3:  79%|███████▉  | 123/156 [03:53<01:01,  1.87s/it, loss=3.5414, recon=0.9823, ce=2.5591]Epoch 1/3:  79%|███████▉  | 124/156 [03:53<00:59,  1.87s/it, loss=3.5414, recon=0.9823, ce=2.5591]Epoch 1/3:  79%|███████▉  | 124/156 [03:55<00:59,  1.87s/it, loss=3.6064, recon=0.9820, ce=2.6245]Epoch 1/3:  80%|████████  | 125/156 [03:55<00:58,  1.87s/it, loss=3.6064, recon=0.9820, ce=2.6245]Epoch 1/3:  80%|████████  | 125/156 [03:57<00:58,  1.87s/it, loss=3.5701, recon=0.9817, ce=2.5884]Epoch 1/3:  81%|████████  | 126/156 [03:57<00:56,  1.87s/it, loss=3.5701, recon=0.9817, ce=2.5884]Epoch 1/3:  81%|████████  | 126/156 [03:58<00:56,  1.87s/it, loss=3.5488, recon=0.9814, ce=2.5674]Epoch 1/3:  81%|████████▏ | 127/156 [03:58<00:54,  1.88s/it, loss=3.5488, recon=0.9814, ce=2.5674]Epoch 1/3:  81%|████████▏ | 127/156 [04:00<00:54,  1.88s/it, loss=3.4898, recon=0.9811, ce=2.5087]Epoch 1/3:  82%|████████▏ | 128/156 [04:00<00:52,  1.88s/it, loss=3.4898, recon=0.9811, ce=2.5087]Epoch 1/3:  82%|████████▏ | 128/156 [04:02<00:52,  1.88s/it, loss=3.4512, recon=0.9809, ce=2.4703]Epoch 1/3:  83%|████████▎ | 129/156 [04:02<00:50,  1.88s/it, loss=3.4512, recon=0.9809, ce=2.4703]Epoch 1/3:  83%|████████▎ | 129/156 [04:04<00:50,  1.88s/it, loss=3.6817, recon=0.9806, ce=2.7011]Epoch 1/3:  83%|████████▎ | 130/156 [04:04<00:48,  1.87s/it, loss=3.6817, recon=0.9806, ce=2.7011]Epoch 1/3:  83%|████████▎ | 130/156 [04:06<00:48,  1.87s/it, loss=3.5583, recon=0.9803, ce=2.5779]Epoch 1/3:  84%|████████▍ | 131/156 [04:06<00:46,  1.87s/it, loss=3.5583, recon=0.9803, ce=2.5779]Epoch 1/3:  84%|████████▍ | 131/156 [04:08<00:46,  1.87s/it, loss=3.2891, recon=0.9801, ce=2.3090]Epoch 1/3:  85%|████████▍ | 132/156 [04:08<00:44,  1.87s/it, loss=3.2891, recon=0.9801, ce=2.3090]Epoch 1/3:  85%|████████▍ | 132/156 [04:10<00:44,  1.87s/it, loss=3.5311, recon=0.9797, ce=2.5514]Epoch 1/3:  85%|████████▌ | 133/156 [04:10<00:43,  1.87s/it, loss=3.5311, recon=0.9797, ce=2.5514]Epoch 1/3:  85%|████████▌ | 133/156 [04:12<00:43,  1.87s/it, loss=3.6855, recon=0.9794, ce=2.7061]Epoch 1/3:  86%|████████▌ | 134/156 [04:12<00:41,  1.87s/it, loss=3.6855, recon=0.9794, ce=2.7061]Epoch 1/3:  86%|████████▌ | 134/156 [04:13<00:41,  1.87s/it, loss=3.4492, recon=0.9791, ce=2.4701]Epoch 1/3:  87%|████████▋ | 135/156 [04:13<00:39,  1.88s/it, loss=3.4492, recon=0.9791, ce=2.4701]Epoch 1/3:  87%|████████▋ | 135/156 [04:15<00:39,  1.88s/it, loss=3.5258, recon=0.9788, ce=2.5470]Epoch 1/3:  87%|████████▋ | 136/156 [04:15<00:37,  1.88s/it, loss=3.5258, recon=0.9788, ce=2.5470]Epoch 1/3:  87%|████████▋ | 136/156 [04:17<00:37,  1.88s/it, loss=3.4808, recon=0.9785, ce=2.5023]Epoch 1/3:  88%|████████▊ | 137/156 [04:17<00:35,  1.87s/it, loss=3.4808, recon=0.9785, ce=2.5023]Epoch 1/3:  88%|████████▊ | 137/156 [04:19<00:35,  1.87s/it, loss=3.3293, recon=0.9781, ce=2.3512]Epoch 1/3:  88%|████████▊ | 138/156 [04:19<00:33,  1.88s/it, loss=3.3293, recon=0.9781, ce=2.3512]Epoch 1/3:  88%|████████▊ | 138/156 [04:21<00:33,  1.88s/it, loss=3.3346, recon=0.9779, ce=2.3567]Epoch 1/3:  89%|████████▉ | 139/156 [04:21<00:31,  1.87s/it, loss=3.3346, recon=0.9779, ce=2.3567]Epoch 1/3:  89%|████████▉ | 139/156 [04:23<00:31,  1.87s/it, loss=3.4477, recon=0.9776, ce=2.4700]Epoch 1/3:  90%|████████▉ | 140/156 [04:23<00:29,  1.87s/it, loss=3.4477, recon=0.9776, ce=2.4700]Epoch 1/3:  90%|████████▉ | 140/156 [04:25<00:29,  1.87s/it, loss=3.5031, recon=0.9773, ce=2.5258]Epoch 1/3:  90%|█████████ | 141/156 [04:25<00:28,  1.88s/it, loss=3.5031, recon=0.9773, ce=2.5258]Epoch 1/3:  90%|█████████ | 141/156 [04:27<00:28,  1.88s/it, loss=3.4701, recon=0.9770, ce=2.4930]Epoch 1/3:  91%|█████████ | 142/156 [04:27<00:26,  1.88s/it, loss=3.4701, recon=0.9770, ce=2.4930]Epoch 1/3:  91%|█████████ | 142/156 [04:28<00:26,  1.88s/it, loss=3.3477, recon=0.9767, ce=2.3710]Epoch 1/3:  92%|█████████▏| 143/156 [04:28<00:24,  1.88s/it, loss=3.3477, recon=0.9767, ce=2.3710]Epoch 1/3:  92%|█████████▏| 143/156 [04:30<00:24,  1.88s/it, loss=3.2116, recon=0.9764, ce=2.2352]Epoch 1/3:  92%|█████████▏| 144/156 [04:30<00:22,  1.88s/it, loss=3.2116, recon=0.9764, ce=2.2352]Epoch 1/3:  92%|█████████▏| 144/156 [04:32<00:22,  1.88s/it, loss=3.2017, recon=0.9761, ce=2.2257]Epoch 1/3:  93%|█████████▎| 145/156 [04:32<00:20,  1.88s/it, loss=3.2017, recon=0.9761, ce=2.2257]Epoch 1/3:  93%|█████████▎| 145/156 [04:34<00:20,  1.88s/it, loss=3.4036, recon=0.9757, ce=2.4279]Epoch 1/3:  94%|█████████▎| 146/156 [04:34<00:18,  1.88s/it, loss=3.4036, recon=0.9757, ce=2.4279]Epoch 1/3:  94%|█████████▎| 146/156 [04:36<00:18,  1.88s/it, loss=3.4104, recon=0.9754, ce=2.4350]Epoch 1/3:  94%|█████████▍| 147/156 [04:36<00:16,  1.87s/it, loss=3.4104, recon=0.9754, ce=2.4350]Epoch 1/3:  94%|█████████▍| 147/156 [04:38<00:16,  1.87s/it, loss=3.2095, recon=0.9751, ce=2.2344]Epoch 1/3:  95%|█████████▍| 148/156 [04:38<00:14,  1.87s/it, loss=3.2095, recon=0.9751, ce=2.2344]Epoch 1/3:  95%|█████████▍| 148/156 [04:40<00:14,  1.87s/it, loss=3.4875, recon=0.9748, ce=2.5128]Epoch 1/3:  96%|█████████▌| 149/156 [04:40<00:13,  1.88s/it, loss=3.4875, recon=0.9748, ce=2.5128]Epoch 1/3:  96%|█████████▌| 149/156 [04:42<00:13,  1.88s/it, loss=3.2131, recon=0.9745, ce=2.2386]Epoch 1/3:  96%|█████████▌| 150/156 [04:42<00:11,  1.88s/it, loss=3.2131, recon=0.9745, ce=2.2386]Epoch 1/3:  96%|█████████▌| 150/156 [04:43<00:11,  1.88s/it, loss=3.6840, recon=0.9741, ce=2.7099]Epoch 1/3:  97%|█████████▋| 151/156 [04:43<00:09,  1.88s/it, loss=3.6840, recon=0.9741, ce=2.7099]Epoch 1/3:  97%|█████████▋| 151/156 [04:45<00:09,  1.88s/it, loss=3.1909, recon=0.9738, ce=2.2171]Epoch 1/3:  97%|█████████▋| 152/156 [04:45<00:07,  1.88s/it, loss=3.1909, recon=0.9738, ce=2.2171]Epoch 1/3:  97%|█████████▋| 152/156 [04:47<00:07,  1.88s/it, loss=3.2579, recon=0.9735, ce=2.2844]Epoch 1/3:  98%|█████████▊| 153/156 [04:47<00:05,  1.88s/it, loss=3.2579, recon=0.9735, ce=2.2844]Epoch 1/3:  98%|█████████▊| 153/156 [04:49<00:05,  1.88s/it, loss=3.2057, recon=0.9732, ce=2.2325]Epoch 1/3:  99%|█████████▊| 154/156 [04:49<00:03,  1.88s/it, loss=3.2057, recon=0.9732, ce=2.2325]Epoch 1/3:  99%|█████████▊| 154/156 [04:51<00:03,  1.88s/it, loss=3.3839, recon=0.9728, ce=2.4111]Epoch 1/3:  99%|█████████▉| 155/156 [04:51<00:01,  1.87s/it, loss=3.3839, recon=0.9728, ce=2.4111]Epoch 1/3:  99%|█████████▉| 155/156 [04:53<00:01,  1.87s/it, loss=3.2780, recon=0.9725, ce=2.3055]Epoch 1/3: 100%|██████████| 156/156 [04:53<00:00,  1.88s/it, loss=3.2780, recon=0.9725, ce=2.3055]Epoch 1/3: 100%|██████████| 156/156 [04:53<00:00,  1.88s/it, loss=3.2780, recon=0.9725, ce=2.3055]

  Step 100: Quick accuracy = 0.0%

Epoch 1 complete:
  Avg loss: 4.5475
  Avg recon: 0.9913
  Avg CE: 3.5562

Running full evaluation...
Evaluating:   0%|          | 0/500 [00:00<?, ?it/s]Evaluating:   1%|          | 5/500 [00:00<00:10, 46.33it/s]Evaluating:   2%|▏         | 10/500 [00:00<00:10, 46.78it/s]Evaluating:   3%|▎         | 15/500 [00:00<00:15, 30.67it/s]Evaluating:   4%|▍         | 19/500 [00:00<00:20, 23.12it/s]Evaluating:   4%|▍         | 22/500 [00:00<00:20, 22.94it/s]Evaluating:   5%|▌         | 26/500 [00:00<00:19, 23.90it/s]Evaluating:   6%|▌         | 30/500 [00:01<00:17, 26.61it/s]Evaluating:   7%|▋         | 35/500 [00:01<00:14, 31.62it/s]Evaluating:   8%|▊         | 40/500 [00:01<00:13, 34.03it/s]Evaluating:   9%|▉         | 44/500 [00:01<00:12, 35.14it/s]Evaluating:  10%|▉         | 48/500 [00:01<00:12, 35.98it/s]Evaluating:  11%|█         | 53/500 [00:01<00:11, 39.00it/s]Evaluating:  12%|█▏        | 58/500 [00:01<00:11, 38.67it/s]Evaluating:  12%|█▏        | 62/500 [00:01<00:11, 36.64it/s]Evaluating:  13%|█▎        | 67/500 [00:02<00:10, 39.45it/s]Evaluating:  14%|█▍        | 72/500 [00:02<00:11, 36.01it/s]Evaluating:  15%|█▌        | 76/500 [00:02<00:12, 33.51it/s]Evaluating:  16%|█▌        | 80/500 [00:02<00:13, 30.95it/s]Evaluating:  17%|█▋        | 84/500 [00:02<00:14, 29.37it/s]Evaluating:  18%|█▊        | 88/500 [00:02<00:16, 24.86it/s]Evaluating:  19%|█▊        | 93/500 [00:02<00:13, 29.56it/s]Evaluating:  19%|█▉        | 97/500 [00:03<00:13, 29.79it/s]Evaluating:  20%|██        | 102/500 [00:03<00:11, 33.89it/s]Evaluating:  21%|██        | 106/500 [00:03<00:11, 34.98it/s]Evaluating:  22%|██▏       | 110/500 [00:03<00:10, 35.83it/s]Evaluating:  23%|██▎       | 115/500 [00:03<00:09, 38.93it/s]Evaluating:  24%|██▍       | 120/500 [00:03<00:10, 37.41it/s]Evaluating:  25%|██▌       | 125/500 [00:03<00:09, 39.96it/s]Evaluating:  26%|██▌       | 130/500 [00:03<00:09, 39.12it/s]Evaluating:  27%|██▋       | 135/500 [00:04<00:08, 41.07it/s]Evaluating:  28%|██▊       | 140/500 [00:04<00:10, 35.55it/s]Evaluating:  29%|██▉       | 144/500 [00:05<00:27, 13.00it/s]Evaluating:  30%|██▉       | 149/500 [00:05<00:20, 16.85it/s]Evaluating:  31%|███       | 154/500 [00:05<00:16, 21.04it/s]Evaluating:  32%|███▏      | 159/500 [00:05<00:13, 25.33it/s]Evaluating:  33%|███▎      | 164/500 [00:05<00:11, 29.48it/s]Evaluating:  34%|███▍      | 169/500 [00:06<00:22, 14.67it/s]Evaluating:  35%|███▍      | 173/500 [00:06<00:19, 16.52it/s]Evaluating:  35%|███▌      | 176/500 [00:06<00:18, 17.13it/s]Evaluating:  36%|███▌      | 181/500 [00:06<00:14, 21.50it/s]Evaluating:  37%|███▋      | 186/500 [00:06<00:12, 26.11it/s]Evaluating:  38%|███▊      | 191/500 [00:06<00:10, 30.40it/s]Evaluating:  39%|███▉      | 195/500 [00:06<00:09, 30.89it/s]Evaluating:  40%|███▉      | 199/500 [00:07<00:09, 32.64it/s]Evaluating:  41%|████      | 204/500 [00:07<00:08, 36.30it/s]Evaluating:  42%|████▏     | 209/500 [00:07<00:08, 35.72it/s]Evaluating:  43%|████▎     | 214/500 [00:07<00:07, 38.60it/s]Evaluating:  44%|████▍     | 219/500 [00:07<00:06, 40.84it/s]Evaluating:  45%|████▍     | 224/500 [00:07<00:07, 39.17it/s]Evaluating:  46%|████▌     | 229/500 [00:07<00:09, 27.94it/s]Evaluating:  47%|████▋     | 233/500 [00:08<00:10, 26.52it/s]Evaluating:  47%|████▋     | 237/500 [00:08<00:10, 26.26it/s]Evaluating:  48%|████▊     | 241/500 [00:08<00:09, 26.28it/s]Evaluating:  49%|████▉     | 245/500 [00:08<00:10, 24.23it/s]Evaluating:  50%|████▉     | 249/500 [00:08<00:09, 26.22it/s]Evaluating:  51%|█████     | 253/500 [00:08<00:08, 27.50it/s]Evaluating:  51%|█████▏    | 257/500 [00:09<00:08, 29.81it/s]Evaluating:  52%|█████▏    | 262/500 [00:09<00:06, 34.10it/s]Evaluating:  53%|█████▎    | 267/500 [00:09<00:06, 37.46it/s]Evaluating:  54%|█████▍    | 272/500 [00:09<00:05, 40.02it/s]Evaluating:  55%|█████▌    | 277/500 [00:09<00:08, 26.43it/s]Evaluating:  56%|█████▌    | 281/500 [00:09<00:09, 22.82it/s]Evaluating:  57%|█████▋    | 284/500 [00:10<00:09, 22.55it/s]Evaluating:  58%|█████▊    | 288/500 [00:10<00:08, 25.28it/s]Evaluating:  59%|█████▊    | 293/500 [00:10<00:06, 30.09it/s]Evaluating:  60%|█████▉    | 298/500 [00:10<00:06, 32.75it/s]Evaluating:  61%|██████    | 303/500 [00:10<00:05, 36.06it/s]Evaluating:  61%|██████▏   | 307/500 [00:10<00:05, 36.65it/s]Evaluating:  62%|██████▏   | 312/500 [00:10<00:04, 39.50it/s]Evaluating:  63%|██████▎   | 317/500 [00:10<00:05, 36.08it/s]Evaluating:  64%|██████▍   | 322/500 [00:10<00:04, 38.87it/s]Evaluating:  65%|██████▌   | 327/500 [00:11<00:04, 39.16it/s]Evaluating:  66%|██████▋   | 332/500 [00:11<00:04, 34.73it/s]Evaluating:  67%|██████▋   | 336/500 [00:11<00:05, 30.49it/s]Evaluating:  68%|██████▊   | 340/500 [00:11<00:06, 25.74it/s]Evaluating:  69%|██████▊   | 343/500 [00:11<00:06, 24.82it/s]Evaluating:  70%|██████▉   | 348/500 [00:11<00:05, 28.96it/s]Evaluating:  71%|███████   | 353/500 [00:12<00:04, 32.71it/s]Evaluating:  71%|███████▏  | 357/500 [00:12<00:04, 32.61it/s]Evaluating:  72%|███████▏  | 361/500 [00:12<00:04, 33.99it/s]Evaluating:  73%|███████▎  | 366/500 [00:12<00:03, 37.46it/s]Evaluating:  74%|███████▍  | 371/500 [00:12<00:03, 40.09it/s]Evaluating:  75%|███████▌  | 376/500 [00:12<00:02, 42.02it/s]Evaluating:  76%|███████▌  | 381/500 [00:12<00:03, 39.37it/s]Evaluating:  77%|███████▋  | 386/500 [00:12<00:02, 39.43it/s]Evaluating:  78%|███████▊  | 391/500 [00:12<00:02, 40.72it/s]Evaluating:  79%|███████▉  | 396/500 [00:13<00:03, 31.02it/s]Evaluating:  80%|████████  | 400/500 [00:13<00:03, 29.55it/s]Evaluating:  81%|████████  | 404/500 [00:13<00:03, 24.44it/s]Evaluating:  81%|████████▏ | 407/500 [00:13<00:03, 24.96it/s]Evaluating:  82%|████████▏ | 411/500 [00:13<00:03, 27.83it/s]Evaluating:  83%|████████▎ | 416/500 [00:13<00:02, 32.41it/s]Evaluating:  84%|████████▍ | 421/500 [00:14<00:02, 35.60it/s]Evaluating:  85%|████████▌ | 426/500 [00:14<00:01, 38.60it/s]Evaluating:  86%|████████▌ | 431/500 [00:14<00:01, 37.20it/s]Evaluating:  87%|████████▋ | 436/500 [00:14<00:01, 39.74it/s]Evaluating:  88%|████████▊ | 441/500 [00:14<00:01, 41.71it/s]Evaluating:  89%|████████▉ | 446/500 [00:14<00:01, 43.15it/s]Evaluating:  90%|█████████ | 451/500 [00:14<00:01, 43.98it/s]Evaluating:  91%|█████████ | 456/500 [00:14<00:01, 32.31it/s]Evaluating:  92%|█████████▏| 460/500 [00:15<00:01, 29.33it/s]Evaluating:  93%|█████████▎| 464/500 [00:15<00:01, 28.39it/s]Evaluating:  94%|█████████▎| 468/500 [00:15<00:01, 27.24it/s]Evaluating:  94%|█████████▍| 472/500 [00:15<00:00, 29.67it/s]Evaluating:  95%|█████████▌| 476/500 [00:15<00:00, 28.07it/s]Evaluating:  96%|█████████▌| 481/500 [00:15<00:00, 32.50it/s]Evaluating:  97%|█████████▋| 485/500 [00:15<00:00, 33.95it/s]Evaluating:  98%|█████████▊| 490/500 [00:16<00:00, 36.81it/s]Evaluating:  99%|█████████▉| 495/500 [00:16<00:00, 39.54it/s]Evaluating: 100%|██████████| 500/500 [00:16<00:00, 41.64it/s]Evaluating: 100%|██████████| 500/500 [00:16<00:00, 30.70it/s]
  F1: 0.000
  EM: 0.000
Epoch 2/3:   0%|          | 0/156 [00:00<?, ?it/s]Epoch 2/3:   0%|          | 0/156 [00:01<?, ?it/s, loss=3.2106, recon=0.9722, ce=2.2384]Epoch 2/3:   1%|          | 1/156 [00:01<04:50,  1.88s/it, loss=3.2106, recon=0.9722, ce=2.2384]Epoch 2/3:   1%|          | 1/156 [00:03<04:50,  1.88s/it, loss=3.3749, recon=0.9718, ce=2.4030]Epoch 2/3:   1%|▏         | 2/156 [00:03<04:49,  1.88s/it, loss=3.3749, recon=0.9718, ce=2.4030]Epoch 2/3:   1%|▏         | 2/156 [00:05<04:49,  1.88s/it, loss=3.2851, recon=0.9716, ce=2.3135]Epoch 2/3:   2%|▏         | 3/156 [00:05<04:46,  1.87s/it, loss=3.2851, recon=0.9716, ce=2.3135]Epoch 2/3:   2%|▏         | 3/156 [00:07<04:46,  1.87s/it, loss=3.0407, recon=0.9714, ce=2.0693]Epoch 2/3:   3%|▎         | 4/156 [00:07<04:45,  1.88s/it, loss=3.0407, recon=0.9714, ce=2.0693]Epoch 2/3:   3%|▎         | 4/156 [00:09<04:45,  1.88s/it, loss=3.1773, recon=0.9710, ce=2.2063]Epoch 2/3:   3%|▎         | 5/156 [00:09<04:43,  1.88s/it, loss=3.1773, recon=0.9710, ce=2.2063]Epoch 2/3:   3%|▎         | 5/156 [00:11<04:43,  1.88s/it, loss=3.2011, recon=0.9706, ce=2.2304]Epoch 2/3:   4%|▍         | 6/156 [00:11<04:41,  1.88s/it, loss=3.2011, recon=0.9706, ce=2.2304]Epoch 2/3:   4%|▍         | 6/156 [00:13<04:41,  1.88s/it, loss=3.2710, recon=0.9703, ce=2.3007]Epoch 2/3:   4%|▍         | 7/156 [00:13<04:37,  1.86s/it, loss=3.2710, recon=0.9703, ce=2.3007]Epoch 2/3:   4%|▍         | 7/156 [00:14<04:37,  1.86s/it, loss=3.3277, recon=0.9700, ce=2.3577]Epoch 2/3:   5%|▌         | 8/156 [00:14<04:36,  1.87s/it, loss=3.3277, recon=0.9700, ce=2.3577]Epoch 2/3:   5%|▌         | 8/156 [00:16<04:36,  1.87s/it, loss=3.0996, recon=0.9697, ce=2.1299]Epoch 2/3:   6%|▌         | 9/156 [00:16<04:34,  1.87s/it, loss=3.0996, recon=0.9697, ce=2.1299]Epoch 2/3:   6%|▌         | 9/156 [00:18<04:34,  1.87s/it, loss=3.0699, recon=0.9694, ce=2.1005]Epoch 2/3:   6%|▋         | 10/156 [00:18<04:32,  1.87s/it, loss=3.0699, recon=0.9694, ce=2.1005]Epoch 2/3:   6%|▋         | 10/156 [00:20<04:32,  1.87s/it, loss=3.1696, recon=0.9691, ce=2.2006]Epoch 2/3:   7%|▋         | 11/156 [00:20<04:31,  1.87s/it, loss=3.1696, recon=0.9691, ce=2.2006]Epoch 2/3:   7%|▋         | 11/156 [00:22<04:31,  1.87s/it, loss=3.0714, recon=0.9688, ce=2.1026]Epoch 2/3:   8%|▊         | 12/156 [00:22<04:29,  1.87s/it, loss=3.0714, recon=0.9688, ce=2.1026]Epoch 2/3:   8%|▊         | 12/156 [00:24<04:29,  1.87s/it, loss=3.1152, recon=0.9685, ce=2.1468]Epoch 2/3:   8%|▊         | 13/156 [00:24<04:28,  1.87s/it, loss=3.1152, recon=0.9685, ce=2.1468]