/users/sujinesh/.local/lib/python3.10/site-packages/transformers/utils/hub.py:128: FutureWarning: Using `TRANSFORMERS_CACHE` is deprecated and will be removed in v5 of Transformers. Use `HF_HOME` instead.
  warnings.warn(
============================================================
TELEPATHY TRAINING: ARC_EASY
============================================================

Dataset: arc_easy (4 classes)
Random baseline: 25.0%
Source layer: 31
Soft tokens: 8
Steps: 1500
Diversity weight: 0.1
============================================================
Downloading shards:   0%|          | 0/4 [00:00<?, ?it/s]Downloading shards: 100%|██████████| 4/4 [00:00<00:00, 2125.85it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:03<00:09,  3.30s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:07<00:07,  3.88s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:11<00:04,  4.07s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  2.90s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  3.25s/it]
Downloading shards:   0%|          | 0/3 [00:00<?, ?it/s]Downloading shards: 100%|██████████| 3/3 [00:00<00:00, 2233.79it/s]
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:03<00:07,  3.80s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:07<00:03,  3.96s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:11<00:00,  3.94s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:11<00:00,  3.93s/it]
2026-01-19 12:25:39,908 - INFO - FlowMatchingBridge: 8 tokens, 4 flow steps
Target embedding RMS: 0.0027
Using Flow Matching Bridge (MATH) - steps=4

Training on 2251 samples
Validation: 2376 samples
Starting training...

ARC_EASY:   0%|                                                            | 0/1500 [00:00<?, ?it/s]ARC_EASY:   0%|                                                            | 0/1500 [00:00<?, ?it/s]
Traceback (most recent call last):
  File "/scratch/m000066/sujinesh/LatentWire/telepathy/train_telepathy.py", line 1285, in main
    loss, loss_dict = train_step(
  File "/scratch/m000066/sujinesh/LatentWire/telepathy/train_telepathy.py", line 714, in train_step
    soft_tokens, aux_loss, diversity, z_variance = bridge_module(src_h, src_mask)
  File "/users/sujinesh/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/users/sujinesh/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/scratch/m000066/sujinesh/LatentWire/telepathy/cross_model_experiments.py", line 1196, in forward
    soft_tokens = self.integrate_flow(x0)
  File "/scratch/m000066/sujinesh/LatentWire/telepathy/cross_model_experiments.py", line 1170, in integrate_flow
    v = self.compute_velocity(x, t)
  File "/scratch/m000066/sujinesh/LatentWire/telepathy/cross_model_experiments.py", line 1150, in compute_velocity
    v = self.velocity_net(xt)
  File "/users/sujinesh/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/users/sujinesh/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/users/sujinesh/.local/lib/python3.10/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
  File "/users/sujinesh/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/users/sujinesh/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/users/sujinesh/.local/lib/python3.10/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
RuntimeError: mat1 and mat2 must have the same dtype, but got Float and BFloat16

[ERROR] Training interrupted by exception at step 1
[ERROR] RuntimeError: mat1 and mat2 must have the same dtype, but got Float and BFloat16

[EMERGENCY] Checkpoint saved to runs/reasoning_final_20260119_122501/novel_bridges/flow_matching_arc_easy_seed42/emergency_checkpoint_step0.pt
[EMERGENCY] Error: RuntimeError: mat1 and mat2 must have the same dtype, but got Float and BFloat16
Traceback (most recent call last):
  File "/scratch/m000066/sujinesh/LatentWire/telepathy/train_telepathy.py", line 1530, in <module>
    main()
  File "/scratch/m000066/sujinesh/LatentWire/telepathy/train_telepathy.py", line 1285, in main
    loss, loss_dict = train_step(
  File "/scratch/m000066/sujinesh/LatentWire/telepathy/train_telepathy.py", line 714, in train_step
    soft_tokens, aux_loss, diversity, z_variance = bridge_module(src_h, src_mask)
  File "/users/sujinesh/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/users/sujinesh/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/scratch/m000066/sujinesh/LatentWire/telepathy/cross_model_experiments.py", line 1196, in forward
    soft_tokens = self.integrate_flow(x0)
  File "/scratch/m000066/sujinesh/LatentWire/telepathy/cross_model_experiments.py", line 1170, in integrate_flow
    v = self.compute_velocity(x, t)
  File "/scratch/m000066/sujinesh/LatentWire/telepathy/cross_model_experiments.py", line 1150, in compute_velocity
    v = self.velocity_net(xt)
  File "/users/sujinesh/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/users/sujinesh/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/users/sujinesh/.local/lib/python3.10/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
  File "/users/sujinesh/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/users/sujinesh/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/users/sujinesh/.local/lib/python3.10/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
RuntimeError: mat1 and mat2 must have the same dtype, but got Float and BFloat16
