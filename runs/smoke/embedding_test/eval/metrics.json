{
  "samples": 200,
  "max_new_tokens": 24,
  "latent_len": 32,
  "device": "cuda",
  "dtype": "torch.bfloat16",
  "avg_prompt_tokens": {
    "llama": 246.03
  },
  "compression": {
    "llama": 7.6884375
  },
  "payload_bytes": 6553600,
  "payload_bytes_detail": {
    "fp32": 6553600,
    "fp16": 3276800,
    "selected": null
  },
  "wire": {
    "prompt_chars": {
      "llama": 251558
    },
    "prompt_count": 200,
    "latent_shape": [
      200,
      32,
      256
    ],
    "latent_bytes": {
      "fp32": 6553600,
      "fp16": 3276800
    },
    "group_size": 32,
    "scale_bits": 16,
    "selected_latent_bytes": null,
    "wire_ratio": {}
  },
  "text": {
    "llama": {
      "em": 0.59,
      "f1": 0.7958243517451916,
      "nll_token": 13.675748455854526
    },
    "wall_clock_sec": 7.361482620239258
  },
  "latent": {
    "llama": {
      "em": 0.0,
      "f1": 0.0,
      "nll": 9.331006917283108,
      "first_token_top1": 0.0,
      "first_token_top5": 0.0,
      "nll_token": 9.331006917283108
    },
    "wall_clock_sec": 1.9895601272583008
  },
  "token_budget": {
    "mode": "content_only",
    "k": 32,
    "llama": {
      "em": 0.005,
      "f1": 0.048777777166363785
    },
    "wall_clock_sec": 1.8387491703033447
  },
  "joint": {
    "em": null,
    "f1": null,
    "agreement": null,
    "oracle": {
      "em": 0.0,
      "f1": 0.0
    }
  },
  "debug": {
    "llama": {
      "latent_anchor_text": "Answer:"
    },
    "settings": {
      "latent_anchor_mode": "auto",
      "latent_anchor_text": "Answer: ",
      "prefix_gain": 1.0,
      "calibration_mode": "embed_rms",
      "append_bos_after_prefix": "auto",
      "decode": {
        "min_new_tokens": 1,
        "eos_ban_steps": 0,
        "first_token_top_p": 1.0,
        "first_token_temperature": 0.0
      },
      "embedding_replay": true,
      "embedding_baseline_modes": [
        "raw",
        "anchor",
        "adapter"
      ]
    }
  },
  "oracle": {
    "em": 0.0,
    "f1": 0.0
  },
  "text_embed": {
    "llama": {
      "em": 0.59,
      "f1": 0.7958243517451916,
      "nll_token": 13.675748455854526
    },
    "wall_clock_sec": 6.831209421157837
  },
  "embedding_baselines": {
    "raw": {
      "metrics": {
        "llama": {
          "em": 0.595,
          "f1": 0.8055916297639502,
          "nll": 13.675748455854526,
          "first_token_top1": 0.0,
          "first_token_top5": 0.0
        }
      },
      "wall_clock_sec": {
        "llama": 30.00700831413269
      }
    },
    "anchor": {
      "metrics": {
        "llama": {
          "em": 0.645,
          "f1": 0.8195118725299646,
          "nll": 12.751180602309384,
          "first_token_top1": 0.0,
          "first_token_top5": 0.0
        }
      },
      "wall_clock_sec": {
        "llama": 29.7332763671875
      }
    },
    "adapter": {
      "metrics": {
        "llama": {
          "em": 0.0,
          "f1": 0.010155969191806216,
          "nll": 9.753239258076329,
          "first_token_top1": 0.0,
          "first_token_top5": 0.0
        }
      },
      "wall_clock_sec": {
        "llama": 54.7069730758667
      }
    }
  },
  "dataset": "squad"
}