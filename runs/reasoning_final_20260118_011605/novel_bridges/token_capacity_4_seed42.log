/users/sujinesh/.local/lib/python3.10/site-packages/transformers/utils/hub.py:128: FutureWarning: Using `TRANSFORMERS_CACHE` is deprecated and will be removed in v5 of Transformers. Use `HF_HOME` instead.
  warnings.warn(
============================================================
TELEPATHY TRAINING: ARC_EASY
============================================================

Dataset: arc_easy (4 classes)
Random baseline: 25.0%
Source layer: 31
Soft tokens: 4
Steps: 1500
Diversity weight: 0.1
============================================================
Downloading shards:   0%|          | 0/4 [00:00<?, ?it/s]Downloading shards: 100%|██████████| 4/4 [00:00<00:00, 2536.24it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.53s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.29s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:11<00:03,  3.44s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:11<00:00,  2.27s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:11<00:00,  2.89s/it]
Downloading shards:   0%|          | 0/3 [00:00<?, ?it/s]Downloading shards: 100%|██████████| 3/3 [00:00<00:00, 3715.06it/s]
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:01<00:03,  1.84s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:03<00:01,  1.90s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:07<00:00,  2.52s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:07<00:00,  2.35s/it]
Target embedding RMS: 0.0027
Generating train split:   0%|          | 0/2251 [00:00<?, ? examples/s]Generating train split: 100%|██████████| 2251/2251 [00:00<00:00, 82704.48 examples/s]
Generating test split:   0%|          | 0/2376 [00:00<?, ? examples/s]Generating test split: 100%|██████████| 2376/2376 [00:00<00:00, 131725.15 examples/s]
Generating validation split:   0%|          | 0/570 [00:00<?, ? examples/s]Generating validation split: 100%|██████████| 570/570 [00:00<00:00, 190104.43 examples/s]

Training on 2251 samples
Validation: 2376 samples
Starting training...

ARC_EASY:   0%|                                                            | 0/1500 [00:00<?, ?it/s]ARC_EASY:   0%|                            | 0/1500 [00:01<?, ?it/s, lm=8.85, aux=0.000, gn=1080.00]ARC_EASY:   0%|                    | 1/1500 [00:01<35:04,  1.40s/it, lm=8.85, aux=0.000, gn=1080.00]ARC_EASY:   0%|                    | 1/1500 [00:01<35:04,  1.40s/it, lm=9.04, aux=0.000, gn=3296.00]ARC_EASY:   0%|                    | 2/1500 [00:01<19:12,  1.30it/s, lm=9.04, aux=0.000, gn=3296.00]ARC_EASY:   0%|                    | 2/1500 [00:02<19:12,  1.30it/s, lm=8.86, aux=0.000, gn=1576.00]ARC_EASY:   0%|                    | 3/1500 [00:02<14:24,  1.73it/s, lm=8.86, aux=0.000, gn=1576.00]ARC_EASY:   0%|                    | 3/1500 [00:02<14:24,  1.73it/s, lm=8.97, aux=0.000, gn=2176.00]ARC_EASY:   0%|                    | 4/1500 [00:02<11:51,  2.10it/s, lm=8.97, aux=0.000, gn=2176.00]ARC_EASY:   0%|                    | 4/1500 [00:02<11:51,  2.10it/s, lm=7.91, aux=0.000, gn=4032.00]ARC_EASY:   0%|                    | 5/1500 [00:02<10:22,  2.40it/s, lm=7.91, aux=0.000, gn=4032.00]ARC_EASY:   0%|                     | 5/1500 [00:03<10:22,  2.40it/s, lm=7.24, aux=0.000, gn=960.00]ARC_EASY:   0%|                     | 6/1500 [00:03<09:25,  2.64it/s, lm=7.24, aux=0.000, gn=960.00]ARC_EASY:   0%|                    | 6/1500 [00:03<09:25,  2.64it/s, lm=7.07, aux=0.000, gn=5344.00]ARC_EASY:   0%|                    | 7/1500 [00:03<08:56,  2.78it/s, lm=7.07, aux=0.000, gn=5344.00]ARC_EASY:   0%|                    | 7/1500 [00:03<08:56,  2.78it/s, lm=6.32, aux=0.000, gn=3024.00]ARC_EASY:   1%|                    | 8/1500 [00:03<08:36,  2.89it/s, lm=6.32, aux=0.000, gn=3024.00]ARC_EASY:   1%|                     | 8/1500 [00:03<08:36,  2.89it/s, lm=6.84, aux=0.000, gn=716.00]ARC_EASY:   1%|▏                    | 9/1500 [00:03<08:27,  2.94it/s, lm=6.84, aux=0.000, gn=716.00]ARC_EASY:   1%|▏                    | 9/1500 [00:04<08:27,  2.94it/s, lm=5.90, aux=0.000, gn=688.00]ARC_EASY:   1%|▏                   | 10/1500 [00:04<08:15,  3.00it/s, lm=5.90, aux=0.000, gn=688.00]ARC_EASY:   1%|▏                   | 10/1500 [00:04<08:15,  3.00it/s, lm=4.40, aux=0.000, gn=482.00]ARC_EASY:   1%|▏                   | 11/1500 [00:04<08:13,  3.02it/s, lm=4.40, aux=0.000, gn=482.00]ARC_EASY:   1%|▏                   | 11/1500 [00:04<08:13,  3.02it/s, lm=3.42, aux=0.000, gn=696.00]ARC_EASY:   1%|▏                   | 12/1500 [00:04<08:13,  3.02it/s, lm=3.42, aux=0.000, gn=696.00]ARC_EASY:   1%|▏                   | 12/1500 [00:05<08:13,  3.02it/s, lm=1.96, aux=0.000, gn=199.00]ARC_EASY:   1%|▏                   | 13/1500 [00:05<08:04,  3.07it/s, lm=1.96, aux=0.000, gn=199.00]ARC_EASY:   1%|▏                   | 13/1500 [00:05<08:04,  3.07it/s, lm=1.80, aux=0.000, gn=222.00]ARC_EASY:   1%|▏                   | 14/1500 [00:05<08:10,  3.03it/s, lm=1.80, aux=0.000, gn=222.00]ARC_EASY:   1%|▏                   | 14/1500 [00:05<08:10,  3.03it/s, lm=1.19, aux=0.000, gn=175.00]ARC_EASY:   1%|▏                   | 15/1500 [00:05<08:06,  3.05it/s, lm=1.19, aux=0.000, gn=175.00]ARC_EASY:   1%|▏                  | 15/1500 [00:06<08:06,  3.05it/s, lm=1.78, aux=0.000, gn=1224.00]ARC_EASY:   1%|▏                  | 16/1500 [00:06<08:10,  3.02it/s, lm=1.78, aux=0.000, gn=1224.00]ARC_EASY:   1%|▏                   | 16/1500 [00:06<08:10,  3.02it/s, lm=0.91, aux=0.000, gn=153.00]ARC_EASY:   1%|▏                   | 17/1500 [00:06<08:14,  3.00it/s, lm=0.91, aux=0.000, gn=153.00]ARC_EASY:   1%|▏                   | 17/1500 [00:06<08:14,  3.00it/s, lm=1.18, aux=0.000, gn=216.00]ARC_EASY:   1%|▏                   | 18/1500 [00:06<08:08,  3.04it/s, lm=1.18, aux=0.000, gn=216.00]ARC_EASY:   1%|▏                   | 18/1500 [00:07<09:45,  2.53it/s, lm=1.18, aux=0.000, gn=216.00]
Traceback (most recent call last):
  File "/scratch/m000066/sujinesh/LatentWire/telepathy/train_telepathy.py", line 1280, in main
    batch = next(iter_dl)
  File "/users/sujinesh/.local/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 701, in __next__
    data = self._next_data()
  File "/users/sujinesh/.local/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 757, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/users/sujinesh/.local/lib/python3.10/site-packages/torch/utils/data/_utils/fetch.py", line 55, in fetch
    return self.collate_fn(data)
  File "/users/sujinesh/.local/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py", line 398, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/users/sujinesh/.local/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py", line 171, in collate
    {
  File "/users/sujinesh/.local/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py", line 172, in <dictcomp>
    key: collate(
  File "/users/sujinesh/.local/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py", line 171, in collate
    {
  File "/users/sujinesh/.local/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py", line 172, in <dictcomp>
    key: collate(
  File "/users/sujinesh/.local/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py", line 207, in collate
    raise RuntimeError("each element in list of batch should be of equal size")
RuntimeError: each element in list of batch should be of equal size

[ERROR] Training interrupted by exception at step 19
[ERROR] RuntimeError: each element in list of batch should be of equal size

[EMERGENCY] Checkpoint saved to runs/reasoning_final_20260118_011605/novel_bridges/token_capacity_4_seed42/emergency_checkpoint_step18.pt
[EMERGENCY] Error: RuntimeError: each element in list of batch should be of equal size
Traceback (most recent call last):
  File "/scratch/m000066/sujinesh/LatentWire/telepathy/train_telepathy.py", line 1530, in <module>
    main()
  File "/scratch/m000066/sujinesh/LatentWire/telepathy/train_telepathy.py", line 1280, in main
    batch = next(iter_dl)
  File "/users/sujinesh/.local/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 701, in __next__
    data = self._next_data()
  File "/users/sujinesh/.local/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 757, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/users/sujinesh/.local/lib/python3.10/site-packages/torch/utils/data/_utils/fetch.py", line 55, in fetch
    return self.collate_fn(data)
  File "/users/sujinesh/.local/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py", line 398, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/users/sujinesh/.local/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py", line 171, in collate
    {
  File "/users/sujinesh/.local/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py", line 172, in <dictcomp>
    key: collate(
  File "/users/sujinesh/.local/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py", line 171, in collate
    {
  File "/users/sujinesh/.local/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py", line 172, in <dictcomp>
    key: collate(
  File "/users/sujinesh/.local/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py", line 207, in collate
    raise RuntimeError("each element in list of batch should be of equal size")
RuntimeError: each element in list of batch should be of equal size
