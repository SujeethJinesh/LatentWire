/users/sujinesh/.local/lib/python3.10/site-packages/transformers/utils/hub.py:128: FutureWarning: Using `TRANSFORMERS_CACHE` is deprecated and will be removed in v5 of Transformers. Use `HF_HOME` instead.
  warnings.warn(
============================================================
TELEPATHY TRAINING: ARC_EASY
============================================================

Dataset: arc_easy (4 classes)
Random baseline: 25.0%
Source layer: 31
Soft tokens: 8
Steps: 1500
Diversity weight: 0.1
============================================================
Downloading shards:   0%|          | 0/4 [00:00<?, ?it/s]Downloading shards: 100%|██████████| 4/4 [00:00<00:00, 1781.59it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.28s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.19s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:11<00:03,  3.88s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  2.66s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  3.17s/it]
Downloading shards:   0%|          | 0/3 [00:00<?, ?it/s]Downloading shards: 100%|██████████| 3/3 [00:00<00:00, 2767.30it/s]
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:02<00:04,  2.25s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:04<00:02,  2.08s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:05<00:00,  1.93s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:05<00:00,  1.99s/it]
2026-01-19 11:45:13,618 - INFO - MoEBridge: 8 tokens, 8 experts, top-2 routing, shared_expert=True, aux_loss_free=False
Target embedding RMS: 0.0027
Using MoE Bridge - 8 experts, top-2, shared_expert=True, aux_loss_free=False

Training on 2251 samples
Validation: 2376 samples
Starting training...

ARC_EASY:   0%|                                                            | 0/1500 [00:00<?, ?it/s]ARC_EASY:   0%|                             | 0/1500 [00:01<?, ?it/s, lm=8.28, aux=0.034, gn=768.00]ARC_EASY:   0%|                     | 1/1500 [00:01<37:57,  1.52s/it, lm=8.28, aux=0.034, gn=768.00]ARC_EASY:   0%|                     | 1/1500 [00:01<37:57,  1.52s/it, lm=8.33, aux=0.034, gn=688.00]ARC_EASY:   0%|                     | 2/1500 [00:01<21:20,  1.17it/s, lm=8.33, aux=0.034, gn=688.00]ARC_EASY:   0%|                    | 2/1500 [00:02<21:20,  1.17it/s, lm=7.45, aux=0.034, gn=1296.00]ARC_EASY:   0%|                    | 3/1500 [00:02<16:19,  1.53it/s, lm=7.45, aux=0.034, gn=1296.00]ARC_EASY:   0%|                     | 3/1500 [00:02<16:19,  1.53it/s, lm=7.27, aux=0.035, gn=422.00]ARC_EASY:   0%|                     | 4/1500 [00:02<13:45,  1.81it/s, lm=7.27, aux=0.035, gn=422.00]ARC_EASY:   0%|                     | 4/1500 [00:03<13:45,  1.81it/s, lm=6.25, aux=0.034, gn=366.00]ARC_EASY:   0%|                     | 5/1500 [00:03<12:21,  2.02it/s, lm=6.25, aux=0.034, gn=366.00]ARC_EASY:   0%|                     | 5/1500 [00:03<12:21,  2.02it/s, lm=4.71, aux=0.032, gn=340.00]ARC_EASY:   0%|                     | 6/1500 [00:03<11:29,  2.17it/s, lm=4.71, aux=0.032, gn=340.00]ARC_EASY:   0%|                     | 6/1500 [00:03<11:29,  2.17it/s, lm=4.36, aux=0.031, gn=600.00]ARC_EASY:   0%|                     | 7/1500 [00:03<11:02,  2.25it/s, lm=4.36, aux=0.031, gn=600.00]ARC_EASY:   0%|                    | 7/1500 [00:04<11:02,  2.25it/s, lm=3.08, aux=0.031, gn=1056.00]ARC_EASY:   1%|                    | 8/1500 [00:04<10:30,  2.37it/s, lm=3.08, aux=0.031, gn=1056.00]ARC_EASY:   1%|                     | 8/1500 [00:04<10:30,  2.37it/s, lm=2.44, aux=0.032, gn=300.00]ARC_EASY:   1%|▏                    | 9/1500 [00:04<10:03,  2.47it/s, lm=2.44, aux=0.032, gn=300.00]ARC_EASY:   1%|▏                    | 9/1500 [00:05<10:03,  2.47it/s, lm=1.46, aux=0.032, gn=280.00]ARC_EASY:   1%|▏                   | 10/1500 [00:05<09:48,  2.53it/s, lm=1.46, aux=0.032, gn=280.00]ARC_EASY:   1%|▏                   | 10/1500 [00:05<09:48,  2.53it/s, lm=1.69, aux=0.030, gn=191.00]ARC_EASY:   1%|▏                   | 11/1500 [00:05<09:44,  2.55it/s, lm=1.69, aux=0.030, gn=191.00]ARC_EASY:   1%|▏                   | 11/1500 [00:05<09:44,  2.55it/s, lm=1.22, aux=0.029, gn=235.00]ARC_EASY:   1%|▏                   | 12/1500 [00:05<09:51,  2.51it/s, lm=1.22, aux=0.029, gn=235.00]ARC_EASY:   1%|▏                   | 12/1500 [00:06<09:51,  2.51it/s, lm=1.01, aux=0.029, gn=246.00]ARC_EASY:   1%|▏                   | 13/1500 [00:06<09:40,  2.56it/s, lm=1.01, aux=0.029, gn=246.00]ARC_EASY:   1%|▏                   | 13/1500 [00:06<09:40,  2.56it/s, lm=0.98, aux=0.030, gn=616.00]ARC_EASY:   1%|▏                   | 14/1500 [00:06<09:40,  2.56it/s, lm=0.98, aux=0.030, gn=616.00]ARC_EASY:   1%|▏                   | 14/1500 [00:06<09:40,  2.56it/s, lm=0.94, aux=0.033, gn=368.00]ARC_EASY:   1%|▏                   | 15/1500 [00:06<09:44,  2.54it/s, lm=0.94, aux=0.033, gn=368.00]ARC_EASY:   1%|▏                   | 15/1500 [00:07<09:44,  2.54it/s, lm=1.40, aux=0.034, gn=296.00]ARC_EASY:   1%|▏                   | 16/1500 [00:07<09:46,  2.53it/s, lm=1.40, aux=0.034, gn=296.00]ARC_EASY:   1%|▏                  | 16/1500 [00:07<09:46,  2.53it/s, lm=1.50, aux=0.033, gn=3248.00]ARC_EASY:   1%|▏                  | 17/1500 [00:07<09:40,  2.55it/s, lm=1.50, aux=0.033, gn=3248.00]ARC_EASY:   1%|▏                    | 17/1500 [00:08<09:40,  2.55it/s, lm=0.96, aux=0.031, gn=56.75]ARC_EASY:   1%|▎                    | 18/1500 [00:08<09:37,  2.56it/s, lm=0.96, aux=0.031, gn=56.75]ARC_EASY:   1%|▎                    | 18/1500 [00:08<11:28,  2.15it/s, lm=0.96, aux=0.031, gn=56.75]
Traceback (most recent call last):
  File "/scratch/m000066/sujinesh/LatentWire/telepathy/train_telepathy.py", line 1280, in main
    batch = next(iter_dl)
  File "/users/sujinesh/.local/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 701, in __next__
    data = self._next_data()
  File "/users/sujinesh/.local/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 757, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/users/sujinesh/.local/lib/python3.10/site-packages/torch/utils/data/_utils/fetch.py", line 55, in fetch
    return self.collate_fn(data)
  File "/users/sujinesh/.local/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py", line 398, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/users/sujinesh/.local/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py", line 171, in collate
    {
  File "/users/sujinesh/.local/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py", line 172, in <dictcomp>
    key: collate(
  File "/users/sujinesh/.local/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py", line 171, in collate
    {
  File "/users/sujinesh/.local/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py", line 172, in <dictcomp>
    key: collate(
  File "/users/sujinesh/.local/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py", line 207, in collate
    raise RuntimeError("each element in list of batch should be of equal size")
RuntimeError: each element in list of batch should be of equal size
