W1107 10:20:41.894000 1100518 torch/distributed/run.py:793] 
W1107 10:20:41.894000 1100518 torch/distributed/run.py:793] *****************************************
W1107 10:20:41.894000 1100518 torch/distributed/run.py:793] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1107 10:20:41.894000 1100518 torch/distributed/run.py:793] *****************************************
/users/sujinesh/.local/lib/python3.10/site-packages/transformers/utils/hub.py:128: FutureWarning: Using `TRANSFORMERS_CACHE` is deprecated and will be removed in v5 of Transformers. Use `HF_HOME` instead.
  warnings.warn(
/users/sujinesh/.local/lib/python3.10/site-packages/transformers/utils/hub.py:128: FutureWarning: Using `TRANSFORMERS_CACHE` is deprecated and will be removed in v5 of Transformers. Use `HF_HOME` instead.
  warnings.warn(
/users/sujinesh/.local/lib/python3.10/site-packages/transformers/utils/hub.py:128: FutureWarning: Using `TRANSFORMERS_CACHE` is deprecated and will be removed in v5 of Transformers. Use `HF_HOME` instead.
  warnings.warn(
/users/sujinesh/.local/lib/python3.10/site-packages/transformers/utils/hub.py:128: FutureWarning: Using `TRANSFORMERS_CACHE` is deprecated and will be removed in v5 of Transformers. Use `HF_HOME` instead.
  warnings.warn(
==== Config ====
source_model: mistralai/Mistral-7B-Instruct-v0.3
target_model: meta-llama/Meta-Llama-3.1-8B-Instruct
translator_type: bottleneck_gated
bottleneck_dim: 1024
soft_tokens: 48
depth: 6
heads: 16
lr: 5e-05
weight_decay: 0.01
train_steps: 3500
warmup_steps: 1000
per_device_batch: 10
eval_every: 250
eval_samples: 500
max_new_tokens: 256
seed: 1234
bf16: True
save_path: runs/focused_sweep_20251107_102040/1_conservative/checkpoint.pt
show_eval_samples: 1
early_stop_patience: 5
Loading source model/tokenizer...
Downloading shards:   0%|          | 0/3 [00:00<?, ?it/s]Downloading shards: 100%|██████████| 3/3 [00:00<00:00, 3095.43it/s]
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:00<00:00,  2.64it/s]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:00<00:00,  3.21it/s]Loading checkpoint shards: 100%|██████████| 3/3 [00:00<00:00,  3.45it/s]Loading checkpoint shards: 100%|██████████| 3/3 [00:00<00:00,  3.29it/s]
Downloading shards:   0%|          | 0/3 [00:00<?, ?it/s]Downloading shards: 100%|██████████| 3/3 [00:00<00:00, 1610.51it/s]
Downloading shards:   0%|          | 0/3 [00:00<?, ?it/s]Downloading shards: 100%|██████████| 3/3 [00:00<00:00, 409.29it/s]
Downloading shards:   0%|          | 0/3 [00:00<?, ?it/s]Downloading shards: 100%|██████████| 3/3 [00:00<00:00, 5986.16it/s]
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:00<00:00,  2.20it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:00<00:00,  2.20it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:00<00:00,  2.21it/s]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:00<00:00,  2.43it/s]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:00<00:00,  2.39it/s]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:00<00:00,  2.50it/s]Loading checkpoint shards: 100%|██████████| 3/3 [00:01<00:00,  2.57it/s]Loading checkpoint shards: 100%|██████████| 3/3 [00:01<00:00,  2.56it/s]Loading checkpoint shards: 100%|██████████| 3/3 [00:01<00:00,  2.49it/s]
Loading checkpoint shards: 100%|██████████| 3/3 [00:01<00:00,  2.44it/s]
Loading checkpoint shards: 100%|██████████| 3/3 [00:01<00:00,  2.70it/s]Loading checkpoint shards: 100%|██████████| 3/3 [00:01<00:00,  2.61it/s]
Loading target model/tokenizer...
Downloading shards:   0%|          | 0/4 [00:00<?, ?it/s]Downloading shards: 100%|██████████| 4/4 [00:00<00:00, 3965.31it/s]
Downloading shards:   0%|          | 0/4 [00:00<?, ?it/s]Downloading shards: 100%|██████████| 4/4 [00:00<00:00, 9771.24it/s]
Downloading shards:   0%|          | 0/4 [00:00<?, ?it/s]Downloading shards: 100%|██████████| 4/4 [00:00<00:00, 9664.29it/s]
Downloading shards:   0%|          | 0/4 [00:00<?, ?it/s]Downloading shards: 100%|██████████| 4/4 [00:00<00:00, 8599.29it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:00<00:01,  2.20it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:00<00:01,  2.20it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:00<00:01,  2.20it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:00<00:01,  2.26it/s]Loading checkpoint shards:  50%|█████     | 2/4 [00:00<00:00,  2.36it/s]Loading checkpoint shards:  50%|█████     | 2/4 [00:00<00:00,  2.35it/s]Loading checkpoint shards:  50%|█████     | 2/4 [00:00<00:00,  2.32it/s]Loading checkpoint shards:  50%|█████     | 2/4 [00:00<00:00,  2.36it/s]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:01<00:00,  2.41it/s]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:01<00:00,  2.40it/s]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:01<00:00,  2.38it/s]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:01<00:00,  2.47it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:01<00:00,  2.54it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:01<00:00,  2.50it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:01<00:00,  2.48it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:01<00:00,  2.43it/s]
Loading checkpoint shards: 100%|██████████| 4/4 [00:01<00:00,  2.55it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:01<00:00,  2.41it/s]
Loading checkpoint shards: 100%|██████████| 4/4 [00:01<00:00,  2.41it/s]
Loading checkpoint shards: 100%|██████████| 4/4 [00:01<00:00,  2.48it/s]
Source hidden dim: 4096 | Target hidden dim: 4096
Target embedding RMS: 0.0105
Translator parameters: 142.8M
Loading GSM8K...
Optimizer groups: 50 decay, 87 no_decay, 6 gates (LR ×3)
Step 20/3500 | Loss (avg over last 20): 9.7068
Step 40/3500 | Loss (avg over last 20): 9.8149
Step 60/3500 | Loss (avg over last 20): 9.9984
Step 80/3500 | Loss (avg over last 20): 9.2138
Step 100/3500 | Loss (avg over last 20): 8.9177
Step 120/3500 | Loss (avg over last 20): 8.8168
Step 140/3500 | Loss (avg over last 20): 8.5827
Step 160/3500 | Loss (avg over last 20): 8.5498
Step 180/3500 | Loss (avg over last 20): 8.5728
Step 200/3500 | Loss (avg over last 20): 8.1515
Step 220/3500 | Loss (avg over last 20): 7.6479
Step 240/3500 | Loss (avg over last 20): 7.2463
/users/sujinesh/.local/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:590: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/users/sujinesh/.local/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:595: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(

============================================================
SAMPLE OUTPUTS (first 3 examples):
============================================================

--- Example 1 ---
Question: You are a helpful math tutor. Solve the problem step by step, then end your final line with '#### <number>'.

Problem:
Janet’s ducks lay 16 eggs per day. She eats three for breakfast every morning and...
Gold answer: 18
Target-alone: 210
Bridged: 85
Bridged generation start:  74 = 85...

--- Example 2 ---
Question: You are a helpful math tutor. Solve the problem step by step, then end your final line with '#### <number>'.

Problem:
A robe takes 2 bolts of blue fiber and half that much white fiber.  How many bolt...
Gold answer: 3
Target-alone: 3
Bridged: 0
Bridged generation start: 1>> 1//1.14.1 - 1.
2.7 1:1.15.1 and 1; 1 // 1
1.21.1 / 1, 1 – 1 >>1.22.1 – > 0...

--- Example 3 ---
Question: You are a helpful math tutor. Solve the problem step by step, then end your final line with '#### <number>'.

Problem:
Josh decides to try flipping a house.  He buys a house for $80,000 and then puts ...
Gold answer: 70000
Target-alone: 97500
Bridged: 7
Bridged generation start: .3=0; 1/0.4>> 7,...
============================================================

[Eval] Step 250 | Target-alone acc: 0.464 | Bridged acc: 0.016
[Early Stop] New best bridged acc: 0.016, resetting patience
Step 260/3500 | Loss (avg over last 20): 6.9679
Step 280/3500 | Loss (avg over last 20): 6.8933
Step 300/3500 | Loss (avg over last 20): 6.8072
Step 320/3500 | Loss (avg over last 20): 6.3789
Step 340/3500 | Loss (avg over last 20): 6.3861
Step 360/3500 | Loss (avg over last 20): 6.0432
Step 380/3500 | Loss (avg over last 20): 5.9778
Step 400/3500 | Loss (avg over last 20): 5.8244
Step 420/3500 | Loss (avg over last 20): 5.8530
Step 440/3500 | Loss (avg over last 20): 5.6271
Step 460/3500 | Loss (avg over last 20): 5.6582
Step 480/3500 | Loss (avg over last 20): 5.4566
Step 500/3500 | Loss (avg over last 20): 5.4750

============================================================
SAMPLE OUTPUTS (first 3 examples):
============================================================

--- Example 1 ---
Question: You are a helpful math tutor. Solve the problem step by step, then end your final line with '#### <number>'.

Problem:
Janet’s ducks lay 16 eggs per day. She eats three for breakfast every morning and...
Gold answer: 18
Target-alone: 210
Bridged: 4

--- Example 2 ---
Question: You are a helpful math tutor. Solve the problem step by step, then end your final line with '#### <number>'.

Problem:
A robe takes 2 bolts of blue fiber and half that much white fiber.  How many bolt...
Gold answer: 3
Target-alone: 3
Bridged: 1
Bridged generation start:  1>>00>>1 >1-0>>>>0-11-0001>>.1-00>>0>1-01>>1 -1>>0001-<<1-10011*>>1 =1>>50>>1**1>>>1*0>>0*1-10>>0 1- >>1*2>>-0-0*>>0
1- 1*-1*00>>->>0<<1* >>1...

--- Example 3 ---
Question: You are a helpful math tutor. Solve the problem step by step, then end your final line with '#### <number>'.

Problem:
Josh decides to try flipping a house.  He buys a house for $80,000 and then puts ...
Gold answer: 70000
Target-alone: 97500
Bridged: 00000020
Bridged generation start: +000000500000000
000000.00000050>>00000,00000 =0000 =00000,000000>>000>>1000000>0000.
0000 >0000<0000 >>0000.0000+0000>>>0000001>>000,0000,>>000=>>000<<0000>0000<<00000>00000<<10000000>00000<<00000.
00000-00000 >00000<00000*00000##000000->000000#00000020>>...
============================================================

[Eval] Step 500 | Target-alone acc: 0.464 | Bridged acc: 0.036
[Early Stop] New best bridged acc: 0.036, resetting patience
Step 520/3500 | Loss (avg over last 20): 5.5807
Step 540/3500 | Loss (avg over last 20): 5.3923
Step 560/3500 | Loss (avg over last 20): 5.4256
Step 580/3500 | Loss (avg over last 20): 5.3192
Step 600/3500 | Loss (avg over last 20): 5.3523
Step 620/3500 | Loss (avg over last 20): 5.4053
Step 640/3500 | Loss (avg over last 20): 5.2813
Step 660/3500 | Loss (avg over last 20): 5.2812
Step 680/3500 | Loss (avg over last 20): 5.4873
Step 700/3500 | Loss (avg over last 20): 5.1837
Step 720/3500 | Loss (avg over last 20): 5.2239
Step 740/3500 | Loss (avg over last 20): 5.1023

============================================================
SAMPLE OUTPUTS (first 3 examples):
============================================================

--- Example 1 ---
Question: You are a helpful math tutor. Solve the problem step by step, then end your final line with '#### <number>'.

Problem:
Janet’s ducks lay 16 eggs per day. She eats three for breakfast every morning and...
Gold answer: 18
Target-alone: 210
Bridged: 44180442404422044

--- Example 2 ---
Question: You are a helpful math tutor. Solve the problem step by step, then end your final line with '#### <number>'.

Problem:
A robe takes 2 bolts of blue fiber and half that much white fiber.  How many bolt...
Gold answer: 3
Target-alone: 3
Bridged: 4564404574464524450454044245344345504440453044154430456044104425442045204405440404405044030440204305
Bridged generation start: 4044245344345504440453044154430456044104425442045204405440404405044030440204305...

--- Example 3 ---
Question: You are a helpful math tutor. Solve the problem step by step, then end your final line with '#### <number>'.

Problem:
Josh decides to try flipping a house.  He buys a house for $80,000 and then puts ...
Gold answer: 70000
Target-alone: 97500
Bridged: 6000009006000007200006004000006005006006006004006006005000006008000006003006006008006006003000006001200006007006006001206006000600400500600
Bridged generation start: 0040000000010000000080000000030000000060000000120000000700000000900000000150000000$60000060060000050060000040060000020060000080060000030060000000600000100600000700600000120600000<<600000900600000720000600400000600500600600600400600600500000600800000600300600600800600600300000600120000600700600600120...
============================================================

[Eval] Step 750 | Target-alone acc: 0.464 | Bridged acc: 0.018
[Early Stop] No improvement, patience: 1/5
Step 760/3500 | Loss (avg over last 20): 5.1955
Step 780/3500 | Loss (avg over last 20): 5.2936
Step 800/3500 | Loss (avg over last 20): 5.1886
Step 820/3500 | Loss (avg over last 20): 5.1754
Step 840/3500 | Loss (avg over last 20): 5.1757
Step 860/3500 | Loss (avg over last 20): 5.1746
Step 880/3500 | Loss (avg over last 20): 5.1913
Step 900/3500 | Loss (avg over last 20): 5.2068
Step 920/3500 | Loss (avg over last 20): 5.1950
Step 940/3500 | Loss (avg over last 20): 5.0352
Step 960/3500 | Loss (avg over last 20): 5.1137
Step 980/3500 | Loss (avg over last 20): 5.1097
Step 1000/3500 | Loss (avg over last 20): 4.9791
