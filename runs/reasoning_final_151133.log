[2026-01-19 22:27:19] Initializing experiment registry at runs/experiment_registry.json
==============================================================
REASONING-FOCUSED FINAL EXPERIMENTS (Publication Ready)
==============================================================
Job ID: 151133
Node: n21
GPUs: 0,1
Start time: Mon Jan 19 10:27:19 PM PST 2026

REASONING BENCHMARKS:
  - ARC-Easy (science)
  - WinoGrande (commonsense)
  - HellaSwag (situational)
  - BoolQ (reading comprehension)

GPU ALLOCATION:
  - GPU 0: Standard bridge (hail mary) + baselines (zero-shot, few-shot, DoRA, prompt tuning, linear probe)
  - GPU 1: Novel bridges + token capacity + latency/memory/throughput/batched benchmarks
==============================================================
Already up to date.

index, name, memory.free [MiB]
0, NVIDIA H100 80GB HBM3, 81106 MiB
1, NVIDIA H100 80GB HBM3, 81106 MiB


[2026-01-19 22:27:21] Starting parallel execution on 2 GPUs...

[2026-01-19 22:27:21] GPU 0 PID: 16853 (Standard Bridge + Baselines)
[2026-01-19 22:27:21] GPU 1 PID: 16854 (Novel Bridges + Benchmarks)

[2026-01-19 22:27:21] [GPU 1] Starting: Novel Bridges + Token Capacity + All Benchmarks

[2026-01-19 22:27:21] [GPU 0] Starting: Standard Bridge + Baselines
[2026-01-19 22:27:21] [GPU 1] Testing flow_matching on ARC-Easy (seed=42)
[2026-01-19 22:27:21] [GPU 0] Running Hail Mary Reasoning Evaluation
[2026-01-19 22:27:21] SKIP: flow_matching_arc_easy_seed42 (already completed)

[2026-01-19 22:27:21] [GPU 1] Testing optimal_transport on ARC-Easy (seed=42)
[2026-01-19 22:27:21] SKIP: hail_mary_reasoning (currently running (started 1.6h ago))
[2026-01-19 22:27:21] [GPU 0] Hail mary evaluation completed

[2026-01-19 22:27:21] [GPU 0] Running Zero-Shot Baseline on all reasoning datasets
[2026-01-19 22:27:21] [GPU 0] Zero-shot on arc_easy
[2026-01-19 22:27:21] SKIP: optimal_transport_arc_easy_seed42 (already completed)

[2026-01-19 22:27:21] [GPU 1] Testing moe on ARC-Easy (seed=42)
[2026-01-19 22:27:21] SKIP: zeroshot_arc_easy (already completed)
[2026-01-19 22:27:21] [GPU 0] Zero-shot on winogrande
[2026-01-19 22:27:21] SKIP: moe_arc_easy_seed42 (already completed)

[2026-01-19 22:27:21] [GPU 1] Starting HAIL MARY Bridge Experiments (6 literature-informed bridges)

[2026-01-19 22:27:21] [GPU 1] Testing HAIL MARY cross_modal_distillation on ARC-Easy (seed=42)
[2026-01-19 22:27:21] SKIP: zeroshot_winogrande (already completed)
[2026-01-19 22:27:21] [GPU 0] Zero-shot on hellaswag
[2026-01-19 22:27:21] SKIP: hailmary_cross_modal_distillation_arc_easy_seed42 (already completed)

[2026-01-19 22:27:21] [GPU 1] Testing HAIL MARY mine on ARC-Easy (seed=42)
[2026-01-19 22:27:21] SKIP: zeroshot_hellaswag (already completed)
[2026-01-19 22:27:21] [GPU 0] Zero-shot on boolq
[2026-01-19 22:27:21] SKIP: hailmary_mine_arc_easy_seed42 (already completed)

[2026-01-19 22:27:21] [GPU 1] Testing HAIL MARY mixture_of_depths on ARC-Easy (seed=42)
[2026-01-19 22:27:21] SKIP: zeroshot_boolq (already completed)

[2026-01-19 22:27:21] [GPU 0] Running Few-Shot Baseline (4-shot) on reasoning datasets
[2026-01-19 22:27:21] [GPU 0] Few-shot (4-shot) on arc_easy
[2026-01-19 22:27:21] SKIP: hailmary_mixture_of_depths_arc_easy_seed42 (already completed)

[2026-01-19 22:27:21] [GPU 1] Testing HAIL MARY thalamic_relay on ARC-Easy (seed=42)
[2026-01-19 22:27:21] SKIP: fewshot_arc_easy (already completed)
[2026-01-19 22:27:21] [GPU 0] Few-shot (4-shot) on winogrande
[2026-01-19 22:27:21] SKIP: hailmary_thalamic_relay_arc_easy_seed42 (already completed)

[2026-01-19 22:27:21] [GPU 1] Testing HAIL MARY domain_adversarial on ARC-Easy (seed=42)
[2026-01-19 22:27:21] SKIP: fewshot_winogrande (already completed)
[2026-01-19 22:27:21] [GPU 0] Few-shot (4-shot) on hellaswag
[2026-01-19 22:27:21] SKIP: hailmary_domain_adversarial_arc_easy_seed42 (already completed)

[2026-01-19 22:27:21] [GPU 1] Testing HAIL MARY successive_refinement on ARC-Easy (seed=42)
[2026-01-19 22:27:21] SKIP: fewshot_hellaswag (already completed)
[2026-01-19 22:27:21] [GPU 0] Few-shot (4-shot) on boolq
[2026-01-19 22:27:21] SKIP: hailmary_successive_refinement_arc_easy_seed42 (already completed)

[2026-01-19 22:27:21] [GPU 1] Token Capacity Scaling on Reasoning (4, 8, 16, 32 tokens, 3 seeds)
[2026-01-19 22:27:21] [GPU 1] Testing 4 soft tokens on ARC-Easy (seed=42)
[2026-01-19 22:27:21] SKIP: fewshot_boolq (already completed)

[2026-01-19 22:27:21] [GPU 0] Running DoRA Baseline (rank=8) on ARC-Easy
[2026-01-19 22:27:21] SKIP: token_capacity_4_seed42 (already completed)
[2026-01-19 22:27:21] [GPU 1] Testing 8 soft tokens on ARC-Easy (seed=42)
[2026-01-19 22:27:21] SKIP: dora_arc_easy (already completed)

[2026-01-19 22:27:21] [GPU 0] Running Prompt Tuning Baseline (8 tokens) on ARC-Easy
[2026-01-19 22:27:21] SKIP: token_capacity_8_seed42 (already completed)
[2026-01-19 22:27:21] [GPU 1] Testing 16 soft tokens on ARC-Easy (seed=42)
[2026-01-19 22:27:21] SKIP: prompt_tuning_arc_easy (already completed)

[2026-01-19 22:27:21] [GPU 0] Running Linear Probe Baseline (layer 31)
[2026-01-19 22:27:21] SKIP: token_capacity_16_seed42 (already completed)
[2026-01-19 22:27:21] [GPU 1] Testing 32 soft tokens on ARC-Easy (seed=42)
[2026-01-19 22:27:22] SKIP: linear_probe (already completed)

[2026-01-19 22:27:22] [GPU 0] Running Text Relay Baseline on ARC-Easy
[2026-01-19 22:27:22] SKIP: token_capacity_32_seed42 (already completed)

[2026-01-19 22:27:22] [GPU 1] Training Bridge on GSM8K (Math Reasoning)
[2026-01-19 22:27:22] [GPU 1] Training Mixture of Depths bridge on GSM8K (seed=42)
[2026-01-19 22:27:22] SKIP: text_relay_arc_easy (already completed)

[2026-01-19 22:27:22] [GPU 0] Running Ensemble Baseline on ARC-Easy
[2026-01-19 22:27:22] SKIP: ensemble_arc_easy (already completed)

[2026-01-19 22:27:22] [GPU 0] Running GSM8K Math Reasoning Baselines
[2026-01-19 22:27:22] [GPU 0] Zero-shot on GSM8K
Started: bridge_gsm8k_mod_seed42
[2026-01-19 22:27:22] START: bridge_gsm8k_mod_seed42
[2026-01-19 22:27:22] SKIP: zeroshot_gsm8k (already completed)
[2026-01-19 22:27:22] [GPU 0] Few-shot (4-shot) on GSM8K
[2026-01-19 22:27:22] SKIP: fewshot_gsm8k (already completed)
[2026-01-19 22:27:22] [GPU 0] All evaluations completed
[2026-01-19 22:27:22] GPU 0 finished
/users/sujinesh/.local/lib/python3.10/site-packages/transformers/utils/hub.py:128: FutureWarning: Using `TRANSFORMERS_CACHE` is deprecated and will be removed in v5 of Transformers. Use `HF_HOME` instead.
  warnings.warn(
============================================================
TELEPATHY TRAINING: GSM8K
============================================================

Dataset: gsm8k (None classes)
Random baseline: 0.0%
Source layer: 31
Soft tokens: 8
Steps: 1500
Diversity weight: 0.1
============================================================
Downloading shards:   0%|          | 0/4 [00:00<?, ?it/s]Downloading shards: 100%|██████████| 4/4 [00:00<00:00, 2111.14it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:02<00:08,  2.94s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:05<00:05,  2.82s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:08<00:02,  2.69s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:08<00:00,  1.90s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:08<00:00,  2.23s/it]
Downloading shards:   0%|          | 0/3 [00:00<?, ?it/s]Downloading shards: 100%|██████████| 3/3 [00:00<00:00, 3774.12it/s]
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:02<00:04,  2.12s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:04<00:02,  2.52s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:06<00:00,  2.29s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:06<00:00,  2.31s/it]
2026-01-19 22:27:46,482 - INFO - MixtureOfDepthsBridge: 8 tokens, 2 layers, capacity=0.5
Target embedding RMS: 0.0027
Using Mixture-of-Depths Bridge - Adaptive compute via early exit
Traceback (most recent call last):
  File "/scratch/m000066/sujinesh/LatentWire/telepathy/train_telepathy.py", line 1583, in <module>
    main()
  File "/scratch/m000066/sujinesh/LatentWire/telepathy/train_telepathy.py", line 1249, in main
    config["labels"] = train_ds.features[config["label_field"]].names
AttributeError: 'Value' object has no attribute 'names'
[2026-01-19 22:27:50] FAILED: bridge_gsm8k_mod_seed42 (exit code: 1)
Failed: bridge_gsm8k_mod_seed42

[2026-01-19 22:27:50] [GPU 1] Running Ridge Regression Baseline on ARC-Easy
[2026-01-19 22:27:50] SKIP: ridge_regression_arc_easy (already completed)

[2026-01-19 22:27:50] [GPU 1] Running Latency Benchmarks
[2026-01-19 22:27:55] [GPU 1] No checkpoint found, running latency benchmark without bridge
[2026-01-19 22:27:55] SKIP: latency_benchmark_no_checkpoint (already completed)

[2026-01-19 22:27:55] [GPU 1] Running Batched Latency Benchmark (batch sizes: 1, 4, 8, 16)
[2026-01-19 22:27:55] SKIP: batched_latency_benchmark (already completed)

[2026-01-19 22:27:55] [GPU 1] Running Memory Benchmark
[2026-01-19 22:27:55] SKIP: memory_benchmark (already completed)

[2026-01-19 22:27:55] [GPU 1] Running Throughput Benchmark
[2026-01-19 22:27:55] SKIP: throughput_benchmark_no_checkpoint (already completed)
[2026-01-19 22:27:55] [GPU 1] All experiments completed
[2026-01-19 22:27:55] GPU 1 finished

==============================================================
AGGREGATING REASONING RESULTS
==============================================================
======================================================================
REASONING BENCHMARK RESULTS (Publication Ready)
======================================================================

ZERO-SHOT BASELINE (no training):
----------------------------------------

FEW-SHOT BASELINE (4-shot):
----------------------------------------

DORA BASELINE (rank=8, SOTA 2024):
----------------------------------------

PROMPT TUNING BASELINE (8 tokens, no sender):
----------------------------------------

NOVEL BRIDGES (ARC-Easy):
----------------------------------------

HAIL MARY BRIDGES (ARC-Easy):
----------------------------------------

TOKEN CAPACITY (ARC-Easy):
----------------------------------------

LATENCY BENCHMARKS:
----------------------------------------

BATCHED LATENCY (samples/sec by batch size):
----------------------------------------
======================================================================

==============================================================
EXPERIMENT SUMMARY
==============================================================
Total experiments run: 0
Successful: 0
Failed: 0
Skipped (already completed): 0

Registry summary:
{
  "total": 37,
  "completed": 35,
  "failed": 1,
  "pending": 0,
  "running": 1,
  "needs_rerun": 0,
  "by_error_category": {
    "unknown": 1
  }
}
==============================================================
[main 21331ef] Reasoning experiments: job 151133 - 0/0 succeeded, 0 skipped
 4 files changed, 48 insertions(+), 4 deletions(-)
 create mode 100644 runs/reasoning_final_20260119_222719/experiment_errors.log
 create mode 100644 runs/reasoning_final_20260119_222719/novel_bridges/gsm8k_mod_seed42.log
 create mode 100644 runs/reasoning_final_20260119_222719/reasoning_results_summary.json
[2026-01-19 22:27:55] Git push attempt 1 of 3
[2026-01-19 22:27:57] Git push successful

==============================================================
REASONING EXPERIMENTS COMPLETED (Publication Ready)
==============================================================
Job ID: 151133
End time: Mon Jan 19 10:27:57 PM PST 2026
Total runtime: 38 seconds (0h 0m)

KEY EXPERIMENTS:
  1. Standard bridge on reasoning? (hail_mary)
  2. Zero-shot baseline? (baselines/zeroshot/)
  3. Few-shot baseline (4-shot)? (baselines/fewshot/)
  4. DoRA baseline (SOTA 2024)? (baselines/dora/)
  5. Prompt tuning (does sender help)? (baselines/prompt_tuning/)
  6. Linear probe upper bound? (baselines/linear_probe/)
  7. Novel bridges help? (novel_bridges/)
  8. More tokens help? (token_capacity: 4, 8, 16, 32)
  9. Latency advantage? (benchmarks/latency)
 10. Batched throughput scaling? (benchmarks/batched) - MLSys Critical

Results: runs/reasoning_final_20260119_222719
==============================================================
[2026-01-19 22:27:57] Job ending with exit code: 0
On branch main
Your branch is up to date with 'origin/main'.

Changes not staged for commit:
  (use "git add <file>..." to update what will be committed)
  (use "git restore <file>..." to discard changes in working directory)
	modified:   runs/reasoning_final_20260119_205402/.hail_mary_reasoning_capture.log
	modified:   runs/reasoning_final_20260119_205402/standard_bridge/hail_mary.log

Untracked files:
  (use "git add <file>..." to include in what will be committed)
	runs/reasoning_final_151133.err
	runs/reasoning_final_151133.log

no changes added to commit (use "git add" and/or "git commit -a")
[2026-01-19 22:27:57] Git push attempt 1 of 3
[2026-01-19 22:27:58] Git push successful
