/users/sujinesh/.local/lib/python3.10/site-packages/transformers/utils/hub.py:128: FutureWarning: Using `TRANSFORMERS_CACHE` is deprecated and will be removed in v5 of Transformers. Use `HF_HOME` instead.
  warnings.warn(
Device: cuda:0

======================================================================
FEW-SHOT BASELINE (4-shot): GSM8K
======================================================================
Note: This is a generative task - using generation-based evaluation

Evaluating Llama (4-shot)...
Downloading shards:   0%|          | 0/4 [00:00<?, ?it/s]Downloading shards: 100%|██████████| 4/4 [00:00<00:00, 3555.25it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:02<00:08,  2.76s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:05<00:05,  2.73s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:08<00:02,  2.80s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:09<00:00,  1.99s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:09<00:00,  2.28s/it]
Seed 42:   0%|          | 0/100 [00:00<?, ?it/s]/users/sujinesh/.local/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:590: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/users/sujinesh/.local/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:595: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
Seed 42:   1%|          | 1/100 [00:05<08:19,  5.05s/it]Seed 42:   2%|▏         | 2/100 [00:09<07:51,  4.82s/it]Seed 42:   3%|▎         | 3/100 [00:14<07:40,  4.75s/it]Seed 42:   4%|▍         | 4/100 [00:19<07:32,  4.71s/it]Seed 42:   5%|▌         | 5/100 [00:23<07:25,  4.69s/it]Seed 42:   6%|▌         | 6/100 [00:28<07:20,  4.68s/it]Seed 42:   7%|▋         | 7/100 [00:32<07:14,  4.67s/it]Seed 42:   8%|▊         | 8/100 [00:37<07:08,  4.66s/it]Seed 42:   9%|▉         | 9/100 [00:42<07:03,  4.66s/it]Seed 42:  10%|█         | 10/100 [00:46<06:58,  4.65s/it]Seed 42:  11%|█         | 11/100 [00:51<06:53,  4.65s/it]Seed 42:  12%|█▏        | 12/100 [00:56<06:49,  4.65s/it]Seed 42:  13%|█▎        | 13/100 [01:00<06:45,  4.66s/it]Seed 42:  14%|█▍        | 14/100 [01:05<06:41,  4.67s/it]Seed 42:  15%|█▌        | 15/100 [01:10<06:36,  4.66s/it]Seed 42:  16%|█▌        | 16/100 [01:14<06:31,  4.66s/it]Seed 42:  17%|█▋        | 17/100 [01:19<06:26,  4.66s/it]Seed 42:  18%|█▊        | 18/100 [01:24<06:23,  4.67s/it]Seed 42:  19%|█▉        | 19/100 [01:28<06:17,  4.66s/it]Seed 42:  20%|██        | 20/100 [01:33<06:11,  4.64s/it]Seed 42:  21%|██        | 21/100 [01:38<06:05,  4.63s/it]Seed 42:  22%|██▏       | 22/100 [01:42<06:01,  4.63s/it]Seed 42:  23%|██▎       | 23/100 [01:47<05:56,  4.64s/it]Seed 42:  24%|██▍       | 24/100 [01:52<05:52,  4.64s/it]Seed 42:  25%|██▌       | 25/100 [01:56<05:48,  4.65s/it]Seed 42:  26%|██▌       | 26/100 [02:01<05:44,  4.65s/it]Seed 42:  27%|██▋       | 27/100 [02:06<05:41,  4.68s/it]Seed 42:  28%|██▊       | 28/100 [02:10<05:35,  4.66s/it]Seed 42:  29%|██▉       | 29/100 [02:15<05:30,  4.65s/it]Seed 42:  30%|███       | 30/100 [02:19<05:24,  4.64s/it]Seed 42:  31%|███       | 31/100 [02:24<05:19,  4.64s/it]Seed 42:  32%|███▏      | 32/100 [02:29<05:16,  4.65s/it]Seed 42:  33%|███▎      | 33/100 [02:33<05:11,  4.65s/it]Seed 42:  34%|███▍      | 34/100 [02:38<05:06,  4.65s/it]Seed 42:  35%|███▌      | 35/100 [02:43<05:02,  4.65s/it]Seed 42:  36%|███▌      | 36/100 [02:47<04:56,  4.63s/it]Seed 42:  37%|███▋      | 37/100 [02:52<04:51,  4.63s/it]Seed 42:  38%|███▊      | 38/100 [02:57<04:46,  4.62s/it]Seed 42:  39%|███▉      | 39/100 [03:01<04:42,  4.63s/it]Seed 42:  40%|████      | 40/100 [03:06<04:38,  4.64s/it]Seed 42:  41%|████      | 41/100 [03:10<04:33,  4.64s/it]Seed 42:  42%|████▏     | 42/100 [03:15<04:28,  4.63s/it]Seed 42:  43%|████▎     | 43/100 [03:20<04:23,  4.62s/it]Seed 42:  44%|████▍     | 44/100 [03:24<04:20,  4.64s/it]Seed 42:  45%|████▌     | 45/100 [03:29<04:14,  4.64s/it]Seed 42:  46%|████▌     | 46/100 [03:34<04:10,  4.64s/it]Seed 42:  47%|████▋     | 47/100 [03:38<04:07,  4.66s/it]Seed 42:  48%|████▊     | 48/100 [03:43<04:01,  4.65s/it]Seed 42:  49%|████▉     | 49/100 [03:48<03:56,  4.63s/it]Seed 42:  50%|█████     | 50/100 [03:52<03:51,  4.62s/it]Seed 42:  51%|█████     | 51/100 [03:57<03:46,  4.61s/it]Seed 42:  52%|█████▏    | 52/100 [04:01<03:42,  4.63s/it]Seed 42:  53%|█████▎    | 53/100 [04:06<03:37,  4.63s/it]Seed 42:  54%|█████▍    | 54/100 [04:11<03:34,  4.66s/it]Seed 42:  55%|█████▌    | 55/100 [04:15<03:30,  4.67s/it]Seed 42:  56%|█████▌    | 56/100 [04:20<03:25,  4.66s/it]Seed 42:  57%|█████▋    | 57/100 [04:25<03:20,  4.65s/it]Seed 42:  58%|█████▊    | 58/100 [04:29<03:15,  4.66s/it]Seed 42:  59%|█████▉    | 59/100 [04:34<03:10,  4.65s/it]Seed 42:  60%|██████    | 60/100 [04:39<03:06,  4.66s/it]Seed 42:  61%|██████    | 61/100 [04:43<03:01,  4.66s/it]Seed 42:  62%|██████▏   | 62/100 [04:48<02:56,  4.66s/it]Seed 42:  63%|██████▎   | 63/100 [04:53<02:52,  4.65s/it]Seed 42:  64%|██████▍   | 64/100 [04:57<02:47,  4.66s/it]Seed 42:  65%|██████▌   | 65/100 [05:02<02:42,  4.65s/it]Seed 42:  66%|██████▌   | 66/100 [05:07<02:38,  4.67s/it]Seed 42:  67%|██████▋   | 67/100 [05:11<02:33,  4.66s/it]Seed 42:  68%|██████▊   | 68/100 [05:16<02:28,  4.65s/it]Seed 42:  69%|██████▉   | 69/100 [05:21<02:24,  4.65s/it]Seed 42:  70%|███████   | 70/100 [05:25<02:19,  4.66s/it]Seed 42:  71%|███████   | 71/100 [05:30<02:15,  4.66s/it]Seed 42:  72%|███████▏  | 72/100 [05:35<02:10,  4.65s/it]Seed 42:  73%|███████▎  | 73/100 [05:39<02:05,  4.65s/it]Seed 42:  74%|███████▍  | 74/100 [05:44<02:00,  4.65s/it]Seed 42:  75%|███████▌  | 75/100 [05:49<01:56,  4.64s/it]Seed 42:  76%|███████▌  | 76/100 [05:53<01:51,  4.64s/it]Seed 42:  77%|███████▋  | 77/100 [05:58<01:46,  4.65s/it]Seed 42:  78%|███████▊  | 78/100 [06:02<01:42,  4.65s/it]Seed 42:  79%|███████▉  | 79/100 [06:07<01:37,  4.64s/it]Seed 42:  80%|████████  | 80/100 [06:12<01:32,  4.63s/it]Seed 42:  81%|████████  | 81/100 [06:16<01:27,  4.62s/it]Seed 42:  82%|████████▏ | 82/100 [06:21<01:23,  4.65s/it]Seed 42:  83%|████████▎ | 83/100 [06:26<01:18,  4.63s/it]Seed 42:  84%|████████▍ | 84/100 [06:30<01:14,  4.64s/it]Seed 42:  85%|████████▌ | 85/100 [06:35<01:09,  4.64s/it]Seed 42:  86%|████████▌ | 86/100 [06:40<01:04,  4.64s/it]Seed 42:  87%|████████▋ | 87/100 [06:44<01:00,  4.64s/it]Seed 42:  88%|████████▊ | 88/100 [06:49<00:55,  4.63s/it]Seed 42:  89%|████████▉ | 89/100 [06:53<00:50,  4.64s/it]Seed 42:  90%|█████████ | 90/100 [06:58<00:46,  4.64s/it]Seed 42:  91%|█████████ | 91/100 [07:03<00:41,  4.64s/it]Seed 42:  92%|█████████▏| 92/100 [07:07<00:37,  4.64s/it]Seed 42:  93%|█████████▎| 93/100 [07:12<00:32,  4.64s/it]Seed 42:  94%|█████████▍| 94/100 [07:17<00:27,  4.64s/it]Seed 42:  95%|█████████▌| 95/100 [07:21<00:23,  4.64s/it]Seed 42:  96%|█████████▌| 96/100 [07:26<00:18,  4.66s/it]Seed 42:  97%|█████████▋| 97/100 [07:31<00:13,  4.67s/it]Seed 42:  98%|█████████▊| 98/100 [07:36<00:09,  4.78s/it]Seed 42:  99%|█████████▉| 99/100 [07:41<00:04,  4.92s/it]Seed 42: 100%|██████████| 100/100 [07:46<00:00,  4.92s/it]                                                            Seed 42: 59.0%
Llama 4-shot: 59.0% +/- 0.0%

Evaluating Mistral (4-shot)...
Downloading shards:   0%|          | 0/3 [00:00<?, ?it/s]Downloading shards: 100%|██████████| 3/3 [00:00<00:00, 3796.90it/s]
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:02<00:05,  2.74s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:05<00:02,  2.78s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:07<00:00,  2.63s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:07<00:00,  2.67s/it]
Seed 42:   0%|          | 0/100 [00:00<?, ?it/s]Seed 42:   1%|          | 1/100 [00:05<09:23,  5.69s/it]Seed 42:   2%|▏         | 2/100 [00:11<09:12,  5.64s/it]Seed 42:   3%|▎         | 3/100 [00:16<09:04,  5.62s/it]Seed 42:   4%|▍         | 4/100 [00:22<08:58,  5.61s/it]Seed 42:   5%|▌         | 5/100 [00:28<08:51,  5.60s/it]Seed 42:   6%|▌         | 6/100 [00:33<08:41,  5.54s/it]Seed 42:   7%|▋         | 7/100 [00:38<08:31,  5.50s/it]Seed 42:   8%|▊         | 8/100 [00:44<08:24,  5.48s/it]Seed 42:   9%|▉         | 9/100 [00:49<08:17,  5.47s/it]Seed 42:  10%|█         | 10/100 [00:55<08:10,  5.45s/it]Seed 42:  11%|█         | 11/100 [01:00<08:04,  5.45s/it]Seed 42:  12%|█▏        | 12/100 [01:06<08:00,  5.46s/it]Seed 42:  13%|█▎        | 13/100 [01:09<06:49,  4.70s/it]Seed 42:  14%|█▍        | 14/100 [01:14<07:03,  4.93s/it]Seed 42:  15%|█▌        | 15/100 [01:19<07:00,  4.95s/it]Seed 42:  16%|█▌        | 16/100 [01:24<07:08,  5.10s/it]Seed 42:  17%|█▋        | 17/100 [01:30<07:14,  5.23s/it]Seed 42:  18%|█▊        | 18/100 [01:35<07:14,  5.30s/it]Seed 42:  19%|█▉        | 19/100 [01:41<07:12,  5.33s/it]Seed 42:  20%|██        | 20/100 [01:46<07:10,  5.38s/it]Seed 42:  21%|██        | 21/100 [01:52<07:06,  5.40s/it]Seed 42:  22%|██▏       | 22/100 [01:57<07:01,  5.41s/it]Seed 42:  23%|██▎       | 23/100 [02:03<06:57,  5.42s/it]Seed 42:  24%|██▍       | 24/100 [02:08<06:52,  5.43s/it]Seed 42:  25%|██▌       | 25/100 [02:14<06:46,  5.42s/it]Seed 42:  26%|██▌       | 26/100 [02:19<06:41,  5.43s/it]Seed 42:  27%|██▋       | 27/100 [02:24<06:37,  5.44s/it]Seed 42:  28%|██▊       | 28/100 [02:30<06:30,  5.43s/it]Seed 42:  29%|██▉       | 29/100 [02:31<04:49,  4.08s/it]Seed 42:  30%|███       | 30/100 [02:35<04:50,  4.15s/it]Seed 42:  31%|███       | 31/100 [02:40<05:11,  4.52s/it]Seed 42:  32%|███▏      | 32/100 [02:46<05:24,  4.77s/it]Seed 42:  33%|███▎      | 33/100 [02:51<05:32,  4.97s/it]Seed 42:  34%|███▍      | 34/100 [02:57<05:37,  5.11s/it]Seed 42:  35%|███▌      | 35/100 [03:02<05:38,  5.20s/it]Seed 42:  36%|███▌      | 36/100 [03:08<05:36,  5.26s/it]Seed 42:  37%|███▋      | 37/100 [03:13<05:31,  5.26s/it]Seed 42:  38%|███▊      | 38/100 [03:18<05:25,  5.25s/it]Seed 42:  39%|███▉      | 39/100 [03:23<05:19,  5.24s/it]Seed 42:  40%|████      | 40/100 [03:29<05:15,  5.25s/it]Seed 42:  41%|████      | 41/100 [03:34<05:12,  5.29s/it]Seed 42:  42%|████▏     | 42/100 [03:35<03:54,  4.05s/it]Seed 42:  43%|████▎     | 43/100 [03:36<03:04,  3.24s/it]Seed 42:  44%|████▍     | 44/100 [03:42<03:35,  3.85s/it]Seed 42:  45%|████▌     | 45/100 [03:44<03:09,  3.45s/it]Seed 42:  46%|████▌     | 46/100 [03:47<02:56,  3.27s/it]Seed 42:  47%|████▋     | 47/100 [03:52<03:25,  3.87s/it]Seed 42:  48%|████▊     | 48/100 [03:58<03:42,  4.28s/it]Seed 42:  49%|████▉     | 49/100 [04:03<03:53,  4.58s/it]Seed 42:  50%|█████     | 50/100 [04:08<03:59,  4.78s/it]Seed 42:  51%|█████     | 51/100 [04:13<04:01,  4.92s/it]Seed 42:  52%|█████▏    | 52/100 [04:19<04:01,  5.03s/it]Seed 42:  53%|█████▎    | 53/100 [04:24<03:59,  5.10s/it]Seed 42:  54%|█████▍    | 54/100 [04:29<03:56,  5.14s/it]Seed 42:  55%|█████▌    | 55/100 [04:34<03:53,  5.19s/it]Seed 42:  56%|█████▌    | 56/100 [04:40<03:49,  5.21s/it]Seed 42:  57%|█████▋    | 57/100 [04:45<03:44,  5.22s/it]Seed 42:  58%|█████▊    | 58/100 [04:50<03:39,  5.23s/it]Seed 42:  59%|█████▉    | 59/100 [04:55<03:34,  5.24s/it]Seed 42:  60%|██████    | 60/100 [05:01<03:30,  5.27s/it]Seed 42:  61%|██████    | 61/100 [05:06<03:26,  5.29s/it]Seed 42:  62%|██████▏   | 62/100 [05:11<03:20,  5.28s/it]Seed 42:  63%|██████▎   | 63/100 [05:14<02:46,  4.51s/it]Seed 42:  64%|██████▍   | 64/100 [05:16<02:18,  3.83s/it]Seed 42:  65%|██████▌   | 65/100 [05:19<01:58,  3.39s/it]Seed 42:  66%|██████▌   | 66/100 [05:24<02:14,  3.95s/it]Seed 42:  67%|██████▋   | 67/100 [05:29<02:23,  4.35s/it]Seed 42:  68%|██████▊   | 68/100 [05:35<02:28,  4.63s/it]Seed 42:  69%|██████▉   | 69/100 [05:40<02:29,  4.81s/it]Seed 42:  70%|███████   | 70/100 [05:45<02:28,  4.95s/it]Seed 42:  71%|███████   | 71/100 [05:50<02:26,  5.05s/it]Seed 42:  72%|███████▏  | 72/100 [05:56<02:23,  5.12s/it]Seed 42:  73%|███████▎  | 73/100 [06:01<02:19,  5.16s/it]Seed 42:  74%|███████▍  | 74/100 [06:04<01:54,  4.42s/it]Seed 42:  75%|███████▌  | 75/100 [06:06<01:39,  3.97s/it]Seed 42:  76%|███████▌  | 76/100 [06:12<01:44,  4.36s/it]Seed 42:  77%|███████▋  | 77/100 [06:17<01:46,  4.63s/it]Seed 42:  78%|███████▊  | 78/100 [06:22<01:46,  4.82s/it]Seed 42:  79%|███████▉  | 79/100 [06:28<01:44,  4.96s/it]Seed 42:  80%|████████  | 80/100 [06:33<01:41,  5.05s/it]Seed 42:  81%|████████  | 81/100 [06:38<01:38,  5.17s/it]Seed 42:  82%|████████▏ | 82/100 [06:44<01:36,  5.35s/it]Seed 42:  83%|████████▎ | 83/100 [06:50<01:32,  5.47s/it]Seed 42:  84%|████████▍ | 84/100 [06:56<01:28,  5.55s/it]Seed 42:  85%|████████▌ | 85/100 [07:01<01:23,  5.58s/it]Seed 42:  86%|████████▌ | 86/100 [07:04<01:06,  4.78s/it]Seed 42:  87%|████████▋ | 87/100 [07:10<01:05,  5.06s/it]Seed 42:  88%|████████▊ | 88/100 [07:12<00:50,  4.20s/it]Seed 42:  89%|████████▉ | 89/100 [07:17<00:50,  4.58s/it]Seed 42:  90%|█████████ | 90/100 [07:23<00:48,  4.89s/it]Seed 42:  91%|█████████ | 91/100 [07:29<00:46,  5.12s/it]Seed 42:  92%|█████████▏| 92/100 [07:34<00:41,  5.25s/it]Seed 42:  93%|█████████▎| 93/100 [07:40<00:37,  5.34s/it]Seed 42:  94%|█████████▍| 94/100 [07:45<00:32,  5.40s/it]Seed 42:  95%|█████████▌| 95/100 [07:51<00:27,  5.49s/it]Seed 42:  96%|█████████▌| 96/100 [07:57<00:21,  5.49s/it]Seed 42:  97%|█████████▋| 97/100 [08:02<00:16,  5.56s/it]Seed 42:  98%|█████████▊| 98/100 [08:08<00:11,  5.58s/it]Seed 42:  99%|█████████▉| 99/100 [08:12<00:05,  5.11s/it]Seed 42: 100%|██████████| 100/100 [08:17<00:00,  5.21s/it]                                                            Seed 42: 41.0%
Mistral 4-shot: 41.0% +/- 0.0%

Results saved to: runs/reasoning_final_20260119_214405/baselines/fewshot/fewshot_gsm8k_20260119_220824.json
