/users/sujinesh/.local/lib/python3.10/site-packages/transformers/utils/hub.py:128: FutureWarning: Using `TRANSFORMERS_CACHE` is deprecated and will be removed in v5 of Transformers. Use `HF_HOME` instead.
  warnings.warn(
Device: cuda:1
GPU: NVIDIA H100 80GB HBM3

======================================================================
LATENCY BENCHMARK
======================================================================
Loading Llama...
Downloading shards:   0%|          | 0/4 [00:00<?, ?it/s]Downloading shards: 100%|██████████| 4/4 [00:00<00:00, 2607.59it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:02<00:07,  2.57s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:04<00:04,  2.39s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:07<00:02,  2.30s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:07<00:00,  1.66s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:07<00:00,  1.92s/it]
Loading Mistral...
Downloading shards:   0%|          | 0/3 [00:00<?, ?it/s]Downloading shards: 100%|██████████| 3/3 [00:00<00:00, 2812.45it/s]
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:02<00:04,  2.21s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:04<00:02,  2.19s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:06<00:00,  2.08s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:06<00:00,  2.12s/it]
Loading SST-2 dataset...

--- Direct Text (Mistral) ---
Direct:   0%|          | 0/50 [00:00<?, ?it/s]Direct:   4%|▍         | 2/50 [00:00<00:04, 10.21it/s]Direct:   8%|▊         | 4/50 [00:00<00:04, 10.19it/s]Direct:  12%|█▏        | 6/50 [00:00<00:04,  9.99it/s]Direct:  16%|█▌        | 8/50 [00:00<00:04, 10.15it/s]Direct:  20%|██        | 10/50 [00:00<00:03, 10.09it/s]Direct:  24%|██▍       | 12/50 [00:01<00:03, 10.20it/s]Direct:  28%|██▊       | 14/50 [00:01<00:03, 10.29it/s]Direct:  32%|███▏      | 16/50 [00:01<00:03, 10.37it/s]Direct:  36%|███▌      | 18/50 [00:01<00:03, 10.41it/s]Direct:  40%|████      | 20/50 [00:01<00:02, 10.42it/s]Direct:  44%|████▍     | 22/50 [00:02<00:02, 10.37it/s]Direct:  48%|████▊     | 24/50 [00:02<00:02, 10.37it/s]Direct:  52%|█████▏    | 26/50 [00:02<00:02,  9.92it/s]Direct:  56%|█████▌    | 28/50 [00:02<00:02, 10.06it/s]Direct:  60%|██████    | 30/50 [00:02<00:01, 10.13it/s]Direct:  64%|██████▍   | 32/50 [00:03<00:01, 10.22it/s]Direct:  68%|██████▊   | 34/50 [00:03<00:01, 10.30it/s]Direct:  72%|███████▏  | 36/50 [00:03<00:01, 10.34it/s]Direct:  76%|███████▌  | 38/50 [00:03<00:01, 10.38it/s]Direct:  80%|████████  | 40/50 [00:03<00:00, 10.38it/s]Direct:  84%|████████▍ | 42/50 [00:04<00:00, 10.42it/s]Direct:  88%|████████▊ | 44/50 [00:04<00:00, 10.45it/s]Direct:  92%|█████████▏| 46/50 [00:04<00:00, 10.47it/s]Direct:  96%|█████████▌| 48/50 [00:04<00:00, 10.40it/s]Direct: 100%|██████████| 50/50 [00:04<00:00, 10.41it/s]Direct: 100%|██████████| 50/50 [00:04<00:00, 10.30it/s]
Direct Text: 96.5 +/- 3.9 ms

--- Text-Relay (Llama -> text -> Mistral) ---
Text-Relay:   0%|          | 0/50 [00:00<?, ?it/s]/users/sujinesh/.local/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:590: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/users/sujinesh/.local/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:595: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
Text-Relay:   2%|▏         | 1/50 [00:00<00:27,  1.79it/s]Text-Relay:   4%|▍         | 2/50 [00:01<00:26,  1.79it/s]Text-Relay:   6%|▌         | 3/50 [00:01<00:26,  1.79it/s]Text-Relay:   8%|▊         | 4/50 [00:02<00:26,  1.74it/s]Text-Relay:  10%|█         | 5/50 [00:02<00:25,  1.74it/s]Text-Relay:  12%|█▏        | 6/50 [00:03<00:25,  1.74it/s]Text-Relay:  14%|█▍        | 7/50 [00:04<00:24,  1.74it/s]Text-Relay:  16%|█▌        | 8/50 [00:04<00:24,  1.75it/s]Text-Relay:  18%|█▊        | 9/50 [00:05<00:23,  1.74it/s]Text-Relay:  20%|██        | 10/50 [00:05<00:23,  1.74it/s]Text-Relay:  22%|██▏       | 11/50 [00:06<00:22,  1.76it/s]Text-Relay:  24%|██▍       | 12/50 [00:06<00:21,  1.77it/s]Text-Relay:  26%|██▌       | 13/50 [00:07<00:20,  1.78it/s]Text-Relay:  28%|██▊       | 14/50 [00:07<00:20,  1.79it/s]Text-Relay:  30%|███       | 15/50 [00:08<00:19,  1.79it/s]Text-Relay:  32%|███▏      | 16/50 [00:09<00:19,  1.78it/s]Text-Relay:  34%|███▍      | 17/50 [00:09<00:18,  1.77it/s]Text-Relay:  36%|███▌      | 18/50 [00:10<00:18,  1.76it/s]Text-Relay:  38%|███▊      | 19/50 [00:10<00:17,  1.76it/s]Text-Relay:  40%|████      | 20/50 [00:11<00:17,  1.75it/s]Text-Relay:  42%|████▏     | 21/50 [00:11<00:16,  1.74it/s]Text-Relay:  44%|████▍     | 22/50 [00:12<00:16,  1.69it/s]Text-Relay:  46%|████▌     | 23/50 [00:13<00:15,  1.69it/s]Text-Relay:  48%|████▊     | 24/50 [00:13<00:15,  1.71it/s]Text-Relay:  50%|█████     | 25/50 [00:14<00:14,  1.73it/s]Text-Relay:  52%|█████▏    | 26/50 [00:14<00:13,  1.76it/s]Text-Relay:  54%|█████▍    | 27/50 [00:15<00:13,  1.76it/s]Text-Relay:  56%|█████▌    | 28/50 [00:15<00:12,  1.76it/s]Text-Relay:  58%|█████▊    | 29/50 [00:16<00:12,  1.75it/s]Text-Relay:  60%|██████    | 30/50 [00:17<00:11,  1.75it/s]Text-Relay:  62%|██████▏   | 31/50 [00:17<00:10,  1.75it/s]Text-Relay:  64%|██████▍   | 32/50 [00:18<00:10,  1.73it/s]Text-Relay:  66%|██████▌   | 33/50 [00:18<00:09,  1.74it/s]Text-Relay:  68%|██████▊   | 34/50 [00:19<00:09,  1.74it/s]Text-Relay:  70%|███████   | 35/50 [00:20<00:08,  1.74it/s]Text-Relay:  72%|███████▏  | 36/50 [00:20<00:08,  1.74it/s]Text-Relay:  74%|███████▍  | 37/50 [00:21<00:07,  1.74it/s]Text-Relay:  76%|███████▌  | 38/50 [00:21<00:06,  1.74it/s]Text-Relay:  78%|███████▊  | 39/50 [00:22<00:06,  1.74it/s]Text-Relay:  80%|████████  | 40/50 [00:22<00:05,  1.74it/s]Text-Relay:  82%|████████▏ | 41/50 [00:23<00:05,  1.74it/s]Text-Relay:  84%|████████▍ | 42/50 [00:24<00:04,  1.75it/s]Text-Relay:  86%|████████▌ | 43/50 [00:24<00:04,  1.75it/s]Text-Relay:  88%|████████▊ | 44/50 [00:25<00:03,  1.75it/s]Text-Relay:  90%|█████████ | 45/50 [00:25<00:02,  1.74it/s]Text-Relay:  92%|█████████▏| 46/50 [00:26<00:02,  1.75it/s]Text-Relay:  94%|█████████▍| 47/50 [00:26<00:01,  1.75it/s]Text-Relay:  96%|█████████▌| 48/50 [00:27<00:01,  1.74it/s]Text-Relay:  98%|█████████▊| 49/50 [00:28<00:00,  1.71it/s]Text-Relay: 100%|██████████| 50/50 [00:28<00:00,  1.72it/s]Text-Relay: 100%|██████████| 50/50 [00:28<00:00,  1.75it/s]
Text-Relay: 572.6 +/- 13.7 ms

Results saved to: runs/reasoning_final_20260119_175045/benchmarks/latency_benchmark_20260119_182721.json
