{
  "experiment": "arc_easy",
  "timestamp": "2026-01-19T18:14:55.474544",
  "config": {
    "dataset": "arc_easy",
    "source_model": "meta-llama/Meta-Llama-3.1-8B-Instruct",
    "target_model": "mistralai/Mistral-7B-Instruct-v0.3",
    "source_layer": 31,
    "soft_tokens": 8,
    "depth": 2,
    "heads": 8,
    "lr": 0.0002,
    "batch_size": 16,
    "grad_accum": 2,
    "steps": 1500,
    "warmup_steps": 100,
    "diversity_weight": 0.1,
    "output_dir": "runs/reasoning_final_20260119_175045/novel_bridges/hailmary_domain_adversarial_arc_easy_seed42",
    "save_path": "bridge_arc_easy.pt",
    "save_every": 500,
    "eval_every": 200,
    "bf16": true,
    "use_fsq": false,
    "seed": 42,
    "gpu": 1,
    "resume": null,
    "auto_resume": true,
    "bridge_type": "domain_adversarial",
    "lambda_reg": 0.0001,
    "eval_only": false,
    "extract_layers": null,
    "learn_layer_weights": false,
    "inject_layers": null,
    "use_gumbel_gates": false,
    "temp_start": 2.0,
    "temp_end": 0.1,
    "use_vib": false,
    "vib_beta": 0.001,
    "vib_beta_anneal": false,
    "use_curriculum": false,
    "curriculum_stages": 5,
    "ot_epsilon": 0.1,
    "ot_iters": 20,
    "infonce_temp": 0.07,
    "infonce_weight": 0.1,
    "sparsity_k": 128,
    "num_refinement_steps": 2,
    "num_receptors": 32,
    "binding_sparsity": 0.1,
    "cca_dim": 256,
    "num_flow_steps": 4,
    "flow_loss_weight": 0.1,
    "moe_num_experts": 8,
    "moe_top_k": 2,
    "moe_use_shared_expert": true,
    "moe_aux_loss_weight": 0.01,
    "moe_aux_loss_free": false
  },
  "library_versions": {
    "torch": "2.5.1+cu121",
    "transformers": "4.46.2",
    "cuda": "12.1",
    "cudnn": 90100
  },
  "num_classes": 5,
  "random_baseline": 20.0,
  "final_results": {
    "accuracy": 83.0,
    "correct": 166,
    "total": 200
  },
  "training_log": [
    {
      "step": 50,
      "type": "metrics",
      "lm_loss": 2.0153480088710785,
      "aux_loss": 0.06538818359375,
      "div_loss": 0.9947745764255523,
      "z_var": 7.323920726776123e-06,
      "grad_norm": 275.6140625,
      "lr": 0.0001,
      "gpu_mem_allocated_gb": 46.35134744644165,
      "gpu_mem_reserved_gb": 50.12109375,
      "gpu_mem_peak_gb": 48.89923429489136
    },
    {
      "step": 100,
      "type": "metrics",
      "lm_loss": 0.953416987657547,
      "aux_loss": 0.02368579149246216,
      "div_loss": 0.9998744338750839,
      "z_var": 9.233951568603515e-06,
      "grad_norm": 109.66125,
      "lr": 0.0002,
      "gpu_mem_allocated_gb": 46.35134744644165,
      "gpu_mem_reserved_gb": 50.12109375,
      "gpu_mem_peak_gb": 48.89923429489136
    },
    {
      "step": 150,
      "type": "metrics",
      "lm_loss": 0.7154629635810852,
      "aux_loss": 0.0,
      "div_loss": 0.9991096955537796,
      "z_var": 1.3814568519592286e-05,
      "grad_norm": 3.1965234375,
      "lr": 0.00019937122098932428,
      "gpu_mem_allocated_gb": 46.35134744644165,
      "gpu_mem_reserved_gb": 50.12109375,
      "gpu_mem_peak_gb": 48.89923429489136
    },
    {
      "step": 200,
      "type": "metrics",
      "lm_loss": 0.7482474440336228,
      "aux_loss": 0.0,
      "div_loss": 0.9898581641912461,
      "z_var": 1.3960599899291992e-05,
      "grad_norm": 40.354609375,
      "lr": 0.00019749279121818235,
      "gpu_mem_allocated_gb": 46.35134744644165,
      "gpu_mem_reserved_gb": 50.12109375,
      "gpu_mem_peak_gb": 48.89923429489136
    },
    {
      "step": 200,
      "type": "eval",
      "accuracy": 43.0,
      "correct": 43,
      "total": 100
    },
    {
      "step": 250,
      "type": "metrics",
      "lm_loss": 0.6399420467019081,
      "aux_loss": 0.0,
      "div_loss": 0.9736486077308655,
      "z_var": 2.6167035102844238e-05,
      "grad_norm": 23.0293359375,
      "lr": 0.00019438833303083678,
      "gpu_mem_allocated_gb": 46.35134744644165,
      "gpu_mem_reserved_gb": 50.130859375,
      "gpu_mem_peak_gb": 48.89923429489136
    },
    {
      "step": 300,
      "type": "metrics",
      "lm_loss": 0.5561532551050186,
      "aux_loss": 0.0,
      "div_loss": 0.9608125096559524,
      "z_var": 1.7200112342834472e-05,
      "grad_norm": 13.5309375,
      "lr": 0.0001900968867902419,
      "gpu_mem_allocated_gb": 46.35134744644165,
      "gpu_mem_reserved_gb": 50.130859375,
      "gpu_mem_peak_gb": 48.936806201934814
    },
    {
      "step": 350,
      "type": "metrics",
      "lm_loss": 0.592430237531662,
      "aux_loss": 3.441333770751953e-05,
      "div_loss": 0.900560296177864,
      "z_var": 1.960098743438721e-05,
      "grad_norm": 27.821875,
      "lr": 0.00018467241992282843,
      "gpu_mem_allocated_gb": 46.35134744644165,
      "gpu_mem_reserved_gb": 50.130859375,
      "gpu_mem_peak_gb": 48.936806201934814
    },
    {
      "step": 400,
      "type": "metrics",
      "lm_loss": 5.497153613567352,
      "aux_loss": 0.0003786170482635498,
      "div_loss": 0.9867105448246002,
      "z_var": 2.562999725341797e-05,
      "grad_norm": 282.9215625,
      "lr": 0.000178183148246803,
      "gpu_mem_allocated_gb": 46.35134744644165,
      "gpu_mem_reserved_gb": 50.130859375,
      "gpu_mem_peak_gb": 48.936806201934814
    },
    {
      "step": 400,
      "type": "eval",
      "accuracy": 22.0,
      "correct": 22,
      "total": 100
    },
    {
      "step": 450,
      "type": "metrics",
      "lm_loss": 1.3058384475111962,
      "aux_loss": 0.0,
      "div_loss": 0.9975417047739029,
      "z_var": 4.7452449798583985e-05,
      "grad_norm": 87.22609375,
      "lr": 0.00017071067811865476,
      "gpu_mem_allocated_gb": 46.35134744644165,
      "gpu_mem_reserved_gb": 50.1328125,
      "gpu_mem_peak_gb": 48.936806201934814
    },
    {
      "step": 500,
      "type": "metrics",
      "lm_loss": 0.9495040833950043,
      "aux_loss": 0.0,
      "div_loss": 0.9974068135023118,
      "z_var": 7.00831413269043e-05,
      "grad_norm": 104.631796875,
      "lr": 0.00016234898018587337,
      "gpu_mem_allocated_gb": 46.35134744644165,
      "gpu_mem_reserved_gb": 50.1328125,
      "gpu_mem_peak_gb": 48.936806201934814
    },
    {
      "step": 550,
      "type": "metrics",
      "lm_loss": 0.6892689847946167,
      "aux_loss": 0.0,
      "div_loss": 0.995864235162735,
      "z_var": 0.00010818958282470702,
      "grad_norm": 35.07296875,
      "lr": 0.00015320320765153367,
      "gpu_mem_allocated_gb": 46.35134744644165,
      "gpu_mem_reserved_gb": 50.1328125,
      "gpu_mem_peak_gb": 48.936806201934814
    },
    {
      "step": 600,
      "type": "metrics",
      "lm_loss": 0.6318180266022683,
      "aux_loss": 0.0,
      "div_loss": 0.9887414491176605,
      "z_var": 0.00014074802398681641,
      "grad_norm": 13.161796875,
      "lr": 0.00014338837391175582,
      "gpu_mem_allocated_gb": 46.35134744644165,
      "gpu_mem_reserved_gb": 50.1328125,
      "gpu_mem_peak_gb": 48.936806201934814
    },
    {
      "step": 600,
      "type": "eval",
      "accuracy": 61.0,
      "correct": 61,
      "total": 100
    },
    {
      "step": 650,
      "type": "metrics",
      "lm_loss": 0.5136486499011517,
      "aux_loss": 0.0,
      "div_loss": 0.9806591606140137,
      "z_var": 0.00015763282775878905,
      "grad_norm": 11.863515625,
      "lr": 0.00013302790619551674,
      "gpu_mem_allocated_gb": 46.35134744644165,
      "gpu_mem_reserved_gb": 50.1328125,
      "gpu_mem_peak_gb": 48.936806201934814
    },
    {
      "step": 700,
      "type": "metrics",
      "lm_loss": 0.4716392166912556,
      "aux_loss": 0.0,
      "div_loss": 0.9812136524915696,
      "z_var": 0.00015440940856933593,
      "grad_norm": 8.18375,
      "lr": 0.00012225209339563145,
      "gpu_mem_allocated_gb": 46.35134744644165,
      "gpu_mem_reserved_gb": 50.1328125,
      "gpu_mem_peak_gb": 48.936806201934814
    },
    {
      "step": 750,
      "type": "metrics",
      "lm_loss": 0.4897506421804428,
      "aux_loss": 0.0,
      "div_loss": 0.9759627854824067,
      "z_var": 0.00018164634704589844,
      "grad_norm": 8.03390625,
      "lr": 0.00011119644761033078,
      "gpu_mem_allocated_gb": 46.35134744644165,
      "gpu_mem_reserved_gb": 50.1328125,
      "gpu_mem_peak_gb": 48.936806201934814
    },
    {
      "step": 800,
      "type": "metrics",
      "lm_loss": 0.4132721558213234,
      "aux_loss": 0.0,
      "div_loss": 0.9711922389268876,
      "z_var": 0.00018342018127441407,
      "grad_norm": 8.3057421875,
      "lr": 0.0001,
      "gpu_mem_allocated_gb": 46.35134744644165,
      "gpu_mem_reserved_gb": 50.1328125,
      "gpu_mem_peak_gb": 48.936806201934814
    },
    {
      "step": 800,
      "type": "eval",
      "accuracy": 64.0,
      "correct": 64,
      "total": 100
    },
    {
      "step": 850,
      "type": "metrics",
      "lm_loss": 0.3767697949707508,
      "aux_loss": 0.0,
      "div_loss": 0.9651953732967377,
      "z_var": 0.0001804065704345703,
      "grad_norm": 7.428984375,
      "lr": 8.880355238966923e-05,
      "gpu_mem_allocated_gb": 46.35134744644165,
      "gpu_mem_reserved_gb": 50.1328125,
      "gpu_mem_peak_gb": 48.936806201934814
    },
    {
      "step": 900,
      "type": "metrics",
      "lm_loss": 0.36199580565094946,
      "aux_loss": 0.0,
      "div_loss": 0.9611986529827118,
      "z_var": 0.00018510818481445312,
      "grad_norm": 4.5987109375,
      "lr": 7.774790660436858e-05,
      "gpu_mem_allocated_gb": 46.35134744644165,
      "gpu_mem_reserved_gb": 50.1328125,
      "gpu_mem_peak_gb": 48.936806201934814
    },
    {
      "step": 950,
      "type": "metrics",
      "lm_loss": 0.2843542212247849,
      "aux_loss": 0.0,
      "div_loss": 0.9509776008129119,
      "z_var": 0.00019314765930175781,
      "grad_norm": 3.6413671875,
      "lr": 6.697209380448333e-05,
      "gpu_mem_allocated_gb": 46.35134744644165,
      "gpu_mem_reserved_gb": 50.1328125,
      "gpu_mem_peak_gb": 48.936806201934814
    },
    {
      "step": 1000,
      "type": "metrics",
      "lm_loss": 0.26629468958824876,
      "aux_loss": 0.0,
      "div_loss": 0.9428111004829407,
      "z_var": 0.00019171714782714844,
      "grad_norm": 3.358828125,
      "lr": 5.6611626088244194e-05,
      "gpu_mem_allocated_gb": 46.35134744644165,
      "gpu_mem_reserved_gb": 50.1328125,
      "gpu_mem_peak_gb": 48.936806201934814
    },
    {
      "step": 1000,
      "type": "eval",
      "accuracy": 78.0,
      "correct": 78,
      "total": 100
    },
    {
      "step": 1050,
      "type": "metrics",
      "lm_loss": 0.22549041759222746,
      "aux_loss": 0.0,
      "div_loss": 0.9331626766920089,
      "z_var": 0.00019168853759765625,
      "grad_norm": 2.750078125,
      "lr": 4.6796792348466356e-05,
      "gpu_mem_allocated_gb": 46.35134744644165,
      "gpu_mem_reserved_gb": 50.1328125,
      "gpu_mem_peak_gb": 48.936806201934814
    },
    {
      "step": 1100,
      "type": "metrics",
      "lm_loss": 0.2314861524105072,
      "aux_loss": 0.0,
      "div_loss": 0.9289488726854325,
      "z_var": 0.00019287109375,
      "grad_norm": 3.578125,
      "lr": 3.7651019814126654e-05,
      "gpu_mem_allocated_gb": 46.35134744644165,
      "gpu_mem_reserved_gb": 50.1328125,
      "gpu_mem_peak_gb": 48.936806201934814
    },
    {
      "step": 1150,
      "type": "metrics",
      "lm_loss": 0.2073069184459746,
      "aux_loss": 0.0,
      "div_loss": 0.9305904299020767,
      "z_var": 0.00019359588623046875,
      "grad_norm": 2.97671875,
      "lr": 2.9289321881345254e-05,
      "gpu_mem_allocated_gb": 46.35134744644165,
      "gpu_mem_reserved_gb": 50.1328125,
      "gpu_mem_peak_gb": 48.936806201934814
    },
    {
      "step": 1200,
      "type": "metrics",
      "lm_loss": 0.1841272034868598,
      "aux_loss": 0.0,
      "div_loss": 0.922323408126831,
      "z_var": 0.00019359588623046875,
      "grad_norm": 2.16447265625,
      "lr": 2.181685175319702e-05,
      "gpu_mem_allocated_gb": 46.35134744644165,
      "gpu_mem_reserved_gb": 50.1328125,
      "gpu_mem_peak_gb": 48.936806201934814
    },
    {
      "step": 1200,
      "type": "eval",
      "accuracy": 84.0,
      "correct": 84,
      "total": 100
    },
    {
      "step": 1250,
      "type": "metrics",
      "lm_loss": 0.19774010414257645,
      "aux_loss": 0.0,
      "div_loss": 0.9166584134101867,
      "z_var": 0.00019359588623046875,
      "grad_norm": 2.198984375,
      "lr": 1.5327580077171587e-05,
      "gpu_mem_allocated_gb": 46.35134744644165,
      "gpu_mem_reserved_gb": 50.1328125,
      "gpu_mem_peak_gb": 48.936806201934814
    },
    {
      "step": 1300,
      "type": "metrics",
      "lm_loss": 0.17207296238746494,
      "aux_loss": 0.0,
      "div_loss": 0.9150334286689759,
      "z_var": 0.00019359588623046875,
      "grad_norm": 1.937109375,
      "lr": 9.903113209758096e-06,
      "gpu_mem_allocated_gb": 46.35134744644165,
      "gpu_mem_reserved_gb": 50.1328125,
      "gpu_mem_peak_gb": 48.936806201934814
    },
    {
      "step": 1350,
      "type": "metrics",
      "lm_loss": 0.18008824557065964,
      "aux_loss": 0.0,
      "div_loss": 0.9161490088701248,
      "z_var": 0.00019359588623046875,
      "grad_norm": 2.01103515625,
      "lr": 5.611666969163243e-06,
      "gpu_mem_allocated_gb": 46.35134744644165,
      "gpu_mem_reserved_gb": 50.1328125,
      "gpu_mem_peak_gb": 48.936806201934814
    },
    {
      "step": 1400,
      "type": "metrics",
      "lm_loss": 0.17448166919872166,
      "aux_loss": 0.0,
      "div_loss": 0.9128819489479065,
      "z_var": 0.00019359588623046875,
      "grad_norm": 2.0658203125,
      "lr": 2.5072087818176382e-06,
      "gpu_mem_allocated_gb": 46.35134744644165,
      "gpu_mem_reserved_gb": 50.1328125,
      "gpu_mem_peak_gb": 48.936806201934814
    },
    {
      "step": 1400,
      "type": "eval",
      "accuracy": 85.0,
      "correct": 85,
      "total": 100
    },
    {
      "step": 1450,
      "type": "metrics",
      "lm_loss": 0.17771038975566625,
      "aux_loss": 0.0,
      "div_loss": 0.9127198541164399,
      "z_var": 0.00019359588623046875,
      "grad_norm": 2.0867578125,
      "lr": 6.287790106757396e-07,
      "gpu_mem_allocated_gb": 46.35134744644165,
      "gpu_mem_reserved_gb": 50.1328125,
      "gpu_mem_peak_gb": 48.936806201934814
    },
    {
      "step": 1500,
      "type": "metrics",
      "lm_loss": 0.17648972516879438,
      "aux_loss": 0.0,
      "div_loss": 0.9127407705783844,
      "z_var": 0.00019359588623046875,
      "grad_norm": 2.02896484375,
      "lr": 0.0,
      "gpu_mem_allocated_gb": 46.35134744644165,
      "gpu_mem_reserved_gb": 50.1328125,
      "gpu_mem_peak_gb": 48.936806201934814
    }
  ]
}