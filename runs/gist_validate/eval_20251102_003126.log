/users/sujinesh/.local/lib/python3.10/site-packages/transformers/utils/hub.py:128: FutureWarning: Using `TRANSFORMERS_CACHE` is deprecated and will be removed in v5 of Transformers. Use `HF_HOME` instead.
  warnings.warn(

================================================================================
GIST TOKENS EVALUATION
================================================================================
Checkpoint: runs/gist_validate
Test samples: 200
Max new tokens: 128
Device: cuda:0
================================================================================

Loading gist model from runs/gist_validate...
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:27<01:22, 27.41s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:46<00:44, 22.31s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [01:04<00:20, 20.35s/it]Loading checkpoint shards: 100%|██████████| 4/4 [01:07<00:00, 13.77s/it]Loading checkpoint shards: 100%|██████████| 4/4 [01:07<00:00, 16.96s/it]
/projects/m000066/sujinesh/LatentWire/compressions/eval_gist.py:40: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  gist_data = torch.load(gist_path, map_location=device)
✓ Loaded gist embedding: 1 tokens
Loading Alpaca test data...
✓ Loaded 200 test samples

Evaluating samples...
Evaluating:   0%|          | 0/200 [00:00<?, ?it/s]/users/sujinesh/.local/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:590: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/users/sujinesh/.local/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:595: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
Evaluating:   0%|          | 1/200 [00:07<23:31,  7.09s/it]Evaluating:   1%|          | 2/200 [00:12<19:25,  5.89s/it]Evaluating:   2%|▏         | 3/200 [00:18<20:18,  6.19s/it]Evaluating:   2%|▏         | 4/200 [00:24<19:57,  6.11s/it]Evaluating:   2%|▎         | 5/200 [00:29<18:21,  5.65s/it]Evaluating:   3%|▎         | 6/200 [00:34<17:21,  5.37s/it]Evaluating:   4%|▎         | 7/200 [00:41<18:40,  5.80s/it]Evaluating:   4%|▍         | 8/200 [00:47<19:20,  6.05s/it]Evaluating:   4%|▍         | 9/200 [00:52<18:10,  5.71s/it]Evaluating:   5%|▌         | 10/200 [00:59<19:11,  6.06s/it]Evaluating:   6%|▌         | 11/200 [01:06<19:38,  6.23s/it]Evaluating:   6%|▌         | 12/200 [01:12<19:59,  6.38s/it]Evaluating:   6%|▋         | 13/200 [01:19<20:24,  6.55s/it]Evaluating:   7%|▋         | 14/200 [01:26<20:18,  6.55s/it]Evaluating:   8%|▊         | 15/200 [01:32<20:12,  6.55s/it]Evaluating:   8%|▊         | 16/200 [01:37<18:26,  6.02s/it]Evaluating:   8%|▊         | 17/200 [01:44<18:57,  6.22s/it]Evaluating:   9%|▉         | 18/200 [01:51<19:29,  6.43s/it]Evaluating:  10%|▉         | 19/200 [01:57<19:30,  6.47s/it]Evaluating:  10%|█         | 20/200 [02:03<18:20,  6.11s/it]Evaluating:  10%|█         | 21/200 [02:09<18:43,  6.28s/it]Evaluating:  11%|█         | 22/200 [02:14<17:12,  5.80s/it]Evaluating:  12%|█▏        | 23/200 [02:19<16:22,  5.55s/it]Evaluating:  12%|█▏        | 24/200 [02:25<17:09,  5.85s/it]Evaluating:  12%|█▎        | 25/200 [02:32<17:40,  6.06s/it]Evaluating:  13%|█▎        | 26/200 [02:37<16:42,  5.76s/it]Evaluating:  14%|█▎        | 27/200 [02:44<17:42,  6.14s/it]Evaluating:  14%|█▍        | 28/200 [02:49<16:18,  5.69s/it]Evaluating:  14%|█▍        | 29/200 [02:55<17:03,  5.98s/it]Evaluating:  15%|█▌        | 30/200 [03:02<17:26,  6.16s/it]Evaluating:  16%|█▌        | 31/200 [03:07<16:18,  5.79s/it]Evaluating:  16%|█▌        | 32/200 [03:14<16:57,  6.06s/it]Evaluating:  16%|█▋        | 33/200 [03:18<15:55,  5.72s/it]Evaluating:  17%|█▋        | 34/200 [03:25<16:15,  5.87s/it]Evaluating:  18%|█▊        | 35/200 [03:30<15:19,  5.57s/it]Evaluating:  18%|█▊        | 36/200 [03:34<14:26,  5.29s/it]Evaluating:  18%|█▊        | 37/200 [03:39<14:09,  5.21s/it]Evaluating:  19%|█▉        | 38/200 [03:45<14:34,  5.40s/it]Evaluating:  20%|█▉        | 39/200 [03:50<14:00,  5.22s/it]Evaluating:  20%|██        | 40/200 [03:55<13:55,  5.22s/it]Evaluating:  20%|██        | 41/200 [04:00<13:18,  5.02s/it]Evaluating:  21%|██        | 42/200 [04:07<14:43,  5.59s/it]Evaluating:  22%|██▏       | 43/200 [04:12<14:36,  5.58s/it]Evaluating:  22%|██▏       | 44/200 [04:19<15:17,  5.88s/it]Evaluating:  22%|██▎       | 45/200 [04:24<14:31,  5.62s/it]Evaluating:  23%|██▎       | 46/200 [04:29<14:01,  5.46s/it]Evaluating:  24%|██▎       | 47/200 [04:33<13:10,  5.17s/it]Evaluating:  24%|██▍       | 48/200 [04:39<13:40,  5.40s/it]Evaluating:  24%|██▍       | 49/200 [04:46<14:44,  5.86s/it]Evaluating:  25%|██▌       | 50/200 [04:51<13:34,  5.43s/it]Evaluating:  26%|██▌       | 51/200 [04:57<14:35,  5.88s/it]Evaluating:  26%|██▌       | 52/200 [05:02<13:33,  5.50s/it]Evaluating:  26%|██▋       | 53/200 [05:07<13:07,  5.36s/it]Evaluating:  27%|██▋       | 54/200 [05:14<14:13,  5.85s/it]Evaluating:  28%|██▊       | 55/200 [05:21<14:41,  6.08s/it]Evaluating:  28%|██▊       | 56/200 [05:27<14:55,  6.22s/it]Evaluating:  28%|██▊       | 57/200 [05:34<15:19,  6.43s/it]Evaluating:  29%|██▉       | 58/200 [05:41<15:23,  6.51s/it]Evaluating:  30%|██▉       | 59/200 [05:46<14:28,  6.16s/it]Evaluating:  30%|███       | 60/200 [05:51<13:39,  5.85s/it]Evaluating:  30%|███       | 61/200 [05:58<14:00,  6.05s/it]Evaluating:  31%|███       | 62/200 [06:03<13:08,  5.72s/it]Evaluating:  32%|███▏      | 63/200 [06:09<13:42,  6.00s/it]Evaluating:  32%|███▏      | 64/200 [06:15<12:55,  5.70s/it]Evaluating:  32%|███▎      | 65/200 [06:20<12:59,  5.78s/it]Evaluating:  33%|███▎      | 66/200 [06:26<12:33,  5.62s/it]Evaluating:  34%|███▎      | 67/200 [06:32<13:04,  5.90s/it]Evaluating:  34%|███▍      | 68/200 [06:39<13:45,  6.25s/it]Evaluating:  34%|███▍      | 69/200 [06:46<13:51,  6.35s/it]Evaluating:  35%|███▌      | 70/200 [06:52<13:52,  6.40s/it]Evaluating:  36%|███▌      | 71/200 [06:59<14:06,  6.56s/it]Evaluating:  36%|███▌      | 72/200 [07:06<13:59,  6.56s/it]Evaluating:  36%|███▋      | 73/200 [07:13<14:03,  6.64s/it]Evaluating:  37%|███▋      | 74/200 [07:20<14:02,  6.69s/it]Evaluating:  38%|███▊      | 75/200 [07:24<12:38,  6.06s/it]Evaluating:  38%|███▊      | 76/200 [07:30<12:38,  6.11s/it]Evaluating:  38%|███▊      | 77/200 [07:35<11:32,  5.63s/it]Evaluating:  39%|███▉      | 78/200 [07:42<12:19,  6.06s/it]Evaluating:  40%|███▉      | 79/200 [07:47<11:21,  5.63s/it]Evaluating:  40%|████      | 80/200 [07:54<12:02,  6.02s/it]Evaluating:  40%|████      | 81/200 [07:59<11:31,  5.81s/it]Evaluating:  41%|████      | 82/200 [08:04<10:52,  5.53s/it]Evaluating:  42%|████▏     | 83/200 [08:11<11:40,  5.98s/it]Evaluating:  42%|████▏     | 84/200 [08:17<11:54,  6.16s/it]Evaluating:  42%|████▎     | 85/200 [08:23<11:21,  5.93s/it]Evaluating:  43%|████▎     | 86/200 [08:29<11:42,  6.16s/it]Evaluating:  44%|████▎     | 87/200 [08:36<11:58,  6.35s/it]Evaluating:  44%|████▍     | 88/200 [08:41<11:03,  5.93s/it]Evaluating:  44%|████▍     | 89/200 [08:46<10:18,  5.57s/it]Evaluating:  45%|████▌     | 90/200 [08:53<10:58,  5.99s/it]Evaluating:  46%|████▌     | 91/200 [08:57<10:06,  5.57s/it]Evaluating:  46%|████▌     | 92/200 [09:04<10:34,  5.87s/it]Evaluating:  46%|████▋     | 93/200 [09:11<10:55,  6.12s/it]Evaluating:  47%|████▋     | 94/200 [09:16<10:26,  5.91s/it]Evaluating:  48%|████▊     | 95/200 [09:23<10:42,  6.12s/it]Evaluating:  48%|████▊     | 96/200 [09:28<10:15,  5.92s/it]Evaluating:  48%|████▊     | 97/200 [09:33<09:35,  5.58s/it]Evaluating:  49%|████▉     | 98/200 [09:38<09:06,  5.36s/it]Evaluating:  50%|████▉     | 99/200 [09:45<09:41,  5.75s/it]Evaluating:  50%|█████     | 100/200 [09:49<09:02,  5.43s/it]Evaluating:  50%|█████     | 101/200 [09:55<09:05,  5.51s/it]Evaluating:  51%|█████     | 102/200 [09:59<08:30,  5.21s/it]Evaluating:  52%|█████▏    | 103/200 [10:05<08:38,  5.35s/it]Evaluating:  52%|█████▏    | 104/200 [10:10<08:21,  5.22s/it]Evaluating:  52%|█████▎    | 105/200 [10:15<08:12,  5.19s/it]Evaluating:  53%|█████▎    | 106/200 [10:22<08:45,  5.59s/it]Evaluating:  54%|█████▎    | 107/200 [10:27<08:28,  5.47s/it]Evaluating:  54%|█████▍    | 108/200 [10:33<08:53,  5.79s/it]Evaluating:  55%|█████▍    | 109/200 [10:40<09:21,  6.17s/it]Evaluating:  55%|█████▌    | 110/200 [10:45<08:30,  5.68s/it]Evaluating:  56%|█████▌    | 111/200 [10:50<08:14,  5.55s/it]Evaluating:  56%|█████▌    | 112/200 [10:57<08:35,  5.85s/it]Evaluating:  56%|█████▋    | 113/200 [11:04<08:57,  6.17s/it]Evaluating:  57%|█████▋    | 114/200 [11:10<09:01,  6.30s/it]Evaluating:  57%|█████▊    | 115/200 [11:17<09:03,  6.39s/it]Evaluating:  58%|█████▊    | 116/200 [11:24<09:08,  6.53s/it]Evaluating:  58%|█████▊    | 117/200 [11:30<09:02,  6.53s/it]Evaluating:  59%|█████▉    | 118/200 [11:35<08:11,  5.99s/it]Evaluating:  60%|█████▉    | 119/200 [11:40<07:37,  5.64s/it]Evaluating:  60%|██████    | 120/200 [11:45<07:10,  5.38s/it]Evaluating:  60%|██████    | 121/200 [11:52<07:41,  5.84s/it]Evaluating:  61%|██████    | 122/200 [11:58<07:52,  6.05s/it]Evaluating:  62%|██████▏   | 123/200 [12:03<07:16,  5.67s/it]Evaluating:  62%|██████▏   | 124/200 [12:10<07:34,  5.98s/it]Evaluating:  62%|██████▎   | 125/200 [12:15<07:22,  5.89s/it]Evaluating:  63%|██████▎   | 126/200 [12:20<06:58,  5.66s/it]Evaluating:  64%|██████▎   | 127/200 [12:27<07:12,  5.93s/it]Evaluating:  64%|██████▍   | 128/200 [12:32<06:42,  5.58s/it]Evaluating:  64%|██████▍   | 129/200 [12:37<06:21,  5.37s/it]Evaluating:  65%|██████▌   | 130/200 [12:41<05:57,  5.11s/it]Evaluating:  66%|██████▌   | 131/200 [12:46<05:43,  4.98s/it]Evaluating:  66%|██████▌   | 132/200 [12:50<05:30,  4.86s/it]Evaluating:  66%|██████▋   | 133/200 [12:55<05:24,  4.84s/it]Evaluating:  67%|██████▋   | 134/200 [13:00<05:26,  4.95s/it]Evaluating:  68%|██████▊   | 135/200 [13:05<05:20,  4.93s/it]Evaluating:  68%|██████▊   | 136/200 [13:10<05:06,  4.80s/it]Evaluating:  68%|██████▊   | 137/200 [13:17<05:42,  5.44s/it]Evaluating:  69%|██████▉   | 138/200 [13:21<05:16,  5.11s/it]Evaluating:  70%|██████▉   | 139/200 [13:26<05:05,  5.01s/it]Evaluating:  70%|███████   | 140/200 [13:31<04:56,  4.94s/it]Evaluating:  70%|███████   | 141/200 [13:37<05:20,  5.42s/it]Evaluating:  71%|███████   | 142/200 [13:42<05:07,  5.31s/it]Evaluating:  72%|███████▏  | 143/200 [13:47<05:01,  5.29s/it]Evaluating:  72%|███████▏  | 144/200 [13:52<04:42,  5.05s/it]Evaluating:  72%|███████▎  | 145/200 [13:57<04:33,  4.98s/it]Evaluating:  73%|███████▎  | 146/200 [14:01<04:24,  4.89s/it]Evaluating:  74%|███████▎  | 147/200 [14:08<04:42,  5.33s/it]Evaluating:  74%|███████▍  | 148/200 [14:14<04:58,  5.74s/it]Evaluating:  74%|███████▍  | 149/200 [14:19<04:42,  5.54s/it]Evaluating:  75%|███████▌  | 150/200 [14:24<04:26,  5.34s/it]Evaluating:  76%|███████▌  | 151/200 [14:29<04:06,  5.04s/it]Evaluating:  76%|███████▌  | 152/200 [14:36<04:28,  5.60s/it]Evaluating:  76%|███████▋  | 153/200 [14:41<04:15,  5.43s/it]Evaluating:  77%|███████▋  | 154/200 [14:47<04:28,  5.83s/it]Evaluating:  78%|███████▊  | 155/200 [14:54<04:31,  6.04s/it]Evaluating:  78%|███████▊  | 156/200 [15:01<04:35,  6.27s/it]Evaluating:  78%|███████▊  | 157/200 [15:07<04:35,  6.40s/it]Evaluating:  79%|███████▉  | 158/200 [15:14<04:32,  6.48s/it]Evaluating:  80%|███████▉  | 159/200 [15:20<04:13,  6.18s/it]Evaluating:  80%|████████  | 160/200 [15:27<04:16,  6.40s/it]Evaluating:  80%|████████  | 161/200 [15:31<03:45,  5.79s/it]Evaluating:  81%|████████  | 162/200 [15:37<03:44,  5.89s/it]Evaluating:  82%|████████▏ | 163/200 [15:44<03:50,  6.22s/it]Evaluating:  82%|████████▏ | 164/200 [15:50<03:42,  6.17s/it]Evaluating:  82%|████████▎ | 165/200 [15:56<03:32,  6.07s/it]Evaluating:  83%|████████▎ | 166/200 [16:02<03:25,  6.03s/it]Evaluating:  84%|████████▎ | 167/200 [16:08<03:19,  6.06s/it]Evaluating:  84%|████████▍ | 168/200 [16:14<03:15,  6.12s/it]Evaluating:  84%|████████▍ | 169/200 [16:21<03:18,  6.39s/it]Evaluating:  85%|████████▌ | 170/200 [16:27<03:02,  6.09s/it]Evaluating:  86%|████████▌ | 171/200 [16:32<02:46,  5.75s/it]Evaluating:  86%|████████▌ | 172/200 [16:36<02:31,  5.40s/it]Evaluating:  86%|████████▋ | 173/200 [16:43<02:40,  5.93s/it]Evaluating:  87%|████████▋ | 174/200 [16:50<02:39,  6.14s/it]Evaluating:  88%|████████▊ | 175/200 [16:55<02:22,  5.71s/it]Evaluating:  88%|████████▊ | 176/200 [16:59<02:07,  5.32s/it]Evaluating:  88%|████████▊ | 177/200 [17:04<01:58,  5.15s/it]Evaluating:  89%|████████▉ | 178/200 [17:09<01:51,  5.08s/it]Evaluating:  90%|████████▉ | 179/200 [17:13<01:44,  4.95s/it]Evaluating:  90%|█████████ | 180/200 [17:18<01:39,  4.99s/it]Evaluating:  90%|█████████ | 181/200 [17:23<01:33,  4.90s/it]Evaluating:  91%|█████████ | 182/200 [17:28<01:25,  4.75s/it]Evaluating:  92%|█████████▏| 183/200 [17:32<01:20,  4.75s/it]Evaluating:  92%|█████████▏| 184/200 [17:37<01:17,  4.87s/it]Evaluating:  92%|█████████▎| 185/200 [17:42<01:13,  4.87s/it]Evaluating:  93%|█████████▎| 186/200 [17:47<01:06,  4.72s/it]Evaluating:  94%|█████████▎| 187/200 [17:51<01:01,  4.73s/it]Evaluating:  94%|█████████▍| 188/200 [17:56<00:55,  4.66s/it]Evaluating:  94%|█████████▍| 189/200 [18:01<00:51,  4.64s/it]Evaluating:  95%|█████████▌| 190/200 [18:05<00:46,  4.68s/it]Evaluating:  96%|█████████▌| 191/200 [18:10<00:41,  4.65s/it]Evaluating:  96%|█████████▌| 192/200 [18:15<00:37,  4.66s/it]Evaluating:  96%|█████████▋| 193/200 [18:19<00:32,  4.69s/it]Evaluating:  97%|█████████▋| 194/200 [18:24<00:27,  4.60s/it]Evaluating:  98%|█████████▊| 195/200 [18:29<00:23,  4.65s/it]Evaluating:  98%|█████████▊| 196/200 [18:33<00:18,  4.68s/it]Evaluating:  98%|█████████▊| 197/200 [18:38<00:13,  4.60s/it]Evaluating:  99%|█████████▉| 198/200 [18:43<00:09,  4.70s/it]Evaluating: 100%|█████████▉| 199/200 [18:47<00:04,  4.68s/it]Evaluating: 100%|██████████| 200/200 [18:52<00:00,  4.70s/it]Evaluating: 100%|██████████| 200/200 [18:52<00:00,  5.66s/it]

Computing ROUGE scores...

================================================================================
RESULTS
================================================================================

Compression:
  Full text avg tokens: 33.3
  Gist avg tokens: 35.3
  Compression ratio: 0.94×

ROUGE Scores:

  Full Text (positive control):
    ROUGE-1: 0.2807
    ROUGE-2: 0.1113
    ROUGE-L: 0.1903

  Gist Tokens (our method):
    ROUGE-1: 0.4500
    ROUGE-2: 0.1797
    ROUGE-L: 0.3621

  Truncated Text (negative control):
    ROUGE-1: 0.2769
    ROUGE-2: 0.1056
    ROUGE-L: 0.1840

  Relative Performance (vs Full Text):
    Gist ROUGE-L: 190.3% of full text
    Truncated ROUGE-L: 96.7% of full text

  Evaluation time: 1132.5s (5.66s per sample)
================================================================================

✓ Saved results to runs/gist_validate/eval_results.json
✓ Saved sample outputs to runs/gist_validate/sample_outputs.json
