Starting training at Sat Oct 11 21:10:49 PDT 2025
/projects/m000066/sujinesh/LatentWire/.venv/lib/python3.9/site-packages/transformers/utils/hub.py:128: FutureWarning: Using `TRANSFORMERS_CACHE` is deprecated and will be removed in v5 of Transformers. Use `HF_HOME` instead.
  warnings.warn(

Configuration:
  model_id: meta-llama/Meta-Llama-3.1-8B-Instruct
  compress_dim: 1024
  compress_method: pca
  input_dim: 4096
  pca_samples: 5000
  adapter_hidden_mult: 4
  adapter_dropout: 0.1
  adapter_lr: 0.0005
  samples: 1000
  epochs: 1
  batch_size: 8
  k_tokens: 2
  lambda_kce: 0.001
  lambda_kd: 0.001
  kd_tau: 1.0
  anneal_gen_objectives: False
  anneal_epochs: 3
  eval_every: 1
  eval_samples: 100
  save_dir: runs/phase1b_sweep/lambda_0.001
  diagnostic_log: runs/phase1b_sweep/lambda_0.001/logs/diagnostics.jsonl
============================================================
STAGE 1 PHASE 1B: RECONSTRUCTION + GENERATION TRAINING
Model: meta-llama/Meta-Llama-3.1-8B-Instruct
Compression: 4096 → 1024 (4.0× compression)
Training samples: 1000
PCA samples: 5000

Generation objectives:
  K-token CE: K=2, λ=0.001
  Prefix KD: τ=1.0, λ=0.001
============================================================

GPU Information:
  CUDA available: Yes
  GPU count: 4
  GPU 0: NVIDIA H100 80GB HBM3 (85.0 GB)
  GPU 1: NVIDIA H100 80GB HBM3 (85.0 GB)
  GPU 2: NVIDIA H100 80GB HBM3 (85.0 GB)
  GPU 3: NVIDIA H100 80GB HBM3 (85.0 GB)

Logging diagnostics to: runs/phase1b_sweep/lambda_0.001/logs/diagnostics.jsonl

Loading model and creating LMWrapper...
Downloading shards:   0%|          | 0/4 [00:00<?, ?it/s]Downloading shards: 100%|██████████| 4/4 [00:00<00:00, 3391.39it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:01<00:04,  1.54s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:03<00:03,  1.51s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:04<00:01,  1.41s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:04<00:00,  1.02it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:04<00:00,  1.16s/it]
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
[meta-llama/Meta-Llama-3.1-8B-Instruct] hf_device_map: {'model.embed_tokens': 0, 'model.layers.0': 0, 'model.layers.1': 0, 'model.layers.2': 0, 'model.layers.3': 0, 'model.layers.4': 0, 'model.layers.5': 1, 'model.layers.6': 1, 'model.layers.7': 1, 'model.layers.8': 1, 'model.layers.9': 1, 'model.layers.10': 1, 'model.layers.11': 1, 'model.layers.12': 1, 'model.layers.13': 1, 'model.layers.14': 1, 'model.layers.15': 2, 'model.layers.16': 2, 'model.layers.17': 2, 'model.layers.18': 2, 'model.layers.19': 2, 'model.layers.20': 2, 'model.layers.21': 2, 'model.layers.22': 2, 'model.layers.23': 2, 'model.layers.24': 2, 'model.layers.25': 3, 'model.layers.26': 3, 'model.layers.27': 3, 'model.layers.28': 3, 'model.layers.29': 3, 'model.layers.30': 3, 'model.layers.31': 3, 'model.norm': 3, 'model.rotary_emb': 3, 'lm_head': 3}
  Anchor text: ' Answer: ' → 3 tokens: [22559, 25, 220]
  Model loaded once (reused from LMWrapper to save memory)

Creating adapter...
Adapter parameters: 50,374,657

Loading dataset...
Training samples: 1000
Validation samples: 500

Fitting PCA compressor on 5,000 samples...

GPU memory status:
  GPU 0: 80.9 GB free / 85.0 GB total (allocated: 3.3 GB)
  GPU 1: 80.1 GB free / 85.0 GB total (allocated: 4.4 GB)
  GPU 2: 80.1 GB free / 85.0 GB total (allocated: 4.4 GB)
  GPU 3: 80.3 GB free / 85.0 GB total (allocated: 4.1 GB)

Using GPU 0 for PCA (80.9 GB free)
Collecting embeddings...
Collecting embeddings:   0%|          | 0/79 [00:00<?, ?it/s]Collecting embeddings:   3%|▎         | 2/79 [00:00<00:04, 18.22it/s]Collecting embeddings:   9%|▉         | 7/79 [00:00<00:02, 35.70it/s]Collecting embeddings:  16%|█▋        | 13/79 [00:00<00:01, 43.42it/s]Collecting embeddings:  24%|██▍       | 19/79 [00:00<00:01, 46.47it/s]Collecting embeddings:  32%|███▏      | 25/79 [00:00<00:01, 48.65it/s]Collecting embeddings:  39%|███▉      | 31/79 [00:00<00:00, 49.85it/s]Collecting embeddings:  47%|████▋     | 37/79 [00:00<00:00, 50.77it/s]Collecting embeddings:  54%|█████▍    | 43/79 [00:00<00:00, 44.24it/s]Collecting embeddings:  61%|██████    | 48/79 [00:01<00:00, 37.20it/s]Collecting embeddings:  66%|██████▌   | 52/79 [00:01<00:00, 30.17it/s]Collecting embeddings:  71%|███████   | 56/79 [00:01<00:00, 29.47it/s]Collecting embeddings:  77%|███████▋  | 61/79 [00:01<00:00, 33.49it/s]Collecting embeddings:  85%|████████▍ | 67/79 [00:01<00:00, 38.50it/s]Collecting embeddings:  92%|█████████▏| 73/79 [00:01<00:00, 42.54it/s]Collecting embeddings: 100%|██████████| 79/79 [00:01<00:00, 40.84it/s]
Concatenating 863,997 embedding vectors...
  Fitting PCA on GPU with 863,997 embedding vectors...
  Computing top 1024 components via randomized SVD...
  PCA captured variance (top 1024 components): 100.0%
✓ PCA fitted on 863,997 embedding vectors

============================================================
TRAINING
============================================================

Epoch 1/1:   0%|          | 0/125 [00:00<?, ?it/s]Starting from v4.46, the `logits` model output will have the same type as the model (except at train time, where it will always be FP32)
Epoch 1/1:   0%|          | 0/125 [00:01<?, ?it/s, loss=1.0212, recon=1.000, kce=13.004, kd=7.857, cos=-0.000]Epoch 1/1:   1%|          | 1/125 [00:01<03:20,  1.61s/it, loss=1.0212, recon=1.000, kce=13.004, kd=7.857, cos=-0.000]Epoch 1/1:   1%|          | 1/125 [00:02<03:20,  1.61s/it, loss=0.9457, recon=0.923, kce=12.271, kd=10.606, cos=0.077]Epoch 1/1:   2%|▏         | 2/125 [00:02<02:15,  1.10s/it, loss=0.9457, recon=0.923, kce=12.271, kd=10.606, cos=0.077]Epoch 1/1:   2%|▏         | 2/125 [00:03<02:15,  1.10s/it, loss=0.8724, recon=0.848, kce=13.576, kd=11.299, cos=0.152]Epoch 1/1:   2%|▏         | 3/125 [00:03<01:57,  1.04it/s, loss=0.8724, recon=0.848, kce=13.576, kd=11.299, cos=0.152]Epoch 1/1:   2%|▏         | 3/125 [00:03<01:57,  1.04it/s, loss=0.8178, recon=0.796, kce=14.346, kd=7.570, cos=0.204] Epoch 1/1:   3%|▎         | 4/125 [00:03<01:45,  1.15it/s, loss=0.8178, recon=0.796, kce=14.346, kd=7.570, cos=0.204]Epoch 1/1:   3%|▎         | 4/125 [00:04<01:45,  1.15it/s, loss=0.7739, recon=0.755, kce=12.357, kd=6.966, cos=0.246]Epoch 1/1:   4%|▍         | 5/125 [00:04<01:35,  1.25it/s, loss=0.7739, recon=0.755, kce=12.357, kd=6.966, cos=0.246]Epoch 1/1:   4%|▍         | 5/125 [00:05<01:35,  1.25it/s, loss=0.7311, recon=0.710, kce=14.104, kd=7.377, cos=0.291]Epoch 1/1:   5%|▍         | 6/125 [00:05<01:39,  1.19it/s, loss=0.7311, recon=0.710, kce=14.104, kd=7.377, cos=0.291]Epoch 1/1:   5%|▍         | 6/125 [00:06<01:39,  1.19it/s, loss=0.7158, recon=0.696, kce=12.898, kd=6.686, cos=0.305]Epoch 1/1:   6%|▌         | 7/125 [00:06<01:32,  1.28it/s, loss=0.7158, recon=0.696, kce=12.898, kd=6.686, cos=0.305]Epoch 1/1:   6%|▌         | 7/125 [00:06<01:32,  1.28it/s, loss=0.6961, recon=0.673, kce=16.093, kd=6.675, cos=0.328]Epoch 1/1:   6%|▋         | 8/125 [00:06<01:30,  1.29it/s, loss=0.6961, recon=0.673, kce=16.093, kd=6.675, cos=0.328]Epoch 1/1:   6%|▋         | 8/125 [00:07<01:30,  1.29it/s, loss=0.6715, recon=0.652, kce=11.972, kd=7.254, cos=0.348]Epoch 1/1:   7%|▋         | 9/125 [00:07<01:20,  1.44it/s, loss=0.6715, recon=0.652, kce=11.972, kd=7.254, cos=0.348]Epoch 1/1:   7%|▋         | 9/125 [00:08<01:20,  1.44it/s, loss=0.6544, recon=0.633, kce=14.764, kd=7.103, cos=0.367]Epoch 1/1:   8%|▊         | 10/125 [00:08<01:19,  1.45it/s, loss=0.6544, recon=0.633, kce=14.764, kd=7.103, cos=0.367]Epoch 1/1:   8%|▊         | 10/125 [00:09<01:19,  1.45it/s, loss=0.6397, recon=0.615, kce=14.815, kd=9.402, cos=0.385]Epoch 1/1:   9%|▉         | 11/125 [00:09<01:28,  1.29it/s, loss=0.6397, recon=0.615, kce=14.815, kd=9.402, cos=0.385]Epoch 1/1:   9%|▉         | 11/125 [00:09<01:28,  1.29it/s, loss=0.6360, recon=0.615, kce=10.093, kd=10.939, cos=0.385]Epoch 1/1:  10%|▉         | 12/125 [00:09<01:24,  1.34it/s, loss=0.6360, recon=0.615, kce=10.093, kd=10.939, cos=0.385]Epoch 1/1:  10%|▉         | 12/125 [00:10<01:24,  1.34it/s, loss=0.6351, recon=0.613, kce=12.195, kd=9.735, cos=0.387] Epoch 1/1:  10%|█         | 13/125 [00:10<01:26,  1.29it/s, loss=0.6351, recon=0.613, kce=12.195, kd=9.735, cos=0.387]Epoch 1/1:  10%|█         | 13/125 [00:11<01:26,  1.29it/s, loss=0.6154, recon=0.594, kce=11.114, kd=9.866, cos=0.406]Epoch 1/1:  11%|█         | 14/125 [00:11<01:22,  1.34it/s, loss=0.6154, recon=0.594, kce=11.114, kd=9.866, cos=0.406]Epoch 1/1:  11%|█         | 14/125 [00:11<01:22,  1.34it/s, loss=0.5922, recon=0.575, kce=9.378, kd=8.102, cos=0.426] Epoch 1/1:  12%|█▏        | 15/125 [00:11<01:20,  1.37it/s, loss=0.5922, recon=0.575, kce=9.378, kd=8.102, cos=0.426]Epoch 1/1:  12%|█▏        | 15/125 [00:12<01:20,  1.37it/s, loss=0.5849, recon=0.566, kce=10.271, kd=8.875, cos=0.436]Epoch 1/1:  13%|█▎        | 16/125 [00:12<01:19,  1.37it/s, loss=0.5849, recon=0.566, kce=10.271, kd=8.875, cos=0.436]Epoch 1/1:  13%|█▎        | 16/125 [00:13<01:19,  1.37it/s, loss=0.5821, recon=0.564, kce=9.595, kd=8.176, cos=0.436] Epoch 1/1:  14%|█▎        | 17/125 [00:13<01:13,  1.46it/s, loss=0.5821, recon=0.564, kce=9.595, kd=8.176, cos=0.436]Epoch 1/1:  14%|█▎        | 17/125 [00:13<01:13,  1.46it/s, loss=0.5711, recon=0.552, kce=9.760, kd=9.519, cos=0.449]Epoch 1/1:  14%|█▍        | 18/125 [00:13<01:11,  1.50it/s, loss=0.5711, recon=0.552, kce=9.760, kd=9.519, cos=0.449]Epoch 1/1:  14%|█▍        | 18/125 [00:14<01:11,  1.50it/s, loss=0.5583, recon=0.540, kce=10.277, kd=7.815, cos=0.461]Epoch 1/1:  15%|█▌        | 19/125 [00:14<01:14,  1.42it/s, loss=0.5583, recon=0.540, kce=10.277, kd=7.815, cos=0.461]Epoch 1/1:  15%|█▌        | 19/125 [00:15<01:14,  1.42it/s, loss=0.5482, recon=0.533, kce=7.058, kd=7.638, cos=0.467] Epoch 1/1:  16%|█▌        | 20/125 [00:15<01:12,  1.44it/s, loss=0.5482, recon=0.533, kce=7.058, kd=7.638, cos=0.467]Epoch 1/1:  16%|█▌        | 20/125 [00:16<01:12,  1.44it/s, loss=0.5226, recon=0.507, kce=7.469, kd=7.686, cos=0.494]Epoch 1/1:  17%|█▋        | 21/125 [00:16<01:20,  1.29it/s, loss=0.5226, recon=0.507, kce=7.469, kd=7.686, cos=0.494]Epoch 1/1:  17%|█▋        | 21/125 [00:16<01:20,  1.29it/s, loss=0.5347, recon=0.518, kce=10.068, kd=6.394, cos=0.482]Epoch 1/1:  18%|█▊        | 22/125 [00:16<01:16,  1.35it/s, loss=0.5347, recon=0.518, kce=10.068, kd=6.394, cos=0.482]Epoch 1/1:  18%|█▊        | 22/125 [00:17<01:16,  1.35it/s, loss=0.5365, recon=0.519, kce=10.939, kd=6.687, cos=0.482]Epoch 1/1:  18%|█▊        | 23/125 [00:17<01:18,  1.30it/s, loss=0.5365, recon=0.519, kce=10.939, kd=6.687, cos=0.482]Epoch 1/1:  18%|█▊        | 23/125 [00:18<01:18,  1.30it/s, loss=0.5197, recon=0.505, kce=8.175, kd=6.993, cos=0.496] Epoch 1/1:  19%|█▉        | 24/125 [00:18<01:10,  1.42it/s, loss=0.5197, recon=0.505, kce=8.175, kd=6.993, cos=0.496]Epoch 1/1:  19%|█▉        | 24/125 [00:19<01:10,  1.42it/s, loss=0.5302, recon=0.514, kce=9.581, kd=6.917, cos=0.486]Epoch 1/1:  20%|██        | 25/125 [00:19<01:09,  1.44it/s, loss=0.5302, recon=0.514, kce=9.581, kd=6.917, cos=0.486]Epoch 1/1:  20%|██        | 25/125 [00:19<01:09,  1.44it/s, loss=0.4982, recon=0.482, kce=8.787, kd=7.000, cos=0.520]Epoch 1/1:  21%|██        | 26/125 [00:19<01:10,  1.41it/s, loss=0.4982, recon=0.482, kce=8.787, kd=7.000, cos=0.520]Epoch 1/1:  21%|██        | 26/125 [00:20<01:10,  1.41it/s, loss=0.4939, recon=0.476, kce=9.127, kd=8.356, cos=0.523]Epoch 1/1:  22%|██▏       | 27/125 [00:20<01:02,  1.57it/s, loss=0.4939, recon=0.476, kce=9.127, kd=8.356, cos=0.523]Epoch 1/1:  22%|██▏       | 27/125 [00:20<01:02,  1.57it/s, loss=0.4913, recon=0.477, kce=7.613, kd=6.232, cos=0.523]Epoch 1/1:  22%|██▏       | 28/125 [00:20<01:04,  1.49it/s, loss=0.4913, recon=0.477, kce=7.613, kd=6.232, cos=0.523]Epoch 1/1:  22%|██▏       | 28/125 [00:21<01:04,  1.49it/s, loss=0.4919, recon=0.478, kce=7.874, kd=6.146, cos=0.523]Epoch 1/1:  23%|██▎       | 29/125 [00:21<01:08,  1.40it/s, loss=0.4919, recon=0.478, kce=7.874, kd=6.146, cos=0.523]Epoch 1/1:  23%|██▎       | 29/125 [00:22<01:08,  1.40it/s, loss=0.4697, recon=0.452, kce=9.264, kd=8.072, cos=0.547]Epoch 1/1:  24%|██▍       | 30/125 [00:22<01:06,  1.42it/s, loss=0.4697, recon=0.452, kce=9.264, kd=8.072, cos=0.547]Epoch 1/1:  24%|██▍       | 30/125 [00:23<01:06,  1.42it/s, loss=0.4529, recon=0.438, kce=8.383, kd=6.139, cos=0.562]Epoch 1/1:  25%|██▍       | 31/125 [00:23<01:11,  1.31it/s, loss=0.4529, recon=0.438, kce=8.383, kd=6.139, cos=0.562]Epoch 1/1:  25%|██▍       | 31/125 [00:24<01:11,  1.31it/s, loss=0.4558, recon=0.443, kce=5.284, kd=7.102, cos=0.559]Epoch 1/1:  26%|██▌       | 32/125 [00:24<01:08,  1.36it/s, loss=0.4558, recon=0.443, kce=5.284, kd=7.102, cos=0.559]Epoch 1/1:  26%|██▌       | 32/125 [00:24<01:08,  1.36it/s, loss=0.4831, recon=0.470, kce=5.605, kd=7.308, cos=0.531]Epoch 1/1:  26%|██▋       | 33/125 [00:24<01:07,  1.36it/s, loss=0.4831, recon=0.470, kce=5.605, kd=7.308, cos=0.531]Epoch 1/1:  26%|██▋       | 33/125 [00:25<01:07,  1.36it/s, loss=0.4574, recon=0.440, kce=9.241, kd=8.459, cos=0.562]Epoch 1/1:  27%|██▋       | 34/125 [00:25<01:09,  1.32it/s, loss=0.4574, recon=0.440, kce=9.241, kd=8.459, cos=0.562]Epoch 1/1:  27%|██▋       | 34/125 [00:26<01:09,  1.32it/s, loss=0.4600, recon=0.446, kce=5.851, kd=8.292, cos=0.555]Epoch 1/1:  28%|██▊       | 35/125 [00:26<01:05,  1.37it/s, loss=0.4600, recon=0.446, kce=5.851, kd=8.292, cos=0.555]Epoch 1/1:  28%|██▊       | 35/125 [00:27<01:05,  1.37it/s, loss=0.4678, recon=0.452, kce=8.435, kd=7.009, cos=0.547]Epoch 1/1:  29%|██▉       | 36/125 [00:27<01:10,  1.27it/s, loss=0.4678, recon=0.452, kce=8.435, kd=7.009, cos=0.547]Epoch 1/1:  29%|██▉       | 36/125 [00:27<01:10,  1.27it/s, loss=0.4255, recon=0.410, kce=8.055, kd=7.675, cos=0.590]Epoch 1/1:  30%|██▉       | 37/125 [00:27<01:06,  1.33it/s, loss=0.4255, recon=0.410, kce=8.055, kd=7.675, cos=0.590]Epoch 1/1:  30%|██▉       | 37/125 [00:28<01:06,  1.33it/s, loss=0.4258, recon=0.409, kce=8.181, kd=8.155, cos=0.590]Epoch 1/1:  30%|███       | 38/125 [00:28<01:03,  1.36it/s, loss=0.4258, recon=0.409, kce=8.181, kd=8.155, cos=0.590]Epoch 1/1:  30%|███       | 38/125 [00:29<01:03,  1.36it/s, loss=0.4451, recon=0.429, kce=8.256, kd=7.680, cos=0.570]Epoch 1/1:  31%|███       | 39/125 [00:29<01:06,  1.29it/s, loss=0.4451, recon=0.429, kce=8.256, kd=7.680, cos=0.570]Epoch 1/1:  31%|███       | 39/125 [00:30<01:06,  1.29it/s, loss=0.4209, recon=0.407, kce=7.670, kd=6.515, cos=0.594]Epoch 1/1:  32%|███▏      | 40/125 [00:30<01:03,  1.34it/s, loss=0.4209, recon=0.407, kce=7.670, kd=6.515, cos=0.594]Epoch 1/1:  32%|███▏      | 40/125 [00:30<01:03,  1.34it/s, loss=0.4311, recon=0.413, kce=9.211, kd=8.481, cos=0.586]Epoch 1/1:  33%|███▎      | 41/125 [00:30<01:03,  1.32it/s, loss=0.4311, recon=0.413, kce=9.211, kd=8.481, cos=0.586]Epoch 1/1:  33%|███▎      | 41/125 [00:31<01:03,  1.32it/s, loss=0.4038, recon=0.389, kce=6.213, kd=8.323, cos=0.613]Epoch 1/1:  34%|███▎      | 42/125 [00:31<00:56,  1.47it/s, loss=0.4038, recon=0.389, kce=6.213, kd=8.323, cos=0.613]Epoch 1/1:  34%|███▎      | 42/125 [00:31<00:56,  1.47it/s, loss=0.4165, recon=0.402, kce=6.188, kd=7.852, cos=0.598]Epoch 1/1:  34%|███▍      | 43/125 [00:31<00:50,  1.62it/s, loss=0.4165, recon=0.402, kce=6.188, kd=7.852, cos=0.598]Epoch 1/1:  34%|███▍      | 43/125 [00:32<00:50,  1.62it/s, loss=0.4115, recon=0.397, kce=6.189, kd=7.960, cos=0.602]Epoch 1/1:  35%|███▌      | 44/125 [00:32<00:52,  1.54it/s, loss=0.4115, recon=0.397, kce=6.189, kd=7.960, cos=0.602]Epoch 1/1:  35%|███▌      | 44/125 [00:33<00:52,  1.54it/s, loss=0.4359, recon=0.420, kce=7.002, kd=8.616, cos=0.582]Epoch 1/1:  36%|███▌      | 45/125 [00:33<00:49,  1.63it/s, loss=0.4359, recon=0.420, kce=7.002, kd=8.616, cos=0.582]Epoch 1/1:  36%|███▌      | 45/125 [00:33<00:49,  1.63it/s, loss=0.3957, recon=0.380, kce=8.560, kd=6.703, cos=0.621]Epoch 1/1:  37%|███▋      | 46/125 [00:33<00:48,  1.64it/s, loss=0.3957, recon=0.380, kce=8.560, kd=6.703, cos=0.621]Epoch 1/1:  37%|███▋      | 46/125 [00:34<00:48,  1.64it/s, loss=0.3937, recon=0.380, kce=7.473, kd=6.217, cos=0.621]Epoch 1/1:  38%|███▊      | 47/125 [00:34<00:54,  1.42it/s, loss=0.3937, recon=0.380, kce=7.473, kd=6.217, cos=0.621]Epoch 1/1:  38%|███▊      | 47/125 [00:35<00:54,  1.42it/s, loss=0.3998, recon=0.387, kce=6.043, kd=6.571, cos=0.613]Epoch 1/1:  38%|███▊      | 48/125 [00:35<00:51,  1.50it/s, loss=0.3998, recon=0.387, kce=6.043, kd=6.571, cos=0.613]Epoch 1/1:  38%|███▊      | 48/125 [00:36<00:51,  1.50it/s, loss=0.3917, recon=0.376, kce=8.563, kd=7.139, cos=0.625]Epoch 1/1:  39%|███▉      | 49/125 [00:36<00:54,  1.39it/s, loss=0.3917, recon=0.376, kce=8.563, kd=7.139, cos=0.625]Epoch 1/1:  39%|███▉      | 49/125 [00:36<00:54,  1.39it/s, loss=0.3924, recon=0.378, kce=7.081, kd=7.606, cos=0.621]Epoch 1/1:  40%|████      | 50/125 [00:36<00:54,  1.38it/s, loss=0.3924, recon=0.378, kce=7.081, kd=7.606, cos=0.621]Epoch 1/1:  40%|████      | 50/125 [00:37<00:54,  1.38it/s, loss=0.3830, recon=0.371, kce=6.484, kd=5.889, cos=0.629]Epoch 1/1:  41%|████      | 51/125 [00:37<00:55,  1.35it/s, loss=0.3830, recon=0.371, kce=6.484, kd=5.889, cos=0.629]Epoch 1/1:  41%|████      | 51/125 [00:38<00:55,  1.35it/s, loss=0.3957, recon=0.382, kce=6.778, kd=6.545, cos=0.617]Epoch 1/1:  42%|████▏     | 52/125 [00:38<00:57,  1.26it/s, loss=0.3957, recon=0.382, kce=6.778, kd=6.545, cos=0.617]Epoch 1/1:  42%|████▏     | 52/125 [00:39<00:57,  1.26it/s, loss=0.3643, recon=0.351, kce=7.284, kd=5.688, cos=0.648]Epoch 1/1:  42%|████▏     | 53/125 [00:39<00:54,  1.32it/s, loss=0.3643, recon=0.351, kce=7.284, kd=5.688, cos=0.648]Epoch 1/1:  42%|████▏     | 53/125 [00:40<00:54,  1.32it/s, loss=0.3783, recon=0.366, kce=6.939, kd=5.825, cos=0.637]Epoch 1/1:  43%|████▎     | 54/125 [00:40<00:56,  1.26it/s, loss=0.3783, recon=0.366, kce=6.939, kd=5.825, cos=0.637]Epoch 1/1:  43%|████▎     | 54/125 [00:40<00:56,  1.26it/s, loss=0.3812, recon=0.367, kce=7.035, kd=7.069, cos=0.633]Epoch 1/1:  44%|████▍     | 55/125 [00:40<00:52,  1.32it/s, loss=0.3812, recon=0.367, kce=7.035, kd=7.069, cos=0.633]Epoch 1/1:  44%|████▍     | 55/125 [00:41<00:52,  1.32it/s, loss=0.3776, recon=0.363, kce=6.110, kd=8.820, cos=0.637]Epoch 1/1:  45%|████▍     | 56/125 [00:41<00:47,  1.46it/s, loss=0.3776, recon=0.363, kce=6.110, kd=8.820, cos=0.637]Epoch 1/1:  45%|████▍     | 56/125 [00:42<00:47,  1.46it/s, loss=0.3565, recon=0.344, kce=7.161, kd=5.726, cos=0.656]Epoch 1/1:  46%|████▌     | 57/125 [00:42<00:51,  1.33it/s, loss=0.3565, recon=0.344, kce=7.161, kd=5.726, cos=0.656]Epoch 1/1:  46%|████▌     | 57/125 [00:42<00:51,  1.33it/s, loss=0.3813, recon=0.369, kce=5.676, kd=6.523, cos=0.633]Epoch 1/1:  46%|████▋     | 58/125 [00:42<00:48,  1.38it/s, loss=0.3813, recon=0.369, kce=5.676, kd=6.523, cos=0.633]Epoch 1/1:  46%|████▋     | 58/125 [00:43<00:48,  1.38it/s, loss=0.3616, recon=0.347, kce=7.536, kd=7.136, cos=0.652]Epoch 1/1:  47%|████▋     | 59/125 [00:43<00:49,  1.34it/s, loss=0.3616, recon=0.347, kce=7.536, kd=7.136, cos=0.652]Epoch 1/1:  47%|████▋     | 59/125 [00:44<00:49,  1.34it/s, loss=0.3581, recon=0.346, kce=7.656, kd=4.164, cos=0.656]Epoch 1/1:  48%|████▊     | 60/125 [00:44<00:47,  1.37it/s, loss=0.3581, recon=0.346, kce=7.656, kd=4.164, cos=0.656]Epoch 1/1:  48%|████▊     | 60/125 [00:45<00:47,  1.37it/s, loss=0.3719, recon=0.359, kce=6.387, kd=6.179, cos=0.641]Epoch 1/1:  49%|████▉     | 61/125 [00:45<00:46,  1.38it/s, loss=0.3719, recon=0.359, kce=6.387, kd=6.179, cos=0.641]Epoch 1/1:  49%|████▉     | 61/125 [00:45<00:46,  1.38it/s, loss=0.3706, recon=0.359, kce=4.038, kd=8.023, cos=0.641]Epoch 1/1:  50%|████▉     | 62/125 [00:45<00:49,  1.28it/s, loss=0.3706, recon=0.359, kce=4.038, kd=8.023, cos=0.641]Epoch 1/1:  50%|████▉     | 62/125 [00:46<00:49,  1.28it/s, loss=0.3660, recon=0.350, kce=7.886, kd=7.851, cos=0.652]Epoch 1/1:  50%|█████     | 63/125 [00:46<00:46,  1.34it/s, loss=0.3660, recon=0.350, kce=7.886, kd=7.851, cos=0.652]Epoch 1/1:  50%|█████     | 63/125 [00:47<00:46,  1.34it/s, loss=0.3655, recon=0.353, kce=6.472, kd=5.967, cos=0.648]Epoch 1/1:  51%|█████     | 64/125 [00:47<00:46,  1.30it/s, loss=0.3655, recon=0.353, kce=6.472, kd=5.967, cos=0.648]Epoch 1/1:  51%|█████     | 64/125 [00:48<00:46,  1.30it/s, loss=0.3380, recon=0.326, kce=5.163, kd=7.039, cos=0.676]Epoch 1/1:  52%|█████▏    | 65/125 [00:48<00:44,  1.35it/s, loss=0.3380, recon=0.326, kce=5.163, kd=7.039, cos=0.676]Epoch 1/1:  52%|█████▏    | 65/125 [00:48<00:44,  1.35it/s, loss=0.3199, recon=0.308, kce=5.118, kd=7.121, cos=0.691]Epoch 1/1:  53%|█████▎    | 66/125 [00:48<00:39,  1.48it/s, loss=0.3199, recon=0.308, kce=5.118, kd=7.121, cos=0.691]Epoch 1/1:  53%|█████▎    | 66/125 [00:49<00:39,  1.48it/s, loss=0.3183, recon=0.306, kce=6.674, kd=5.952, cos=0.695]Epoch 1/1:  54%|█████▎    | 67/125 [00:49<00:41,  1.40it/s, loss=0.3183, recon=0.306, kce=6.674, kd=5.952, cos=0.695]Epoch 1/1:  54%|█████▎    | 67/125 [00:50<00:41,  1.40it/s, loss=0.3730, recon=0.358, kce=8.179, kd=6.666, cos=0.641]Epoch 1/1:  54%|█████▍    | 68/125 [00:50<00:39,  1.43it/s, loss=0.3730, recon=0.358, kce=8.179, kd=6.666, cos=0.641]Epoch 1/1:  54%|█████▍    | 68/125 [00:50<00:39,  1.43it/s, loss=0.3525, recon=0.337, kce=8.587, kd=6.498, cos=0.664]Epoch 1/1:  55%|█████▌    | 69/125 [00:50<00:38,  1.44it/s, loss=0.3525, recon=0.337, kce=8.587, kd=6.498, cos=0.664]Epoch 1/1:  55%|█████▌    | 69/125 [00:51<00:38,  1.44it/s, loss=0.3454, recon=0.331, kce=8.032, kd=6.158, cos=0.668]Epoch 1/1:  56%|█████▌    | 70/125 [00:51<00:41,  1.32it/s, loss=0.3454, recon=0.331, kce=8.032, kd=6.158, cos=0.668]Epoch 1/1:  56%|█████▌    | 70/125 [00:52<00:41,  1.32it/s, loss=0.3265, recon=0.311, kce=7.957, kd=7.621, cos=0.691]Epoch 1/1:  57%|█████▋    | 71/125 [00:52<00:39,  1.38it/s, loss=0.3265, recon=0.311, kce=7.957, kd=7.621, cos=0.691]Epoch 1/1:  57%|█████▋    | 71/125 [00:53<00:39,  1.38it/s, loss=0.3493, recon=0.335, kce=8.683, kd=5.851, cos=0.664]Epoch 1/1:  58%|█████▊    | 72/125 [00:53<00:40,  1.32it/s, loss=0.3493, recon=0.335, kce=8.683, kd=5.851, cos=0.664]Epoch 1/1:  58%|█████▊    | 72/125 [00:53<00:40,  1.32it/s, loss=0.3364, recon=0.323, kce=6.642, kd=6.737, cos=0.680]Epoch 1/1:  58%|█████▊    | 73/125 [00:53<00:38,  1.37it/s, loss=0.3364, recon=0.323, kce=6.642, kd=6.737, cos=0.680]Epoch 1/1:  58%|█████▊    | 73/125 [00:54<00:38,  1.37it/s, loss=0.3266, recon=0.312, kce=8.091, kd=6.269, cos=0.688]Epoch 1/1:  59%|█████▉    | 74/125 [00:54<00:36,  1.39it/s, loss=0.3266, recon=0.312, kce=8.091, kd=6.269, cos=0.688]Epoch 1/1:  59%|█████▉    | 74/125 [00:55<00:36,  1.39it/s, loss=0.3413, recon=0.326, kce=7.233, kd=8.120, cos=0.676]Epoch 1/1:  60%|██████    | 75/125 [00:55<00:38,  1.29it/s, loss=0.3413, recon=0.326, kce=7.233, kd=8.120, cos=0.676]Epoch 1/1:  60%|██████    | 75/125 [00:56<00:38,  1.29it/s, loss=0.3230, recon=0.311, kce=5.733, kd=6.098, cos=0.691]Epoch 1/1:  61%|██████    | 76/125 [00:56<00:36,  1.34it/s, loss=0.3230, recon=0.311, kce=5.733, kd=6.098, cos=0.691]Epoch 1/1:  61%|██████    | 76/125 [00:56<00:36,  1.34it/s, loss=0.3374, recon=0.324, kce=7.331, kd=5.989, cos=0.676]Epoch 1/1:  62%|██████▏   | 77/125 [00:56<00:37,  1.26it/s, loss=0.3374, recon=0.324, kce=7.331, kd=5.989, cos=0.676]Epoch 1/1:  62%|██████▏   | 77/125 [00:57<00:37,  1.26it/s, loss=0.3384, recon=0.325, kce=7.214, kd=5.765, cos=0.676]Epoch 1/1:  62%|██████▏   | 78/125 [00:57<00:35,  1.32it/s, loss=0.3384, recon=0.325, kce=7.214, kd=5.765, cos=0.676]Epoch 1/1:  62%|██████▏   | 78/125 [00:58<00:35,  1.32it/s, loss=0.3517, recon=0.339, kce=6.204, kd=6.834, cos=0.660]Epoch 1/1:  63%|██████▎   | 79/125 [00:58<00:32,  1.41it/s, loss=0.3517, recon=0.339, kce=6.204, kd=6.834, cos=0.660]Epoch 1/1:  63%|██████▎   | 79/125 [00:58<00:32,  1.41it/s, loss=0.3295, recon=0.318, kce=4.742, kd=6.614, cos=0.684]Epoch 1/1:  64%|██████▍   | 80/125 [00:58<00:31,  1.41it/s, loss=0.3295, recon=0.318, kce=4.742, kd=6.614, cos=0.684]Epoch 1/1:  64%|██████▍   | 80/125 [00:59<00:31,  1.41it/s, loss=0.3192, recon=0.305, kce=7.291, kd=7.022, cos=0.695]Epoch 1/1:  65%|██████▍   | 81/125 [00:59<00:32,  1.36it/s, loss=0.3192, recon=0.305, kce=7.291, kd=7.022, cos=0.695]Epoch 1/1:  65%|██████▍   | 81/125 [01:00<00:32,  1.36it/s, loss=0.3249, recon=0.312, kce=6.159, kd=6.865, cos=0.688]Epoch 1/1:  66%|██████▌   | 82/125 [01:00<00:33,  1.29it/s, loss=0.3249, recon=0.312, kce=6.159, kd=6.865, cos=0.688]Epoch 1/1:  66%|██████▌   | 82/125 [01:01<00:33,  1.29it/s, loss=0.3457, recon=0.334, kce=5.783, kd=5.761, cos=0.668]Epoch 1/1:  66%|██████▋   | 83/125 [01:01<00:31,  1.34it/s, loss=0.3457, recon=0.334, kce=5.783, kd=5.761, cos=0.668]Epoch 1/1:  66%|██████▋   | 83/125 [01:01<00:31,  1.34it/s, loss=0.3269, recon=0.317, kce=4.119, kd=5.979, cos=0.684]Epoch 1/1:  67%|██████▋   | 84/125 [01:01<00:29,  1.39it/s, loss=0.3269, recon=0.317, kce=4.119, kd=5.979, cos=0.684]Epoch 1/1:  67%|██████▋   | 84/125 [01:02<00:29,  1.39it/s, loss=0.3407, recon=0.326, kce=9.082, kd=5.346, cos=0.676]Epoch 1/1:  68%|██████▊   | 85/125 [01:02<00:31,  1.28it/s, loss=0.3407, recon=0.326, kce=9.082, kd=5.346, cos=0.676][WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] KD teacher: adapters NOT disabled - KD may be contaminated
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
Epoch 1/1:  68%|██████▊   | 85/125 [01:03<00:31,  1.28it/s, loss=0.3130, recon=0.302, kce=4.499, kd=6.215, cos=0.699]Epoch 1/1:  69%|██████▉   | 86/125 [01:03<00:30,  1.29it/s, loss=0.3130, recon=0.302, kce=4.499, kd=6.215, cos=0.699]Epoch 1/1:  69%|██████▉   | 86/125 [01:04<00:30,  1.29it/s, loss=0.3188, recon=0.307, kce=5.481, kd=6.436, cos=0.695]Epoch 1/1:  70%|██████▉   | 87/125 [01:04<00:31,  1.22it/s, loss=0.3188, recon=0.307, kce=5.481, kd=6.436, cos=0.695]Epoch 1/1:  70%|██████▉   | 87/125 [01:05<00:31,  1.22it/s, loss=0.3309, recon=0.317, kce=7.560, kd=5.875, cos=0.684]Epoch 1/1:  70%|███████   | 88/125 [01:05<00:28,  1.29it/s, loss=0.3309, recon=0.317, kce=7.560, kd=5.875, cos=0.684]Epoch 1/1:  70%|███████   | 88/125 [01:06<00:28,  1.29it/s, loss=0.3086, recon=0.300, kce=3.544, kd=4.657, cos=0.699]Epoch 1/1:  71%|███████   | 89/125 [01:06<00:29,  1.21it/s, loss=0.3086, recon=0.300, kce=3.544, kd=4.657, cos=0.699]Epoch 1/1:  71%|███████   | 89/125 [01:06<00:29,  1.21it/s, loss=0.3183, recon=0.308, kce=4.302, kd=6.519, cos=0.691]Epoch 1/1:  72%|███████▏  | 90/125 [01:06<00:27,  1.29it/s, loss=0.3183, recon=0.308, kce=4.302, kd=6.519, cos=0.691]Epoch 1/1:  72%|███████▏  | 90/125 [01:07<00:27,  1.29it/s, loss=0.3275, recon=0.315, kce=5.589, kd=6.666, cos=0.684]Epoch 1/1:  73%|███████▎  | 91/125 [01:07<00:25,  1.32it/s, loss=0.3275, recon=0.315, kce=5.589, kd=6.666, cos=0.684]Epoch 1/1:  73%|███████▎  | 91/125 [01:08<00:25,  1.32it/s, loss=0.2972, recon=0.286, kce=4.974, kd=6.606, cos=0.715]Epoch 1/1:  74%|███████▎  | 92/125 [01:08<00:25,  1.28it/s, loss=0.2972, recon=0.286, kce=4.974, kd=6.606, cos=0.715]Epoch 1/1:  74%|███████▎  | 92/125 [01:09<00:25,  1.28it/s, loss=0.3239, recon=0.310, kce=6.824, kd=7.090, cos=0.691]Epoch 1/1:  74%|███████▍  | 93/125 [01:09<00:23,  1.34it/s, loss=0.3239, recon=0.310, kce=6.824, kd=7.090, cos=0.691]Epoch 1/1:  74%|███████▍  | 93/125 [01:09<00:23,  1.34it/s, loss=0.3324, recon=0.321, kce=5.680, kd=5.377, cos=0.680]Epoch 1/1:  75%|███████▌  | 94/125 [01:09<00:24,  1.26it/s, loss=0.3324, recon=0.321, kce=5.680, kd=5.377, cos=0.680]Epoch 1/1:  75%|███████▌  | 94/125 [01:10<00:24,  1.26it/s, loss=0.3420, recon=0.329, kce=6.005, kd=7.033, cos=0.672]Epoch 1/1:  76%|███████▌  | 95/125 [01:10<00:21,  1.37it/s, loss=0.3420, recon=0.329, kce=6.005, kd=7.033, cos=0.672]Epoch 1/1:  76%|███████▌  | 95/125 [01:11<00:21,  1.37it/s, loss=0.3316, recon=0.320, kce=5.801, kd=5.890, cos=0.680]Epoch 1/1:  77%|███████▋  | 96/125 [01:11<00:20,  1.40it/s, loss=0.3316, recon=0.320, kce=5.801, kd=5.890, cos=0.680]Epoch 1/1:  77%|███████▋  | 96/125 [01:12<00:20,  1.40it/s, loss=0.3225, recon=0.311, kce=5.371, kd=5.816, cos=0.688]Epoch 1/1:  78%|███████▊  | 97/125 [01:12<00:21,  1.31it/s, loss=0.3225, recon=0.311, kce=5.371, kd=5.816, cos=0.688]Epoch 1/1:  78%|███████▊  | 97/125 [01:12<00:21,  1.31it/s, loss=0.3113, recon=0.300, kce=5.391, kd=5.993, cos=0.699]Epoch 1/1:  78%|███████▊  | 98/125 [01:12<00:19,  1.36it/s, loss=0.3113, recon=0.300, kce=5.391, kd=5.993, cos=0.699]Epoch 1/1:  78%|███████▊  | 98/125 [01:13<00:19,  1.36it/s, loss=0.3005, recon=0.288, kce=4.838, kd=7.660, cos=0.711]Epoch 1/1:  79%|███████▉  | 99/125 [01:13<00:20,  1.29it/s, loss=0.3005, recon=0.288, kce=4.838, kd=7.660, cos=0.711]Epoch 1/1:  79%|███████▉  | 99/125 [01:14<00:20,  1.29it/s, loss=0.3316, recon=0.320, kce=5.138, kd=6.605, cos=0.680]Epoch 1/1:  80%|████████  | 100/125 [01:14<00:20,  1.21it/s, loss=0.3316, recon=0.320, kce=5.138, kd=6.605, cos=0.680]Epoch 1/1:  80%|████████  | 100/125 [01:15<00:20,  1.21it/s, loss=0.3450, recon=0.331, kce=7.030, kd=6.823, cos=0.668]Epoch 1/1:  81%|████████  | 101/125 [01:15<00:19,  1.21it/s, loss=0.3450, recon=0.331, kce=7.030, kd=6.823, cos=0.668]Epoch 1/1:  81%|████████  | 101/125 [01:15<00:19,  1.21it/s, loss=0.3254, recon=0.310, kce=7.815, kd=7.095, cos=0.691]Epoch 1/1:  82%|████████▏ | 102/125 [01:15<00:16,  1.36it/s, loss=0.3254, recon=0.310, kce=7.815, kd=7.095, cos=0.691]Epoch 1/1:  82%|████████▏ | 102/125 [01:16<00:16,  1.36it/s, loss=0.3147, recon=0.302, kce=6.552, kd=6.344, cos=0.699]Epoch 1/1:  82%|████████▏ | 103/125 [01:16<00:16,  1.34it/s, loss=0.3147, recon=0.302, kce=6.552, kd=6.344, cos=0.699]Epoch 1/1:  82%|████████▏ | 103/125 [01:17<00:16,  1.34it/s, loss=0.3085, recon=0.297, kce=5.516, kd=6.406, cos=0.703]Epoch 1/1:  83%|████████▎ | 104/125 [01:17<00:15,  1.34it/s, loss=0.3085, recon=0.297, kce=5.516, kd=6.406, cos=0.703]Epoch 1/1:  83%|████████▎ | 104/125 [01:18<00:15,  1.34it/s, loss=0.2979, recon=0.286, kce=5.257, kd=6.682, cos=0.715]Epoch 1/1:  84%|████████▍ | 105/125 [01:18<00:14,  1.38it/s, loss=0.2979, recon=0.286, kce=5.257, kd=6.682, cos=0.715]Epoch 1/1:  84%|████████▍ | 105/125 [01:18<00:14,  1.38it/s, loss=0.3110, recon=0.299, kce=5.914, kd=6.331, cos=0.703]Epoch 1/1:  85%|████████▍ | 106/125 [01:18<00:14,  1.34it/s, loss=0.3110, recon=0.299, kce=5.914, kd=6.331, cos=0.703]Epoch 1/1:  85%|████████▍ | 106/125 [01:19<00:14,  1.34it/s, loss=0.3170, recon=0.309, kce=2.593, kd=5.640, cos=0.691]Epoch 1/1:  86%|████████▌ | 107/125 [01:19<00:13,  1.35it/s, loss=0.3170, recon=0.309, kce=2.593, kd=5.640, cos=0.691]Epoch 1/1:  86%|████████▌ | 107/125 [01:20<00:13,  1.35it/s, loss=0.3045, recon=0.294, kce=5.836, kd=4.377, cos=0.707]Epoch 1/1:  86%|████████▋ | 108/125 [01:20<00:11,  1.45it/s, loss=0.3045, recon=0.294, kce=5.836, kd=4.377, cos=0.707]Epoch 1/1:  86%|████████▋ | 108/125 [01:21<00:11,  1.45it/s, loss=0.3417, recon=0.331, kce=4.559, kd=6.489, cos=0.672]Epoch 1/1:  87%|████████▋ | 109/125 [01:21<00:11,  1.40it/s, loss=0.3417, recon=0.331, kce=4.559, kd=6.489, cos=0.672]Epoch 1/1:  87%|████████▋ | 109/125 [01:21<00:11,  1.40it/s, loss=0.3075, recon=0.297, kce=3.408, kd=6.688, cos=0.703]Epoch 1/1:  88%|████████▊ | 110/125 [01:21<00:10,  1.42it/s, loss=0.3075, recon=0.297, kce=3.408, kd=6.688, cos=0.703]Epoch 1/1:  88%|████████▊ | 110/125 [01:22<00:10,  1.42it/s, loss=0.3097, recon=0.297, kce=6.677, kd=5.669, cos=0.703]Epoch 1/1:  89%|████████▉ | 111/125 [01:22<00:10,  1.33it/s, loss=0.3097, recon=0.297, kce=6.677, kd=5.669, cos=0.703]Epoch 1/1:  89%|████████▉ | 111/125 [01:23<00:10,  1.33it/s, loss=0.3166, recon=0.305, kce=6.308, kd=5.732, cos=0.695]Epoch 1/1:  90%|████████▉ | 112/125 [01:23<00:09,  1.37it/s, loss=0.3166, recon=0.305, kce=6.308, kd=5.732, cos=0.695]Epoch 1/1:  90%|████████▉ | 112/125 [01:23<00:09,  1.37it/s, loss=0.2957, recon=0.282, kce=7.220, kd=6.257, cos=0.719]Epoch 1/1:  90%|█████████ | 113/125 [01:23<00:08,  1.41it/s, loss=0.2957, recon=0.282, kce=7.220, kd=6.257, cos=0.719]Epoch 1/1:  90%|█████████ | 113/125 [01:24<00:08,  1.41it/s, loss=0.3254, recon=0.313, kce=6.086, kd=6.228, cos=0.688]Epoch 1/1:  91%|█████████ | 114/125 [01:24<00:08,  1.34it/s, loss=0.3254, recon=0.313, kce=6.086, kd=6.228, cos=0.688]Epoch 1/1:  91%|█████████ | 114/125 [01:25<00:08,  1.34it/s, loss=0.3027, recon=0.292, kce=5.737, kd=5.079, cos=0.707]Epoch 1/1:  92%|█████████▏| 115/125 [01:25<00:07,  1.38it/s, loss=0.3027, recon=0.292, kce=5.737, kd=5.079, cos=0.707]Epoch 1/1:  92%|█████████▏| 115/125 [01:26<00:07,  1.38it/s, loss=0.3335, recon=0.322, kce=5.525, kd=6.045, cos=0.680]Epoch 1/1:  93%|█████████▎| 116/125 [01:26<00:06,  1.40it/s, loss=0.3335, recon=0.322, kce=5.525, kd=6.045, cos=0.680]Epoch 1/1:  93%|█████████▎| 116/125 [01:26<00:06,  1.40it/s, loss=0.3191, recon=0.306, kce=6.969, kd=6.334, cos=0.695]Epoch 1/1:  94%|█████████▎| 117/125 [01:26<00:06,  1.31it/s, loss=0.3191, recon=0.306, kce=6.969, kd=6.334, cos=0.695]Epoch 1/1:  94%|█████████▎| 117/125 [01:27<00:06,  1.31it/s, loss=0.3017, recon=0.289, kce=6.589, kd=6.114, cos=0.711]Epoch 1/1:  94%|█████████▍| 118/125 [01:27<00:04,  1.42it/s, loss=0.3017, recon=0.289, kce=6.589, kd=6.114, cos=0.711]Epoch 1/1:  94%|█████████▍| 118/125 [01:28<00:04,  1.42it/s, loss=0.3020, recon=0.288, kce=6.775, kd=6.979, cos=0.711]Epoch 1/1:  95%|█████████▌| 119/125 [01:28<00:04,  1.48it/s, loss=0.3020, recon=0.288, kce=6.775, kd=6.979, cos=0.711]Epoch 1/1:  95%|█████████▌| 119/125 [01:28<00:04,  1.48it/s, loss=0.3047, recon=0.294, kce=4.502, kd=5.893, cos=0.707]Epoch 1/1:  96%|█████████▌| 120/125 [01:28<00:03,  1.47it/s, loss=0.3047, recon=0.294, kce=4.502, kd=5.893, cos=0.707]Epoch 1/1:  96%|█████████▌| 120/125 [01:29<00:03,  1.47it/s, loss=0.3073, recon=0.294, kce=6.765, kd=6.093, cos=0.707]Epoch 1/1:  97%|█████████▋| 121/125 [01:29<00:02,  1.48it/s, loss=0.3073, recon=0.294, kce=6.765, kd=6.093, cos=0.707]Epoch 1/1:  97%|█████████▋| 121/125 [01:30<00:02,  1.48it/s, loss=0.3029, recon=0.290, kce=5.974, kd=6.750, cos=0.711]Epoch 1/1:  98%|█████████▊| 122/125 [01:30<00:02,  1.34it/s, loss=0.3029, recon=0.290, kce=5.974, kd=6.750, cos=0.711]Epoch 1/1:  98%|█████████▊| 122/125 [01:30<00:02,  1.34it/s, loss=0.3302, recon=0.314, kce=8.315, kd=7.534, cos=0.688]Epoch 1/1:  98%|█████████▊| 123/125 [01:30<00:01,  1.47it/s, loss=0.3302, recon=0.314, kce=8.315, kd=7.534, cos=0.688]Epoch 1/1:  98%|█████████▊| 123/125 [01:31<00:01,  1.47it/s, loss=0.3058, recon=0.295, kce=4.801, kd=5.789, cos=0.707]Epoch 1/1:  99%|█████████▉| 124/125 [01:31<00:00,  1.47it/s, loss=0.3058, recon=0.295, kce=4.801, kd=5.789, cos=0.707]Epoch 1/1:  99%|█████████▉| 124/125 [01:32<00:00,  1.47it/s, loss=0.3215, recon=0.309, kce=6.184, kd=6.071, cos=0.691]Epoch 1/1: 100%|██████████| 125/125 [01:32<00:00,  1.47it/s, loss=0.3215, recon=0.309, kce=6.184, kd=6.071, cos=0.691]Epoch 1/1: 100%|██████████| 125/125 [01:32<00:00,  1.35it/s, loss=0.3215, recon=0.309, kce=6.184, kd=6.071, cos=0.691]
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.

  Quick eval (first example):
    Expected: 'Dane'
    Generated: '_="Middle of the="'
    Norm ratio: 1.000 | Cosine: 0.609
  Avg norm ratio: 1.000 | Avg cosine: 0.607
  FirstTok@1: 0.0% | Top-5: 0.0%

  Step 100: Quick F1 = 0.0%, FirstTok@1 = 0.0%
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.
[WARN] Failed to disable KD teacher adapters: No adapter loaded. Please load an adapter first.

Epoch 1 complete:
  Avg loss: 0.4196
  Avg cosine similarity: 0.595
  Avg relative error: 1.000

Running full evaluation...

================================================================================
EVALUATION DIAGNOSTICS (Batched with size 32)
================================================================================
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:  25%|██▌       | 1/4 [00:00<00:02,  1.33it/s]Evaluating:  50%|█████     | 2/4 [00:01<00:01,  1.05it/s]Evaluating:  75%|███████▌  | 3/4 [00:02<00:00,  1.16it/s]Evaluating: 100%|██████████| 4/4 [00:03<00:00,  1.17it/s]Evaluating: 100%|██████████| 4/4 [00:03<00:00,  1.16it/s]

────────────────────────────────────────────────────────────────────────────────
Example 1:
  Question: Context: Tesla was the fourth of five children. He had an older brother named Da...
  Expected: 'Dane'
  Generated: '_="Middle of the="="'

  Embedding diagnostics:
    Original norm:  0.31
    Reconstructed norm: 0.31
    Ratio: 1.000 (OK)
    Cosine similarity: 0.613

  Token-level reconstruction (first example only):
    Original tokens:  <|eot_id|><|eot_id|><|eot_id|><|eot_id|><|eot_id|><|eot_id|><|eot_id|><|eot_id|><|eot_id|><|eot_id|><|eot_id|><|eot_id|><|eot_id|><|eot_id|><|eot_id|>...
    Reconstructed →:  дивидудивидудивидудивидудивидудивидудивидудивидудивидудивидудивидудивидудивидудивидудивидудивидудивидудивидудивидудивидудивидудивидудивидудивидудивиду...

────────────────────────────────────────────────────────────────────────────────
Example 2:
  Question: Context: Islamists have asked the question, "If Islam is a way of life, how can ...
  Expected: 'Muslims'
  Generated: 'the,,,, and,," the, and,," the,,,,, and'

  Embedding diagnostics:
    Original norm:  0.36
    Reconstructed norm: 0.36
    Ratio: 1.000 (OK)
    Cosine similarity: 0.613

────────────────────────────────────────────────────────────────────────────────
Example 3:
  Question: Context: The concept environmental determinism served as a moral justification f...
  Expected: 'orientalism and tropicality'
  Generated: 'ual the two of the two of the two of the two of the two of the'

  Embedding diagnostics:
    Original norm:  0.31
    Reconstructed norm: 0.31
    Ratio: 1.000 (OK)
    Cosine similarity: 0.617

================================================================================

Computing FirstTok metrics on 50 examples...
  F1: 0.020
  EM: 0.000
  FirstTok@1: 0.0%
  FirstTok@5: 4.0%
  → New best F1! Saved checkpoint

============================================================
Training complete!
Best F1: 0.020
============================================================

============================================================
PHASE 1B RESULTS
============================================================
Best F1: 2.0%
❌ BELOW PHASE 1A: Generation objectives may not be working
   Check: Loss function bugs? Anchor text alignment?
============================================================
Completed λ=0.001 at Sat Oct 11 21:12:50 PDT 2025
