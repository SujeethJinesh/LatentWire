{
  "samples": 200,
  "max_new_tokens": 12,
  "latent_len": 16,
  "device": "cuda",
  "dtype": "torch.bfloat16",
  "avg_prompt_tokens": {
    "llama": 245.065,
    "qwen": 230.69
  },
  "compression": {
    "llama": 15.3165625,
    "qwen": 14.418125
  },
  "payload_bytes": 16384,
  "wire": {
    "text_bytes_onecopy": {
      "llama_avg": 1259,
      "qwen_avg": 1106,
      "max_avg": 1259
    },
    "text_bytes_twocopies": {
      "sum_avg": 2365
    },
    "latent_bytes": {
      "fp32": 16384,
      "fp16": 8192
    },
    "wire_compression": {
      "vs_onecopy_fp16": 0.1536865234375,
      "vs_onecopy_fp32": 0.07684326171875
    }
  },
  "text": {
    "wall_clock_sec": 16.234424591064453,
    "llama": {
      "em": 0.58,
      "f1": 0.7994106570072514,
      "nll_token": 12.72173482274305
    },
    "qwen": {
      "em": 0.69,
      "f1": 0.85772697967667,
      "nll_token": 26.15362625052689
    }
  },
  "latent": {
    "wall_clock_sec": 13.365266799926758,
    "llama": {
      "em": 0.0,
      "f1": 0.0409140063153221,
      "nll_token": 8.588848368651202
    },
    "qwen": {
      "em": 0.0,
      "f1": 0.0,
      "nll_token": 8.26335947885715
    }
  },
  "token_budget": {
    "mode": "content_only",
    "k": 16,
    "llama": {
      "em": 0.0,
      "f1": 0.038205738705738714
    },
    "wall_clock_sec": 11.727833986282349,
    "qwen": {
      "em": 0.01,
      "f1": 0.04269888444888446
    }
  },
  "joint": {
    "em": 0.0,
    "f1": 0.0,
    "agreement": 0.005,
    "oracle": {
      "em": null,
      "f1": null
    }
  },
  "debug": {
    "llama": {
      "adapter_scale": 1.0251884460449219,
      "Z_std": 0.9986631870269775,
      "Z_mean_norm": 15.978583335876465,
      "prefix_std": 0.010572929866611958,
      "prefix_mean_norm": 0.6737159490585327,
      "embed_rms": 0.010572961531579494,
      "encoder_text_mode": "raw",
      "calibration_mode": "embed_rms",
      "prepend_bos": true
    },
    "qwen": {
      "adapter_scale": 1.0042412281036377,
      "Z_std": 0.9986631870269775,
      "Z_mean_norm": 15.978583335876465,
      "prefix_std": 0.013623539358377457,
      "prefix_mean_norm": 0.8143240213394165,
      "embed_rms": 0.013638040982186794,
      "encoder_text_mode": "raw",
      "calibration_mode": "embed_rms",
      "prepend_bos": true
    },
    "latent_anchor_mode": "chat",
    "latent_anchor_text": "<|start_header_id|>assistant<|end_header_id|>\n\n",
    "prefix_gain": 1.0,
    "calibration_mode": "embed_rms",
    "prepend_bos": true,
    "decode": {
      "min_new_tokens": 2,
      "eos_ban_steps": 6,
      "first_token_top_p": 0.9,
      "first_token_temperature": 0.7
    }
  },
  "oracle": {
    "em": 0.0,
    "f1": 0.0409140063153221
  },
  "dataset": "squad"
}