{
  "samples": 16,
  "max_new_tokens": 12,
  "latent_len": 16,
  "device": "cuda",
  "dtype": "torch.bfloat16",
  "avg_prompt_tokens": {
    "llama": 290.75,
    "qwen": 278.5625
  },
  "compression": {
    "llama": 18.171875,
    "qwen": 17.41015625
  },
  "payload_bytes": 16384,
  "wire": {
    "text_bytes_onecopy": {
      "llama_avg": 1476,
      "qwen_avg": 1323,
      "max_avg": 1476
    },
    "text_bytes_twocopies": {
      "sum_avg": 2799
    },
    "latent_bytes": {
      "fp32": 16384,
      "fp16": 8192
    },
    "wire_compression": {
      "vs_onecopy_fp16": 0.18017578125,
      "vs_onecopy_fp32": 0.090087890625
    }
  },
  "text": {
    "wall_clock_sec": 2.1489784717559814,
    "llama": {
      "em": 0.5625,
      "f1": 0.7356004901960784,
      "nll_token": 11.496574388513089
    },
    "qwen": {
      "em": 0.625,
      "f1": 0.761904761904762,
      "nll_token": 25.969573822021484
    }
  },
  "latent": {
    "wall_clock_sec": 1.329759120941162,
    "llama": {
      "em": 0.0,
      "f1": 0.0,
      "nll_token": 10.778967049162267
    },
    "qwen": {
      "em": 0.0,
      "f1": 0.0,
      "nll_token": 7.46905300617218
    }
  },
  "token_budget": {
    "mode": "content_only",
    "k": 16,
    "llama": {
      "em": 0.0,
      "f1": 0.0
    },
    "wall_clock_sec": 0.9257338047027588,
    "qwen": {
      "em": 0.0,
      "f1": 0.03125
    }
  },
  "joint": {
    "em": 0.0,
    "f1": 0.0,
    "agreement": 0.0,
    "oracle": {
      "em": null,
      "f1": null
    }
  },
  "debug": {
    "llama": {
      "adapter_scale": 1.0251884460449219,
      "Z_std": 0.9987947344779968,
      "Z_mean_norm": 15.98057746887207,
      "prefix_std": 0.013212851248681545,
      "prefix_mean_norm": 0.8421143293380737,
      "embed_rms": 0.010569977574050426,
      "encoder_text_mode": "neutral_chat",
      "calibration_mode": "embed_rms",
      "append_bos_after_prefix": "no",
      "latent_anchor_mode": "text",
      "latent_anchor_text": "Answer: ",
      "model_id": "meta-llama/Meta-Llama-3.1-8B-Instruct"
    },
    "qwen": {
      "adapter_scale": 1.0042412281036377,
      "Z_std": 0.9987480044364929,
      "Z_mean_norm": 15.979828834533691,
      "prefix_std": 0.017040520906448364,
      "prefix_mean_norm": 1.0185554027557373,
      "embed_rms": 0.013652293011546135,
      "encoder_text_mode": "qwen_chat",
      "calibration_mode": "embed_rms",
      "append_bos_after_prefix": "no",
      "latent_anchor_mode": "text",
      "latent_anchor_text": "Answer: ",
      "model_id": "Qwen/Qwen2.5-7B-Instruct"
    },
    "latent_anchor_mode": "text",
    "latent_anchor_text": "Answer: ",
    "prefix_gain": 1.25,
    "calibration_mode": "embed_rms",
    "append_bos_after_prefix": "no",
    "decode": {
      "min_new_tokens": 2,
      "eos_ban_steps": 6,
      "first_token_top_p": 0.9,
      "first_token_temperature": 0.7
    }
  },
  "oracle": {
    "em": 0.0,
    "f1": 0.0
  },
  "dataset": "squad"
}