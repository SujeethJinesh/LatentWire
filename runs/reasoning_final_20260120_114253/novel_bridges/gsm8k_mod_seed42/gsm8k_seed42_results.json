{
  "experiment": "gsm8k",
  "timestamp": "2026-01-20T11:58:55.545438",
  "config": {
    "dataset": "gsm8k",
    "source_model": "meta-llama/Meta-Llama-3.1-8B-Instruct",
    "target_model": "mistralai/Mistral-7B-Instruct-v0.3",
    "source_layer": 31,
    "soft_tokens": 8,
    "depth": 2,
    "heads": 8,
    "lr": 0.0002,
    "batch_size": 16,
    "grad_accum": 2,
    "steps": 1500,
    "warmup_steps": 100,
    "diversity_weight": 0.1,
    "output_dir": "runs/reasoning_final_20260120_114253/novel_bridges/gsm8k_mod_seed42",
    "save_path": "bridge_gsm8k.pt",
    "save_every": 500,
    "eval_every": 200,
    "bf16": true,
    "use_fsq": false,
    "seed": 42,
    "gpu": 1,
    "resume": null,
    "auto_resume": true,
    "bridge_type": "mixture_of_depths",
    "lambda_reg": 0.0001,
    "eval_only": false,
    "extract_layers": null,
    "learn_layer_weights": false,
    "inject_layers": null,
    "use_gumbel_gates": false,
    "temp_start": 2.0,
    "temp_end": 0.1,
    "use_vib": false,
    "vib_beta": 0.001,
    "vib_beta_anneal": false,
    "use_curriculum": false,
    "curriculum_stages": 5,
    "ot_epsilon": 0.1,
    "ot_iters": 20,
    "infonce_temp": 0.07,
    "infonce_weight": 0.1,
    "sparsity_k": 128,
    "num_refinement_steps": 2,
    "num_receptors": 32,
    "binding_sparsity": 0.1,
    "cca_dim": 256,
    "num_flow_steps": 4,
    "flow_loss_weight": 0.1,
    "moe_num_experts": 8,
    "moe_top_k": 2,
    "moe_use_shared_expert": true,
    "moe_aux_loss_weight": 0.01,
    "moe_aux_loss_free": false
  },
  "library_versions": {
    "torch": "2.5.1+cu121",
    "transformers": "4.46.2",
    "cuda": "12.1",
    "cudnn": 90100
  },
  "num_classes": null,
  "random_baseline": 0.0,
  "final_results": {
    "accuracy": 0.0,
    "correct": 0,
    "total": 200
  },
  "training_log": [
    {
      "step": 50,
      "type": "metrics",
      "lm_loss": 2.6373173666000365,
      "aux_loss": 0.0,
      "div_loss": 0.9622506791353226,
      "z_var": 8.882587503649119e-06,
      "grad_norm": 30.98875,
      "lr": 0.0001,
      "gpu_mem_allocated_gb": 46.27283954620361,
      "gpu_mem_reserved_gb": 51.74609375,
      "gpu_mem_peak_gb": 50.195481300354004
    },
    {
      "step": 100,
      "type": "metrics",
      "lm_loss": 2.3976878726482393,
      "aux_loss": 0.0,
      "div_loss": 0.9963106846809388,
      "z_var": 1.8107383093592945e-05,
      "grad_norm": 12.1490625,
      "lr": 0.0002,
      "gpu_mem_allocated_gb": 46.27283954620361,
      "gpu_mem_reserved_gb": 52.1171875,
      "gpu_mem_peak_gb": 50.39696979522705
    },
    {
      "step": 150,
      "type": "metrics",
      "lm_loss": 2.35710458278656,
      "aux_loss": 0.0,
      "div_loss": 0.9815887916088104,
      "z_var": 4.508689675276401e-05,
      "grad_norm": 3.7112890625,
      "lr": 0.00019937122098932428,
      "gpu_mem_allocated_gb": 46.27283954620361,
      "gpu_mem_reserved_gb": 52.1171875,
      "gpu_mem_peak_gb": 50.39696979522705
    },
    {
      "step": 200,
      "type": "metrics",
      "lm_loss": 2.2831545341014863,
      "aux_loss": 0.0,
      "div_loss": 0.9539072108268738,
      "z_var": 8.950988732976839e-05,
      "grad_norm": 2.3025390625,
      "lr": 0.00019749279121818235,
      "gpu_mem_allocated_gb": 46.27283954620361,
      "gpu_mem_reserved_gb": 52.1171875,
      "gpu_mem_peak_gb": 50.39696979522705
    },
    {
      "step": 200,
      "type": "eval",
      "accuracy": 0.0,
      "correct": 0,
      "total": 100
    },
    {
      "step": 250,
      "type": "metrics",
      "lm_loss": 2.244793198108673,
      "aux_loss": 0.0,
      "div_loss": 0.9790496027469635,
      "z_var": 0.00010458934273628984,
      "grad_norm": 2.200234375,
      "lr": 0.00019438833303083678,
      "gpu_mem_allocated_gb": 46.27283954620361,
      "gpu_mem_reserved_gb": 52.1171875,
      "gpu_mem_peak_gb": 50.39696979522705
    },
    {
      "step": 300,
      "type": "metrics",
      "lm_loss": 2.1436384046077728,
      "aux_loss": 0.0,
      "div_loss": 0.9673043590784073,
      "z_var": 0.00012238652365340386,
      "grad_norm": 1.7405078125,
      "lr": 0.0001900968867902419,
      "gpu_mem_allocated_gb": 46.27283954620361,
      "gpu_mem_reserved_gb": 52.1171875,
      "gpu_mem_peak_gb": 50.39696979522705
    },
    {
      "step": 350,
      "type": "metrics",
      "lm_loss": 2.1044414854049682,
      "aux_loss": 0.0,
      "div_loss": 0.9266966158151626,
      "z_var": 0.00015527307346928864,
      "grad_norm": 1.6378125,
      "lr": 0.00018467241992282843,
      "gpu_mem_allocated_gb": 46.27283954620361,
      "gpu_mem_reserved_gb": 52.1171875,
      "gpu_mem_peak_gb": 50.39696979522705
    },
    {
      "step": 400,
      "type": "metrics",
      "lm_loss": 2.08304767370224,
      "aux_loss": 0.0,
      "div_loss": 0.8908763003349304,
      "z_var": 0.00017937876109499484,
      "grad_norm": 1.3880078125,
      "lr": 0.000178183148246803,
      "gpu_mem_allocated_gb": 46.27283954620361,
      "gpu_mem_reserved_gb": 52.1171875,
      "gpu_mem_peak_gb": 50.39696979522705
    },
    {
      "step": 400,
      "type": "eval",
      "accuracy": 0.0,
      "correct": 0,
      "total": 100
    },
    {
      "step": 450,
      "type": "metrics",
      "lm_loss": 2.030075249671936,
      "aux_loss": 0.0,
      "div_loss": 0.8342522180080414,
      "z_var": 0.00020980883535230533,
      "grad_norm": 1.3737109375,
      "lr": 0.00017071067811865476,
      "gpu_mem_allocated_gb": 46.27283954620361,
      "gpu_mem_reserved_gb": 52.1171875,
      "gpu_mem_peak_gb": 50.39696979522705
    },
    {
      "step": 500,
      "type": "metrics",
      "lm_loss": 1.9483175992965698,
      "aux_loss": 0.0,
      "div_loss": 0.8116481918096542,
      "z_var": 0.000250735590379918,
      "grad_norm": 1.33,
      "lr": 0.00016234898018587337,
      "gpu_mem_allocated_gb": 46.27283954620361,
      "gpu_mem_reserved_gb": 52.1171875,
      "gpu_mem_peak_gb": 50.39696979522705
    },
    {
      "step": 550,
      "type": "metrics",
      "lm_loss": 1.914941064119339,
      "aux_loss": 0.0,
      "div_loss": 0.8237418270111084,
      "z_var": 0.0002852677446207963,
      "grad_norm": 1.3856640625,
      "lr": 0.00015320320765153367,
      "gpu_mem_allocated_gb": 46.27283954620361,
      "gpu_mem_reserved_gb": 52.1171875,
      "gpu_mem_peak_gb": 50.39696979522705
    },
    {
      "step": 600,
      "type": "metrics",
      "lm_loss": 1.9354994595050812,
      "aux_loss": 0.0,
      "div_loss": 0.7792421597242355,
      "z_var": 0.00030561849154764787,
      "grad_norm": 1.510546875,
      "lr": 0.00014338837391175582,
      "gpu_mem_allocated_gb": 46.27283954620361,
      "gpu_mem_reserved_gb": 52.1171875,
      "gpu_mem_peak_gb": 50.39696979522705
    },
    {
      "step": 600,
      "type": "eval",
      "accuracy": 0.0,
      "correct": 0,
      "total": 100
    },
    {
      "step": 650,
      "type": "metrics",
      "lm_loss": 1.9000391781330108,
      "aux_loss": 0.0,
      "div_loss": 0.7114581823348999,
      "z_var": 0.00033547820727108046,
      "grad_norm": 1.3359375,
      "lr": 0.00013302790619551674,
      "gpu_mem_allocated_gb": 46.27283954620361,
      "gpu_mem_reserved_gb": 52.1171875,
      "gpu_mem_peak_gb": 50.39696979522705
    },
    {
      "step": 700,
      "type": "metrics",
      "lm_loss": 1.841232067346573,
      "aux_loss": 0.0,
      "div_loss": 0.7574544423818588,
      "z_var": 0.00037802054604981096,
      "grad_norm": 1.366015625,
      "lr": 0.00012225209339563145,
      "gpu_mem_allocated_gb": 46.27283954620361,
      "gpu_mem_reserved_gb": 52.1171875,
      "gpu_mem_peak_gb": 50.39696979522705
    },
    {
      "step": 750,
      "type": "metrics",
      "lm_loss": 1.7548062002658844,
      "aux_loss": 0.0,
      "div_loss": 0.7469191366434097,
      "z_var": 0.0004056264480459504,
      "grad_norm": 1.39125,
      "lr": 0.00011119644761033078,
      "gpu_mem_allocated_gb": 46.27283954620361,
      "gpu_mem_reserved_gb": 52.1171875,
      "gpu_mem_peak_gb": 50.39696979522705
    },
    {
      "step": 800,
      "type": "metrics",
      "lm_loss": 1.7633629739284515,
      "aux_loss": 0.0,
      "div_loss": 0.7668073517084122,
      "z_var": 0.0004298796976218,
      "grad_norm": 2.0009375,
      "lr": 0.0001,
      "gpu_mem_allocated_gb": 46.27283954620361,
      "gpu_mem_reserved_gb": 52.1171875,
      "gpu_mem_peak_gb": 50.39696979522705
    },
    {
      "step": 800,
      "type": "eval",
      "accuracy": 0.0,
      "correct": 0,
      "total": 100
    },
    {
      "step": 850,
      "type": "metrics",
      "lm_loss": 1.743888328075409,
      "aux_loss": 0.0,
      "div_loss": 0.7254960602521896,
      "z_var": 0.0004320030426606536,
      "grad_norm": 1.389765625,
      "lr": 8.880355238966923e-05,
      "gpu_mem_allocated_gb": 46.27283954620361,
      "gpu_mem_reserved_gb": 52.1171875,
      "gpu_mem_peak_gb": 50.39696979522705
    },
    {
      "step": 900,
      "type": "metrics",
      "lm_loss": 1.7616422307491302,
      "aux_loss": 0.0,
      "div_loss": 0.7269592154026031,
      "z_var": 0.0004458273021737114,
      "grad_norm": 1.330703125,
      "lr": 7.774790660436858e-05,
      "gpu_mem_allocated_gb": 46.27283954620361,
      "gpu_mem_reserved_gb": 52.1171875,
      "gpu_mem_peak_gb": 50.39696979522705
    },
    {
      "step": 950,
      "type": "metrics",
      "lm_loss": 1.7055658423900604,
      "aux_loss": 0.0,
      "div_loss": 0.7219058245420455,
      "z_var": 0.0004457986357738264,
      "grad_norm": 1.26796875,
      "lr": 6.697209380448333e-05,
      "gpu_mem_allocated_gb": 46.27283954620361,
      "gpu_mem_reserved_gb": 52.1171875,
      "gpu_mem_peak_gb": 50.39696979522705
    },
    {
      "step": 1000,
      "type": "metrics",
      "lm_loss": 1.6354884791374207,
      "aux_loss": 0.0,
      "div_loss": 0.6890386807918548,
      "z_var": 0.0004458449038793333,
      "grad_norm": 1.96671875,
      "lr": 5.6611626088244194e-05,
      "gpu_mem_allocated_gb": 46.27283954620361,
      "gpu_mem_reserved_gb": 52.1171875,
      "gpu_mem_peak_gb": 50.39696979522705
    },
    {
      "step": 1000,
      "type": "eval",
      "accuracy": 0.0,
      "correct": 0,
      "total": 100
    },
    {
      "step": 1050,
      "type": "metrics",
      "lm_loss": 1.6522962951660156,
      "aux_loss": 0.0,
      "div_loss": 0.6531932854652405,
      "z_var": 0.00044584507471881804,
      "grad_norm": 1.8390625,
      "lr": 4.6796792348466356e-05,
      "gpu_mem_allocated_gb": 46.27283954620361,
      "gpu_mem_reserved_gb": 52.1171875,
      "gpu_mem_peak_gb": 50.39696979522705
    },
    {
      "step": 1100,
      "type": "metrics",
      "lm_loss": 1.625850603580475,
      "aux_loss": 0.0,
      "div_loss": 0.6229496014118194,
      "z_var": 0.0004458177444757894,
      "grad_norm": 1.637109375,
      "lr": 3.7651019814126654e-05,
      "gpu_mem_allocated_gb": 46.27283954620361,
      "gpu_mem_reserved_gb": 52.1171875,
      "gpu_mem_peak_gb": 50.39696979522705
    },
    {
      "step": 1150,
      "type": "metrics",
      "lm_loss": 1.6328311622142793,
      "aux_loss": 0.0,
      "div_loss": 0.5865577310323715,
      "z_var": 0.0004457914555678144,
      "grad_norm": 1.503984375,
      "lr": 2.9289321881345254e-05,
      "gpu_mem_allocated_gb": 46.27283954620361,
      "gpu_mem_reserved_gb": 52.1171875,
      "gpu_mem_peak_gb": 50.39696979522705
    },
    {
      "step": 1200,
      "type": "metrics",
      "lm_loss": 1.5790107226371766,
      "aux_loss": 0.0,
      "div_loss": 0.5920265245437623,
      "z_var": 0.00044580043002497407,
      "grad_norm": 1.702265625,
      "lr": 2.181685175319702e-05,
      "gpu_mem_allocated_gb": 46.27283954620361,
      "gpu_mem_reserved_gb": 52.1171875,
      "gpu_mem_peak_gb": 50.39696979522705
    },
    {
      "step": 1200,
      "type": "eval",
      "accuracy": 0.0,
      "correct": 0,
      "total": 100
    },
    {
      "step": 1250,
      "type": "metrics",
      "lm_loss": 1.5298107707500457,
      "aux_loss": 0.0,
      "div_loss": 0.583166561126709,
      "z_var": 0.0004458008662913926,
      "grad_norm": 1.581640625,
      "lr": 1.5327580077171587e-05,
      "gpu_mem_allocated_gb": 46.27283954620361,
      "gpu_mem_reserved_gb": 52.1171875,
      "gpu_mem_peak_gb": 50.39696979522705
    },
    {
      "step": 1300,
      "type": "metrics",
      "lm_loss": 1.5595836687088012,
      "aux_loss": 0.0,
      "div_loss": 0.5844353598356247,
      "z_var": 0.00044581224850844594,
      "grad_norm": 1.72921875,
      "lr": 9.903113209758096e-06,
      "gpu_mem_allocated_gb": 46.27283954620361,
      "gpu_mem_reserved_gb": 52.1171875,
      "gpu_mem_peak_gb": 50.39696979522705
    },
    {
      "step": 1350,
      "type": "metrics",
      "lm_loss": 1.5685231947898866,
      "aux_loss": 0.0,
      "div_loss": 0.5871365106105805,
      "z_var": 0.0004458146935212426,
      "grad_norm": 1.571171875,
      "lr": 5.611666969163243e-06,
      "gpu_mem_allocated_gb": 46.27283954620361,
      "gpu_mem_reserved_gb": 52.1171875,
      "gpu_mem_peak_gb": 50.39696979522705
    },
    {
      "step": 1400,
      "type": "metrics",
      "lm_loss": 1.5531589150428773,
      "aux_loss": 0.0,
      "div_loss": 0.5850924062728882,
      "z_var": 0.0004458132054423913,
      "grad_norm": 1.7053125,
      "lr": 2.5072087818176382e-06,
      "gpu_mem_allocated_gb": 46.27283954620361,
      "gpu_mem_reserved_gb": 52.1171875,
      "gpu_mem_peak_gb": 50.39696979522705
    },
    {
      "step": 1400,
      "type": "eval",
      "accuracy": 0.0,
      "correct": 0,
      "total": 100
    },
    {
      "step": 1450,
      "type": "metrics",
      "lm_loss": 1.550633260011673,
      "aux_loss": 0.0,
      "div_loss": 0.5845241272449493,
      "z_var": 0.0004458094690926373,
      "grad_norm": 1.45421875,
      "lr": 6.287790106757396e-07,
      "gpu_mem_allocated_gb": 46.27283954620361,
      "gpu_mem_reserved_gb": 52.1171875,
      "gpu_mem_peak_gb": 50.39696979522705
    },
    {
      "step": 1500,
      "type": "metrics",
      "lm_loss": 1.5311433351039887,
      "aux_loss": 0.0,
      "div_loss": 0.5851551085710526,
      "z_var": 0.0004458133946172893,
      "grad_norm": 1.614609375,
      "lr": 0.0,
      "gpu_mem_allocated_gb": 46.27283954620361,
      "gpu_mem_reserved_gb": 52.1171875,
      "gpu_mem_peak_gb": 50.39696979522705
    }
  ]
}