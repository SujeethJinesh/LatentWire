{
  "experiment": "arc_easy",
  "timestamp": "2026-01-19T21:19:51.534755",
  "config": {
    "dataset": "arc_easy",
    "source_model": "meta-llama/Meta-Llama-3.1-8B-Instruct",
    "target_model": "mistralai/Mistral-7B-Instruct-v0.3",
    "source_layer": 31,
    "soft_tokens": 8,
    "depth": 2,
    "heads": 8,
    "lr": 0.0002,
    "batch_size": 16,
    "grad_accum": 2,
    "steps": 1500,
    "warmup_steps": 100,
    "diversity_weight": 0.1,
    "output_dir": "runs/reasoning_final_20260119_205402/novel_bridges/moe_arc_easy_seed42",
    "save_path": "bridge_arc_easy.pt",
    "save_every": 500,
    "eval_every": 200,
    "bf16": true,
    "use_fsq": false,
    "seed": 42,
    "gpu": 1,
    "resume": null,
    "auto_resume": true,
    "bridge_type": "moe",
    "lambda_reg": 0.0001,
    "eval_only": false,
    "extract_layers": null,
    "learn_layer_weights": false,
    "inject_layers": null,
    "use_gumbel_gates": false,
    "temp_start": 2.0,
    "temp_end": 0.1,
    "use_vib": false,
    "vib_beta": 0.001,
    "vib_beta_anneal": false,
    "use_curriculum": false,
    "curriculum_stages": 5,
    "ot_epsilon": 0.1,
    "ot_iters": 20,
    "infonce_temp": 0.07,
    "infonce_weight": 0.1,
    "sparsity_k": 128,
    "num_refinement_steps": 2,
    "num_receptors": 32,
    "binding_sparsity": 0.1,
    "cca_dim": 256,
    "num_flow_steps": 4,
    "flow_loss_weight": 0.1,
    "moe_num_experts": 8,
    "moe_top_k": 2,
    "moe_use_shared_expert": true,
    "moe_aux_loss_weight": 0.01,
    "moe_aux_loss_free": false
  },
  "library_versions": {
    "torch": "2.5.1+cu121",
    "transformers": "4.46.2",
    "cuda": "12.1",
    "cudnn": 90100
  },
  "num_classes": 5,
  "random_baseline": 20.0,
  "final_results": {
    "accuracy": 49.0,
    "correct": 98,
    "total": 200
  },
  "training_log": [
    {
      "step": 50,
      "type": "metrics",
      "lm_loss": 1.7207994997501372,
      "aux_loss": 0.061558526176959276,
      "div_loss": 0.9953699165582657,
      "z_var": 8.678908320689516e-06,
      "grad_norm": 268.4575,
      "lr": 0.0001,
      "gpu_mem_allocated_gb": 53.52455806732178,
      "gpu_mem_reserved_gb": 59.41015625,
      "gpu_mem_peak_gb": 57.400413513183594
    },
    {
      "step": 100,
      "type": "metrics",
      "lm_loss": 3.325036811828613,
      "aux_loss": 0.0665885303914547,
      "div_loss": 0.9999545246362687,
      "z_var": 1.7383425365551375e-05,
      "grad_norm": 261.025703125,
      "lr": 0.0002,
      "gpu_mem_allocated_gb": 53.52455806732178,
      "gpu_mem_reserved_gb": 59.41015625,
      "gpu_mem_peak_gb": 57.400413513183594
    },
    {
      "step": 150,
      "type": "metrics",
      "lm_loss": 5.739640457630157,
      "aux_loss": 0.07546697244048119,
      "div_loss": 0.999980412721634,
      "z_var": 2.5679807495180286e-05,
      "grad_norm": 1060.611875,
      "lr": 0.00019937122098932428,
      "gpu_mem_allocated_gb": 53.27451992034912,
      "gpu_mem_reserved_gb": 59.41015625,
      "gpu_mem_peak_gb": 57.400413513183594
    },
    {
      "step": 200,
      "type": "metrics",
      "lm_loss": 2.241046315431595,
      "aux_loss": 0.07999999821186066,
      "div_loss": 0.9999956458806991,
      "z_var": 0.00012602236962266033,
      "grad_norm": 40.383125,
      "lr": 0.00019749279121818235,
      "gpu_mem_allocated_gb": 53.27451992034912,
      "gpu_mem_reserved_gb": 59.41015625,
      "gpu_mem_peak_gb": 57.400413513183594
    },
    {
      "step": 200,
      "type": "eval",
      "accuracy": 100.0,
      "correct": 100,
      "total": 100
    },
    {
      "step": 250,
      "type": "metrics",
      "lm_loss": 2.0702378010749816,
      "aux_loss": 0.07999999821186066,
      "div_loss": 0.9999955487251282,
      "z_var": 0.00038341520368703644,
      "grad_norm": 56.89578125,
      "lr": 0.00019438833303083678,
      "gpu_mem_allocated_gb": 53.27451992034912,
      "gpu_mem_reserved_gb": 59.41015625,
      "gpu_mem_peak_gb": 57.400413513183594
    },
    {
      "step": 300,
      "type": "metrics",
      "lm_loss": 2.8366624236106874,
      "aux_loss": 0.07999999821186066,
      "div_loss": 0.9999955862760543,
      "z_var": 0.000727946586557664,
      "grad_norm": 59.605625,
      "lr": 0.0001900968867902419,
      "gpu_mem_allocated_gb": 53.27451992034912,
      "gpu_mem_reserved_gb": 59.41015625,
      "gpu_mem_peak_gb": 57.400413513183594
    },
    {
      "step": 350,
      "type": "metrics",
      "lm_loss": 0.933500028848648,
      "aux_loss": 0.07999999821186066,
      "div_loss": 0.9999955755472183,
      "z_var": 0.001201113645802252,
      "grad_norm": 31.5841015625,
      "lr": 0.00018467241992282843,
      "gpu_mem_allocated_gb": 53.27451992034912,
      "gpu_mem_reserved_gb": 59.41015625,
      "gpu_mem_peak_gb": 57.400413513183594
    },
    {
      "step": 400,
      "type": "metrics",
      "lm_loss": 0.802717964053154,
      "aux_loss": 0.07999999821186066,
      "div_loss": 0.9999955248832703,
      "z_var": 0.0015975990309379995,
      "grad_norm": 14.32140625,
      "lr": 0.000178183148246803,
      "gpu_mem_allocated_gb": 53.27451992034912,
      "gpu_mem_reserved_gb": 59.41015625,
      "gpu_mem_peak_gb": 57.400413513183594
    },
    {
      "step": 400,
      "type": "eval",
      "accuracy": 23.0,
      "correct": 23,
      "total": 100
    },
    {
      "step": 450,
      "type": "metrics",
      "lm_loss": 0.8198038160800933,
      "aux_loss": 0.07999999821186066,
      "div_loss": 0.9999954712390899,
      "z_var": 0.0016436055838130416,
      "grad_norm": 26.84146484375,
      "lr": 0.00017071067811865476,
      "gpu_mem_allocated_gb": 53.27451992034912,
      "gpu_mem_reserved_gb": 59.41015625,
      "gpu_mem_peak_gb": 57.400413513183594
    },
    {
      "step": 500,
      "type": "metrics",
      "lm_loss": 0.7579198068380356,
      "aux_loss": 0.07999999821186066,
      "div_loss": 0.9999955022335052,
      "z_var": 0.0016738236520905047,
      "grad_norm": 7.45595703125,
      "lr": 0.00016234898018587337,
      "gpu_mem_allocated_gb": 53.27451992034912,
      "gpu_mem_reserved_gb": 59.41015625,
      "gpu_mem_peak_gb": 57.400413513183594
    },
    {
      "step": 550,
      "type": "metrics",
      "lm_loss": 0.7653350311517716,
      "aux_loss": 0.07999999821186066,
      "div_loss": 0.9999954676628113,
      "z_var": 0.0016822422936093062,
      "grad_norm": 17.1698828125,
      "lr": 0.00015320320765153367,
      "gpu_mem_allocated_gb": 53.27451992034912,
      "gpu_mem_reserved_gb": 59.41015625,
      "gpu_mem_peak_gb": 57.400413513183594
    },
    {
      "step": 600,
      "type": "metrics",
      "lm_loss": 0.8234698808193207,
      "aux_loss": 0.07999999821186066,
      "div_loss": 0.9999954307079315,
      "z_var": 0.0016822405625134707,
      "grad_norm": 29.84341796875,
      "lr": 0.00014338837391175582,
      "gpu_mem_allocated_gb": 53.27451992034912,
      "gpu_mem_reserved_gb": 59.41015625,
      "gpu_mem_peak_gb": 57.400413513183594
    },
    {
      "step": 600,
      "type": "eval",
      "accuracy": 30.0,
      "correct": 30,
      "total": 100
    },
    {
      "step": 650,
      "type": "metrics",
      "lm_loss": 0.7323178404569626,
      "aux_loss": 0.07999999821186066,
      "div_loss": 0.9999955058097839,
      "z_var": 0.0016822502727154643,
      "grad_norm": 6.52658203125,
      "lr": 0.00013302790619551674,
      "gpu_mem_allocated_gb": 53.27451992034912,
      "gpu_mem_reserved_gb": 59.41015625,
      "gpu_mem_peak_gb": 57.400413513183594
    },
    {
      "step": 700,
      "type": "metrics",
      "lm_loss": 0.7525707852840423,
      "aux_loss": 0.07999999821186066,
      "div_loss": 0.9999954307079315,
      "z_var": 0.0016822594264522194,
      "grad_norm": 3.87357421875,
      "lr": 0.00012225209339563145,
      "gpu_mem_allocated_gb": 53.27451992034912,
      "gpu_mem_reserved_gb": 59.41015625,
      "gpu_mem_peak_gb": 57.400413513183594
    },
    {
      "step": 750,
      "type": "metrics",
      "lm_loss": 0.7322874569892883,
      "aux_loss": 0.07999999821186066,
      "div_loss": 0.9999954652786255,
      "z_var": 0.001682258523069322,
      "grad_norm": 1.98060546875,
      "lr": 0.00011119644761033078,
      "gpu_mem_allocated_gb": 53.27451992034912,
      "gpu_mem_reserved_gb": 59.41015625,
      "gpu_mem_peak_gb": 57.400413513183594
    },
    {
      "step": 800,
      "type": "metrics",
      "lm_loss": 0.7273737603425979,
      "aux_loss": 0.07999999821186066,
      "div_loss": 0.9999954181909562,
      "z_var": 0.0016822624357882886,
      "grad_norm": 1.80712890625,
      "lr": 0.0001,
      "gpu_mem_allocated_gb": 53.27451992034912,
      "gpu_mem_reserved_gb": 59.41015625,
      "gpu_mem_peak_gb": 57.400413513183594
    },
    {
      "step": 800,
      "type": "eval",
      "accuracy": 29.0,
      "correct": 29,
      "total": 100
    },
    {
      "step": 850,
      "type": "metrics",
      "lm_loss": 0.7239828056097031,
      "aux_loss": 0.07999999821186066,
      "div_loss": 0.9999953812360763,
      "z_var": 0.0016822661412879824,
      "grad_norm": 2.02728515625,
      "lr": 8.880355238966923e-05,
      "gpu_mem_allocated_gb": 53.27451992034912,
      "gpu_mem_reserved_gb": 59.41015625,
      "gpu_mem_peak_gb": 57.400413513183594
    },
    {
      "step": 900,
      "type": "metrics",
      "lm_loss": 0.7221148639917374,
      "aux_loss": 0.07999999821186066,
      "div_loss": 0.9999953097105027,
      "z_var": 0.001682266853749752,
      "grad_norm": 1.506875,
      "lr": 7.774790660436858e-05,
      "gpu_mem_allocated_gb": 53.27451992034912,
      "gpu_mem_reserved_gb": 59.41015625,
      "gpu_mem_peak_gb": 57.400413513183594
    },
    {
      "step": 950,
      "type": "metrics",
      "lm_loss": 0.7205205380916595,
      "aux_loss": 0.07999999821186066,
      "div_loss": 0.9999952387809753,
      "z_var": 0.0016822713101282715,
      "grad_norm": 1.615859375,
      "lr": 6.697209380448333e-05,
      "gpu_mem_allocated_gb": 53.27451992034912,
      "gpu_mem_reserved_gb": 59.41015625,
      "gpu_mem_peak_gb": 57.400413513183594
    },
    {
      "step": 1000,
      "type": "metrics",
      "lm_loss": 0.7220130997896195,
      "aux_loss": 0.07999999821186066,
      "div_loss": 0.9999951213598252,
      "z_var": 0.0016822717105969788,
      "grad_norm": 1.44427734375,
      "lr": 5.6611626088244194e-05,
      "gpu_mem_allocated_gb": 53.27451992034912,
      "gpu_mem_reserved_gb": 59.41015625,
      "gpu_mem_peak_gb": 57.400413513183594
    },
    {
      "step": 1000,
      "type": "eval",
      "accuracy": 23.0,
      "correct": 23,
      "total": 100
    },
    {
      "step": 1050,
      "type": "metrics",
      "lm_loss": 0.721467581987381,
      "aux_loss": 0.07999999821186066,
      "div_loss": 0.9999940890073776,
      "z_var": 0.0016822733636945486,
      "grad_norm": 1.675,
      "lr": 4.6796792348466356e-05,
      "gpu_mem_allocated_gb": 53.27451992034912,
      "gpu_mem_reserved_gb": 59.4140625,
      "gpu_mem_peak_gb": 57.400413513183594
    },
    {
      "step": 1100,
      "type": "metrics",
      "lm_loss": 0.7183641928434372,
      "aux_loss": 0.07995204724371434,
      "div_loss": 0.9998835498094558,
      "z_var": 0.001682274527847767,
      "grad_norm": 3.6544140625,
      "lr": 3.7651019814126654e-05,
      "gpu_mem_allocated_gb": 53.27451992034912,
      "gpu_mem_reserved_gb": 59.4140625,
      "gpu_mem_peak_gb": 57.400413513183594
    },
    {
      "step": 1150,
      "type": "metrics",
      "lm_loss": 0.7316366702318191,
      "aux_loss": 0.07999999821186066,
      "div_loss": 0.9999764239788056,
      "z_var": 0.0016822775173932314,
      "grad_norm": 10.39390625,
      "lr": 2.9289321881345254e-05,
      "gpu_mem_allocated_gb": 53.27451992034912,
      "gpu_mem_reserved_gb": 59.4140625,
      "gpu_mem_peak_gb": 57.400413513183594
    },
    {
      "step": 1200,
      "type": "metrics",
      "lm_loss": 0.6724592533707618,
      "aux_loss": 0.07999999821186066,
      "div_loss": 0.9993499827384948,
      "z_var": 0.0016822791902814061,
      "grad_norm": 4.6971484375,
      "lr": 2.181685175319702e-05,
      "gpu_mem_allocated_gb": 53.27451992034912,
      "gpu_mem_reserved_gb": 59.4140625,
      "gpu_mem_peak_gb": 57.400413513183594
    },
    {
      "step": 1200,
      "type": "eval",
      "accuracy": 27.0,
      "correct": 27,
      "total": 100
    },
    {
      "step": 1250,
      "type": "metrics",
      "lm_loss": 0.6205024129152298,
      "aux_loss": 0.07999999821186066,
      "div_loss": 0.9987055158615112,
      "z_var": 0.001682280401000753,
      "grad_norm": 3.12880859375,
      "lr": 1.5327580077171587e-05,
      "gpu_mem_allocated_gb": 54.02463436126709,
      "gpu_mem_reserved_gb": 59.4140625,
      "gpu_mem_peak_gb": 57.400413513183594
    },
    {
      "step": 1300,
      "type": "metrics",
      "lm_loss": 0.5740450650453568,
      "aux_loss": 0.07999999821186066,
      "div_loss": 0.9979962295293808,
      "z_var": 0.0016822812752798199,
      "grad_norm": 2.863671875,
      "lr": 9.903113209758096e-06,
      "gpu_mem_allocated_gb": 54.02463436126709,
      "gpu_mem_reserved_gb": 59.4140625,
      "gpu_mem_peak_gb": 57.400413513183594
    },
    {
      "step": 1350,
      "type": "metrics",
      "lm_loss": 0.5622003880143166,
      "aux_loss": 0.07999999821186066,
      "div_loss": 0.9975980043411254,
      "z_var": 0.0016822816396597773,
      "grad_norm": 2.2745703125,
      "lr": 5.611666969163243e-06,
      "gpu_mem_allocated_gb": 54.02463436126709,
      "gpu_mem_reserved_gb": 59.4140625,
      "gpu_mem_peak_gb": 57.400413513183594
    },
    {
      "step": 1400,
      "type": "metrics",
      "lm_loss": 0.555721538066864,
      "aux_loss": 0.07999999821186066,
      "div_loss": 0.9974235874414444,
      "z_var": 0.0016822816978674382,
      "grad_norm": 2.1983984375,
      "lr": 2.5072087818176382e-06,
      "gpu_mem_allocated_gb": 54.02463436126709,
      "gpu_mem_reserved_gb": 59.4140625,
      "gpu_mem_peak_gb": 57.400413513183594
    },
    {
      "step": 1400,
      "type": "eval",
      "accuracy": 50.0,
      "correct": 50,
      "total": 100
    },
    {
      "step": 1450,
      "type": "metrics",
      "lm_loss": 0.5645631283521653,
      "aux_loss": 0.07999999821186066,
      "div_loss": 0.997508864402771,
      "z_var": 0.0016822817118372767,
      "grad_norm": 2.50419921875,
      "lr": 6.287790106757396e-07,
      "gpu_mem_allocated_gb": 54.02463436126709,
      "gpu_mem_reserved_gb": 59.4140625,
      "gpu_mem_peak_gb": 57.400413513183594
    },
    {
      "step": 1500,
      "type": "metrics",
      "lm_loss": 0.5455265763401985,
      "aux_loss": 0.07999999821186066,
      "div_loss": 0.9973577344417572,
      "z_var": 0.0016822817199863493,
      "grad_norm": 2.302890625,
      "lr": 0.0,
      "gpu_mem_allocated_gb": 54.02463436126709,
      "gpu_mem_reserved_gb": 59.4140625,
      "gpu_mem_peak_gb": 57.400413513183594
    }
  ]
}