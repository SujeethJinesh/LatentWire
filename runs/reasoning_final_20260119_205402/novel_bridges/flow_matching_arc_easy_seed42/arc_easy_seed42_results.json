{
  "experiment": "arc_easy",
  "timestamp": "2026-01-19T21:05:17.290073",
  "config": {
    "dataset": "arc_easy",
    "source_model": "meta-llama/Meta-Llama-3.1-8B-Instruct",
    "target_model": "mistralai/Mistral-7B-Instruct-v0.3",
    "source_layer": 31,
    "soft_tokens": 8,
    "depth": 2,
    "heads": 8,
    "lr": 0.0002,
    "batch_size": 16,
    "grad_accum": 2,
    "steps": 1500,
    "warmup_steps": 100,
    "diversity_weight": 0.1,
    "output_dir": "runs/reasoning_final_20260119_205402/novel_bridges/flow_matching_arc_easy_seed42",
    "save_path": "bridge_arc_easy.pt",
    "save_every": 500,
    "eval_every": 200,
    "bf16": true,
    "use_fsq": false,
    "seed": 42,
    "gpu": 1,
    "resume": null,
    "auto_resume": true,
    "bridge_type": "flow_matching",
    "lambda_reg": 0.0001,
    "eval_only": false,
    "extract_layers": null,
    "learn_layer_weights": false,
    "inject_layers": null,
    "use_gumbel_gates": false,
    "temp_start": 2.0,
    "temp_end": 0.1,
    "use_vib": false,
    "vib_beta": 0.001,
    "vib_beta_anneal": false,
    "use_curriculum": false,
    "curriculum_stages": 5,
    "ot_epsilon": 0.1,
    "ot_iters": 20,
    "infonce_temp": 0.07,
    "infonce_weight": 0.1,
    "sparsity_k": 128,
    "num_refinement_steps": 2,
    "num_receptors": 32,
    "binding_sparsity": 0.1,
    "cca_dim": 256,
    "num_flow_steps": 4,
    "flow_loss_weight": 0.1,
    "moe_num_experts": 8,
    "moe_top_k": 2,
    "moe_use_shared_expert": true,
    "moe_aux_loss_weight": 0.01,
    "moe_aux_loss_free": false
  },
  "library_versions": {
    "torch": "2.5.1+cu121",
    "transformers": "4.46.2",
    "cuda": "12.1",
    "cudnn": 90100
  },
  "num_classes": 5,
  "random_baseline": 20.0,
  "final_results": {
    "accuracy": 68.0,
    "correct": 136,
    "total": 200
  },
  "training_log": [
    {
      "step": 50,
      "type": "metrics",
      "lm_loss": 2.7132937651872635,
      "aux_loss": 0.207978515625,
      "div_loss": 0.876779345870018,
      "z_var": 7.3316693305969236e-06,
      "grad_norm": 163.219375,
      "lr": 0.0001,
      "gpu_mem_allocated_gb": 44.27199935913086,
      "gpu_mem_reserved_gb": 47.482421875,
      "gpu_mem_peak_gb": 46.74005746841431
    },
    {
      "step": 100,
      "type": "metrics",
      "lm_loss": 1.1342054146528244,
      "aux_loss": 0.326767578125,
      "div_loss": 0.9483478301763535,
      "z_var": 9.410977363586425e-06,
      "grad_norm": 230.4390625,
      "lr": 0.0002,
      "gpu_mem_allocated_gb": 44.27199935913086,
      "gpu_mem_reserved_gb": 47.482421875,
      "gpu_mem_peak_gb": 46.74005746841431
    },
    {
      "step": 150,
      "type": "metrics",
      "lm_loss": 1.6425460720062255,
      "aux_loss": 0.5259375,
      "div_loss": 0.964932958483696,
      "z_var": 3.318667411804199e-05,
      "grad_norm": 88.3696875,
      "lr": 0.00019937122098932428,
      "gpu_mem_allocated_gb": 44.27199935913086,
      "gpu_mem_reserved_gb": 47.482421875,
      "gpu_mem_peak_gb": 46.74005746841431
    },
    {
      "step": 200,
      "type": "metrics",
      "lm_loss": 0.9765248453617096,
      "aux_loss": 0.59953125,
      "div_loss": 0.9642339318990707,
      "z_var": 0.00011195659637451171,
      "grad_norm": 56.4750390625,
      "lr": 0.00019749279121818235,
      "gpu_mem_allocated_gb": 44.27199935913086,
      "gpu_mem_reserved_gb": 47.482421875,
      "gpu_mem_peak_gb": 46.74005746841431
    },
    {
      "step": 200,
      "type": "eval",
      "accuracy": 29.0,
      "correct": 29,
      "total": 100
    },
    {
      "step": 250,
      "type": "metrics",
      "lm_loss": 0.8589159768819808,
      "aux_loss": 0.4408203125,
      "div_loss": 0.932708997130394,
      "z_var": 0.00020524024963378907,
      "grad_norm": 19.9370703125,
      "lr": 0.00019438833303083678,
      "gpu_mem_allocated_gb": 44.27199935913086,
      "gpu_mem_reserved_gb": 47.515625,
      "gpu_mem_peak_gb": 46.74005746841431
    },
    {
      "step": 300,
      "type": "metrics",
      "lm_loss": 0.8840792399644851,
      "aux_loss": 0.4007421875,
      "div_loss": 0.9042461109161377,
      "z_var": 0.00029111862182617187,
      "grad_norm": 16.7070703125,
      "lr": 0.0001900968867902419,
      "gpu_mem_allocated_gb": 44.27199935913086,
      "gpu_mem_reserved_gb": 47.515625,
      "gpu_mem_peak_gb": 46.78009748458862
    },
    {
      "step": 350,
      "type": "metrics",
      "lm_loss": 0.8844274473190308,
      "aux_loss": 0.43095703125,
      "div_loss": 0.8478073066473008,
      "z_var": 0.00039821624755859375,
      "grad_norm": 18.3804296875,
      "lr": 0.00018467241992282843,
      "gpu_mem_allocated_gb": 44.27199935913086,
      "gpu_mem_reserved_gb": 47.515625,
      "gpu_mem_peak_gb": 46.78009748458862
    },
    {
      "step": 400,
      "type": "metrics",
      "lm_loss": 0.8575526094436645,
      "aux_loss": 0.3445703125,
      "div_loss": 0.8549934619665146,
      "z_var": 0.0005055999755859375,
      "grad_norm": 9.6634375,
      "lr": 0.000178183148246803,
      "gpu_mem_allocated_gb": 44.27199935913086,
      "gpu_mem_reserved_gb": 47.515625,
      "gpu_mem_peak_gb": 46.78009748458862
    },
    {
      "step": 400,
      "type": "eval",
      "accuracy": 29.0,
      "correct": 29,
      "total": 100
    },
    {
      "step": 450,
      "type": "metrics",
      "lm_loss": 0.6155989614129066,
      "aux_loss": 0.41333984375,
      "div_loss": 0.8381110209226609,
      "z_var": 0.0006077957153320313,
      "grad_norm": 6.581015625,
      "lr": 0.00017071067811865476,
      "gpu_mem_allocated_gb": 44.27199935913086,
      "gpu_mem_reserved_gb": 47.515625,
      "gpu_mem_peak_gb": 46.78009748458862
    },
    {
      "step": 500,
      "type": "metrics",
      "lm_loss": 0.6487888124585152,
      "aux_loss": 0.55166015625,
      "div_loss": 0.8274257683753967,
      "z_var": 0.000703887939453125,
      "grad_norm": 6.5924609375,
      "lr": 0.00016234898018587337,
      "gpu_mem_allocated_gb": 44.27199935913086,
      "gpu_mem_reserved_gb": 47.515625,
      "gpu_mem_peak_gb": 46.78009748458862
    },
    {
      "step": 550,
      "type": "metrics",
      "lm_loss": 0.5476884505152703,
      "aux_loss": 0.3351953125,
      "div_loss": 0.8183993554115295,
      "z_var": 0.00076385498046875,
      "grad_norm": 4.30140625,
      "lr": 0.00015320320765153367,
      "gpu_mem_allocated_gb": 44.27199935913086,
      "gpu_mem_reserved_gb": 47.515625,
      "gpu_mem_peak_gb": 46.78009748458862
    },
    {
      "step": 600,
      "type": "metrics",
      "lm_loss": 1.0407245150208473,
      "aux_loss": 0.3301171875,
      "div_loss": 0.7836506307125092,
      "z_var": 0.0008791351318359375,
      "grad_norm": 34.9621875,
      "lr": 0.00014338837391175582,
      "gpu_mem_allocated_gb": 44.27199935913086,
      "gpu_mem_reserved_gb": 47.515625,
      "gpu_mem_peak_gb": 46.78009748458862
    },
    {
      "step": 600,
      "type": "eval",
      "accuracy": 30.0,
      "correct": 30,
      "total": 100
    },
    {
      "step": 650,
      "type": "metrics",
      "lm_loss": 0.6236806309223175,
      "aux_loss": 0.2991796875,
      "div_loss": 0.7617569702863694,
      "z_var": 0.0009841156005859376,
      "grad_norm": 59.188203125,
      "lr": 0.00013302790619551674,
      "gpu_mem_allocated_gb": 44.27199935913086,
      "gpu_mem_reserved_gb": 47.515625,
      "gpu_mem_peak_gb": 46.78009748458862
    },
    {
      "step": 700,
      "type": "metrics",
      "lm_loss": 0.449358441978693,
      "aux_loss": 0.28384765625,
      "div_loss": 0.7034898173809051,
      "z_var": 0.001007080078125,
      "grad_norm": 4.31390625,
      "lr": 0.00012225209339563145,
      "gpu_mem_allocated_gb": 44.27199935913086,
      "gpu_mem_reserved_gb": 47.515625,
      "gpu_mem_peak_gb": 46.78009748458862
    },
    {
      "step": 750,
      "type": "metrics",
      "lm_loss": 0.328377777338028,
      "aux_loss": 0.28130859375,
      "div_loss": 0.7765698099136352,
      "z_var": 0.001007080078125,
      "grad_norm": 6.69078125,
      "lr": 0.00011119644761033078,
      "gpu_mem_allocated_gb": 44.27199935913086,
      "gpu_mem_reserved_gb": 47.515625,
      "gpu_mem_peak_gb": 46.78009748458862
    },
    {
      "step": 800,
      "type": "metrics",
      "lm_loss": 0.29369631834328175,
      "aux_loss": 0.253369140625,
      "div_loss": 0.6980625486373901,
      "z_var": 0.001007080078125,
      "grad_norm": 4.41296875,
      "lr": 0.0001,
      "gpu_mem_allocated_gb": 44.27199935913086,
      "gpu_mem_reserved_gb": 47.515625,
      "gpu_mem_peak_gb": 46.78009748458862
    },
    {
      "step": 800,
      "type": "eval",
      "accuracy": 60.0,
      "correct": 60,
      "total": 100
    },
    {
      "step": 850,
      "type": "metrics",
      "lm_loss": 0.3194280441850424,
      "aux_loss": 0.249951171875,
      "div_loss": 0.7116724979877472,
      "z_var": 0.001007080078125,
      "grad_norm": 5.688125,
      "lr": 8.880355238966923e-05,
      "gpu_mem_allocated_gb": 44.27199935913086,
      "gpu_mem_reserved_gb": 47.515625,
      "gpu_mem_peak_gb": 46.78009748458862
    },
    {
      "step": 900,
      "type": "metrics",
      "lm_loss": 0.21983785800635813,
      "aux_loss": 0.2309765625,
      "div_loss": 0.644943224787712,
      "z_var": 0.001007080078125,
      "grad_norm": 4.15234375,
      "lr": 7.774790660436858e-05,
      "gpu_mem_allocated_gb": 44.27199935913086,
      "gpu_mem_reserved_gb": 47.515625,
      "gpu_mem_peak_gb": 46.78009748458862
    },
    {
      "step": 950,
      "type": "metrics",
      "lm_loss": 0.1873945591505617,
      "aux_loss": 0.224638671875,
      "div_loss": 0.6200117319822311,
      "z_var": 0.001007080078125,
      "grad_norm": 8.75484375,
      "lr": 6.697209380448333e-05,
      "gpu_mem_allocated_gb": 44.27199935913086,
      "gpu_mem_reserved_gb": 47.515625,
      "gpu_mem_peak_gb": 46.78009748458862
    },
    {
      "step": 1000,
      "type": "metrics",
      "lm_loss": 0.1460703826136887,
      "aux_loss": 0.223232421875,
      "div_loss": 0.6170478403568268,
      "z_var": 0.001007080078125,
      "grad_norm": 4.89359375,
      "lr": 5.6611626088244194e-05,
      "gpu_mem_allocated_gb": 44.27199935913086,
      "gpu_mem_reserved_gb": 47.515625,
      "gpu_mem_peak_gb": 46.78009748458862
    },
    {
      "step": 1000,
      "type": "eval",
      "accuracy": 64.0,
      "correct": 64,
      "total": 100
    },
    {
      "step": 1050,
      "type": "metrics",
      "lm_loss": 0.08197853541234508,
      "aux_loss": 0.213056640625,
      "div_loss": 0.5698406487703324,
      "z_var": 0.001007080078125,
      "grad_norm": 3.550859375,
      "lr": 4.6796792348466356e-05,
      "gpu_mem_allocated_gb": 44.27199935913086,
      "gpu_mem_reserved_gb": 47.515625,
      "gpu_mem_peak_gb": 46.78009748458862
    },
    {
      "step": 1100,
      "type": "metrics",
      "lm_loss": 0.06687572123133577,
      "aux_loss": 0.20763671875,
      "div_loss": 0.5282009533047676,
      "z_var": 0.001007080078125,
      "grad_norm": 6.32046875,
      "lr": 3.7651019814126654e-05,
      "gpu_mem_allocated_gb": 44.27199935913086,
      "gpu_mem_reserved_gb": 47.515625,
      "gpu_mem_peak_gb": 46.78009748458862
    },
    {
      "step": 1150,
      "type": "metrics",
      "lm_loss": 0.032798860245384275,
      "aux_loss": 0.204228515625,
      "div_loss": 0.5129278317093849,
      "z_var": 0.001007080078125,
      "grad_norm": 2.78271484375,
      "lr": 2.9289321881345254e-05,
      "gpu_mem_allocated_gb": 44.27199935913086,
      "gpu_mem_reserved_gb": 47.515625,
      "gpu_mem_peak_gb": 46.78009748458862
    },
    {
      "step": 1200,
      "type": "metrics",
      "lm_loss": 0.022266959985136055,
      "aux_loss": 0.199091796875,
      "div_loss": 0.4525318667292595,
      "z_var": 0.001007080078125,
      "grad_norm": 3.2115625,
      "lr": 2.181685175319702e-05,
      "gpu_mem_allocated_gb": 44.27199935913086,
      "gpu_mem_reserved_gb": 47.515625,
      "gpu_mem_peak_gb": 46.78009748458862
    },
    {
      "step": 1200,
      "type": "eval",
      "accuracy": 65.0,
      "correct": 65,
      "total": 100
    },
    {
      "step": 1250,
      "type": "metrics",
      "lm_loss": 0.008842645589320455,
      "aux_loss": 0.196455078125,
      "div_loss": 0.42295320868492126,
      "z_var": 0.001007080078125,
      "grad_norm": 2.707763671875,
      "lr": 1.5327580077171587e-05,
      "gpu_mem_allocated_gb": 44.27199935913086,
      "gpu_mem_reserved_gb": 47.515625,
      "gpu_mem_peak_gb": 46.78009748458862
    },
    {
      "step": 1300,
      "type": "metrics",
      "lm_loss": 0.006372703246743185,
      "aux_loss": 0.1947265625,
      "div_loss": 0.40873523861169814,
      "z_var": 0.001007080078125,
      "grad_norm": 1.046767578125,
      "lr": 9.903113209758096e-06,
      "gpu_mem_allocated_gb": 44.27199935913086,
      "gpu_mem_reserved_gb": 47.515625,
      "gpu_mem_peak_gb": 46.78009748458862
    },
    {
      "step": 1350,
      "type": "metrics",
      "lm_loss": 0.003158666887466097,
      "aux_loss": 0.194384765625,
      "div_loss": 0.4004016226530075,
      "z_var": 0.001007080078125,
      "grad_norm": 0.518857421875,
      "lr": 5.611666969163243e-06,
      "gpu_mem_allocated_gb": 44.27199935913086,
      "gpu_mem_reserved_gb": 47.515625,
      "gpu_mem_peak_gb": 46.78009748458862
    },
    {
      "step": 1400,
      "type": "metrics",
      "lm_loss": 0.003726270179977291,
      "aux_loss": 0.19373046875,
      "div_loss": 0.39940343260765077,
      "z_var": 0.001007080078125,
      "grad_norm": 0.689404296875,
      "lr": 2.5072087818176382e-06,
      "gpu_mem_allocated_gb": 44.27199935913086,
      "gpu_mem_reserved_gb": 47.515625,
      "gpu_mem_peak_gb": 46.78009748458862
    },
    {
      "step": 1400,
      "type": "eval",
      "accuracy": 67.0,
      "correct": 67,
      "total": 100
    },
    {
      "step": 1450,
      "type": "metrics",
      "lm_loss": 0.0031367005986976436,
      "aux_loss": 0.193310546875,
      "div_loss": 0.3967482128739357,
      "z_var": 0.001007080078125,
      "grad_norm": 0.43498046875,
      "lr": 6.287790106757396e-07,
      "gpu_mem_allocated_gb": 44.27199935913086,
      "gpu_mem_reserved_gb": 47.515625,
      "gpu_mem_peak_gb": 46.78009748458862
    },
    {
      "step": 1500,
      "type": "metrics",
      "lm_loss": 0.003245009776801453,
      "aux_loss": 0.193125,
      "div_loss": 0.3976739302277565,
      "z_var": 0.001007080078125,
      "grad_norm": 0.61787109375,
      "lr": 0.0,
      "gpu_mem_allocated_gb": 44.27199935913086,
      "gpu_mem_reserved_gb": 47.515625,
      "gpu_mem_peak_gb": 46.78009748458862
    }
  ]
}