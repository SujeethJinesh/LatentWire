{
  "experiment": "arc_easy",
  "timestamp": "2026-01-19T18:56:40.570230",
  "config": {
    "dataset": "arc_easy",
    "source_model": "meta-llama/Meta-Llama-3.1-8B-Instruct",
    "target_model": "mistralai/Mistral-7B-Instruct-v0.3",
    "source_layer": 31,
    "soft_tokens": 8,
    "depth": 2,
    "heads": 8,
    "lr": 0.0002,
    "batch_size": 16,
    "grad_accum": 2,
    "steps": 1500,
    "warmup_steps": 100,
    "diversity_weight": 0.1,
    "output_dir": "runs/reasoning_final_20260119_183620/novel_bridges/hailmary_successive_refinement_arc_easy_seed42",
    "save_path": "bridge_arc_easy.pt",
    "save_every": 500,
    "eval_every": 200,
    "bf16": true,
    "use_fsq": false,
    "seed": 42,
    "gpu": 1,
    "resume": null,
    "auto_resume": true,
    "bridge_type": "successive_refinement",
    "lambda_reg": 0.0001,
    "eval_only": false,
    "extract_layers": null,
    "learn_layer_weights": false,
    "inject_layers": null,
    "use_gumbel_gates": false,
    "temp_start": 2.0,
    "temp_end": 0.1,
    "use_vib": false,
    "vib_beta": 0.001,
    "vib_beta_anneal": false,
    "use_curriculum": false,
    "curriculum_stages": 5,
    "ot_epsilon": 0.1,
    "ot_iters": 20,
    "infonce_temp": 0.07,
    "infonce_weight": 0.1,
    "sparsity_k": 128,
    "num_refinement_steps": 2,
    "num_receptors": 32,
    "binding_sparsity": 0.1,
    "cca_dim": 256,
    "num_flow_steps": 4,
    "flow_loss_weight": 0.1,
    "moe_num_experts": 8,
    "moe_top_k": 2,
    "moe_use_shared_expert": true,
    "moe_aux_loss_weight": 0.01,
    "moe_aux_loss_free": false
  },
  "library_versions": {
    "torch": "2.5.1+cu121",
    "transformers": "4.46.2",
    "cuda": "12.1",
    "cudnn": 90100
  },
  "num_classes": 5,
  "random_baseline": 20.0,
  "final_results": {
    "accuracy": 72.5,
    "correct": 145,
    "total": 200
  },
  "training_log": [
    {
      "step": 50,
      "type": "metrics",
      "lm_loss": 4.314086782932281,
      "aux_loss": 0.25,
      "div_loss": 0.9402833729982376,
      "z_var": 7.264614105224609e-06,
      "grad_norm": 959.65125,
      "lr": 0.0001,
      "gpu_mem_allocated_gb": 50.39936637878418,
      "gpu_mem_reserved_gb": 55.0,
      "gpu_mem_peak_gb": 53.10942029953003
    },
    {
      "step": 100,
      "type": "metrics",
      "lm_loss": 2.377659475207329,
      "aux_loss": 0.25,
      "div_loss": 0.9976302015781403,
      "z_var": 1.0114908218383788e-05,
      "grad_norm": 324.985625,
      "lr": 0.0002,
      "gpu_mem_allocated_gb": 50.39936637878418,
      "gpu_mem_reserved_gb": 55.0,
      "gpu_mem_peak_gb": 53.10942029953003
    },
    {
      "step": 150,
      "type": "metrics",
      "lm_loss": 0.8006321942806244,
      "aux_loss": 0.25,
      "div_loss": 0.9995779085159302,
      "z_var": 3.96418571472168e-05,
      "grad_norm": 16.07328125,
      "lr": 0.00019937122098932428,
      "gpu_mem_allocated_gb": 50.39936637878418,
      "gpu_mem_reserved_gb": 55.0,
      "gpu_mem_peak_gb": 53.10942029953003
    },
    {
      "step": 200,
      "type": "metrics",
      "lm_loss": 0.7264575189352036,
      "aux_loss": 0.249443359375,
      "div_loss": 0.9997446882724762,
      "z_var": 5.923748016357422e-05,
      "grad_norm": 2.279453125,
      "lr": 0.00019749279121818235,
      "gpu_mem_allocated_gb": 50.39936637878418,
      "gpu_mem_reserved_gb": 55.001953125,
      "gpu_mem_peak_gb": 53.10942029953003
    },
    {
      "step": 200,
      "type": "eval",
      "accuracy": 44.0,
      "correct": 44,
      "total": 100
    },
    {
      "step": 250,
      "type": "metrics",
      "lm_loss": 0.6392431020736694,
      "aux_loss": 0.24634765625,
      "div_loss": 0.991615429520607,
      "z_var": 6.62088394165039e-05,
      "grad_norm": 4.8857421875,
      "lr": 0.00019438833303083678,
      "gpu_mem_allocated_gb": 50.39936637878418,
      "gpu_mem_reserved_gb": 55.025390625,
      "gpu_mem_peak_gb": 53.10942029953003
    },
    {
      "step": 300,
      "type": "metrics",
      "lm_loss": 0.5405302482843399,
      "aux_loss": 0.2446484375,
      "div_loss": 0.9850601923465728,
      "z_var": 7.732868194580078e-05,
      "grad_norm": 1.664453125,
      "lr": 0.0001900968867902419,
      "gpu_mem_allocated_gb": 50.39936637878418,
      "gpu_mem_reserved_gb": 55.025390625,
      "gpu_mem_peak_gb": 53.16653299331665
    },
    {
      "step": 350,
      "type": "metrics",
      "lm_loss": 0.5231687334179879,
      "aux_loss": 0.24322265625,
      "div_loss": 0.9812683224678039,
      "z_var": 8.70656967163086e-05,
      "grad_norm": 1.6437109375,
      "lr": 0.00018467241992282843,
      "gpu_mem_allocated_gb": 50.39936637878418,
      "gpu_mem_reserved_gb": 55.025390625,
      "gpu_mem_peak_gb": 53.16653299331665
    },
    {
      "step": 400,
      "type": "metrics",
      "lm_loss": 0.5100510334968567,
      "aux_loss": 0.241171875,
      "div_loss": 0.9732410907745361,
      "z_var": 8.760452270507812e-05,
      "grad_norm": 4.3364453125,
      "lr": 0.000178183148246803,
      "gpu_mem_allocated_gb": 50.39936637878418,
      "gpu_mem_reserved_gb": 55.025390625,
      "gpu_mem_peak_gb": 53.16653299331665
    },
    {
      "step": 400,
      "type": "eval",
      "accuracy": 51.0,
      "correct": 51,
      "total": 100
    },
    {
      "step": 450,
      "type": "metrics",
      "lm_loss": 0.4961899879574776,
      "aux_loss": 0.240078125,
      "div_loss": 0.9707144123315811,
      "z_var": 0.00011189460754394531,
      "grad_norm": 4.45015625,
      "lr": 0.00017071067811865476,
      "gpu_mem_allocated_gb": 50.39936637878418,
      "gpu_mem_reserved_gb": 55.025390625,
      "gpu_mem_peak_gb": 53.16653299331665
    },
    {
      "step": 500,
      "type": "metrics",
      "lm_loss": 0.5111345762014389,
      "aux_loss": 0.23990234375,
      "div_loss": 0.9701338696479798,
      "z_var": 0.00012864112854003905,
      "grad_norm": 4.6071875,
      "lr": 0.00016234898018587337,
      "gpu_mem_allocated_gb": 50.39936637878418,
      "gpu_mem_reserved_gb": 55.025390625,
      "gpu_mem_peak_gb": 53.16653299331665
    },
    {
      "step": 550,
      "type": "metrics",
      "lm_loss": 0.490142739713192,
      "aux_loss": 0.239453125,
      "div_loss": 0.9740924286842346,
      "z_var": 0.00013792037963867188,
      "grad_norm": 1.5163671875,
      "lr": 0.00015320320765153367,
      "gpu_mem_allocated_gb": 50.39936637878418,
      "gpu_mem_reserved_gb": 55.025390625,
      "gpu_mem_peak_gb": 53.16653299331665
    },
    {
      "step": 600,
      "type": "metrics",
      "lm_loss": 0.45703415632247923,
      "aux_loss": 0.237158203125,
      "div_loss": 0.9627380746603013,
      "z_var": 0.00012409210205078125,
      "grad_norm": 3.1743359375,
      "lr": 0.00014338837391175582,
      "gpu_mem_allocated_gb": 50.39936637878418,
      "gpu_mem_reserved_gb": 55.025390625,
      "gpu_mem_peak_gb": 53.16653299331665
    },
    {
      "step": 600,
      "type": "eval",
      "accuracy": 60.0,
      "correct": 60,
      "total": 100
    },
    {
      "step": 650,
      "type": "metrics",
      "lm_loss": 0.38505922734737397,
      "aux_loss": 0.23703125,
      "div_loss": 0.9197993397712707,
      "z_var": 0.00011063575744628907,
      "grad_norm": 2.1933203125,
      "lr": 0.00013302790619551674,
      "gpu_mem_allocated_gb": 50.39936637878418,
      "gpu_mem_reserved_gb": 55.02734375,
      "gpu_mem_peak_gb": 53.16653299331665
    },
    {
      "step": 700,
      "type": "metrics",
      "lm_loss": 0.40112809717655185,
      "aux_loss": 0.23755859375,
      "div_loss": 0.9178788673877716,
      "z_var": 0.00010743141174316407,
      "grad_norm": 3.966484375,
      "lr": 0.00012225209339563145,
      "gpu_mem_allocated_gb": 50.39936637878418,
      "gpu_mem_reserved_gb": 55.02734375,
      "gpu_mem_peak_gb": 53.16653299331665
    },
    {
      "step": 750,
      "type": "metrics",
      "lm_loss": 0.28010198451578616,
      "aux_loss": 0.2383203125,
      "div_loss": 0.8895901244878769,
      "z_var": 0.00010746955871582031,
      "grad_norm": 3.5504296875,
      "lr": 0.00011119644761033078,
      "gpu_mem_allocated_gb": 50.39936637878418,
      "gpu_mem_reserved_gb": 55.02734375,
      "gpu_mem_peak_gb": 53.16653299331665
    },
    {
      "step": 800,
      "type": "metrics",
      "lm_loss": 0.4529399164766073,
      "aux_loss": 0.238642578125,
      "div_loss": 0.9245501035451889,
      "z_var": 0.00013536453247070312,
      "grad_norm": 24.313203125,
      "lr": 0.0001,
      "gpu_mem_allocated_gb": 50.39936637878418,
      "gpu_mem_reserved_gb": 55.02734375,
      "gpu_mem_peak_gb": 53.16653299331665
    },
    {
      "step": 800,
      "type": "eval",
      "accuracy": 69.0,
      "correct": 69,
      "total": 100
    },
    {
      "step": 850,
      "type": "metrics",
      "lm_loss": 0.3067135116457939,
      "aux_loss": 0.237529296875,
      "div_loss": 0.9215498948097229,
      "z_var": 0.00013074874877929687,
      "grad_norm": 9.214140625,
      "lr": 8.880355238966923e-05,
      "gpu_mem_allocated_gb": 50.39936637878418,
      "gpu_mem_reserved_gb": 55.02734375,
      "gpu_mem_peak_gb": 53.16653299331665
    },
    {
      "step": 900,
      "type": "metrics",
      "lm_loss": 0.2670432829484344,
      "aux_loss": 0.23703125,
      "div_loss": 0.8969267868995666,
      "z_var": 0.00012752532958984375,
      "grad_norm": 3.97140625,
      "lr": 7.774790660436858e-05,
      "gpu_mem_allocated_gb": 50.39936637878418,
      "gpu_mem_reserved_gb": 55.02734375,
      "gpu_mem_peak_gb": 53.16653299331665
    },
    {
      "step": 950,
      "type": "metrics",
      "lm_loss": 0.18932959511876107,
      "aux_loss": 0.23802734375,
      "div_loss": 0.8744563925266265,
      "z_var": 0.0001366424560546875,
      "grad_norm": 3.311171875,
      "lr": 6.697209380448333e-05,
      "gpu_mem_allocated_gb": 50.39936637878418,
      "gpu_mem_reserved_gb": 55.02734375,
      "gpu_mem_peak_gb": 53.16653299331665
    },
    {
      "step": 1000,
      "type": "metrics",
      "lm_loss": 0.17737275920808315,
      "aux_loss": 0.23744140625,
      "div_loss": 0.8813545340299607,
      "z_var": 0.000134124755859375,
      "grad_norm": 3.2246875,
      "lr": 5.6611626088244194e-05,
      "gpu_mem_allocated_gb": 50.39936637878418,
      "gpu_mem_reserved_gb": 55.02734375,
      "gpu_mem_peak_gb": 53.16653299331665
    },
    {
      "step": 1000,
      "type": "eval",
      "accuracy": 66.0,
      "correct": 66,
      "total": 100
    },
    {
      "step": 1050,
      "type": "metrics",
      "lm_loss": 0.13586373593658208,
      "aux_loss": 0.238056640625,
      "div_loss": 0.8701241773366928,
      "z_var": 0.0001316070556640625,
      "grad_norm": 2.544296875,
      "lr": 4.6796792348466356e-05,
      "gpu_mem_allocated_gb": 50.39936637878418,
      "gpu_mem_reserved_gb": 55.02734375,
      "gpu_mem_peak_gb": 53.16653299331665
    },
    {
      "step": 1100,
      "type": "metrics",
      "lm_loss": 0.1201269643753767,
      "aux_loss": 0.2385546875,
      "div_loss": 0.866261614561081,
      "z_var": 0.0001316070556640625,
      "grad_norm": 3.405546875,
      "lr": 3.7651019814126654e-05,
      "gpu_mem_allocated_gb": 50.39936637878418,
      "gpu_mem_reserved_gb": 55.02734375,
      "gpu_mem_peak_gb": 53.16653299331665
    },
    {
      "step": 1150,
      "type": "metrics",
      "lm_loss": 0.09578776575624942,
      "aux_loss": 0.238701171875,
      "div_loss": 0.8616957366466522,
      "z_var": 0.0001316070556640625,
      "grad_norm": 2.390625,
      "lr": 2.9289321881345254e-05,
      "gpu_mem_allocated_gb": 50.39936637878418,
      "gpu_mem_reserved_gb": 55.02734375,
      "gpu_mem_peak_gb": 53.16653299331665
    },
    {
      "step": 1200,
      "type": "metrics",
      "lm_loss": 0.07075530517147854,
      "aux_loss": 0.2387890625,
      "div_loss": 0.8548753064870834,
      "z_var": 0.0001316070556640625,
      "grad_norm": 1.8860546875,
      "lr": 2.181685175319702e-05,
      "gpu_mem_allocated_gb": 50.39936637878418,
      "gpu_mem_reserved_gb": 55.02734375,
      "gpu_mem_peak_gb": 53.16653299331665
    },
    {
      "step": 1200,
      "type": "eval",
      "accuracy": 69.0,
      "correct": 69,
      "total": 100
    },
    {
      "step": 1250,
      "type": "metrics",
      "lm_loss": 0.06365724941017106,
      "aux_loss": 0.23884765625,
      "div_loss": 0.8477364236116409,
      "z_var": 0.0001316070556640625,
      "grad_norm": 2.1272265625,
      "lr": 1.5327580077171587e-05,
      "gpu_mem_allocated_gb": 50.39936637878418,
      "gpu_mem_reserved_gb": 55.02734375,
      "gpu_mem_peak_gb": 53.16653299331665
    },
    {
      "step": 1300,
      "type": "metrics",
      "lm_loss": 0.044230940260458734,
      "aux_loss": 0.23908203125,
      "div_loss": 0.8474965780973435,
      "z_var": 0.0001316070556640625,
      "grad_norm": 1.822265625,
      "lr": 9.903113209758096e-06,
      "gpu_mem_allocated_gb": 50.39936637878418,
      "gpu_mem_reserved_gb": 55.02734375,
      "gpu_mem_peak_gb": 53.16653299331665
    },
    {
      "step": 1350,
      "type": "metrics",
      "lm_loss": 0.052765029307920486,
      "aux_loss": 0.239052734375,
      "div_loss": 0.8468481677770615,
      "z_var": 0.0001316070556640625,
      "grad_norm": 2.0437890625,
      "lr": 5.611666969163243e-06,
      "gpu_mem_allocated_gb": 50.39936637878418,
      "gpu_mem_reserved_gb": 55.02734375,
      "gpu_mem_peak_gb": 53.16653299331665
    },
    {
      "step": 1400,
      "type": "metrics",
      "lm_loss": 0.049208290304522964,
      "aux_loss": 0.238994140625,
      "div_loss": 0.8459709900617599,
      "z_var": 0.0001316070556640625,
      "grad_norm": 2.3355078125,
      "lr": 2.5072087818176382e-06,
      "gpu_mem_allocated_gb": 50.39936637878418,
      "gpu_mem_reserved_gb": 55.02734375,
      "gpu_mem_peak_gb": 53.16653299331665
    },
    {
      "step": 1400,
      "type": "eval",
      "accuracy": 72.0,
      "correct": 72,
      "total": 100
    },
    {
      "step": 1450,
      "type": "metrics",
      "lm_loss": 0.04734368845121935,
      "aux_loss": 0.238994140625,
      "div_loss": 0.8462446898221969,
      "z_var": 0.0001316070556640625,
      "grad_norm": 2.175234375,
      "lr": 6.287790106757396e-07,
      "gpu_mem_allocated_gb": 50.39936637878418,
      "gpu_mem_reserved_gb": 55.02734375,
      "gpu_mem_peak_gb": 53.16653299331665
    },
    {
      "step": 1500,
      "type": "metrics",
      "lm_loss": 0.044346400576760064,
      "aux_loss": 0.239140625,
      "div_loss": 0.8431486463546753,
      "z_var": 0.0001316070556640625,
      "grad_norm": 1.99296875,
      "lr": 0.0,
      "gpu_mem_allocated_gb": 50.39936637878418,
      "gpu_mem_reserved_gb": 55.02734375,
      "gpu_mem_peak_gb": 53.16653299331665
    }
  ]
}