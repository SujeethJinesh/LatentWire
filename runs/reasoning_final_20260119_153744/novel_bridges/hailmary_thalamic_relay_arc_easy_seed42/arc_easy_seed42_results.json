{
  "experiment": "arc_easy",
  "timestamp": "2026-01-19T16:15:38.437948",
  "config": {
    "dataset": "arc_easy",
    "source_model": "meta-llama/Meta-Llama-3.1-8B-Instruct",
    "target_model": "mistralai/Mistral-7B-Instruct-v0.3",
    "source_layer": 31,
    "soft_tokens": 8,
    "depth": 2,
    "heads": 8,
    "lr": 0.0002,
    "batch_size": 16,
    "grad_accum": 2,
    "steps": 1500,
    "warmup_steps": 100,
    "diversity_weight": 0.1,
    "output_dir": "runs/reasoning_final_20260119_153744/novel_bridges/hailmary_thalamic_relay_arc_easy_seed42",
    "save_path": "bridge_arc_easy.pt",
    "save_every": 500,
    "eval_every": 200,
    "bf16": true,
    "use_fsq": false,
    "seed": 42,
    "gpu": 1,
    "resume": null,
    "auto_resume": true,
    "bridge_type": "thalamic_relay",
    "lambda_reg": 0.0001,
    "eval_only": false,
    "extract_layers": null,
    "learn_layer_weights": false,
    "inject_layers": null,
    "use_gumbel_gates": false,
    "temp_start": 2.0,
    "temp_end": 0.1,
    "use_vib": false,
    "vib_beta": 0.001,
    "vib_beta_anneal": false,
    "use_curriculum": false,
    "curriculum_stages": 5,
    "ot_epsilon": 0.1,
    "ot_iters": 20,
    "infonce_temp": 0.07,
    "infonce_weight": 0.1,
    "sparsity_k": 128,
    "num_refinement_steps": 2,
    "num_receptors": 32,
    "binding_sparsity": 0.1,
    "cca_dim": 256,
    "num_flow_steps": 4,
    "flow_loss_weight": 0.1,
    "moe_num_experts": 8,
    "moe_top_k": 2,
    "moe_use_shared_expert": true,
    "moe_aux_loss_weight": 0.01,
    "moe_aux_loss_free": false
  },
  "library_versions": {
    "torch": "2.5.1+cu121",
    "transformers": "4.46.2",
    "cuda": "12.1",
    "cudnn": 90100
  },
  "num_classes": 5,
  "random_baseline": 20.0,
  "final_results": {
    "accuracy": 81.0,
    "correct": 162,
    "total": 200
  },
  "training_log": [
    {
      "step": 50,
      "type": "metrics",
      "lm_loss": 2.4843503576517105,
      "aux_loss": 0.0,
      "div_loss": 0.994285187125206,
      "z_var": 7.848441600799561e-06,
      "grad_norm": 472.38125,
      "lr": 0.0001,
      "gpu_mem_allocated_gb": 46.52352714538574,
      "gpu_mem_reserved_gb": 50.443359375,
      "gpu_mem_peak_gb": 49.085575103759766
    },
    {
      "step": 100,
      "type": "metrics",
      "lm_loss": 0.8660728996992111,
      "aux_loss": 0.0,
      "div_loss": 0.9997335535287857,
      "z_var": 1.5330314636230468e-05,
      "grad_norm": 127.57625,
      "lr": 0.0002,
      "gpu_mem_allocated_gb": 46.52352714538574,
      "gpu_mem_reserved_gb": 50.443359375,
      "gpu_mem_peak_gb": 49.085575103759766
    },
    {
      "step": 150,
      "type": "metrics",
      "lm_loss": 0.7404880058765412,
      "aux_loss": 0.0,
      "div_loss": 0.9999865925312043,
      "z_var": 2.322196960449219e-05,
      "grad_norm": 24.46609375,
      "lr": 0.00019937122098932428,
      "gpu_mem_allocated_gb": 46.52352714538574,
      "gpu_mem_reserved_gb": 50.443359375,
      "gpu_mem_peak_gb": 49.085575103759766
    },
    {
      "step": 200,
      "type": "metrics",
      "lm_loss": 0.6805439946055413,
      "aux_loss": 0.0,
      "div_loss": 0.9990157425403595,
      "z_var": 1.9211769104003906e-05,
      "grad_norm": 15.036875,
      "lr": 0.00019749279121818235,
      "gpu_mem_allocated_gb": 46.52352714538574,
      "gpu_mem_reserved_gb": 50.443359375,
      "gpu_mem_peak_gb": 49.085575103759766
    },
    {
      "step": 200,
      "type": "eval",
      "accuracy": 53.0,
      "correct": 53,
      "total": 100
    },
    {
      "step": 250,
      "type": "metrics",
      "lm_loss": 0.5922856423258781,
      "aux_loss": 0.0,
      "div_loss": 0.9945933330059051,
      "z_var": 2.0335912704467774e-05,
      "grad_norm": 18.616875,
      "lr": 0.00019438833303083678,
      "gpu_mem_allocated_gb": 46.52352714538574,
      "gpu_mem_reserved_gb": 50.44921875,
      "gpu_mem_peak_gb": 49.085575103759766
    },
    {
      "step": 300,
      "type": "metrics",
      "lm_loss": 0.5290322583913804,
      "aux_loss": 0.0,
      "div_loss": 0.9904670405387879,
      "z_var": 2.0613670349121092e-05,
      "grad_norm": 14.2928125,
      "lr": 0.0001900968867902419,
      "gpu_mem_allocated_gb": 46.52352714538574,
      "gpu_mem_reserved_gb": 50.44921875,
      "gpu_mem_peak_gb": 49.12925052642822
    },
    {
      "step": 350,
      "type": "metrics",
      "lm_loss": 0.5425178399682045,
      "aux_loss": 0.0,
      "div_loss": 0.9848647850751877,
      "z_var": 2.2646188735961914e-05,
      "grad_norm": 11.8440625,
      "lr": 0.00018467241992282843,
      "gpu_mem_allocated_gb": 46.52352714538574,
      "gpu_mem_reserved_gb": 50.44921875,
      "gpu_mem_peak_gb": 49.12925052642822
    },
    {
      "step": 400,
      "type": "metrics",
      "lm_loss": 0.5223818236589431,
      "aux_loss": 0.0,
      "div_loss": 0.9761848384141922,
      "z_var": 2.2346973419189454e-05,
      "grad_norm": 8.850625,
      "lr": 0.000178183148246803,
      "gpu_mem_allocated_gb": 46.52352714538574,
      "gpu_mem_reserved_gb": 50.44921875,
      "gpu_mem_peak_gb": 49.12925052642822
    },
    {
      "step": 400,
      "type": "eval",
      "accuracy": 42.0,
      "correct": 42,
      "total": 100
    },
    {
      "step": 450,
      "type": "metrics",
      "lm_loss": 0.5276116582751275,
      "aux_loss": 0.0,
      "div_loss": 0.9781452977657318,
      "z_var": 2.702832221984863e-05,
      "grad_norm": 7.93421875,
      "lr": 0.00017071067811865476,
      "gpu_mem_allocated_gb": 46.52352714538574,
      "gpu_mem_reserved_gb": 50.44921875,
      "gpu_mem_peak_gb": 49.12925052642822
    },
    {
      "step": 500,
      "type": "metrics",
      "lm_loss": 0.5192212355136872,
      "aux_loss": 0.0,
      "div_loss": 0.9746013349294662,
      "z_var": 2.9044151306152342e-05,
      "grad_norm": 6.6390625,
      "lr": 0.00016234898018587337,
      "gpu_mem_allocated_gb": 46.52352714538574,
      "gpu_mem_reserved_gb": 50.44921875,
      "gpu_mem_peak_gb": 49.12925052642822
    },
    {
      "step": 550,
      "type": "metrics",
      "lm_loss": 0.47028343349695206,
      "aux_loss": 0.0,
      "div_loss": 0.959004071354866,
      "z_var": 3.240346908569336e-05,
      "grad_norm": 23.654375,
      "lr": 0.00015320320765153367,
      "gpu_mem_allocated_gb": 46.52352714538574,
      "gpu_mem_reserved_gb": 50.44921875,
      "gpu_mem_peak_gb": 49.12925052642822
    },
    {
      "step": 600,
      "type": "metrics",
      "lm_loss": 0.3349324245378375,
      "aux_loss": 0.0,
      "div_loss": 0.9584845983982087,
      "z_var": 3.365516662597656e-05,
      "grad_norm": 18.2275,
      "lr": 0.00014338837391175582,
      "gpu_mem_allocated_gb": 46.52352714538574,
      "gpu_mem_reserved_gb": 50.44921875,
      "gpu_mem_peak_gb": 49.12925052642822
    },
    {
      "step": 600,
      "type": "eval",
      "accuracy": 80.0,
      "correct": 80,
      "total": 100
    },
    {
      "step": 650,
      "type": "metrics",
      "lm_loss": 0.25399170074611904,
      "aux_loss": 0.0,
      "div_loss": 0.9545562976598739,
      "z_var": 4.1289329528808595e-05,
      "grad_norm": 14.423125,
      "lr": 0.00013302790619551674,
      "gpu_mem_allocated_gb": 46.52352714538574,
      "gpu_mem_reserved_gb": 50.44921875,
      "gpu_mem_peak_gb": 49.12925052642822
    },
    {
      "step": 700,
      "type": "metrics",
      "lm_loss": 0.23139036606997251,
      "aux_loss": 0.0,
      "div_loss": 0.9538552850484848,
      "z_var": 3.9086341857910156e-05,
      "grad_norm": 11.0259375,
      "lr": 0.00012225209339563145,
      "gpu_mem_allocated_gb": 46.52352714538574,
      "gpu_mem_reserved_gb": 50.44921875,
      "gpu_mem_peak_gb": 49.12925052642822
    },
    {
      "step": 750,
      "type": "metrics",
      "lm_loss": 0.22086573131382464,
      "aux_loss": 0.0,
      "div_loss": 0.950194890499115,
      "z_var": 3.959417343139648e-05,
      "grad_norm": 9.814375,
      "lr": 0.00011119644761033078,
      "gpu_mem_allocated_gb": 46.52352714538574,
      "gpu_mem_reserved_gb": 50.44921875,
      "gpu_mem_peak_gb": 49.12925052642822
    },
    {
      "step": 800,
      "type": "metrics",
      "lm_loss": 0.19995925080031157,
      "aux_loss": 0.0,
      "div_loss": 0.9435182821750641,
      "z_var": 4.218578338623047e-05,
      "grad_norm": 9.0371875,
      "lr": 0.0001,
      "gpu_mem_allocated_gb": 46.52352714538574,
      "gpu_mem_reserved_gb": 50.44921875,
      "gpu_mem_peak_gb": 49.12925052642822
    },
    {
      "step": 800,
      "type": "eval",
      "accuracy": 87.0,
      "correct": 87,
      "total": 100
    },
    {
      "step": 850,
      "type": "metrics",
      "lm_loss": 0.1688277163542807,
      "aux_loss": 0.0,
      "div_loss": 0.9420565563440323,
      "z_var": 4.6715736389160156e-05,
      "grad_norm": 7.52453125,
      "lr": 8.880355238966923e-05,
      "gpu_mem_allocated_gb": 46.52352714538574,
      "gpu_mem_reserved_gb": 50.44921875,
      "gpu_mem_peak_gb": 49.12925052642822
    },
    {
      "step": 900,
      "type": "metrics",
      "lm_loss": 0.1728273246716708,
      "aux_loss": 0.0,
      "div_loss": 0.9354142326116562,
      "z_var": 4.643440246582031e-05,
      "grad_norm": 12.8509375,
      "lr": 7.774790660436858e-05,
      "gpu_mem_allocated_gb": 46.52352714538574,
      "gpu_mem_reserved_gb": 50.44921875,
      "gpu_mem_peak_gb": 49.12925052642822
    },
    {
      "step": 950,
      "type": "metrics",
      "lm_loss": 0.12440196602605283,
      "aux_loss": 0.0,
      "div_loss": 0.9283815771341324,
      "z_var": 4.539966583251953e-05,
      "grad_norm": 7.2075,
      "lr": 6.697209380448333e-05,
      "gpu_mem_allocated_gb": 46.52352714538574,
      "gpu_mem_reserved_gb": 50.44921875,
      "gpu_mem_peak_gb": 49.12925052642822
    },
    {
      "step": 1000,
      "type": "metrics",
      "lm_loss": 0.16003902687632945,
      "aux_loss": 0.0,
      "div_loss": 0.9315381342172623,
      "z_var": 4.9271583557128905e-05,
      "grad_norm": 12.8484375,
      "lr": 5.6611626088244194e-05,
      "gpu_mem_allocated_gb": 46.52352714538574,
      "gpu_mem_reserved_gb": 50.44921875,
      "gpu_mem_peak_gb": 49.12925052642822
    },
    {
      "step": 1000,
      "type": "eval",
      "accuracy": 84.0,
      "correct": 84,
      "total": 100
    },
    {
      "step": 1050,
      "type": "metrics",
      "lm_loss": 0.08580752341425978,
      "aux_loss": 0.0,
      "div_loss": 0.9277969366312027,
      "z_var": 4.7659873962402345e-05,
      "grad_norm": 7.639453125,
      "lr": 4.6796792348466356e-05,
      "gpu_mem_allocated_gb": 46.52352714538574,
      "gpu_mem_reserved_gb": 50.44921875,
      "gpu_mem_peak_gb": 49.12925052642822
    },
    {
      "step": 1100,
      "type": "metrics",
      "lm_loss": 0.06800230152497534,
      "aux_loss": 0.0,
      "div_loss": 0.9214601874351501,
      "z_var": 4.716157913208008e-05,
      "grad_norm": 6.2011328125,
      "lr": 3.7651019814126654e-05,
      "gpu_mem_allocated_gb": 46.52352714538574,
      "gpu_mem_reserved_gb": 50.44921875,
      "gpu_mem_peak_gb": 49.12925052642822
    },
    {
      "step": 1150,
      "type": "metrics",
      "lm_loss": 0.0467054623295553,
      "aux_loss": 0.0,
      "div_loss": 0.9211405038833618,
      "z_var": 4.780292510986328e-05,
      "grad_norm": 5.1128125,
      "lr": 2.9289321881345254e-05,
      "gpu_mem_allocated_gb": 46.52352714538574,
      "gpu_mem_reserved_gb": 50.44921875,
      "gpu_mem_peak_gb": 49.12925052642822
    },
    {
      "step": 1200,
      "type": "metrics",
      "lm_loss": 0.04872690771226189,
      "aux_loss": 0.0,
      "div_loss": 0.9136105251312255,
      "z_var": 4.792213439941406e-05,
      "grad_norm": 6.2400244140625,
      "lr": 2.181685175319702e-05,
      "gpu_mem_allocated_gb": 46.52352714538574,
      "gpu_mem_reserved_gb": 50.44921875,
      "gpu_mem_peak_gb": 49.12925052642822
    },
    {
      "step": 1200,
      "type": "eval",
      "accuracy": 83.0,
      "correct": 83,
      "total": 100
    },
    {
      "step": 1250,
      "type": "metrics",
      "lm_loss": 0.028816204324393767,
      "aux_loss": 0.0,
      "div_loss": 0.9125726163387299,
      "z_var": 4.792213439941406e-05,
      "grad_norm": 3.786142578125,
      "lr": 1.5327580077171587e-05,
      "gpu_mem_allocated_gb": 46.52352714538574,
      "gpu_mem_reserved_gb": 50.451171875,
      "gpu_mem_peak_gb": 49.12925052642822
    },
    {
      "step": 1300,
      "type": "metrics",
      "lm_loss": 0.021107239574339475,
      "aux_loss": 0.0,
      "div_loss": 0.9093575555086136,
      "z_var": 4.792213439941406e-05,
      "grad_norm": 2.8150390625,
      "lr": 9.903113209758096e-06,
      "gpu_mem_allocated_gb": 46.52352714538574,
      "gpu_mem_reserved_gb": 50.451171875,
      "gpu_mem_peak_gb": 49.12925052642822
    },
    {
      "step": 1350,
      "type": "metrics",
      "lm_loss": 0.023923357965395554,
      "aux_loss": 0.0,
      "div_loss": 0.9105671405792236,
      "z_var": 4.792213439941406e-05,
      "grad_norm": 3.8224365234375,
      "lr": 5.611666969163243e-06,
      "gpu_mem_allocated_gb": 46.52352714538574,
      "gpu_mem_reserved_gb": 50.451171875,
      "gpu_mem_peak_gb": 49.12925052642822
    },
    {
      "step": 1400,
      "type": "metrics",
      "lm_loss": 0.020999577786496956,
      "aux_loss": 0.0,
      "div_loss": 0.9095558774471283,
      "z_var": 4.792213439941406e-05,
      "grad_norm": 3.0953564453125,
      "lr": 2.5072087818176382e-06,
      "gpu_mem_allocated_gb": 46.52352714538574,
      "gpu_mem_reserved_gb": 50.451171875,
      "gpu_mem_peak_gb": 49.12925052642822
    },
    {
      "step": 1400,
      "type": "eval",
      "accuracy": 84.0,
      "correct": 84,
      "total": 100
    },
    {
      "step": 1450,
      "type": "metrics",
      "lm_loss": 0.018148902081011328,
      "aux_loss": 0.0,
      "div_loss": 0.909080737233162,
      "z_var": 4.792213439941406e-05,
      "grad_norm": 2.7210302734375,
      "lr": 6.287790106757396e-07,
      "gpu_mem_allocated_gb": 46.52352714538574,
      "gpu_mem_reserved_gb": 50.451171875,
      "gpu_mem_peak_gb": 49.12925052642822
    },
    {
      "step": 1500,
      "type": "metrics",
      "lm_loss": 0.02183462035594857,
      "aux_loss": 0.0,
      "div_loss": 0.9091434305906296,
      "z_var": 4.792213439941406e-05,
      "grad_norm": 3.014345703125,
      "lr": 0.0,
      "gpu_mem_allocated_gb": 46.52352714538574,
      "gpu_mem_reserved_gb": 50.451171875,
      "gpu_mem_peak_gb": 49.12925052642822
    }
  ]
}