{
  "experiment": "arc_easy",
  "timestamp": "2026-01-19T16:03:21.833985",
  "config": {
    "dataset": "arc_easy",
    "source_model": "meta-llama/Meta-Llama-3.1-8B-Instruct",
    "target_model": "mistralai/Mistral-7B-Instruct-v0.3",
    "source_layer": 31,
    "soft_tokens": 8,
    "depth": 2,
    "heads": 8,
    "lr": 0.0002,
    "batch_size": 16,
    "grad_accum": 2,
    "steps": 1500,
    "warmup_steps": 100,
    "diversity_weight": 0.1,
    "output_dir": "runs/reasoning_final_20260119_153744/novel_bridges/hailmary_mixture_of_depths_arc_easy_seed42",
    "save_path": "bridge_arc_easy.pt",
    "save_every": 500,
    "eval_every": 200,
    "bf16": true,
    "use_fsq": false,
    "seed": 42,
    "gpu": 1,
    "resume": null,
    "auto_resume": true,
    "bridge_type": "mixture_of_depths",
    "lambda_reg": 0.0001,
    "eval_only": false,
    "extract_layers": null,
    "learn_layer_weights": false,
    "inject_layers": null,
    "use_gumbel_gates": false,
    "temp_start": 2.0,
    "temp_end": 0.1,
    "use_vib": false,
    "vib_beta": 0.001,
    "vib_beta_anneal": false,
    "use_curriculum": false,
    "curriculum_stages": 5,
    "ot_epsilon": 0.1,
    "ot_iters": 20,
    "infonce_temp": 0.07,
    "infonce_weight": 0.1,
    "sparsity_k": 128,
    "num_refinement_steps": 2,
    "num_receptors": 32,
    "binding_sparsity": 0.1,
    "cca_dim": 256,
    "num_flow_steps": 4,
    "flow_loss_weight": 0.1,
    "moe_num_experts": 8,
    "moe_top_k": 2,
    "moe_use_shared_expert": true,
    "moe_aux_loss_weight": 0.01,
    "moe_aux_loss_free": false
  },
  "library_versions": {
    "torch": "2.5.1+cu121",
    "transformers": "4.46.2",
    "cuda": "12.1",
    "cudnn": 90100
  },
  "num_classes": 5,
  "random_baseline": 20.0,
  "final_results": {
    "accuracy": 84.5,
    "correct": 169,
    "total": 200
  },
  "training_log": [
    {
      "step": 50,
      "type": "metrics",
      "lm_loss": 2.327043191194534,
      "aux_loss": 0.0,
      "div_loss": 0.9823813557624816,
      "z_var": 7.419441321872e-06,
      "grad_norm": 248.72875,
      "lr": 0.0001,
      "gpu_mem_allocated_gb": 46.27271747589111,
      "gpu_mem_reserved_gb": 50.04296875,
      "gpu_mem_peak_gb": 48.82463312149048
    },
    {
      "step": 100,
      "type": "metrics",
      "lm_loss": 4.585137978196144,
      "aux_loss": 0.0,
      "div_loss": 0.9723669368028641,
      "z_var": 9.577265518601053e-06,
      "grad_norm": 914.70015625,
      "lr": 0.0002,
      "gpu_mem_allocated_gb": 46.27271747589111,
      "gpu_mem_reserved_gb": 50.04296875,
      "gpu_mem_peak_gb": 48.82463312149048
    },
    {
      "step": 150,
      "type": "metrics",
      "lm_loss": 2.213825182914734,
      "aux_loss": 0.0,
      "div_loss": 0.995874417424202,
      "z_var": 2.538408998589148e-05,
      "grad_norm": 315.58875,
      "lr": 0.00019937122098932428,
      "gpu_mem_allocated_gb": 46.27271747589111,
      "gpu_mem_reserved_gb": 50.04296875,
      "gpu_mem_peak_gb": 48.82463312149048
    },
    {
      "step": 200,
      "type": "metrics",
      "lm_loss": 1.40090637922287,
      "aux_loss": 0.0,
      "div_loss": 0.9977064025402069,
      "z_var": 4.0557832871854774e-05,
      "grad_norm": 117.6621875,
      "lr": 0.00019749279121818235,
      "gpu_mem_allocated_gb": 46.27271747589111,
      "gpu_mem_reserved_gb": 50.04296875,
      "gpu_mem_peak_gb": 48.82463312149048
    },
    {
      "step": 200,
      "type": "eval",
      "accuracy": 21.0,
      "correct": 21,
      "total": 100
    },
    {
      "step": 250,
      "type": "metrics",
      "lm_loss": 1.8154507899284362,
      "aux_loss": 0.0,
      "div_loss": 0.9948128074407577,
      "z_var": 6.014313556079287e-05,
      "grad_norm": 182.09296875,
      "lr": 0.00019438833303083678,
      "gpu_mem_allocated_gb": 46.27271747589111,
      "gpu_mem_reserved_gb": 50.05859375,
      "gpu_mem_peak_gb": 48.82463312149048
    },
    {
      "step": 300,
      "type": "metrics",
      "lm_loss": 0.7582536959648132,
      "aux_loss": 0.0,
      "div_loss": 0.9952990400791168,
      "z_var": 7.42899462056812e-05,
      "grad_norm": 12.781796875,
      "lr": 0.0001900968867902419,
      "gpu_mem_allocated_gb": 46.27271747589111,
      "gpu_mem_reserved_gb": 50.05859375,
      "gpu_mem_peak_gb": 48.862205028533936
    },
    {
      "step": 350,
      "type": "metrics",
      "lm_loss": 0.7561752384901047,
      "aux_loss": 0.0,
      "div_loss": 0.9966924840211868,
      "z_var": 0.00010740338751929812,
      "grad_norm": 21.03140625,
      "lr": 0.00018467241992282843,
      "gpu_mem_allocated_gb": 46.27271747589111,
      "gpu_mem_reserved_gb": 50.05859375,
      "gpu_mem_peak_gb": 48.862205028533936
    },
    {
      "step": 400,
      "type": "metrics",
      "lm_loss": 0.6419451904296875,
      "aux_loss": 0.0,
      "div_loss": 0.996656209230423,
      "z_var": 0.00012886643409729004,
      "grad_norm": 8.135078125,
      "lr": 0.000178183148246803,
      "gpu_mem_allocated_gb": 46.27271747589111,
      "gpu_mem_reserved_gb": 50.05859375,
      "gpu_mem_peak_gb": 48.862205028533936
    },
    {
      "step": 400,
      "type": "eval",
      "accuracy": 46.0,
      "correct": 46,
      "total": 100
    },
    {
      "step": 450,
      "type": "metrics",
      "lm_loss": 0.5791926461458207,
      "aux_loss": 0.0,
      "div_loss": 0.9939202904701233,
      "z_var": 0.00012207436018798034,
      "grad_norm": 7.407265625,
      "lr": 0.00017071067811865476,
      "gpu_mem_allocated_gb": 46.27271747589111,
      "gpu_mem_reserved_gb": 50.05859375,
      "gpu_mem_peak_gb": 48.862205028533936
    },
    {
      "step": 500,
      "type": "metrics",
      "lm_loss": 0.5538315764069557,
      "aux_loss": 0.0,
      "div_loss": 0.9831208735704422,
      "z_var": 0.00012187998356239405,
      "grad_norm": 10.6447265625,
      "lr": 0.00016234898018587337,
      "gpu_mem_allocated_gb": 46.27271747589111,
      "gpu_mem_reserved_gb": 50.05859375,
      "gpu_mem_peak_gb": 48.862205028533936
    },
    {
      "step": 550,
      "type": "metrics",
      "lm_loss": 0.5274164944887161,
      "aux_loss": 0.0,
      "div_loss": 0.9756556725502015,
      "z_var": 0.00014462060833466238,
      "grad_norm": 4.3242578125,
      "lr": 0.00015320320765153367,
      "gpu_mem_allocated_gb": 46.27271747589111,
      "gpu_mem_reserved_gb": 50.05859375,
      "gpu_mem_peak_gb": 48.862205028533936
    },
    {
      "step": 600,
      "type": "metrics",
      "lm_loss": 0.5810578806698322,
      "aux_loss": 0.0,
      "div_loss": 0.9709788846969605,
      "z_var": 0.0001475640691933222,
      "grad_norm": 24.2165625,
      "lr": 0.00014338837391175582,
      "gpu_mem_allocated_gb": 46.27271747589111,
      "gpu_mem_reserved_gb": 50.05859375,
      "gpu_mem_peak_gb": 48.862205028533936
    },
    {
      "step": 600,
      "type": "eval",
      "accuracy": 48.0,
      "correct": 48,
      "total": 100
    },
    {
      "step": 650,
      "type": "metrics",
      "lm_loss": 0.5841750041395426,
      "aux_loss": 0.0,
      "div_loss": 0.9279418766498566,
      "z_var": 0.0001446278704679571,
      "grad_norm": 29.37953125,
      "lr": 0.00013302790619551674,
      "gpu_mem_allocated_gb": 46.27271747589111,
      "gpu_mem_reserved_gb": 50.060546875,
      "gpu_mem_peak_gb": 48.862205028533936
    },
    {
      "step": 700,
      "type": "metrics",
      "lm_loss": 0.3076390664279461,
      "aux_loss": 0.0,
      "div_loss": 0.9145682311058044,
      "z_var": 0.00014446782050072215,
      "grad_norm": 9.862421875,
      "lr": 0.00012225209339563145,
      "gpu_mem_allocated_gb": 46.27271747589111,
      "gpu_mem_reserved_gb": 50.060546875,
      "gpu_mem_peak_gb": 48.862205028533936
    },
    {
      "step": 750,
      "type": "metrics",
      "lm_loss": 0.2744411092996597,
      "aux_loss": 0.0,
      "div_loss": 0.9317646843194961,
      "z_var": 0.00016620041569694876,
      "grad_norm": 5.750703125,
      "lr": 0.00011119644761033078,
      "gpu_mem_allocated_gb": 46.27271747589111,
      "gpu_mem_reserved_gb": 50.060546875,
      "gpu_mem_peak_gb": 48.862205028533936
    },
    {
      "step": 800,
      "type": "metrics",
      "lm_loss": 0.25956009447574613,
      "aux_loss": 0.0,
      "div_loss": 0.9109764164686203,
      "z_var": 0.00016823133220896124,
      "grad_norm": 3.898671875,
      "lr": 0.0001,
      "gpu_mem_allocated_gb": 46.27271747589111,
      "gpu_mem_reserved_gb": 50.060546875,
      "gpu_mem_peak_gb": 48.862205028533936
    },
    {
      "step": 800,
      "type": "eval",
      "accuracy": 83.0,
      "correct": 83,
      "total": 100
    },
    {
      "step": 850,
      "type": "metrics",
      "lm_loss": 0.233242005109787,
      "aux_loss": 0.0,
      "div_loss": 0.9224142897129058,
      "z_var": 0.00017196321918163448,
      "grad_norm": 3.2742578125,
      "lr": 8.880355238966923e-05,
      "gpu_mem_allocated_gb": 46.27271747589111,
      "gpu_mem_reserved_gb": 50.060546875,
      "gpu_mem_peak_gb": 48.862205028533936
    },
    {
      "step": 900,
      "type": "metrics",
      "lm_loss": 0.21789686787873508,
      "aux_loss": 0.0,
      "div_loss": 0.8850403314828873,
      "z_var": 0.00018184491127613,
      "grad_norm": 2.37259765625,
      "lr": 7.774790660436858e-05,
      "gpu_mem_allocated_gb": 46.27271747589111,
      "gpu_mem_reserved_gb": 50.060546875,
      "gpu_mem_peak_gb": 48.862205028533936
    },
    {
      "step": 950,
      "type": "metrics",
      "lm_loss": 0.1988981669023633,
      "aux_loss": 0.0,
      "div_loss": 0.8639521205425262,
      "z_var": 0.0001802743882581126,
      "grad_norm": 1.72009765625,
      "lr": 6.697209380448333e-05,
      "gpu_mem_allocated_gb": 46.27271747589111,
      "gpu_mem_reserved_gb": 50.060546875,
      "gpu_mem_peak_gb": 48.862205028533936
    },
    {
      "step": 1000,
      "type": "metrics",
      "lm_loss": 0.18683017384260892,
      "aux_loss": 0.0,
      "div_loss": 0.8230543196201324,
      "z_var": 0.00018296504102181644,
      "grad_norm": 2.219609375,
      "lr": 5.6611626088244194e-05,
      "gpu_mem_allocated_gb": 46.27271747589111,
      "gpu_mem_reserved_gb": 50.060546875,
      "gpu_mem_peak_gb": 48.862205028533936
    },
    {
      "step": 1000,
      "type": "eval",
      "accuracy": 83.0,
      "correct": 83,
      "total": 100
    },
    {
      "step": 1050,
      "type": "metrics",
      "lm_loss": 0.2205816537886858,
      "aux_loss": 0.0,
      "div_loss": 0.7881604218482972,
      "z_var": 0.00019024819746846333,
      "grad_norm": 5.517265625,
      "lr": 4.6796792348466356e-05,
      "gpu_mem_allocated_gb": 46.27271747589111,
      "gpu_mem_reserved_gb": 50.060546875,
      "gpu_mem_peak_gb": 48.862205028533936
    },
    {
      "step": 1100,
      "type": "metrics",
      "lm_loss": 0.1782654531672597,
      "aux_loss": 0.0,
      "div_loss": 0.7785004299879074,
      "z_var": 0.0001902486488688737,
      "grad_norm": 1.4274609375,
      "lr": 3.7651019814126654e-05,
      "gpu_mem_allocated_gb": 46.27271747589111,
      "gpu_mem_reserved_gb": 50.060546875,
      "gpu_mem_peak_gb": 48.862205028533936
    },
    {
      "step": 1150,
      "type": "metrics",
      "lm_loss": 0.16801134621724487,
      "aux_loss": 0.0,
      "div_loss": 0.7605993288755417,
      "z_var": 0.00019025495639652946,
      "grad_norm": 2.98140625,
      "lr": 2.9289321881345254e-05,
      "gpu_mem_allocated_gb": 46.27271747589111,
      "gpu_mem_reserved_gb": 50.060546875,
      "gpu_mem_peak_gb": 48.862205028533936
    },
    {
      "step": 1200,
      "type": "metrics",
      "lm_loss": 0.155187431036029,
      "aux_loss": 0.0,
      "div_loss": 0.7264326149225235,
      "z_var": 0.0001902566220087465,
      "grad_norm": 1.5296875,
      "lr": 2.181685175319702e-05,
      "gpu_mem_allocated_gb": 46.27271747589111,
      "gpu_mem_reserved_gb": 50.060546875,
      "gpu_mem_peak_gb": 48.862205028533936
    },
    {
      "step": 1200,
      "type": "eval",
      "accuracy": 88.0,
      "correct": 88,
      "total": 100
    },
    {
      "step": 1250,
      "type": "metrics",
      "lm_loss": 0.1588706933055073,
      "aux_loss": 0.0,
      "div_loss": 0.6530681920051574,
      "z_var": 0.0001902568638615776,
      "grad_norm": 2.1333984375,
      "lr": 1.5327580077171587e-05,
      "gpu_mem_allocated_gb": 46.27271747589111,
      "gpu_mem_reserved_gb": 50.060546875,
      "gpu_mem_peak_gb": 48.862205028533936
    },
    {
      "step": 1300,
      "type": "metrics",
      "lm_loss": 0.14561126726912335,
      "aux_loss": 0.0,
      "div_loss": 0.6297500348091125,
      "z_var": 0.0001902555195556488,
      "grad_norm": 2.014375,
      "lr": 9.903113209758096e-06,
      "gpu_mem_allocated_gb": 46.27271747589111,
      "gpu_mem_reserved_gb": 50.060546875,
      "gpu_mem_peak_gb": 48.862205028533936
    },
    {
      "step": 1350,
      "type": "metrics",
      "lm_loss": 0.14401154179126024,
      "aux_loss": 0.0,
      "div_loss": 0.6305731493234634,
      "z_var": 0.0001902556604181882,
      "grad_norm": 1.8211328125,
      "lr": 5.611666969163243e-06,
      "gpu_mem_allocated_gb": 46.27271747589111,
      "gpu_mem_reserved_gb": 50.060546875,
      "gpu_mem_peak_gb": 48.862205028533936
    },
    {
      "step": 1400,
      "type": "metrics",
      "lm_loss": 0.1350876050721854,
      "aux_loss": 0.0,
      "div_loss": 0.6204763251543045,
      "z_var": 0.00019025584377232007,
      "grad_norm": 1.9276171875,
      "lr": 2.5072087818176382e-06,
      "gpu_mem_allocated_gb": 46.27271747589111,
      "gpu_mem_reserved_gb": 50.060546875,
      "gpu_mem_peak_gb": 48.862205028533936
    },
    {
      "step": 1400,
      "type": "eval",
      "accuracy": 90.0,
      "correct": 90,
      "total": 100
    },
    {
      "step": 1450,
      "type": "metrics",
      "lm_loss": 0.1396722462773323,
      "aux_loss": 0.0,
      "div_loss": 0.626875227689743,
      "z_var": 0.00019025553148821928,
      "grad_norm": 1.8284765625,
      "lr": 6.287790106757396e-07,
      "gpu_mem_allocated_gb": 46.27271747589111,
      "gpu_mem_reserved_gb": 50.060546875,
      "gpu_mem_peak_gb": 48.862205028533936
    },
    {
      "step": 1500,
      "type": "metrics",
      "lm_loss": 0.14312189272837714,
      "aux_loss": 0.0,
      "div_loss": 0.6178151369094849,
      "z_var": 0.00019025602348847316,
      "grad_norm": 1.8884765625,
      "lr": 0.0,
      "gpu_mem_allocated_gb": 46.27271747589111,
      "gpu_mem_reserved_gb": 50.060546875,
      "gpu_mem_peak_gb": 48.862205028533936
    }
  ]
}