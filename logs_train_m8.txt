Loading HotpotQA subset...
Llama hidden size: 2048, Qwen hidden size: 896
Epoch 1/1
  step 10/5000 | loss_llama=1.7427 | loss_qwen=8.9328 | grad_norm=117852.80
  step 20/5000 | loss_llama=1.5214 | loss_qwen=9.6109 | grad_norm=85693.05
  step 30/5000 | loss_llama=1.7176 | loss_qwen=10.8762 | grad_norm=199.80
  step 40/5000 | loss_llama=3.3054 | loss_qwen=11.1555 | grad_norm=223.06
  step 50/5000 | loss_llama=1.4698 | loss_qwen=11.1193 | grad_norm=103250.80
  step 60/5000 | loss_llama=2.0725 | loss_qwen=10.8842 | grad_norm=58624.80
  step 70/5000 | loss_llama=0.9376 | loss_qwen=11.9617 | grad_norm=144.66
  step 80/5000 | loss_llama=0.7513 | loss_qwen=11.2197 | grad_norm=168.74
  step 90/5000 | loss_llama=2.4732 | loss_qwen=8.5252 | grad_norm=214.25
  step 100/5000 | loss_llama=0.7222 | loss_qwen=8.1534 | grad_norm=191.77
  step 110/5000 | loss_llama=2.4384 | loss_qwen=9.6746 | grad_norm=18526.75
  step 120/5000 | loss_llama=0.7157 | loss_qwen=6.2860 | grad_norm=111.00
  step 130/5000 | loss_llama=0.8886 | loss_qwen=6.8218 | grad_norm=39265.90
  step 140/5000 | loss_llama=1.2112 | loss_qwen=5.8149 | grad_norm=82.10
  step 150/5000 | loss_llama=1.0050 | loss_qwen=5.8899 | grad_norm=42283.91
  step 160/5000 | loss_llama=1.4491 | loss_qwen=5.9721 | grad_norm=87417.49
  step 170/5000 | loss_llama=1.7919 | loss_qwen=7.0493 | grad_norm=58202.45
  step 180/5000 | loss_llama=0.3679 | loss_qwen=4.4737 | grad_norm=46026.67
  step 190/5000 | loss_llama=1.1254 | loss_qwen=5.0846 | grad_norm=49147.12
  step 200/5000 | loss_llama=1.1500 | loss_qwen=5.0937 | grad_norm=73.16
  step 210/5000 | loss_llama=1.0434 | loss_qwen=6.4867 | grad_norm=102.62
  step 220/5000 | loss_llama=1.1746 | loss_qwen=10.3241 | grad_norm=63142.96
  step 230/5000 | loss_llama=2.4379 | loss_qwen=6.9012 | grad_norm=39587.50
  step 240/5000 | loss_llama=0.6631 | loss_qwen=4.0166 | grad_norm=51481.76
  step 250/5000 | loss_llama=1.4980 | loss_qwen=6.9874 | grad_norm=54.83
  ✅ Saved checkpoint at step 250
  step 260/5000 | loss_llama=0.5807 | loss_qwen=5.6932 | grad_norm=106.02
  step 270/5000 | loss_llama=1.0032 | loss_qwen=5.2120 | grad_norm=53096.64
  step 280/5000 | loss_llama=0.9446 | loss_qwen=10.2220 | grad_norm=58278.11
  step 290/5000 | loss_llama=0.6185 | loss_qwen=5.1511 | grad_norm=67.18
  step 300/5000 | loss_llama=1.0563 | loss_qwen=4.8829 | grad_norm=47.83
  step 310/5000 | loss_llama=0.6668 | loss_qwen=6.9349 | grad_norm=46.85
  step 320/5000 | loss_llama=1.6032 | loss_qwen=6.0642 | grad_norm=58837.11
  step 330/5000 | loss_llama=0.7422 | loss_qwen=5.3052 | grad_norm=48973.00
  step 340/5000 | loss_llama=1.0984 | loss_qwen=5.2457 | grad_norm=65.65
  step 350/5000 | loss_llama=0.6002 | loss_qwen=6.3221 | grad_norm=84632.98
  step 360/5000 | loss_llama=0.5334 | loss_qwen=6.8426 | grad_norm=54124.87
  step 370/5000 | loss_llama=0.4649 | loss_qwen=5.9594 | grad_norm=133.93
  step 380/5000 | loss_llama=0.6280 | loss_qwen=9.1785 | grad_norm=124.07
  step 390/5000 | loss_llama=0.3789 | loss_qwen=6.7871 | grad_norm=53123.41
  step 400/5000 | loss_llama=0.5888 | loss_qwen=6.6675 | grad_norm=122.65
  step 410/5000 | loss_llama=1.6817 | loss_qwen=5.3625 | grad_norm=60483.71
  step 420/5000 | loss_llama=0.9359 | loss_qwen=4.2152 | grad_norm=70.41
  step 430/5000 | loss_llama=0.3740 | loss_qwen=7.9698 | grad_norm=53480.38
  step 440/5000 | loss_llama=1.3013 | loss_qwen=6.9285 | grad_norm=86812.70
  step 450/5000 | loss_llama=1.7801 | loss_qwen=5.3449 | grad_norm=52139.24
  step 460/5000 | loss_llama=1.7821 | loss_qwen=6.9800 | grad_norm=82.74
  step 470/5000 | loss_llama=1.7938 | loss_qwen=5.7764 | grad_norm=60.51
  step 480/5000 | loss_llama=0.7612 | loss_qwen=7.0910 | grad_norm=68501.11
  step 490/5000 | loss_llama=0.2652 | loss_qwen=5.1590 | grad_norm=114.59
  step 500/5000 | loss_llama=0.9731 | loss_qwen=6.7554 | grad_norm=4188.92
  ✅ Saved checkpoint at step 500
  step 510/5000 | loss_llama=0.7439 | loss_qwen=4.8975 | grad_norm=54264.04
  step 520/5000 | loss_llama=1.1396 | loss_qwen=8.5359 | grad_norm=85557.88
  step 530/5000 | loss_llama=0.3980 | loss_qwen=7.5019 | grad_norm=60400.41
  step 540/5000 | loss_llama=0.9397 | loss_qwen=6.2211 | grad_norm=39723.43
  step 550/5000 | loss_llama=0.9032 | loss_qwen=4.5161 | grad_norm=55428.50
  step 560/5000 | loss_llama=1.2651 | loss_qwen=5.9153 | grad_norm=61.61
  step 570/5000 | loss_llama=1.2343 | loss_qwen=4.6314 | grad_norm=39673.76
  step 580/5000 | loss_llama=0.3453 | loss_qwen=4.1967 | grad_norm=47635.93
  step 590/5000 | loss_llama=1.0494 | loss_qwen=5.7487 | grad_norm=57.20
  step 600/5000 | loss_llama=0.9518 | loss_qwen=5.3363 | grad_norm=50467.11
  step 610/5000 | loss_llama=1.2376 | loss_qwen=6.0660 | grad_norm=45113.05
  step 620/5000 | loss_llama=1.2167 | loss_qwen=5.1167 | grad_norm=50.01
  step 630/5000 | loss_llama=0.5978 | loss_qwen=6.2096 | grad_norm=66622.38
  step 640/5000 | loss_llama=1.1622 | loss_qwen=4.2119 | grad_norm=79951.94
  step 650/5000 | loss_llama=1.5757 | loss_qwen=4.4381 | grad_norm=103297.45
  step 660/5000 | loss_llama=0.2849 | loss_qwen=5.6636 | grad_norm=86.55
  step 670/5000 | loss_llama=1.4344 | loss_qwen=5.3512 | grad_norm=59389.50
  step 680/5000 | loss_llama=0.3227 | loss_qwen=5.4576 | grad_norm=87.63
  step 690/5000 | loss_llama=1.6616 | loss_qwen=4.5181 | grad_norm=43916.36
  step 700/5000 | loss_llama=0.8462 | loss_qwen=4.2178 | grad_norm=68.63
  step 710/5000 | loss_llama=1.1177 | loss_qwen=5.3025 | grad_norm=65343.55
  step 720/5000 | loss_llama=1.2715 | loss_qwen=4.9379 | grad_norm=69.31
  step 730/5000 | loss_llama=0.3425 | loss_qwen=7.5943 | grad_norm=122.24
  step 740/5000 | loss_llama=1.3177 | loss_qwen=8.2944 | grad_norm=112.90
  step 750/5000 | loss_llama=1.6847 | loss_qwen=3.8363 | grad_norm=36.16
  ✅ Saved checkpoint at step 750
  step 760/5000 | loss_llama=1.1139 | loss_qwen=6.0434 | grad_norm=52651.53
  step 770/5000 | loss_llama=0.5655 | loss_qwen=5.8028 | grad_norm=106.67
  step 780/5000 | loss_llama=0.4751 | loss_qwen=4.8155 | grad_norm=45860.21
  step 790/5000 | loss_llama=1.9342 | loss_qwen=5.7034 | grad_norm=64.86
  step 800/5000 | loss_llama=0.3298 | loss_qwen=6.7981 | grad_norm=93.91
  step 810/5000 | loss_llama=0.5859 | loss_qwen=6.1656 | grad_norm=97.97
  step 820/5000 | loss_llama=0.6724 | loss_qwen=4.6505 | grad_norm=56418.89
  step 830/5000 | loss_llama=1.4442 | loss_qwen=4.8408 | grad_norm=38484.43
  step 840/5000 | loss_llama=1.9319 | loss_qwen=6.1018 | grad_norm=40266.02
  step 850/5000 | loss_llama=0.9913 | loss_qwen=3.9643 | grad_norm=55.89
  step 860/5000 | loss_llama=1.2942 | loss_qwen=4.6870 | grad_norm=64615.52
  step 870/5000 | loss_llama=1.2705 | loss_qwen=4.0754 | grad_norm=48004.34
  step 880/5000 | loss_llama=0.2218 | loss_qwen=6.0575 | grad_norm=41862.65
  step 890/5000 | loss_llama=0.3658 | loss_qwen=3.4452 | grad_norm=66.37
  step 900/5000 | loss_llama=1.0235 | loss_qwen=4.9673 | grad_norm=85.05
  step 910/5000 | loss_llama=1.2214 | loss_qwen=4.0728 | grad_norm=70294.70
  step 920/5000 | loss_llama=1.0551 | loss_qwen=4.9853 | grad_norm=58.51
  step 930/5000 | loss_llama=0.5903 | loss_qwen=3.3270 | grad_norm=37.43
  step 940/5000 | loss_llama=1.0171 | loss_qwen=6.0889 | grad_norm=54039.25
  step 950/5000 | loss_llama=1.9912 | loss_qwen=4.5856 | grad_norm=61493.45
  step 960/5000 | loss_llama=4.0650 | loss_qwen=7.8793 | grad_norm=63010.15
  step 970/5000 | loss_llama=0.2835 | loss_qwen=4.7497 | grad_norm=67.56
  step 980/5000 | loss_llama=0.1812 | loss_qwen=4.8600 | grad_norm=78137.61
  step 990/5000 | loss_llama=0.3485 | loss_qwen=4.1836 | grad_norm=47793.90
  step 1000/5000 | loss_llama=1.2329 | loss_qwen=3.7028 | grad_norm=42.37
  ✅ Saved checkpoint at step 1000
  step 1010/5000 | loss_llama=0.3883 | loss_qwen=4.1259 | grad_norm=44195.95
  step 1020/5000 | loss_llama=0.8475 | loss_qwen=3.6824 | grad_norm=54660.39
  step 1030/5000 | loss_llama=1.0932 | loss_qwen=3.9491 | grad_norm=45361.82
  step 1040/5000 | loss_llama=2.0579 | loss_qwen=3.6488 | grad_norm=35.50
  step 1050/5000 | loss_llama=0.9230 | loss_qwen=3.7623 | grad_norm=43039.45
  step 1060/5000 | loss_llama=0.7733 | loss_qwen=4.6690 | grad_norm=63.59
  step 1070/5000 | loss_llama=0.7584 | loss_qwen=5.2764 | grad_norm=52182.61
  step 1080/5000 | loss_llama=1.5216 | loss_qwen=3.6705 | grad_norm=41996.50
  step 1090/5000 | loss_llama=1.0491 | loss_qwen=3.5825 | grad_norm=34.29
  step 1100/5000 | loss_llama=0.3728 | loss_qwen=5.8971 | grad_norm=78866.52
  step 1110/5000 | loss_llama=0.5985 | loss_qwen=3.1630 | grad_norm=41.73
  step 1120/5000 | loss_llama=0.4948 | loss_qwen=3.8780 | grad_norm=53462.50
  step 1130/5000 | loss_llama=0.2249 | loss_qwen=5.4660 | grad_norm=85244.77
  step 1140/5000 | loss_llama=2.5959 | loss_qwen=5.0450 | grad_norm=39676.04
  step 1150/5000 | loss_llama=0.9979 | loss_qwen=4.3965 | grad_norm=41.57
  step 1160/5000 | loss_llama=0.4095 | loss_qwen=5.0611 | grad_norm=53049.88
  step 1170/5000 | loss_llama=1.2897 | loss_qwen=3.9784 | grad_norm=37165.92
  step 1180/5000 | loss_llama=1.3137 | loss_qwen=4.8900 | grad_norm=55608.50
  step 1190/5000 | loss_llama=0.6036 | loss_qwen=3.9667 | grad_norm=49.72
  step 1200/5000 | loss_llama=0.8033 | loss_qwen=3.7494 | grad_norm=36697.48
  step 1210/5000 | loss_llama=0.2257 | loss_qwen=4.8608 | grad_norm=48.80
  step 1220/5000 | loss_llama=0.7787 | loss_qwen=5.0845 | grad_norm=83386.51
  step 1230/5000 | loss_llama=0.8754 | loss_qwen=4.7199 | grad_norm=543.41
  step 1240/5000 | loss_llama=1.2466 | loss_qwen=4.2664 | grad_norm=57180.33
  step 1250/5000 | loss_llama=1.1733 | loss_qwen=4.5764 | grad_norm=37.71
  ✅ Saved checkpoint at step 1250
  step 1260/5000 | loss_llama=0.9276 | loss_qwen=4.4122 | grad_norm=57.72
  step 1270/5000 | loss_llama=1.4072 | loss_qwen=4.7054 | grad_norm=45.88
  step 1280/5000 | loss_llama=0.2517 | loss_qwen=3.9894 | grad_norm=54553.64
  step 1290/5000 | loss_llama=0.8735 | loss_qwen=3.4813 | grad_norm=33.49
  step 1300/5000 | loss_llama=1.5566 | loss_qwen=4.3265 | grad_norm=53620.56
  step 1310/5000 | loss_llama=4.4978 | loss_qwen=8.3650 | grad_norm=66191.02
  step 1320/5000 | loss_llama=0.5600 | loss_qwen=4.6715 | grad_norm=60.53
  step 1330/5000 | loss_llama=2.4028 | loss_qwen=4.2749 | grad_norm=51.43
  step 1340/5000 | loss_llama=2.1742 | loss_qwen=5.2413 | grad_norm=44100.10
  step 1350/5000 | loss_llama=0.8537 | loss_qwen=3.3698 | grad_norm=36860.55
  step 1360/5000 | loss_llama=1.1261 | loss_qwen=3.6873 | grad_norm=34.37
  step 1370/5000 | loss_llama=1.3695 | loss_qwen=5.6185 | grad_norm=39.81
  step 1380/5000 | loss_llama=1.7567 | loss_qwen=4.4196 | grad_norm=29.20
  step 1390/5000 | loss_llama=0.7167 | loss_qwen=4.6530 | grad_norm=44.78
  step 1400/5000 | loss_llama=1.7546 | loss_qwen=4.5637 | grad_norm=45.61
  step 1410/5000 | loss_llama=0.5640 | loss_qwen=4.7683 | grad_norm=53.58
  step 1420/5000 | loss_llama=1.2130 | loss_qwen=3.7347 | grad_norm=59213.24
  step 1430/5000 | loss_llama=1.3916 | loss_qwen=4.6033 | grad_norm=25836.63
  step 1440/5000 | loss_llama=1.3526 | loss_qwen=3.3861 | grad_norm=42018.61
  step 1450/5000 | loss_llama=2.2200 | loss_qwen=6.9966 | grad_norm=51690.45
  step 1460/5000 | loss_llama=1.8364 | loss_qwen=4.7737 | grad_norm=60031.02
  step 1470/5000 | loss_llama=1.4599 | loss_qwen=3.9743 | grad_norm=29188.68
  step 1480/5000 | loss_llama=1.6072 | loss_qwen=5.1852 | grad_norm=43.79
  step 1490/5000 | loss_llama=0.2916 | loss_qwen=5.1519 | grad_norm=38383.29
  step 1500/5000 | loss_llama=1.2458 | loss_qwen=4.3508 | grad_norm=30.84
  ✅ Saved checkpoint at step 1500
  step 1510/5000 | loss_llama=0.4978 | loss_qwen=4.6786 | grad_norm=54.65
  step 1520/5000 | loss_llama=0.5360 | loss_qwen=3.0910 | grad_norm=24.97
  step 1530/5000 | loss_llama=0.4329 | loss_qwen=5.3535 | grad_norm=65967.12
  step 1540/5000 | loss_llama=3.0370 | loss_qwen=5.1168 | grad_norm=26.03
  step 1550/5000 | loss_llama=1.1911 | loss_qwen=4.4068 | grad_norm=39177.73
  step 1560/5000 | loss_llama=0.5751 | loss_qwen=3.7072 | grad_norm=28.22
  step 1570/5000 | loss_llama=4.2367 | loss_qwen=9.1574 | grad_norm=28.56
  step 1580/5000 | loss_llama=0.5749 | loss_qwen=4.2657 | grad_norm=46.53
  step 1590/5000 | loss_llama=0.2325 | loss_qwen=4.6103 | grad_norm=54.16
  step 1600/5000 | loss_llama=1.0212 | loss_qwen=5.6074 | grad_norm=49.65
  step 1610/5000 | loss_llama=0.5708 | loss_qwen=5.5801 | grad_norm=38117.88
  step 1620/5000 | loss_llama=0.5300 | loss_qwen=4.2049 | grad_norm=32.50
  step 1630/5000 | loss_llama=2.4361 | loss_qwen=6.4628 | grad_norm=47.69
  step 1640/5000 | loss_llama=0.6131 | loss_qwen=5.3410 | grad_norm=38648.98
  step 1650/5000 | loss_llama=0.6081 | loss_qwen=5.3577 | grad_norm=56.61
  step 1660/5000 | loss_llama=1.3281 | loss_qwen=4.7210 | grad_norm=37.56
  step 1670/5000 | loss_llama=0.6542 | loss_qwen=4.3330 | grad_norm=37.94
  step 1680/5000 | loss_llama=0.7636 | loss_qwen=3.3615 | grad_norm=68971.14
  step 1690/5000 | loss_llama=1.3577 | loss_qwen=5.8178 | grad_norm=54186.12
  step 1700/5000 | loss_llama=0.8520 | loss_qwen=4.3110 | grad_norm=37.87
  step 1710/5000 | loss_llama=1.2202 | loss_qwen=5.2840 | grad_norm=38.19
  step 1720/5000 | loss_llama=1.0948 | loss_qwen=4.4139 | grad_norm=40.67
  step 1730/5000 | loss_llama=1.8089 | loss_qwen=4.8399 | grad_norm=28749.10
  step 1740/5000 | loss_llama=0.8212 | loss_qwen=4.4730 | grad_norm=35.11
  step 1750/5000 | loss_llama=0.4773 | loss_qwen=6.0851 | grad_norm=61270.18
  ✅ Saved checkpoint at step 1750
  step 1760/5000 | loss_llama=1.2287 | loss_qwen=4.9215 | grad_norm=41.30
  step 1770/5000 | loss_llama=6.9628 | loss_qwen=9.6425 | grad_norm=41243.00
  step 1780/5000 | loss_llama=0.7954 | loss_qwen=3.8173 | grad_norm=32116.42
  step 1790/5000 | loss_llama=0.4577 | loss_qwen=4.7438 | grad_norm=50.55
  step 1800/5000 | loss_llama=3.2120 | loss_qwen=6.2013 | grad_norm=33.52
  step 1810/5000 | loss_llama=0.2007 | loss_qwen=5.0920 | grad_norm=47.46
  step 1820/5000 | loss_llama=1.4775 | loss_qwen=5.5364 | grad_norm=50597.03
  step 1830/5000 | loss_llama=0.5304 | loss_qwen=5.6836 | grad_norm=52117.61
  step 1840/5000 | loss_llama=0.7661 | loss_qwen=4.6028 | grad_norm=40760.24
  step 1850/5000 | loss_llama=0.5567 | loss_qwen=4.4371 | grad_norm=34223.81
  step 1860/5000 | loss_llama=0.8534 | loss_qwen=4.2030 | grad_norm=35.02
  step 1870/5000 | loss_llama=1.1191 | loss_qwen=4.5758 | grad_norm=31539.16
  step 1880/5000 | loss_llama=1.0644 | loss_qwen=5.3892 | grad_norm=30409.29
  step 1890/5000 | loss_llama=2.0112 | loss_qwen=5.6468 | grad_norm=41806.59
  step 1900/5000 | loss_llama=0.7979 | loss_qwen=5.1348 | grad_norm=36.65
  step 1910/5000 | loss_llama=2.2161 | loss_qwen=5.4346 | grad_norm=26.83
  step 1920/5000 | loss_llama=1.1956 | loss_qwen=3.8526 | grad_norm=33145.26
  step 1930/5000 | loss_llama=0.9362 | loss_qwen=4.5891 | grad_norm=31033.23
  step 1940/5000 | loss_llama=0.4420 | loss_qwen=4.7344 | grad_norm=35792.41
  step 1950/5000 | loss_llama=1.9940 | loss_qwen=5.7426 | grad_norm=26.13
  step 1960/5000 | loss_llama=0.7799 | loss_qwen=4.3205 | grad_norm=49373.51
  step 1970/5000 | loss_llama=1.8090 | loss_qwen=5.2122 | grad_norm=37.32
  step 1980/5000 | loss_llama=0.9100 | loss_qwen=5.2962 | grad_norm=46693.69
  step 1990/5000 | loss_llama=1.4885 | loss_qwen=4.8943 | grad_norm=41.31
  step 2000/5000 | loss_llama=1.5753 | loss_qwen=4.5287 | grad_norm=19.12
  ✅ Saved checkpoint at step 2000
  step 2010/5000 | loss_llama=0.6172 | loss_qwen=4.1116 | grad_norm=35420.05
  step 2020/5000 | loss_llama=0.5350 | loss_qwen=4.5171 | grad_norm=39.98
  step 2030/5000 | loss_llama=0.8209 | loss_qwen=4.0634 | grad_norm=38.88
  step 2040/5000 | loss_llama=0.9370 | loss_qwen=5.1710 | grad_norm=41.06
  step 2050/5000 | loss_llama=0.7137 | loss_qwen=5.0562 | grad_norm=50.89
  step 2060/5000 | loss_llama=0.6962 | loss_qwen=4.4394 | grad_norm=35335.42
  step 2070/5000 | loss_llama=0.5024 | loss_qwen=4.0794 | grad_norm=33.45
  step 2080/5000 | loss_llama=1.1474 | loss_qwen=4.7716 | grad_norm=33.15
  step 2090/5000 | loss_llama=1.5588 | loss_qwen=5.2812 | grad_norm=47885.89
  step 2100/5000 | loss_llama=0.8899 | loss_qwen=4.4221 | grad_norm=31838.17
  step 2110/5000 | loss_llama=0.4161 | loss_qwen=3.3126 | grad_norm=24.45
  step 2120/5000 | loss_llama=1.4529 | loss_qwen=4.9769 | grad_norm=30.39
  step 2130/5000 | loss_llama=0.6311 | loss_qwen=4.1068 | grad_norm=31552.26
  step 2140/5000 | loss_llama=0.4914 | loss_qwen=3.7904 | grad_norm=28422.59
  step 2150/5000 | loss_llama=0.9696 | loss_qwen=4.7386 | grad_norm=33686.04
  step 2160/5000 | loss_llama=0.4122 | loss_qwen=4.3426 | grad_norm=28.15
  step 2170/5000 | loss_llama=0.5968 | loss_qwen=4.0201 | grad_norm=44.93
  step 2180/5000 | loss_llama=0.5378 | loss_qwen=4.9029 | grad_norm=39286.44
  step 2190/5000 | loss_llama=0.3380 | loss_qwen=5.2078 | grad_norm=47.33
  step 2200/5000 | loss_llama=1.1732 | loss_qwen=3.7054 | grad_norm=26692.58
  step 2210/5000 | loss_llama=0.8529 | loss_qwen=5.9504 | grad_norm=45170.12
  step 2220/5000 | loss_llama=0.6705 | loss_qwen=3.9507 | grad_norm=34.98
  step 2230/5000 | loss_llama=0.7375 | loss_qwen=6.2255 | grad_norm=77155.02
  step 2240/5000 | loss_llama=0.7610 | loss_qwen=5.5014 | grad_norm=48.40
  step 2250/5000 | loss_llama=1.1736 | loss_qwen=5.3789 | grad_norm=32.75
  ✅ Saved checkpoint at step 2250
  step 2260/5000 | loss_llama=8.7254 | loss_qwen=9.5558 | grad_norm=18737.34
  step 2270/5000 | loss_llama=0.7710 | loss_qwen=4.6645 | grad_norm=40.71
  step 2280/5000 | loss_llama=0.8094 | loss_qwen=5.8352 | grad_norm=61344.72
  step 2290/5000 | loss_llama=0.8245 | loss_qwen=4.8671 | grad_norm=29.66
  step 2300/5000 | loss_llama=1.8242 | loss_qwen=5.2552 | grad_norm=30993.81
  step 2310/5000 | loss_llama=0.9467 | loss_qwen=4.3278 | grad_norm=30.91
  step 2320/5000 | loss_llama=0.6780 | loss_qwen=4.9247 | grad_norm=38542.93
  step 2330/5000 | loss_llama=0.4280 | loss_qwen=4.2920 | grad_norm=38446.09
  step 2340/5000 | loss_llama=0.2619 | loss_qwen=4.6730 | grad_norm=41966.66
  step 2350/5000 | loss_llama=0.6753 | loss_qwen=4.2189 | grad_norm=41045.54
  step 2360/5000 | loss_llama=1.4007 | loss_qwen=4.5941 | grad_norm=47795.06
  step 2370/5000 | loss_llama=1.0064 | loss_qwen=5.8898 | grad_norm=31703.75
  step 2380/5000 | loss_llama=0.7392 | loss_qwen=4.4377 | grad_norm=50694.39
  step 2390/5000 | loss_llama=0.8217 | loss_qwen=4.9037 | grad_norm=43.03
  step 2400/5000 | loss_llama=0.7067 | loss_qwen=5.1374 | grad_norm=41.72
  step 2410/5000 | loss_llama=0.4103 | loss_qwen=5.3023 | grad_norm=34.24
  step 2420/5000 | loss_llama=0.7157 | loss_qwen=4.4541 | grad_norm=27.42
  step 2430/5000 | loss_llama=1.3540 | loss_qwen=4.1847 | grad_norm=23.41
  step 2440/5000 | loss_llama=1.7687 | loss_qwen=5.3759 | grad_norm=30.54
  step 2450/5000 | loss_llama=0.9575 | loss_qwen=6.1235 | grad_norm=44417.21
  step 2460/5000 | loss_llama=1.4802 | loss_qwen=4.4136 | grad_norm=39554.52
  step 2470/5000 | loss_llama=2.1405 | loss_qwen=4.4182 | grad_norm=26.05
  step 2480/5000 | loss_llama=1.7176 | loss_qwen=4.5940 | grad_norm=28.54
  step 2490/5000 | loss_llama=0.4514 | loss_qwen=3.8510 | grad_norm=21.85
  step 2500/5000 | loss_llama=1.1706 | loss_qwen=4.5072 | grad_norm=35563.88
  ✅ Saved checkpoint at step 2500
  step 2510/5000 | loss_llama=1.0234 | loss_qwen=5.0137 | grad_norm=38.09
  step 2520/5000 | loss_llama=1.5659 | loss_qwen=5.6845 | grad_norm=45653.36
  step 2530/5000 | loss_llama=0.3475 | loss_qwen=4.5272 | grad_norm=30559.00
  step 2540/5000 | loss_llama=0.9987 | loss_qwen=5.6493 | grad_norm=40231.70
  step 2550/5000 | loss_llama=0.4330 | loss_qwen=3.8357 | grad_norm=39.07
  step 2560/5000 | loss_llama=0.4742 | loss_qwen=4.7241 | grad_norm=34.99
  step 2570/5000 | loss_llama=1.4230 | loss_qwen=3.7922 | grad_norm=34528.86
  step 2580/5000 | loss_llama=0.7569 | loss_qwen=4.1798 | grad_norm=27.80
  step 2590/5000 | loss_llama=1.7321 | loss_qwen=4.5508 | grad_norm=23.46
  step 2600/5000 | loss_llama=0.9636 | loss_qwen=5.4666 | grad_norm=43206.57
  step 2610/5000 | loss_llama=0.4030 | loss_qwen=4.0449 | grad_norm=21.86
  step 2620/5000 | loss_llama=3.7416 | loss_qwen=6.1471 | grad_norm=63353.50
  step 2630/5000 | loss_llama=0.9803 | loss_qwen=4.5398 | grad_norm=23.56
  step 2640/5000 | loss_llama=0.2032 | loss_qwen=5.2487 | grad_norm=56704.66
  step 2650/5000 | loss_llama=2.7540 | loss_qwen=5.0794 | grad_norm=17.35
  step 2660/5000 | loss_llama=1.0183 | loss_qwen=4.2400 | grad_norm=44082.06
  step 2670/5000 | loss_llama=1.3393 | loss_qwen=3.9211 | grad_norm=36265.14
  step 2680/5000 | loss_llama=1.4566 | loss_qwen=4.4584 | grad_norm=31031.39
  step 2690/5000 | loss_llama=1.4651 | loss_qwen=3.9740 | grad_norm=21.24
  step 2700/5000 | loss_llama=0.5359 | loss_qwen=4.5426 | grad_norm=57959.07
  step 2710/5000 | loss_llama=0.9660 | loss_qwen=3.7202 | grad_norm=29176.36
  step 2720/5000 | loss_llama=1.1148 | loss_qwen=5.2855 | grad_norm=41064.58
  step 2730/5000 | loss_llama=0.5369 | loss_qwen=4.9465 | grad_norm=39095.16
  step 2740/5000 | loss_llama=0.9964 | loss_qwen=4.9960 | grad_norm=35745.07
  step 2750/5000 | loss_llama=0.7729 | loss_qwen=4.5107 | grad_norm=28.06
  ✅ Saved checkpoint at step 2750
  step 2760/5000 | loss_llama=1.7761 | loss_qwen=4.9012 | grad_norm=25996.87
  step 2770/5000 | loss_llama=0.4492 | loss_qwen=4.4277 | grad_norm=36.02
  step 2780/5000 | loss_llama=1.0386 | loss_qwen=3.7740 | grad_norm=24.16
  step 2790/5000 | loss_llama=1.0293 | loss_qwen=4.3839 | grad_norm=27052.17
  step 2800/5000 | loss_llama=1.1462 | loss_qwen=4.5523 | grad_norm=40497.44
  step 2810/5000 | loss_llama=0.9207 | loss_qwen=4.5301 | grad_norm=28.78
  step 2820/5000 | loss_llama=0.6447 | loss_qwen=4.0703 | grad_norm=29.30
  step 2830/5000 | loss_llama=0.5025 | loss_qwen=4.8157 | grad_norm=27258.07
  step 2840/5000 | loss_llama=1.2570 | loss_qwen=5.2793 | grad_norm=29.07
  step 2850/5000 | loss_llama=0.9574 | loss_qwen=4.1250 | grad_norm=24.36
  step 2860/5000 | loss_llama=0.4506 | loss_qwen=5.3249 | grad_norm=43679.99
  step 2870/5000 | loss_llama=1.2325 | loss_qwen=4.6691 | grad_norm=21906.43
  step 2880/5000 | loss_llama=0.2317 | loss_qwen=4.9708 | grad_norm=42.83
  step 2890/5000 | loss_llama=1.0092 | loss_qwen=5.6874 | grad_norm=49579.33
  step 2900/5000 | loss_llama=0.2038 | loss_qwen=5.2147 | grad_norm=29556.52
  step 2910/5000 | loss_llama=1.4448 | loss_qwen=4.9504 | grad_norm=32248.48
  step 2920/5000 | loss_llama=0.8893 | loss_qwen=4.0368 | grad_norm=26.06
  step 2930/5000 | loss_llama=0.7886 | loss_qwen=5.9046 | grad_norm=40262.56
  step 2940/5000 | loss_llama=3.2248 | loss_qwen=7.3533 | grad_norm=23.72
  step 2950/5000 | loss_llama=2.0366 | loss_qwen=4.8782 | grad_norm=48589.77
  step 2960/5000 | loss_llama=0.4245 | loss_qwen=4.1385 | grad_norm=34469.33
  step 2970/5000 | loss_llama=0.9392 | loss_qwen=4.9083 | grad_norm=44759.29
  step 2980/5000 | loss_llama=0.6486 | loss_qwen=5.5835 | grad_norm=46958.63
  step 2990/5000 | loss_llama=0.6969 | loss_qwen=4.7104 | grad_norm=43456.42
  step 3000/5000 | loss_llama=0.9268 | loss_qwen=5.1226 | grad_norm=50240.48
  ✅ Saved checkpoint at step 3000
  step 3010/5000 | loss_llama=0.8051 | loss_qwen=5.8238 | grad_norm=33.90
  step 3020/5000 | loss_llama=0.3541 | loss_qwen=4.7846 | grad_norm=44.64
  step 3030/5000 | loss_llama=9.5869 | loss_qwen=12.3266 | grad_norm=16578.74
  step 3040/5000 | loss_llama=0.5646 | loss_qwen=6.0594 | grad_norm=40.89
  step 3050/5000 | loss_llama=1.4311 | loss_qwen=5.2333 | grad_norm=28460.93
  step 3060/5000 | loss_llama=0.4445 | loss_qwen=5.7256 | grad_norm=37402.29
  step 3070/5000 | loss_llama=1.8394 | loss_qwen=5.3025 | grad_norm=27.87
  step 3080/5000 | loss_llama=1.0783 | loss_qwen=4.2043 | grad_norm=60233.66
  step 3090/5000 | loss_llama=1.0174 | loss_qwen=4.8905 | grad_norm=41468.07
  step 3100/5000 | loss_llama=0.8461 | loss_qwen=4.6418 | grad_norm=24234.96
  step 3110/5000 | loss_llama=0.8108 | loss_qwen=5.2954 | grad_norm=41.40
  step 3120/5000 | loss_llama=2.0752 | loss_qwen=5.8069 | grad_norm=38102.39
  step 3130/5000 | loss_llama=0.8939 | loss_qwen=4.0666 | grad_norm=20.59
  step 3140/5000 | loss_llama=1.9357 | loss_qwen=5.0164 | grad_norm=18.31
  step 3150/5000 | loss_llama=1.8081 | loss_qwen=6.0387 | grad_norm=36855.19
  step 3160/5000 | loss_llama=1.5344 | loss_qwen=4.9688 | grad_norm=23.35
  step 3170/5000 | loss_llama=0.5059 | loss_qwen=6.3189 | grad_norm=38.64
  step 3180/5000 | loss_llama=1.4596 | loss_qwen=5.1334 | grad_norm=29491.50
/Users/sujeethjinesh/opt/anaconda3/lib/python3.9/multiprocessing/resource_tracker.py:216: UserWarning: resource_tracker: There appear to be 1 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
313
  step 4220/5000 | loss_llama=1.1245 | loss_qwen=12.4434
  step 4230/5000 | loss_llama=1.4182 | loss_qwen=11.8406
  step 4240/5000 | loss_llama=0.7448 | loss_qwen=12.5150
  step 4250/5000 | loss_llama=0.5565 | loss_qwen=12.0835
  step 4260/5000 | loss_llama=0.4716 | loss_qwen=10.9106
  step 4270/5000 | loss_llama=0.5521 | loss_qwen=11.9804
  step 4280/5000 | loss_llama=1.6006 | loss_qwen=13.5857
  step 4290/5000 | loss_llama=2.0595 | loss_qwen=12.7142
  step 4300/5000 | loss_llama=1.1057 | loss_qwen=13.1169
  step 4310/5000 | loss_llama=1.9947 | loss_qwen=13.3678
  step 4320/5000 | loss_llama=1.1706 | loss_qwen=13.1674
  step 4330/5000 | loss_llama=0.2109 | loss_qwen=12.3849
  step 4340/5000 | loss_llama=0.2511 | loss_qwen=11.1154
  step 4350/5000 | loss_llama=0.8679 | loss_qwen=12.5459
  step 4360/5000 | loss_llama=0.9403 | loss_qwen=10.9420
  step 4370/5000 | loss_llama=1.6562 | loss_qwen=10.5726
  step 4380/5000 | loss_llama=1.2326 | loss_qwen=10.1627
  step 4390/5000 | loss_llama=0.2320 | loss_qwen=6.8980
  step 4400/5000 | loss_llama=2.1027 | loss_qwen=8.0367
  step 4410/5000 | loss_llama=3.6064 | loss_qwen=8.5099
  step 4420/5000 | loss_llama=0.9400 | loss_qwen=3.3042
  step 4430/5000 | loss_llama=0.6437 | loss_qwen=3.1471
  step 4440/5000 | loss_llama=0.2599 | loss_qwen=1.8777
  step 4450/5000 | loss_llama=1.1126 | loss_qwen=2.6292
  step 4460/5000 | loss_llama=0.2285 | loss_qwen=0.7567
  step 4470/5000 | loss_llama=1.8901 | loss_qwen=2.8104
  step 4480/5000 | loss_llama=1.3954 | loss_qwen=2.3547
  step 4490/5000 | loss_llama=3.1971 | loss_qwen=5.0910
  step 4500/5000 | loss_llama=2.6657 | loss_qwen=3.9280
  step 4510/5000 | loss_llama=1.3721 | loss_qwen=2.3745
  step 4520/5000 | loss_llama=2.3151 | loss_qwen=2.6996
  step 4530/5000 | loss_llama=0.2076 | loss_qwen=0.1749
  step 4540/5000 | loss_llama=0.8039 | loss_qwen=1.2423
  step 4550/5000 | loss_llama=0.4567 | loss_qwen=1.1786
  step 4560/5000 | loss_llama=0.4813 | loss_qwen=0.7110
  step 4570/5000 | loss_llama=0.4610 | loss_qwen=1.0316
  step 4580/5000 | loss_llama=1.1334 | loss_qwen=1.8126
  step 4590/5000 | loss_llama=3.3487 | loss_qwen=4.5622
  step 4600/5000 | loss_llama=1.0123 | loss_qwen=2.0627
  step 4610/5000 | loss_llama=2.0487 | loss_qwen=3.1645
  step 4620/5000 | loss_llama=5.1814 | loss_qwen=9.3786
  step 4630/5000 | loss_llama=0.8763 | loss_qwen=8.2514
  step 4640/5000 | loss_llama=1.2474 | loss_qwen=10.5245
  step 4650/5000 | loss_llama=0.8280 | loss_qwen=11.2739
  step 4660/5000 | loss_llama=1.2696 | loss_qwen=10.9852
  step 4670/5000 | loss_llama=0.4142 | loss_qwen=10.6887
  step 4680/5000 | loss_llama=0.6481 | loss_qwen=9.7878
  step 4690/5000 | loss_llama=0.9665 | loss_qwen=7.3845
  step 4700/5000 | loss_llama=0.7612 | loss_qwen=6.6119
  step 4710/5000 | loss_llama=1.0366 | loss_qwen=5.5153
  step 4720/5000 | loss_llama=0.6736 | loss_qwen=3.6121
  step 4730/5000 | loss_llama=2.1174 | loss_qwen=3.9438
  step 4740/5000 | loss_llama=1.1326 | loss_qwen=2.7079
  step 4750/5000 | loss_llama=0.7664 | loss_qwen=1.8596
  step 4760/5000 | loss_llama=1.9960 | loss_qwen=3.1933
  step 4770/5000 | loss_llama=0.6841 | loss_qwen=1.2241
  step 4780/5000 | loss_llama=1.9749 | loss_qwen=2.3127
  step 4790/5000 | loss_llama=1.0157 | loss_qwen=1.5109
  step 4800/5000 | loss_llama=0.6035 | loss_qwen=1.9156
  step 4810/5000 | loss_llama=1.4376 | loss_qwen=1.8850
  step 4820/5000 | loss_llama=1.7058 | loss_qwen=2.7409
  step 4830/5000 | loss_llama=1.8023 | loss_qwen=3.0408
  step 4840/5000 | loss_llama=1.0914 | loss_qwen=4.9329
  step 4850/5000 | loss_llama=0.3739 | loss_qwen=9.0889
  step 4860/5000 | loss_llama=1.3491 | loss_qwen=9.6500
  step 4870/5000 | loss_llama=1.8043 | loss_qwen=9.3724
  step 4880/5000 | loss_llama=0.4765 | loss_qwen=9.7863
  step 4890/5000 | loss_llama=1.8653 | loss_qwen=10.9366
  step 4900/5000 | loss_llama=1.4036 | loss_qwen=10.5675
  step 4910/5000 | loss_llama=0.1660 | loss_qwen=9.8930
  step 4920/5000 | loss_llama=1.9196 | loss_qwen=10.1375
  step 4930/5000 | loss_llama=0.9792 | loss_qwen=7.1321
  step 4940/5000 | loss_llama=1.3464 | loss_qwen=6.7651
  step 4950/5000 | loss_llama=1.2621 | loss_qwen=6.1636
  step 4960/5000 | loss_llama=1.8071 | loss_qwen=5.4118
  step 4970/5000 | loss_llama=0.7566 | loss_qwen=3.6587
  step 4980/5000 | loss_llama=2.2052 | loss_qwen=4.2617
  step 4990/5000 | loss_llama=0.4475 | loss_qwen=1.8423
  step 5000/5000 | loss_llama=1.5065 | loss_qwen=2.5600
Saved encoder and adapters to ./ckpt_m8
